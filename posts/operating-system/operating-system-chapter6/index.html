<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥ - Jungle&#39;s Blog</title><meta name="description" content="Welcome to Jungle&#39;s blog."><meta property="og:title" content="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥" />
<meta property="og:description" content="Operating System $Nanjing\ University\rightarrow Yanyan\ Jiang\newline$ Update Update in 2023-03-10 20:48 åœ¨æ´²çš„æé†’ä¸‹ï¼Œâœ‹æ‰å‘ç°åŸæ¥ç§Ÿå›½å¤–ç”µè¯å·é‚£ä¸ªç½‘ç«™å¯ä»¥æœ‰è®¿é—®ChatGPTçš„æ•™ç¨‹ï¼Œä¹‹å‰é¦–å°”çº¿å’Œç¾å›½çº¿éƒ½å› ä¸ºåIPç»™banäº†" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-10T20:32:20+08:00" />
<meta property="article:modified_time" content="2023-03-10T20:32:20+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥"/>
<meta name="twitter:description" content="Operating System $Nanjing\ University\rightarrow Yanyan\ Jiang\newline$ Update Update in 2023-03-10 20:48 åœ¨æ´²çš„æé†’ä¸‹ï¼Œâœ‹æ‰å‘ç°åŸæ¥ç§Ÿå›½å¤–ç”µè¯å·é‚£ä¸ªç½‘ç«™å¯ä»¥æœ‰è®¿é—®ChatGPTçš„æ•™ç¨‹ï¼Œä¹‹å‰é¦–å°”çº¿å’Œç¾å›½çº¿éƒ½å› ä¸ºåIPç»™banäº†"/>
<meta name="application-name" content="Jungle&#39;s blog">
<meta name="apple-mobile-web-app-title" content="Jungle&#39;s blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" /><link rel="prev" href="https://Jungle430.github.io/posts/operating-system/operating-system-chapter5/" /><link rel="next" href="https://Jungle430.github.io/posts/operating-system/operating-system-chapter7/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/Jungle430.github.io\/posts\/operating-system\/operating-system-chapter6\/"
        },"genre": "posts","keywords": "Operating System","wordcount":  24441 ,
        "url": "https:\/\/Jungle430.github.io\/posts\/operating-system\/operating-system-chapter6\/","datePublished": "2023-03-10T20:32:20+08:00","dateModified": "2023-03-10T20:32:20+08:00","publisher": {
            "@type": "Organization",
            "name": "Jungle"},"author": {
                "@type": "Person",
                "name": "Jungle"
            },"description": ""
    }
    </script></head><body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Jungle&#39;s Blog">Jungle&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/">ğŸ“š æ–‡ç«  </a><a class="menu-item" href="/tags/">ğŸ·ï¸ æ ‡ç­¾ </a><a class="menu-item" href="/categories/">ğŸ—ƒï¸ åˆ†ç±» </a><a class="menu-item" href="/about/">ğŸ‘´ å…³äº </a><a class="menu-item" href="https://github.com/Jungle430" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Jungle&#39;s Blog">Jungle&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">ğŸ“šæ–‡ç« </a><a class="menu-item" href="/tags/" title="">ğŸ·ï¸æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">ğŸ—ƒï¸åˆ†ç±»</a><a class="menu-item" href="/about/" title="">ğŸ‘´å…³äº</a><a class="menu-item" href="https://github.com/Jungle430" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="enable"><div class="single-card" ><h2 class="single-title animated flipInX">Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="https://github.com/Jungle430" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Jungle</a></span>&nbsp;<span class="post-category">å‡ºç‰ˆäº  <a href="/categories/operating-system/"><i class="far fa-folder fa-fw"></i>Operating System</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2023-03-10">2023-03-10</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 24441 å­—</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 49 åˆ†é’Ÿ</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>ç›®å½•</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#çº¿ç¨‹åŒæ­¥">çº¿ç¨‹åŒæ­¥</a>
      <ul>
        <li><a href="#åŒæ­¥-synchronization">åŒæ­¥ (Synchronization)</a></li>
        <li><a href="#å¹¶å‘ç¨‹åºä¸­çš„åŒæ­¥">å¹¶å‘ç¨‹åºä¸­çš„åŒæ­¥</a></li>
        <li><a href="#ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜å­¦åºŸä½ å°±èµ¢äº†">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šå­¦åºŸä½ å°±èµ¢äº†</a>
          <ul>
            <li><a href="#ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜åˆ†æ">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šåˆ†æ</a></li>
          </ul>
        </li>
        <li><a href="#è¡¥å……åˆ©ç”¨rustçš„è‡ªæ—‹é”å®ç°ä¸Šè¿°é—®é¢˜">è¡¥å……ï¼šåˆ©ç”¨<code>Rust</code>çš„è‡ªæ—‹é”å®ç°ä¸Šè¿°é—®é¢˜</a></li>
      </ul>
    </li>
    <li><a href="#æ¡ä»¶å˜é‡ä¸‡èƒ½åŒæ­¥æ–¹æ³•">æ¡ä»¶å˜é‡ï¼šä¸‡èƒ½åŒæ­¥æ–¹æ³•</a>
      <ul>
        <li><a href="#åŒæ­¥é—®é¢˜åˆ†æ">åŒæ­¥é—®é¢˜ï¼šåˆ†æ</a></li>
        <li><a href="#conditional-variables-æ¡ä»¶å˜é‡-cv">Conditional Variables (æ¡ä»¶å˜é‡, CV)</a></li>
        <li><a href="#æ¡ä»¶å˜é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">æ¡ä»¶å˜é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</a></li>
        <li><a href="#æ¡ä»¶å˜é‡æ­£ç¡®çš„æ‰“å¼€æ–¹å¼">æ¡ä»¶å˜é‡ï¼šæ­£ç¡®çš„æ‰“å¼€æ–¹å¼</a></li>
        <li><a href="#æ¡ä»¶å˜é‡å®ç°å¹¶è¡Œè®¡ç®—">æ¡ä»¶å˜é‡ï¼šå®ç°å¹¶è¡Œè®¡ç®—</a></li>
        <li><a href="#æ¡ä»¶å˜é‡æ›´å¤æ€ªçš„ä¹ é¢˜é¢è¯•é¢˜">æ¡ä»¶å˜é‡ï¼šæ›´å¤æ€ªçš„ä¹ é¢˜/é¢è¯•é¢˜</a></li>
      </ul>
    </li>
    <li><a href="#ä¿¡å·é‡">ä¿¡å·é‡</a>
      <ul>
        <li><a href="#å¤ä¹ äº’æ–¥é”å’Œæ›´è¡£å®¤ç®¡ç†">å¤ä¹ ï¼šäº’æ–¥é”å’Œæ›´è¡£å®¤ç®¡ç†</a></li>
        <li><a href="#æ›´è¡£å®¤ç®¡ç†">æ›´è¡£å®¤ç®¡ç†</a></li>
        <li><a href="#æ›´è¡£å®¤ç®¡ç†-by-ew-dijkstra">æ›´è¡£å®¤ç®¡ç† (by E.W. Dijkstra)</a></li>
        <li><a href="#ä¿¡å·é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">ä¿¡å·é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</a></li>
      </ul>
    </li>
    <li><a href="#å“²å­¦å®¶åƒé¥­é—®é¢˜e-w-dijkstra-1960">å“²â™‚ï¸å­¦å®¶åƒé¥­é—®é¢˜(E. W. Dijkstra, 1960)</a>
      <ul>
        <li><a href="#å¤±è´¥ä¸æˆåŠŸçš„å°è¯•">å¤±è´¥ä¸æˆåŠŸçš„å°è¯•</a></li>
        <li><a href="#å¿˜äº†ä¿¡å·é‡è®©ä¸€ä¸ªäººé›†ä¸­ç®¡ç†å‰å­å§">å¿˜äº†ä¿¡å·é‡ï¼Œè®©ä¸€ä¸ªäººé›†ä¸­ç®¡ç†å‰å­å§ï¼</a></li>
        <li><a href="#å¿˜äº†é‚£äº›å¤æ‚çš„åŒæ­¥ç®—æ³•å§">å¿˜äº†é‚£äº›å¤æ‚çš„åŒæ­¥ç®—æ³•å§ï¼</a></li>
      </ul>
    </li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#è¡¥å……è¿›ç¨‹è°ƒåº¦scheduling">è¡¥å……ï¼šè¿›ç¨‹è°ƒåº¦$(Scheduling)$</a>
      <ul>
        <li><a href="#å¯¼è¯»">å¯¼è¯»</a></li>
        <li><a href="#æ‰¹å¤„ç†ç³»ç»Ÿçš„è°ƒåº¦">æ‰¹å¤„ç†ç³»ç»Ÿçš„è°ƒåº¦</a>
          <ul>
            <li><a href="#çº¦æŸæ¡ä»¶">çº¦æŸæ¡ä»¶</a></li>
            <li><a href="#æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</a></li>
            <li><a href="#å…ˆæ¥å…ˆæœåŠ¡">å…ˆæ¥å…ˆæœåŠ¡</a></li>
            <li><a href="#æœ€çŸ­ä½œä¸šä¼˜å…ˆ">æœ€çŸ­ä½œä¸šä¼˜å…ˆ</a></li>
          </ul>
        </li>
        <li><a href="#äº¤äº’å¼ç³»ç»Ÿçš„è°ƒåº¦">äº¤äº’å¼ç³»ç»Ÿçš„è°ƒåº¦</a>
          <ul>
            <li><a href="#çº¦æŸæ¡ä»¶-1">çº¦æŸæ¡ä»¶</a></li>
            <li><a href="#æ€§èƒ½æŒ‡æ ‡-1">æ€§èƒ½æŒ‡æ ‡</a></li>
            <li><a href="#æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆstcf">æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆï¼ˆ<code>STCF</code>ï¼‰</a></li>
            <li><a href="#åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬">åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬</a></li>
          </ul>
        </li>
        <li><a href="#é€šç”¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">é€šç”¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</a>
          <ul>
            <li><a href="#çº¦æŸæ¡ä»¶-2">çº¦æŸæ¡ä»¶</a></li>
            <li><a href="#æ€§èƒ½æŒ‡æ ‡-2">æ€§èƒ½æŒ‡æ ‡</a></li>
            <li><a href="#å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦">å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦</a>
              <ul>
                <li><a href="#å›ºå®šä¼˜å…ˆçº§çš„å¤šçº§æ— åé¦ˆé˜Ÿåˆ—">å›ºå®šä¼˜å…ˆçº§çš„å¤šçº§æ— åé¦ˆé˜Ÿåˆ—</a></li>
                <li><a href="#å¯é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—">å¯é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—</a></li>
                <li><a href="#å¯æå‡é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—">å¯æå‡/é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—</a></li>
              </ul>
            </li>
            <li><a href="#å…¬å¹³ä»½é¢è°ƒåº¦">å…¬å¹³ä»½é¢è°ƒåº¦</a></li>
          </ul>
        </li>
        <li><a href="#å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</a>
          <ul>
            <li><a href="#çº¦æŸæ¡ä»¶-3">çº¦æŸæ¡ä»¶</a></li>
            <li><a href="#æ€§èƒ½æŒ‡æ ‡-3">æ€§èƒ½æŒ‡æ ‡</a></li>
            <li><a href="#é€Ÿç‡å•è°ƒè°ƒåº¦">é€Ÿç‡å•è°ƒè°ƒåº¦</a></li>
            <li><a href="#edfè°ƒåº¦">EDFè°ƒåº¦</a></li>
            <li><a href="#å®æ—¶è°ƒåº¦å®ä¾‹">å®æ—¶è°ƒåº¦å®ä¾‹</a></li>
          </ul>
        </li>
        <li><a href="#å¤šå¤„ç†å™¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">å¤šå¤„ç†å™¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</a>
          <ul>
            <li><a href="#çº¦æŸæ¡ä»¶-4">çº¦æŸæ¡ä»¶</a></li>
            <li><a href="#æ€§èƒ½æŒ‡æ ‡-4">æ€§èƒ½æŒ‡æ ‡</a></li>
            <li><a href="#å•é˜Ÿåˆ—è°ƒåº¦">å•é˜Ÿåˆ—è°ƒåº¦</a>
              <ul>
                <li><a href="#å¤„ç†å™¨äº²å’Œæ€§">å¤„ç†å™¨äº²å’Œæ€§</a></li>
              </ul>
            </li>
            <li><a href="#å¤šé˜Ÿåˆ—è°ƒåº¦">å¤šé˜Ÿåˆ—è°ƒåº¦</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="operating-system">Operating System</h1>
<p>$Nanjing\ University\rightarrow Yanyan\ Jiang\newline$</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Update in 2023-03-10 20:48</p>
<p>åœ¨æ´²çš„æé†’ä¸‹ï¼Œâœ‹æ‰å‘ç°åŸæ¥ç§Ÿå›½å¤–ç”µè¯å·é‚£ä¸ªç½‘ç«™å¯ä»¥æœ‰è®¿é—®<a href="https://openai.com/blog/chatgpt" target="_blank" rel="noopener noreffer">ChatGPT</a>çš„æ•™ç¨‹ï¼Œä¹‹å‰é¦–å°”çº¿å’Œç¾å›½çº¿éƒ½å› ä¸ºåIPç»™banäº†ï¼Œè¿™ç½‘ç«™éƒ½æ²¡ä»”ç»†çœ‹ï¼ŒçœŸæ˜¯è¡€äº</p>
</div>
        </div>
    </div>
<h2 id="overview">Overview</h2>
<p>å¤ä¹ </p>
<ul>
<li>äº’æ–¥ï¼šè‡ªæ—‹é”ã€äº’æ–¥é”ã€futex</li>
<li><del>æ˜¯æ—¶å€™é¢å¯¹çœŸæ­£çš„å¹¶å‘ç¼–ç¨‹äº†</del></li>
</ul>
<hr>
<p>æœ¬æ¬¡è¯¾å›ç­”çš„é—®é¢˜</p>
<ul>
<li><strong>Q</strong>: <b>å¦‚ä½•åœ¨å¤šå¤„ç†å™¨ä¸ŠååŒå¤šä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼Ÿ</b></li>
</ul>
<hr>
<p>æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹</p>
<ul>
<li>å…¸å‹çš„åŒæ­¥é—®é¢˜ï¼š<b>ç”Ÿäº§è€…-æ¶ˆè´¹è€…</b>ï¼›å“²å­¦å®¶åƒé¥­</li>
<li>åŒæ­¥çš„å®ç°æ–¹æ³•ï¼šä¿¡å·é‡ã€æ¡ä»¶å˜é‡</li>
</ul>
<h2 id="çº¿ç¨‹åŒæ­¥">çº¿ç¨‹åŒæ­¥</h2>
<h3 id="åŒæ­¥-synchronization">åŒæ­¥ (Synchronization)</h3>
<ul>
<li>
<p><b>ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šéšæ—¶é—´å˜åŒ–çš„é‡åœ¨å˜åŒ–è¿‡ç¨‹ä¸­ä¿æŒä¸€å®šçš„<u>ç›¸å¯¹å…³ç³»</u></b></p>
</li>
<li>
<p>iPhone/iCloud åŒæ­¥ (æ‰‹æœº vs ç”µè„‘ vs äº‘ç«¯)</p>
</li>
<li>
<p>å˜é€Ÿç®±åŒæ­¥å™¨ (åˆå¹¶å¿«æ…¢é€Ÿé½¿è½®)</p>
</li>
<li>
<p>åŒæ­¥ç”µæœº (è½¬å­ä¸ç£åœºé€Ÿåº¦ä¸€è‡´)</p>
</li>
<li>
<p>åŒæ­¥ç”µè·¯ (æ‰€æœ‰è§¦å‘å™¨åœ¨è¾¹æ²¿åŒæ—¶è§¦å‘)</p>
</li>
</ul>
<hr>
<ul>
<li><b>å¼‚æ­¥ (Asynchronous) = ä¸åŒæ­¥</b>
<ul>
<li>ä¸Šè¿°å¾ˆå¤šä¾‹å­éƒ½æœ‰å¼‚æ­¥ç‰ˆæœ¬ (å¼‚æ­¥ç”µæœºã€å¼‚æ­¥ç”µè·¯ã€å¼‚æ­¥çº¿ç¨‹)</li>
</ul>
</li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Update in 2023-03-11 14:00</p>
<p>ä¹Œç­å›¾æ‰“èµ¢å¤æ´»èµ›æˆåŠŸ $\Longrightarrow$ å¤§çˆ¹å¤æ´»åšå®¢<a href="https://blog.csdn.net/ningmengzhihe/article/details/127295333" target="_blank" rel="noopener noreffer">ã€ŠGPartedç»™ubuntuç³»ç»Ÿç£ç›˜resizeå¤§å°æ—¶å€™å‡ºç°cannot resize read-only file systemè§£å†³åŠæ³•ã€‹</a></p>
<p>ä¸‹åˆç»§ç»­æ‹¿ç€ä¹Œç­å›¾å¬è¯¾</p>
</div>
        </div>
    </div>
<h3 id="å¹¶å‘ç¨‹åºä¸­çš„åŒæ­¥">å¹¶å‘ç¨‹åºä¸­çš„åŒæ­¥</h3>
<ul>
<li>
<p><b>å¹¶å‘ç¨‹åºçš„æ­¥è°ƒå¾ˆéš¾ä¿æŒ â€œ<font color="red">å®Œå…¨</font>ä¸€è‡´â€</b></p>
<ul>
<li><b>çº¿ç¨‹åŒæ­¥ï¼š<font color="red">åœ¨æŸä¸ªæ—¶é—´ç‚¹å…±åŒè¾¾åˆ°äº’ç›¸å·²çŸ¥çš„çŠ¶æ€</font></b>ï¼Œï¼ˆå…ˆæ•´å®Œçš„ç­‰å¦ä¸€ä¸ª</li>
</ul>
</li>
<li>
<p>å†æ¬¡æŠŠçº¿ç¨‹æƒ³è±¡æˆæˆ‘ä»¬è‡ªå·±</p>
<ul>
<li>NPYï¼šç­‰æˆ‘æ´—ä¸ªå¤´å°±å‡ºé—¨/ç­‰æˆ‘æ‰“å®Œè¿™å±€æ¸¸æˆå°±æ¥</li>
<li>èˆå‹ï¼šç­‰æˆ‘ä¿®å¥½è¿™ä¸ª bug å°±åƒé¥­</li>
<li>å¯¼å¸ˆï¼šç­‰æˆ‘å‡ºå·®å›æ¥å°±è®¨è®ºè¿™ä¸ªè¯¾é¢˜</li>
<li>jyyï¼š<del>ç­‰æˆ‘æˆä¸ºå·ç‹å°±èººå¹³</del>
<ul>
<li><font color="red"><b>â€œå…ˆåˆ°å…ˆç­‰â€</b></font></li>
</ul>
</li>
</ul>
</li>
<li>
<p>ç›®æ ‡ï¼šå†™çº¿ç¨‹æ¨¡æ‹Ÿä¸Šé¢çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚Açº¿ç¨‹ä»£è¡¨ä½ æ‰“æ¸¸æˆï¼ŒBçº¿ç¨‹ä»£è¡¨ä½ èˆå‹ä¿®bugï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹è¦åšçš„æ˜¯åœ¨ä½ æ‰“å®Œæ¸¸æˆï¼Œèˆå‹ä¿®å®Œbugä¹‹åä¸€èµ·å»å¹²é¥­</p>
</li>
</ul>
<h3 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜å­¦åºŸä½ å°±èµ¢äº†">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šå­¦åºŸä½ å°±èµ¢äº†</h3>
<blockquote>
<p><b><font color="red">99% çš„å®é™…å¹¶å‘é—®é¢˜éƒ½å¯ä»¥ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…è§£å†³ã€‚</font></b></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tproduce</span><span class="p">()</span> <span class="p">{</span> <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tconsume</span><span class="p">()</span> <span class="p">{</span> <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ <code>printf</code> å‰åå¢åŠ ä»£ç ï¼Œä½¿å¾—æ‰“å°çš„æ‹¬å·åºåˆ—æ»¡è¶³</p>
<ul>
<li>ä¸€å®šæ˜¯æŸä¸ªåˆæ³•æ‹¬å·åºåˆ—çš„<b>å‰ç¼€</b></li>
<li>æ‹¬å·<b>åµŒå¥—çš„æ·±åº¦</b>ä¸è¶…è¿‡$n$
<ul>
<li>$n=3$, <code>((())())(((</code> åˆæ³•</li>
<li>$n=3$, <code>(((())))</code>, <code>(()))</code> ä¸åˆæ³•</li>
</ul>
</li>
<li>åŒæ­¥
<ul>
<li><b>ç­‰åˆ°æœ‰ç©ºä½ï¼ˆåµŒå¥—å±‚æ•°ä¸å¤šï¼‰å†æ‰“å°å·¦æ‹¬å·</b></li>
<li><b>ç­‰åˆ°èƒ½é…å¯¹æ—¶å†æ‰“å°å³æ‹¬å·</b></li>
</ul>
</li>
</ul>
<h4 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜åˆ†æ">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šåˆ†æ</h4>
<ul>
<li>
<p>ä¸ºä»€ä¹ˆå« â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€ è€Œä¸æ˜¯ â€œæ‹¬å·é—®é¢˜â€ï¼Ÿ</p>
<ul>
<li>
<p><b>å·¦æ‹¬å·ï¼šç”Ÿäº§èµ„æº (ä»»åŠ¡)ã€æ”¾å…¥é˜Ÿåˆ—</b></p>
</li>
<li>
<p><b>å³æ‹¬å·ï¼šä»é˜Ÿåˆ—å–å‡ºèµ„æº (ä»»åŠ¡) æ‰§è¡Œ</b></p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>èƒ½å¦ç”¨äº’æ–¥é”å®ç°æ‹¬å·é—®é¢˜ï¼Ÿ</p>
<ul>
<li>å·¦æ‹¬å·ï¼šåµŒå¥—æ·±åº¦ (é˜Ÿåˆ—) ä¸è¶³$n$æ—¶æ‰èƒ½æ‰“å°</li>
<li>å³æ‹¬å·ï¼šåµŒå¥—æ·±åº¦ (é˜Ÿåˆ—) &gt; 1æ—¶æ‰èƒ½æ‰“å°</li>
</ul>
</li>
<li>
<p><font color="red">å½“ç„¶æ˜¯ç­‰åˆ°æ»¡è¶³æ¡ä»¶æ—¶å†æ‰“å°äº†</font>ï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/pc.c" target="_blank" rel="noopener noreffer">pc.c</a></p>
<ul>
<li><font color="red">ç”¨äº’æ–¥é”ä¿æŒæ¡ä»¶æˆç«‹</font></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread-sync.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">mutex_t</span> <span class="n">lk</span> <span class="o">=</span> <span class="n">MUTEX_INIT</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tproduce</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">retry</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">goto</span> <span class="n">retry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tconsume</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">retry</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">goto</span> <span class="n">retry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">assert</span><span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tproduce</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tconsume</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å‹åŠ›æµ‹è¯•çš„æ£€æŸ¥å½“ç„¶ä¸èƒ½å°‘ï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/pc-check.py" target="_blank" rel="noopener noreffer">pc-check.py</a> $\Longrightarrow$ <b>å­¦ä¸€é—¨è„šæœ¬è¯­è¨€æ¥åšè‡ªåŠ¨åŒ–æ£€æµ‹ï¼ˆå¾ˆé‡è¦ï¼ï¼‰ï¼Œæ€»æ¯”$OJ$ç»™ä½ æŠ¥é”™ä½ ä¸çŸ¥é“é”™åœ¨å“ªé‡Œå¥½å¾ˆå¤š</b></li>
<li>å°‘é¢å‘OJç¼–ç¨‹ï¼ˆçœŸæ­£çš„projectæ²¡æœ‰è¿™ç©æ„å„¿ï¼‰</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-1.png" title="/img/Operating System/chapter6-1.png" data-thumbnail="/img/Operating System/chapter6-1.png" data-sub-html="<h2>æœ‰æ—¶é—´çœ‹ä¸€çœ‹</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-1.png"
            data-srcset="/img/Operating%20System/chapter6-1.png, /img/Operating%20System/chapter6-1.png 1.5x, /img/Operating%20System/chapter6-1.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-1.png" />
    </a><figcaption class="image-caption">æœ‰æ—¶é—´çœ‹ä¸€çœ‹</figcaption>
    </figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">count</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span> <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span> <span class="n">count</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> Ok.&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Model checker å½“ç„¶ä¹Ÿä¸èƒ½å°‘ (ç•™ä½œä¹ é¢˜)</p>
</li>
<li>
<p>ç®¡é“é€šä¿¡+è‡ªåŠ¨åŒ–è„šæœ¬æ£€æµ‹</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> 2023-03-11 15:21:02 âŒš  jungle-virtual-machine in ~/chapter6
</span></span><span class="line"><span class="cl">â—‹ â†’ ./pc <span class="m">3</span> <span class="p">|</span> python3 pc-check.py <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 2023-03-11 15:23:26 âŒš  jungle-virtual-machine in ~/chapter6
</span></span><span class="line"><span class="cl">â—‹ â†’ ./pc <span class="m">3</span> <span class="p">|</span> python3 pc-check.py <span class="m">2</span>
</span></span><span class="line"><span class="cl">Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/home/jungle/chapter6/pc-check.py&#34;</span>, line 9, in &lt;module&gt;
</span></span><span class="line"><span class="cl">    assert <span class="m">0</span> &lt;<span class="o">=</span> count &lt;<span class="o">=</span> limit
</span></span><span class="line"><span class="cl">AssertionError
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¡¥å……åˆ©ç”¨rustçš„è‡ªæ—‹é”å®ç°ä¸Šè¿°é—®é¢˜">è¡¥å……ï¼šåˆ©ç”¨<code>Rust</code>çš„è‡ªæ—‹é”å®ç°ä¸Šè¿°é—®é¢˜</h3>
<ul>
<li><code>lib.rs</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">Write</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">sync</span>::<span class="p">{</span><span class="n">Arc</span><span class="p">,</span><span class="w"> </span><span class="n">Mutex</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>:<span class="err">ğŸ§µ</span>:<span class="p">{</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">JoinHandle</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">Produceconsume</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">counter</span>: <span class="nc">Arc</span><span class="o">&lt;</span><span class="n">Mutex</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">max</span>: <span class="kt">u32</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">channel</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">JoinHandle</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Produceconsume</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">n</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Produceconsume</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span>::<span class="n">new</span><span class="p">(</span><span class="n">Mutex</span>::<span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Produceconsume</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">counter</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">max</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">channel</span>: <span class="nc">vec</span><span class="o">!</span><span class="p">[],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">produce</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span>::<span class="n">clone</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">counter</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">max</span><span class="p">;</span><span class="w"> </span><span class="c1">// å°† max å¤åˆ¶åˆ°é—­åŒ…ä¸­ï¼Œé¿å…å¯¹ self è¿›è¡Œ Move
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">hand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thread</span>::<span class="n">spawn</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="n">lock</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">*</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">continue</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="o">*</span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="fm">print!</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">stdout</span><span class="p">().</span><span class="n">flush</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">channel</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">hand</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">consume</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span>::<span class="n">clone</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">counter</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">hand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thread</span>::<span class="n">spawn</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="n">lock</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">*</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">continue</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="o">*</span><span class="n">count</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="fm">print!</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">stdout</span><span class="p">().</span><span class="n">flush</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">channel</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">hand</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">join</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">channel</span><span class="p">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">channel</span><span class="p">.</span><span class="n">pop</span><span class="p">().</span><span class="n">unwrap</span><span class="p">().</span><span class="n">join</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>main.rs</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">rust_practice</span>::<span class="n">Produceconsume</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span>::<span class="n">env</span>::<span class="n">args</span><span class="p">().</span><span class="n">skip</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">n</span>: <span class="kt">u32</span> <span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">next</span><span class="p">().</span><span class="n">unwrap</span><span class="p">().</span><span class="n">parse</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="fm">assert_ne!</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">pac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Produceconsume</span>::<span class="n">new</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">pac</span><span class="p">.</span><span class="n">produce</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">pac</span><span class="p">.</span><span class="n">consume</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">pac</span><span class="p">.</span><span class="n">join</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å‹åŠ›æµ‹è¯•</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â”Œâ”€â”€<span class="o">(</span>jungleã‰¿LAPTOP-A7S3TAA4<span class="o">)</span>-<span class="o">[</span>~/some_address<span class="o">]</span>
</span></span><span class="line"><span class="cl">â””â”€$ cargo run <span class="m">3</span> <span class="p">|</span> python3 checker.py <span class="m">3</span>
</span></span><span class="line"><span class="cl">    Finished dev <span class="o">[</span>unoptimized + debuginfo<span class="o">]</span> target<span class="o">(</span>s<span class="o">)</span> in 0.09s
</span></span><span class="line"><span class="cl">     Running <span class="sb">`</span>target/debug/rust_practice 3<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl">^CTraceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/mnt/d/work for vscode/rust_practice/checker.py&#34;</span>, line 6, in &lt;module&gt;
</span></span><span class="line"><span class="cl">    <span class="k">for</span> ch in sys.stdin.read<span class="o">(</span>n<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/usr/lib/python3.10/codecs.py&#34;</span>, line 319, in decode
</span></span><span class="line"><span class="cl">    def decode<span class="o">(</span>self, input, <span class="nv">final</span><span class="o">=</span>False<span class="o">)</span>:
</span></span><span class="line"><span class="cl">KeyboardInterrupt
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>äº’æ–¥é”å¤ªéš¾äº†ï¼ˆ<code>Rust</code>å†™ç€å°±å¾ˆéš¾ï¼‰ï¼Œæœ‰æ—¶é—´å†çœ‹å§ğŸ˜­</li>
</ul>
<h2 id="æ¡ä»¶å˜é‡ä¸‡èƒ½åŒæ­¥æ–¹æ³•">æ¡ä»¶å˜é‡ï¼šä¸‡èƒ½åŒæ­¥æ–¹æ³•</h2>
<h3 id="åŒæ­¥é—®é¢˜åˆ†æ">åŒæ­¥é—®é¢˜ï¼šåˆ†æ</h3>
<blockquote>
<p>ä»»ä½•åŒæ­¥é—®é¢˜éƒ½<b><font color="red">æœ‰å…ˆæ¥å…ˆç­‰å¾…çš„æ¡ä»¶</font></b></p>
</blockquote>
<ul>
<li>
<p>çº¿ç¨‹ join (<a href="https://jyywiki.cn/pages/OS/2022/demos/thread.h" target="_blank" rel="noopener noreffer">thread.h</a>, <a href="https://jyywiki.cn/pages/OS/2022/demos/sum.c" target="_blank" rel="noopener noreffer">sum.c</a>)</p>
<ul>
<li>ç­‰æ‰€æœ‰çº¿ç¨‹ç»“æŸåç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™ç­‰å¾…</li>
</ul>
</li>
<li>
<p>NPY çš„ä¾‹å­</p>
<ul>
<li>æ‰“å®Œæ¸¸æˆä¸”æ´—å®Œå¤´åç»§ç»­æ‰§è¡Œ <code>date()</code>ï¼Œå¦åˆ™ç­‰å¾…</li>
</ul>
</li>
<li>
<p>ç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜</p>
<ul>
<li>å·¦æ‹¬å·ï¼šæ·±åº¦$k &lt; n$æ—¶<code>printf</code>ï¼Œå¦åˆ™ç­‰å¾…</li>
<li>å³æ‹¬å·ï¼š$k &gt; 0$æ—¶<code>printf</code>ï¼Œå¦åˆ™ç­‰å¾…
<ul>
<li>å†çœ‹ä¸€çœ¼ <a href="https://jyywiki.cn/pages/OS/2022/demos/pc.c" target="_blank" rel="noopener noreffer">pc.c</a> $\Longrightarrow$ threadæ¯æ¬¡åœä¸‹æ¥éƒ½è¦æ‰§è¡Œâ€œ<b>ä¸ŠğŸ”’ $\rightarrow$ <b><font color="orange">è®©æˆ‘çœ‹çœ‹ï¼</font></b>(èµ„æºï¼Œå¥½åº·çš„ä¸œè¥¿) $\rightarrow$ æ‰§è¡Œæˆ–è§£ğŸ”’</b>â€ï¼ˆä»£ç ï¼š<code>retry:mutex_lock(&amp;lk);if (count == 0) {mutex_unlock(&amp;lk);goto retry;}</code>ï¼‰æµªè´¹äº†æ—¶é—´ï¼Œèƒ½ä¸èƒ½ä¼˜åŒ–æ‰â€œ<b>ä¸ŠğŸ”’ $\rightarrow$ <b><font color="orange">è®©æˆ‘çœ‹çœ‹ï¼</font></b>$\rightarrow$ æ‰§è¡Œæˆ–è§£ğŸ”’</b>â€çš„æ—¶é—´ï¼Ÿ</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-2.png" title="/img/Operating System/chapter6-2.png" data-thumbnail="/img/Operating System/chapter6-2.png" data-sub-html="<h2>jyyçš„threadåº“é€šè¿‡ChatGPTçœ‹èµ·æ¥èˆ’æœå¤šäº†</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-2.png"
            data-srcset="/img/Operating%20System/chapter6-2.png, /img/Operating%20System/chapter6-2.png 1.5x, /img/Operating%20System/chapter6-2.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-2.png" />
    </a><figcaption class="image-caption">jyyçš„threadåº“é€šè¿‡ChatGPTçœ‹èµ·æ¥èˆ’æœå¤šäº†</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-3.png" title="/img/Operating System/chapter6-3.png" data-thumbnail="/img/Operating System/chapter6-3.png" data-sub-html="<h2>joinä¹Ÿå‘Šè¯‰ä½ åœ¨å¹²å•¥äº†</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-3.png"
            data-srcset="/img/Operating%20System/chapter6-3.png, /img/Operating%20System/chapter6-3.png 1.5x, /img/Operating%20System/chapter6-3.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-3.png" />
    </a><figcaption class="image-caption">joinä¹Ÿå‘Šè¯‰ä½ åœ¨å¹²å•¥äº†</figcaption>
    </figure>
<ul>
<li>
<p>ç›®å‰ç†è§£ï¼š<code>join() = while(!terminated_all);</code></p>
</li>
<li>
<p>æˆ‘ä»¬æƒ³è¦åšçš„ï¼š<b>å°†â€œä¸ŠğŸ”’ $\rightarrow$ <b><font color="orange">è®©æˆ‘çœ‹çœ‹ï¼</font></b>$\rightarrow$ æ‰§è¡Œæˆ–è§£ğŸ”’â€å˜æˆâ€œçœ‹å®Œäº†ï¼Œèµ„æºä¸å¯¹ï¼Œé‚£å°±ç¡è§‰ï¼ˆæ‚²â€</b>ï¼ˆä»£ç ï¼š<code>mutex_lock(&amp;lk);if (count == 0){mutex_unlock_and_sleep(&amp;lk);}</code>ï¼‰ï¼Œä¹Ÿå°±æ˜¯â€œåŠè‡ªæ—‹â€$\Longrightarrow$ ä¼‘çœ </p>
<ul>
<li>åŒæ—¶ï¼Œå¦ä¸€ä¸ªthreadåœ¨æ‰§è¡Œ<b>å®Œè¯¥åšçš„ä»»åŠ¡åè¦å«é†’ä¼‘çœ çš„çº¿ç¨‹</b></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span> <span class="c1">//finish my work
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">wake_up</span><span class="p">(</span><span class="n">other_thread</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="conditional-variables-æ¡ä»¶å˜é‡-cv">Conditional Variables (æ¡ä»¶å˜é‡, CV)</h3>
<ul>
<li>
<p>æ¡ä»¶å˜é‡ API</p>
<ul>
<li>wait(cv, mutex) ğŸ’¤
<ul>
<li>è°ƒç”¨æ—¶å¿…é¡»ä¿è¯å·²ç»è·å¾— mutex</li>
<li>é‡Šæ”¾ mutexã€è¿›å…¥ç¡çœ çŠ¶æ€</li>
</ul>
</li>
</ul>
</li>
<li>
<p>signal/notify(cv) ğŸ’¬ ç§ä¿¡ï¼šèµ°èµ·</p>
<ul>
<li>å¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾… cvï¼Œåˆ™å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹</li>
</ul>
</li>
<li>
<p>broadcast/notifyAll(cv) ğŸ“£ æ‰€æœ‰äººï¼šèµ°èµ·</p>
<ul>
<li>å”¤é†’å…¨éƒ¨æ­£åœ¨ç­‰å¾… cv çš„çº¿ç¨‹ï¼ˆå‘ƒå‘ƒå‘ƒï¼ŒåŸæ¥å»å¹´cydçš„Javaæ•™çš„å°±æ˜¯è¿™ç©æ„å•Šï¼ŒğŸ®é­”å·®ç‚¹å†™æ­»âœŒï¼‰</li>
</ul>
</li>
</ul>
<h3 id="æ¡ä»¶å˜é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">æ¡ä»¶å˜é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h3>
<ul>
<li>æ”¹è‰¯ä»£ç </li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tproduce</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="n">cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span> <span class="n">count</span><span class="o">++</span><span class="p">;</span> <span class="n">cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tconsume</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span> <span class="n">count</span><span class="o">--</span><span class="p">;</span> <span class="n">cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‹åŠ›æµ‹è¯•ï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.c" target="_blank" rel="noopener noreffer">pc-cv.c</a>ï¼›æ¨¡å‹æ£€éªŒï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.py" target="_blank" rel="noopener noreffer">pc-cv.py</a></p>
<ul>
<li>(Small scope hypothesis)</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-4.png" title="/img/Operating System/chapter6-4.png" data-thumbnail="/img/Operating System/chapter6-4.png" data-sub-html="<h2>æˆ‘è‡ªå·±çš„ç–‘é—®</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-4.png"
            data-srcset="/img/Operating%20System/chapter6-4.png, /img/Operating%20System/chapter6-4.png 1.5x, /img/Operating%20System/chapter6-4.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-4.png" />
    </a><figcaption class="image-caption">æˆ‘è‡ªå·±çš„ç–‘é—®</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-5.png" title="/img/Operating System/chapter6-5.png" data-thumbnail="/img/Operating System/chapter6-5.png" data-sub-html="<h2>ç»§ç»­æé—®</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-5.png"
            data-srcset="/img/Operating%20System/chapter6-5.png, /img/Operating%20System/chapter6-5.png 1.5x, /img/Operating%20System/chapter6-5.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-5.png" />
    </a><figcaption class="image-caption">ç»§ç»­æé—®</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-6.png" title="/img/Operating System/chapter6-6.png" data-thumbnail="/img/Operating System/chapter6-6.png" data-sub-html="<h2>ç»§ç»­æé—®</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-6.png"
            data-srcset="/img/Operating%20System/chapter6-6.png, /img/Operating%20System/chapter6-6.png 1.5x, /img/Operating%20System/chapter6-6.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-6.png" />
    </a><figcaption class="image-caption">ç»§ç»­æé—®</figcaption>
    </figure>
<ul>
<li><a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.c" target="_blank" rel="noopener noreffer">pc-cv.c</a></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread-sync.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">mutex_t</span> <span class="n">lk</span> <span class="o">=</span> <span class="n">MUTEX_INIT</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">cond_t</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">COND_INIT</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tproduce</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span> <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tconsume</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">pthread_cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span> <span class="n">count</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">assert</span><span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tproduce</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tconsume</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è§‚å¯Ÿ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tproduce</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tconsume</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>i &lt; 1</code>çš„æ—¶å€™æ²¡é—®é¢˜ï¼Œè€Œ<code>i &lt; 8</code>çš„æ—¶å€™å°±å‡ºäº†é—®é¢˜</p>
</li>
<li>
<p><a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.py" target="_blank" rel="noopener noreffer">pc-cy.py</a></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ProducerConsumer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">locked</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">waits</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tryacquire</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">,</span> <span class="n">seen</span> <span class="o">=</span> <span class="s1">&#39;ğŸ”’&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">seen</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">release</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@thread</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span> <span class="c1"># mutex_lock()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># cond_wait</span>
</span></span><span class="line"><span class="cl">                <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">+</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="s1">&#39;1&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># cond_signal</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span> <span class="c1"># mutex_unlock()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@thread</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tc1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">+</span> <span class="s1">&#39;2&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="s1">&#39;2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@thread</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tc2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">+</span> <span class="s1">&#39;3&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="s1">&#39;3&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tryacquire</span><span class="p">():</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@marker</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">mark_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span> <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span> <span class="n">count</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;red&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿‡ç¨‹è§£è¯»ï¼ˆä¸Šé¢çš„pc-cv.cï¼‰</li>
</ul>
<div class="mermaid" id="id-1"></div>
<ul>
<li>
<p>ä»ç”Ÿæˆè€…å¼€å§‹å¾€ä¸‹èµ°ï¼Œ<b>ä¸€ä¸ªç”Ÿæˆææ–™ç”ŸæˆæˆåŠŸï¼Œè€Œæ¶ˆè´¹è¿‡ç¨‹æ‰§è¡Œäº†ä¸¤æ¬¡</b> $\Longrightarrow$ å¯„äº†ï¼</p>
<ul>
<li><b>ä¸ºä»€ä¹ˆå‘¢ï¼šåŒç±»å”¤é†’äº†åŒç±»ï¼Œè¿™æ˜¯é”™è¯¯çš„</b></li>
<li><b>éœ€è¦ä¸¤ä¸ªæ¡ä»¶å˜é‡ï¼Œä¿è¯åªèƒ½å”¤é†’å¼‚ç±»</b>ï¼Œè¯¾åè‡ªå·±é˜…è¯»ç›¸å…³ææ–™</li>
</ul>
</li>
<li>
<p><a href="https://github.com/Jungle430/check-for-NJU-OS/blob/main/pc-cv.html" target="_blank" rel="noopener noreffer">å¯è§†åŒ–</a></p>
</li>
</ul>
<h3 id="æ¡ä»¶å˜é‡æ­£ç¡®çš„æ‰“å¼€æ–¹å¼">æ¡ä»¶å˜é‡ï¼šæ­£ç¡®çš„æ‰“å¼€æ–¹å¼</h3>
<ul>
<li>éœ€è¦<b><font color="red">ç­‰å¾…æ¡ä»¶æ»¡è¶³æ—¶</font></b></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">cond</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">assert</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1">// äº’æ–¥é”ä¿è¯äº†åœ¨æ­¤æœŸé—´æ¡ä»¶ cond æ€»æ˜¯æˆç«‹
</span></span></span><span class="line"><span class="cl"><span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><b><font color="red">å…¶ä»–çº¿ç¨‹æ¡ä»¶å¯èƒ½è¢«æ»¡è¶³æ—¶</font></b></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">broadcast</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¿®æ”¹ <a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.c" target="_blank" rel="noopener noreffer">pc-cv.c</a> å’Œ <a href="https://jyywiki.cn/pages/OS/2022/demos/pc-cv.py" target="_blank" rel="noopener noreffer">pc-cv.py</a> $if \rightarrow while\ and\ signal \rightarrow boardcast\newline$</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-8.png" title="/img/Operating System/chapter6-8.png" data-thumbnail="/img/Operating System/chapter6-8.png" data-sub-html="<h2>ä¸¤è€…åŒºåˆ«</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-8.png"
            data-srcset="/img/Operating%20System/chapter6-8.png, /img/Operating%20System/chapter6-8.png 1.5x, /img/Operating%20System/chapter6-8.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-8.png" />
    </a><figcaption class="image-caption">ä¸¤è€…åŒºåˆ«</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-9.png" title="/img/Operating System/chapter6-9.png" data-thumbnail="/img/Operating System/chapter6-9.png" data-sub-html="<h2>ä¸ºä»€ä¹ˆè¦å”¤é†’å…¨éƒ¨çº¿ç¨‹çš„åŸå› ã€‚æ€»ç®—ææ˜ç™½ä¸ºä»€ä¹ˆä¹‹å‰åªæ”¹$if \rightarrow while$çš„æƒ…å†µä¸‹ç¨‹åºä¼šå¡æ­»</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-9.png"
            data-srcset="/img/Operating%20System/chapter6-9.png, /img/Operating%20System/chapter6-9.png 1.5x, /img/Operating%20System/chapter6-9.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-9.png" />
    </a><figcaption class="image-caption">ä¸ºä»€ä¹ˆè¦å”¤é†’å…¨éƒ¨çº¿ç¨‹çš„åŸå› ã€‚æ€»ç®—ææ˜ç™½ä¸ºä»€ä¹ˆä¹‹å‰åªæ”¹$if \rightarrow while$çš„æƒ…å†µä¸‹ç¨‹åºä¼šå¡æ­»</figcaption>
    </figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">2023-03-11 20:47:45 âŒš  jungle-virtual-machine in ~/chapter6
</span></span><span class="line"><span class="cl">â—‹ â†’ ./pc-cv <span class="m">3</span> <span class="p">|</span> python3 pc-check.py <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span><span class="line"><span class="cl"><span class="m">100000</span> Ok.
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿è¡ŒæˆåŠŸï¼</li>
<li>é—®å¤§çˆ¹ChatGPT</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-7.png" title="/img/Operating System/chapter6-7.png" data-thumbnail="/img/Operating System/chapter6-7.png" data-sub-html="<h2>ifæ˜¯å‡ç¡çœ ï¼Œåªèƒ½ç¡ä¸€æ¬¡ï¼Œä¸‹ä¸€æ¬¡å°±ä¼šè‹é†’ï¼Œè€Œwhileæ‰æ˜¯çœŸç¡çœ ï¼Œåªæœ‰æ¡ä»¶æ»¡è¶³æ—¶æ‰è‹é†’</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-7.png"
            data-srcset="/img/Operating%20System/chapter6-7.png, /img/Operating%20System/chapter6-7.png 1.5x, /img/Operating%20System/chapter6-7.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-7.png" />
    </a><figcaption class="image-caption"><code>if</code>æ˜¯<b>å‡ç¡çœ </b>ï¼Œåªèƒ½ç¡ä¸€æ¬¡ï¼Œä¸‹ä¸€æ¬¡å°±ä¼šè‹é†’ï¼Œè€Œ<code>while</code>æ‰æ˜¯<b>çœŸç¡çœ </b>ï¼Œåªæœ‰æ¡ä»¶æ»¡è¶³æ—¶æ‰è‹é†’</figcaption>
    </figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">pthread_mutex_t</span> <span class="n">lock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pthread_cond_t</span> <span class="n">cond</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span><span class="nf">thread_func</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">pthread_cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Thread %d: data = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">arg</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_t</span> <span class="n">tid1</span><span class="p">,</span> <span class="n">tid2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_cond_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">thread_func</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">thread_func</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pthread_mutex_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">pthread_cond_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ¡ä»¶å˜é‡å®ç°å¹¶è¡Œè®¡ç®—">æ¡ä»¶å˜é‡ï¼šå®ç°å¹¶è¡Œè®¡ç®—</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">job</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">run</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">struct</span> <span class="n">job</span> <span class="o">*</span><span class="n">job</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="o">!</span> <span class="p">(</span><span class="n">job</span> <span class="o">=</span> <span class="n">get_job</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">job</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">job</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">);</span> <span class="c1">// ä¸éœ€è¦æŒæœ‰é”
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                      <span class="c1">// å¯ä»¥ç”Ÿæˆæ–°çš„ job
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                      <span class="c1">// æ³¨æ„å›æ”¶åˆ†é…çš„èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸‹é¢å¼€å§‹å°†æœ€é•¿å…¬å…±å­ä¸²çš„dpç®—æ³•ï¼Œè§†é¢‘æ–­äº†ï¼Œè¿™ä¸ªä¹‹å‰åšå®¢é‡Œé¢æœ‰<a href="https://jungle430.github.io/posts/data-structures-and-algorithms/dynamic-programming/#longest-common-subsequence-by-dynamic-programming" target="_blank" rel="noopener noreffer">ã€ŠDynamic Programmingã€‹</a>å›å»å¤ä¹ </li>
<li>è§†é¢‘ä¸­æ–­ï¼Œä½†æ˜¯å¤§è‡´å¬å‡ºæ¥ä¼˜åŒ–çš„æ–¹æ³•ï¼Œå› ä¸ºä¸Šé¢çš„æœ€é•¿å…¬å…±å­ä¸²çš„è®¡ç®—æ˜¯<b>æœ‰ä¸€å®šé¡ºåº</b>çš„ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®—$depth$æ¯”è¾ƒæµ…çš„ï¼Œç„¶åå†ç®—$depth$æ¯”è¾ƒæµ…çš„ $\Longrightarrow$ <font color="red">æ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„ç”Ÿæˆè€…ï¼Œæ¶ˆè´¹è€…é—®é¢˜æœ‰ç€ç›¸ä¼¼çš„åœ°æ–¹ï¼Ÿ</font><b>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæƒ³æ³•åˆ†é…ç»™ä¸åŒçš„çº¿ç¨‹ï¼Œåˆ©ç”¨sleepå’Œnotifyæ¥ä¿æŒç›¸å¯¹çš„ä¸€ä¸ªé¡ºåºæ¥å¯¹æˆ‘ä»¬ä¹‹å‰çš„ç®—æ³•åšä¼˜åŒ–ï¼ï¼ˆæ³¨æ„åˆ©ç”¨ä¸Šé¢çš„jobåº“ï¼‰</b></li>
<li>ç ”ç©¶è¿™é“é¢˜<a href="https://leetcode.cn/problems/building-h2o" target="_blank" rel="noopener noreffer">$H_20$ç”Ÿæˆ</a></li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Pause<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Pause in 2023-03-11 21:30</p>
<p>æ„Ÿè§‰è¿™èŠ‚è¯¾å†…å®¹å¥½â„¢ï¸çš„å¤šï¼Œå·²ç»ä¸æ˜¯ä»…ä»…å°±é™åˆ¶äºä¸€ä¸ªä¸€ä¸ªç®—æ³•äº†</p>
<p>å»å¹´cydçš„<code>Java</code>ä¸Šé¢è®²çš„Threadé‚£äº›ä¸œè¥¿ç»ˆäºå¼€å§‹ç†è§£äº†ï¼Œè€Œä¸æ˜¯åƒå½“æ—¶é‚£æ ·åœ¨å®¿èˆçğŸ”8ï¸âƒ£å†™<code>Thread</code></p>
<p>æ„Ÿè°¢<a href="https://github.com/derecknowayback" target="_blank" rel="noopener noreffer">Dereck Chen</a>æ¨èçš„ä¸¤ç¯‡æœ‰å…³<code>xv6</code>é”çš„æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/352699414" target="_blank" rel="noopener noreffer">ã€ŠChapter 6: Lockingã€‹</a>å’Œ<a href="https://zhuanlan.zhihu.com/p/353400345" target="_blank" rel="noopener noreffer">ã€ŠChapter 6.5: More Tools, Examples and Deadlocksã€‹</a>ï¼Œä¸€å®šæ‰¾æ—¶é—´å¥½å¥½çœ‹</p>
<p>æ„Ÿè°¢æ´²å¸®æˆ‘æ‰¾åˆ°äº†ç”¨å°æ¹¾çº¿ä¸Š<a href="https://openai.com/blog/chatgpt" target="_blank" rel="noopener noreffer">ChatGPT</a>çš„æ–¹æ³•</p>
</div>
        </div>
    </div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Update in 2023-03-12 11:30</p>
<p>ğŸ‘€âœ‹ä»Šå¤©è–„çº±ä½ è¿™ç« </p>
</div>
        </div>
    </div>
<h3 id="æ¡ä»¶å˜é‡æ›´å¤æ€ªçš„ä¹ é¢˜é¢è¯•é¢˜">æ¡ä»¶å˜é‡ï¼šæ›´å¤æ€ªçš„ä¹ é¢˜/é¢è¯•é¢˜</h3>
<p>æœ‰ä¸‰ç§çº¿ç¨‹ï¼Œåˆ†åˆ«æ‰“å° <code>&lt;</code>, <code>&gt;</code>, å’Œ <code>_</code></p>
<ul>
<li>å¯¹è¿™äº›çº¿ç¨‹è¿›è¡ŒåŒæ­¥ï¼Œä½¿å¾—æ‰“å°å‡ºçš„åºåˆ—æ€»æ˜¯ <code>&lt;&gt;&lt;_</code> å’Œ <code>&gt;&lt;&gt;_</code> ç»„åˆ</li>
</ul>
<hr>
<p>ä½¿ç”¨æ¡ä»¶å˜é‡ï¼Œåªè¦å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æ‰“å° â€œ<code>&lt;</code>â€ çš„æ¡ä»¶ï¼Ÿ</li>
<li>æ‰“å° â€œ<code>&gt;</code>â€ çš„æ¡ä»¶ï¼Ÿ</li>
<li>æ‰“å° â€œ<code>_</code>â€ çš„æ¡ä»¶ï¼Ÿ
<ul>
<li><a href="https://jyywiki.cn/pages/OS/2022/demos/fish.c" target="_blank" rel="noopener noreffer">fish.c</a></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define LENGTH(arr) (sizeof(arr) / sizeof(arr[0]))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="p">{</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">rule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">rule</span> <span class="n">rules</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">A</span><span class="p">,</span> <span class="sc">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">B</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">B</span><span class="p">,</span> <span class="sc">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">C</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">C</span><span class="p">,</span> <span class="sc">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">D</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">A</span><span class="p">,</span> <span class="sc">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">E</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">E</span><span class="p">,</span> <span class="sc">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">F</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">F</span><span class="p">,</span> <span class="sc">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">D</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">D</span><span class="p">,</span> <span class="sc">&#39;_&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">quota</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pthread_mutex_t</span> <span class="n">lk</span>   <span class="o">=</span> <span class="n">PTHREAD_MUTEX_INITIALIZER</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pthread_cond_t</span>  <span class="n">cond</span> <span class="o">=</span> <span class="n">PTHREAD_COND_INITIALIZER</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">next</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">LENGTH</span><span class="p">(</span><span class="n">rules</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">rule</span> <span class="o">*</span><span class="n">rule</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">rules</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">rule</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">==</span> <span class="n">current</span> <span class="o">&amp;&amp;</span> <span class="n">rule</span><span class="o">-&gt;</span><span class="n">ch</span> <span class="o">==</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">rule</span><span class="o">-&gt;</span><span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fish_before</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">next</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">quota</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// can proceed only if (next(ch) &amp;&amp; quota)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">pthread_cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">quota</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fish_after</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">quota</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">current</span> <span class="o">=</span> <span class="n">next</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">assert</span><span class="p">(</span><span class="n">current</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">pthread_cond_broadcast</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="n">roles</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;.&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;___&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fish_thread</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">role</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">id</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">fish_before</span><span class="p">(</span><span class="n">role</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">putchar</span><span class="p">(</span><span class="n">role</span><span class="p">);</span> <span class="c1">// can be long; no lock protection
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fish_after</span><span class="p">(</span><span class="n">role</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">roles</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">fish_thread</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¿¡å·é‡">ä¿¡å·é‡</h2>
<h3 id="å¤ä¹ äº’æ–¥é”å’Œæ›´è¡£å®¤ç®¡ç†">å¤ä¹ ï¼šäº’æ–¥é”å’Œæ›´è¡£å®¤ç®¡ç†</h3>
<p>æ“ä½œç³»ç»Ÿ = æ›´è¡£å®¤ç®¡ç†å‘˜</p>
<ul>
<li>å…ˆåˆ°çš„äºº (çº¿ç¨‹)
<ul>
<li>æˆåŠŸè·å¾—æ‰‹ç¯ï¼Œè¿›å…¥æ¸¸æ³³é¦†</li>
<li><code>*lk = ğŸ”’</code>ï¼Œç³»ç»Ÿè°ƒç”¨ç›´æ¥è¿”å›</li>
</ul>
</li>
<li>ååˆ°çš„äºº (çº¿ç¨‹)
<ul>
<li>ä¸èƒ½è¿›å…¥æ¸¸æ³³é¦†ï¼Œæ’é˜Ÿç­‰å¾…</li>
<li>çº¿ç¨‹æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œæ‰§è¡Œçº¿ç¨‹åˆ‡æ¢ (yield)</li>
</ul>
</li>
<li>æ´—å®Œæ¾¡å‡ºæ¥çš„äºº (çº¿ç¨‹)
<ul>
<li>äº¤è¿˜æ‰‹ç¯ç»™ç®¡ç†å‘˜ï¼›ç®¡ç†å‘˜æŠŠæ‰‹ç¯å†äº¤ç»™æ’é˜Ÿçš„äºº</li>
<li>å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ç©ºï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªçº¿ç¨‹å…è®¸æ‰§è¡Œ</li>
<li>å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ºç©ºï¼Œ<code>*lk = âœ…</code></li>
</ul>
</li>
<li>ç®¡ç†å‘˜ (OS) ä½¿ç”¨è‡ªæ—‹é”ç¡®ä¿è‡ªå·±å¤„ç†æ‰‹ç¯çš„è¿‡ç¨‹æ˜¯åŸå­çš„</li>
</ul>
<h3 id="æ›´è¡£å®¤ç®¡ç†">æ›´è¡£å®¤ç®¡ç†</h3>
<p>å®Œå…¨æ²¡æœ‰å¿…è¦é™åˆ¶æ‰‹ç¯çš„æ•°é‡â€”â€”è®©æ›´å¤šåŒå­¦å¯ä»¥è¿›å…¥æ›´è¡£å®¤</p>
<ul>
<li>ç®¡ç†å‘˜å¯ä»¥æŒæœ‰ä»»æ„æ•°é‡çš„æ‰‹ç¯ (æ›´è¡£å®¤å®¹é‡ä¸Šé™)
<ul>
<li>å…ˆè¿›å…¥æ›´è¡£å®¤çš„åŒå­¦å…ˆå¾—åˆ°</li>
<li>æ‰‹ç¯ç”¨å®Œåæ‰éœ€è¦ç­‰åŒå­¦å‡ºæ¥</li>
</ul>
</li>
</ul>
<h3 id="æ›´è¡£å®¤ç®¡ç†-by-ew-dijkstra">æ›´è¡£å®¤ç®¡ç† (by E.W. Dijkstra)</h3>
<p>åšä¸€ç‚¹æ‰©å±•â€”â€”çº¿ç¨‹å¯ä»¥ä»»æ„ â€œå˜å‡ºâ€ ä¸€ä¸ªæ‰‹ç¯</p>
<ul>
<li>æŠŠæ‰‹ç¯çœ‹æˆæ˜¯ä»¤ç‰Œ</li>
<li>å¾—åˆ°ä»¤ç‰Œçš„å¯ä»¥è¿›å…¥æ‰§è¡Œ</li>
<li>å¯ä»¥éšæ—¶åˆ›å»ºä»¤ç‰Œ</li>
</ul>
<a class="lightgallery" href="/img/Operating%20System/chapter6-10.gif" title="/img/Operating System/chapter6-10.gif" data-thumbnail="/img/Operating System/chapter6-10.gif">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-10.gif"
            data-srcset="/img/Operating%20System/chapter6-10.gif, /img/Operating%20System/chapter6-10.gif 1.5x, /img/Operating%20System/chapter6-10.gif 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-10.gif" />
    </a>
<p>â€œæ‰‹ç¯â€ = â€œä»¤ç‰Œâ€ = â€œä¸€ä¸ªèµ„æºâ€ = â€œä¿¡å·é‡â€ (semaphore)</p>
<ul>
<li>P(&amp;sem) - prolaag = try + decrease; wait; down; in
<ul>
<li>ç­‰å¾…ä¸€ä¸ªæ‰‹ç¯åè¿”å›</li>
<li>å¦‚æœæ­¤æ—¶ç®¡ç†å‘˜æ‰‹ä¸Šæœ‰ç©ºé—²çš„æ‰‹ç¯ï¼Œç«‹å³è¿”å›</li>
</ul>
</li>
<li>V(&amp;sem) - verhoog = increase; post; up; out
<ul>
<li>å˜å‡ºä¸€ä¸ªæ‰‹ç¯ï¼Œé€ç»™ç®¡ç†å‘˜</li>
</ul>
</li>
<li>ä¿¡å·é‡çš„è¡Œä¸ºå»ºæ¨¡: <a href="https://jyywiki.cn/pages/OS/2022/demos/sem.py" target="_blank" rel="noopener noreffer">sem.py</a></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Semaphore</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">token</span><span class="p">,</span> <span class="n">waits</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="c1"># ä»ä¸€æŠŠğŸ”‘å˜æˆäº†å¥½å¤šæŠŠğŸ”‘ï¼Œtokenç°åœ¨æ˜¯ä¸€ä¸ªè®¡æ•°å™¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tid</span><span class="p">):</span> <span class="c1"># æ‹¿ğŸ”‘</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>   <span class="c1"># æœ‰è¶…è¿‡ä¸€æŠŠğŸ”‘ï¼ŒğŸ”‘-1ï¼Œè‡ªå·±å¾—åˆ°äº†ä¸€æŠŠğŸ”‘</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">+</span> <span class="n">tid</span> <span class="c1"># æ²¡æœ‰ğŸ”‘å°±åªèƒ½æŠŠè‡ªå·±æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—é‡Œé¢ï¼Œç­‰åˆ°åˆ«äººæŠŠæˆ‘å”¤é†’</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">V</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># äº¤ä»˜ğŸ”‘</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">waits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># å¦‚æœæœ‰äººåœ¨ç­‰å¾…é˜Ÿåˆ—é‡Œé¢ï¼Œç›´æ¥å”¤é†’ä»–ï¼ˆä¸éœ€è¦é€šè¿‡ç®¡ç†å‘˜ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># å¦‚æœæ— äººç­‰å¾…ç›´æ¥æŠŠæ‰‹ç¯äº¤ç»™ç®¡ç†å‘˜</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@thread</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">t1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="s1">&#39;1&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">        <span class="n">cs</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">del</span> <span class="n">cs</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@thread</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">t2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="s1">&#39;2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">waits</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">        <span class="n">cs</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">del</span> <span class="n">cs</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@marker</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">mark_t1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">localvar</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;blue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@marker</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">mark_t2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">localvar</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;green&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@marker</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">mark_both</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">localvar</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">localvar</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;red&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><a href="https://github.com/Jungle430/check-for-NJU-OS/blob/main/sem.html" target="_blank" rel="noopener noreffer">model-checker</a></li>
</ul>
<h3 id="ä¿¡å·é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">ä¿¡å·é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h3>
<p>ä¿¡å·é‡è®¾è®¡çš„é‡ç‚¹</p>
<ul>
<li>è€ƒè™‘ â€œæ‰‹ç¯â€ (æ¯ä¸€å•ä½çš„ â€œ<font color="red"><b>èµ„æº</b></font>â€) æ˜¯ä»€ä¹ˆï¼Œè°åˆ›é€ ï¼Ÿè°è·å–ï¼Ÿ
<ul>
<li><a href="https://jyywiki.cn/pages/OS/2022/demos/pc-sem.c" target="_blank" rel="noopener noreffer">pc-sem.c</a></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">producer</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">P</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">);</span>   <span class="c1">// P()è¿”å› -&gt; å¾—åˆ°æ‰‹ç¯ ï¼ˆæ£€æµ‹åŒ…é‡Œé¢æ˜¯å¦è¿˜æœ‰ç©ºä½ï¼Œæœ‰ç©ºä½å°±åŠ å…¥ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">);</span> <span class="c1">// å‡è®¾çº¿ç¨‹å®‰å…¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">V</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fill</span><span class="p">);</span> <span class="c1">//æ‰“å°å°±å°±ç›¸å½“äºå‘åŒ…é‡Œæ”¾ä¸€ä¸ªä¸œè¥¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">consumer</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">P</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fill</span><span class="p">);</span> <span class="c1">//æ£€æµ‹åŒ…é‡Œé¢æ˜¯å¦è¿˜æœ‰ä¸œè¥¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">V</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">);</span> <span class="c1">//æŠŠåŒ…é‡Œé¢çš„ä¸€ä¸ªä¸œè¥¿ç»™åƒæ‰äº†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//éå¸¸å¯¹ç§°ä¼˜ç¾ï¼
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>åœ¨ â€œ<font color="red"><b>ä¸€å•ä½èµ„æº</b></font>â€ æ˜ç¡®çš„é—®é¢˜ä¸Šæ›´å¥½ç”¨</li>
<li>â€å‡­ç©ºåˆ›é€ ğŸ”‘â€œè€Œä¸æ˜¯åƒä¹‹å‰é‚£æ ·ä½¿ç”¨â€é…å¯¹çš„æ‰‹ç¯â€œï¼Œç¨‹åºçš„æ­£ç¡®æ€§æ›´åŠ å±é™©ã€‚ã€‚ã€‚</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-11.png" title="/img/Operating System/chapter6-11.png" data-thumbnail="/img/Operating System/chapter6-11.png" data-sub-html="<h2>å›å»å°±ç¿»csapp</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-11.png"
            data-srcset="/img/Operating%20System/chapter6-11.png, /img/Operating%20System/chapter6-11.png 1.5x, /img/Operating%20System/chapter6-11.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-11.png" />
    </a><figcaption class="image-caption">å›å»å°±ç¿»<code>csapp</code></figcaption>
    </figure>
<blockquote>
<p>ChatGPTç”Ÿæˆçš„ä¸€äº›ä»£ç </p>
<p>ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜æ˜¯ä¸€ä¸ªç»å…¸çš„å¹¶å‘é—®é¢˜ï¼Œæè¿°äº†ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…åœ¨å…±äº«èµ„æºçš„ç¯å¢ƒä¸­çš„äº’åŠ¨ã€‚ç”Ÿäº§è€…ç”Ÿæˆä¸€äº›äº§å“å¹¶å°†å®ƒä»¬æ”¾å…¥ä¸€ä¸ªå…±äº«ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»å…±äº«ç¼“å†²åŒºä¸­å–å‡ºäº§å“å¹¶å°†å…¶æ¶ˆè´¹ã€‚ä¸ºäº†ç¡®ä¿ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„æ­£ç¡®äº’åŠ¨ï¼Œéœ€è¦ä½¿ç”¨ä¿¡å·é‡æ¥å®ç°åŒæ­¥å’Œäº’æ–¥ã€‚</p>
</blockquote>
<p>C++å®ç°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;thread&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;mutex&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;condition_variable&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;ctime&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;atomic&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;semaphore.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰ä¿¡å·é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">sem_t</span> <span class="n">empty</span><span class="p">,</span> <span class="n">full</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">producer</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç­‰å¾…ç©ºç¼“å†²åŒº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sem_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// æ·»åŠ æ•°æ®åˆ°ç¼“å†²åŒº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">buffer</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Producer &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; produced data &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, buffer size is &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">buffer</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// å‘ä¿¡å·é‡é€šçŸ¥æœ‰æ–°æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sem_post</span><span class="p">(</span><span class="o">&amp;</span><span class="n">full</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">consumer</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç­‰å¾…æœ‰æ•°æ®çš„ä¿¡å·é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sem_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">full</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ä»ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">buffer</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Consumer &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; consumed data &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, buffer size is &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">buffer</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// å‘ä¿¡å·é‡é€šçŸ¥æœ‰ç©ºç¼“å†²åŒº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sem_post</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆå§‹åŒ–éšæœºç§å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">std</span><span class="o">::</span><span class="n">srand</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">time</span><span class="p">(</span><span class="k">nullptr</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆå§‹åŒ–ä¿¡å·é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">sem_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">BUFFER_SIZE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sem_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">full</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆ›å»ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">producer1</span><span class="p">(</span><span class="n">producer</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">producer2</span><span class="p">(</span><span class="n">producer</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">consumer1</span><span class="p">(</span><span class="n">consumer</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">consumer2</span><span class="p">(</span><span class="n">consumer</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// è¿è¡Œä¸€æ®µæ—¶é—´åç»“æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// é€šçŸ¥çº¿ç¨‹ç»“æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">producer1</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">producer2</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer1</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer2</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// é”€æ¯ä¿¡å·é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">sem_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">empty</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sem_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">full</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/chapter6-12.png" title="/img/Operating System/chapter6-12.png" data-thumbnail="/img/Operating System/chapter6-12.png" data-sub-html="<h2>ä¾‹å­1</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-12.png"
            data-srcset="/img/Operating%20System/chapter6-12.png, /img/Operating%20System/chapter6-12.png 1.5x, /img/Operating%20System/chapter6-12.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-12.png" />
    </a><figcaption class="image-caption"><code>ä¾‹å­1</code></figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-13.png" title="/img/Operating System/chapter6-13.png" data-thumbnail="/img/Operating System/chapter6-13.png" data-sub-html="<h2>ä¾‹å­2</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-13.png"
            data-srcset="/img/Operating%20System/chapter6-13.png, /img/Operating%20System/chapter6-13.png 1.5x, /img/Operating%20System/chapter6-13.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-13.png" />
    </a><figcaption class="image-caption"><code>ä¾‹å­2</code></figcaption>
    </figure>
<h2 id="å“²å­¦å®¶åƒé¥­é—®é¢˜e-w-dijkstra-1960">å“²â™‚ï¸å­¦å®¶åƒé¥­é—®é¢˜(E. W. Dijkstra, 1960)</h2>
<p>å“²å­¦å®¶ (çº¿ç¨‹) æœ‰æ—¶æ€è€ƒï¼Œæœ‰æ—¶åƒé¥­</p>
<ul>
<li><b>åƒé¥­éœ€è¦åŒæ—¶å¾—åˆ°å·¦æ‰‹å’Œå³æ‰‹çš„å‰å­</b></li>
<li>å½“å‰å­è¢«å…¶ä»–äººå æœ‰æ—¶ï¼Œå¿…é¡»ç­‰å¾…ï¼Œå¦‚ä½•å®ŒæˆåŒæ­¥ï¼Ÿ
<ul>
<li><a href="https://leetcode.cn/problems/the-dining-philosophers" target="_blank" rel="noopener noreffer">å¦‚ä½•ç”¨äº’æ–¥é”/ä¿¡å·é‡å®ç°ï¼Ÿ</a></li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter6-14.jpg" title="/img/Operating System/chapter6-14.jpg" data-thumbnail="/img/Operating System/chapter6-14.jpg" data-sub-html="<h2>å“²â™‚ï¸å­¦å®¶</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-14.jpg"
            data-srcset="/img/Operating%20System/chapter6-14.jpg, /img/Operating%20System/chapter6-14.jpg 1.5x, /img/Operating%20System/chapter6-14.jpg 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-14.jpg" />
    </a><figcaption class="image-caption">å“²â™‚ï¸å­¦å®¶</figcaption>
    </figure>
<h3 id="å¤±è´¥ä¸æˆåŠŸçš„å°è¯•">å¤±è´¥ä¸æˆåŠŸçš„å°è¯•</h3>
<p>å¤±è´¥çš„å°è¯•</p>
<ul>
<li><a href="https://jyywiki.cn/pages/OS/2022/demos/philosopher.c" target="_blank" rel="noopener noreffer">philosopher.c</a> (å¦‚ä½•è§£å†³ï¼Ÿ)</li>
<li>è¿™é‡Œé¢ä½¿ç”¨äº†ä¿¡å·é‡</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;thread-sync.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define N 3
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">sem_t</span> <span class="n">locks</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tphilosopher</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">lhs</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">id</span> <span class="o">%</span> <span class="n">N</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">P</span><span class="p">(</span><span class="o">&amp;</span><span class="n">locks</span><span class="p">[</span><span class="n">lhs</span><span class="p">]);</span> <span class="c1">//æ‹¿å·¦è¾¹çš„å‰å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;T%d Got %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">lhs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">P</span><span class="p">(</span><span class="o">&amp;</span><span class="n">locks</span><span class="p">[</span><span class="n">rhs</span><span class="p">]);</span> <span class="c1">//æ‹¿å³è¾¹çš„å‰å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;T%d Got %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">V</span><span class="p">(</span><span class="o">&amp;</span><span class="n">locks</span><span class="p">[</span><span class="n">lhs</span><span class="p">]);</span> <span class="c1">//æ”¾å›å·¦å‰å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">V</span><span class="p">(</span><span class="o">&amp;</span><span class="n">locks</span><span class="p">[</span><span class="n">rhs</span><span class="p">]);</span> <span class="c1">//æ”¾å›å³å‰å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//å°†é”åˆå§‹åŒ–ä¸º1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="n">SEM_INIT</span><span class="p">(</span><span class="o">&amp;</span><span class="n">locks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">create</span><span class="p">(</span><span class="n">Tphilosopher</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸Šé¢çš„ç¨‹åºä¼šå¡æ­»ï¼ˆéƒ½æ‹¿å·¦å‰å­çš„æ—¶å€™æ‰§è¡Œæ‹¿å³å‰å­çš„åŠ¨ä½œçš„æ—¶å€™ä¼šä¸€ç›´<code>wait</code>ç›´åˆ°æœ‰äºº<code>notify</code>å®ƒï¼Œå¯æ˜¯è¿™ä¸ªåœºæ™¯ä¸‹æ²¡äºº<code>notify</code>å®ƒ $\Longrightarrow$ ç¨‹åºæ­»é”ï¼‰</li>
</ul>
<blockquote>
<p>è¿™æ®µä»£ç å®ç°äº†ç»å…¸çš„å“²å­¦å®¶å°±é¤é—®é¢˜ï¼ˆDining Philosophers Problemï¼‰ã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæœ‰ $N$ ä¸ªå“²å­¦å®¶å’Œ $N$ ä¸ªå‰å­ï¼Œæ¯ä¸ªå“²å­¦å®¶éœ€è¦åŒæ—¶æ‹¿åˆ°ä¸¤ä¸ªç›¸é‚»çš„å‰å­æ‰èƒ½åƒé¥­ï¼Œä½†æ˜¯å‰å­ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªå“²å­¦å®¶æ‹¿èµ°ï¼Œå› æ­¤å½“æ‰€æœ‰å“²å­¦å®¶éƒ½æ‹¿èµ·ä¸€ä¸ªå‰å­æ—¶ï¼Œå°±ä¼šå‡ºç°æ­»é”ã€‚è¿™æ®µä»£ç ä½¿ç”¨ä¿¡å·é‡æ¥é¿å…æ­»é”ï¼Œå…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªå‰å­å¯¹åº”ä¸€ä¸ªä¿¡å·é‡ï¼Œå“²å­¦å®¶å…ˆå°è¯•è·å–å·¦è¾¹çš„å‰å­ï¼Œå¦‚æœè·å–ä¸åˆ°åˆ™ç­‰å¾…ï¼Œå¦åˆ™å†å°è¯•è·å–å³è¾¹çš„å‰å­ã€‚è·å–åˆ°ä¸¤ä¸ªå‰å­åï¼Œå“²å­¦å®¶åƒå®Œåå°†ä¸¤ä¸ªå‰å­éƒ½æ”¾å›åŸå¤„ï¼Œå†æ¬¡å°è¯•è·å–å‰å­ã€‚ç”±äºæ¯ä¸ªå“²å­¦å®¶åªå…è®¸åŒæ—¶æŒæœ‰ä¸€ä¸ªå‰å­ï¼Œå› æ­¤ä¸ä¼šå‡ºç°æ­»é”ã€‚</p>
<p>åœ¨ä»£ç ä¸­ï¼Œé¦–å…ˆä½¿ç”¨ <code>SEM_INIT</code> å‡½æ•°å°†æ‰€æœ‰é”åˆå§‹åŒ–ä¸º1ï¼Œè¡¨ç¤ºæ‰€æœ‰å‰å­éƒ½æ²¡æœ‰è¢«å ç”¨ã€‚ç„¶åä½¿ç”¨ <code>create</code> å‡½æ•°åˆ›å»º $N$ ä¸ªå“²å­¦å®¶çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>Tphilosopher</code> å‡½æ•°ï¼Œå³å°è¯•è·å–å‰å­ã€‚åœ¨ <code>Tphilosopher</code> å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å·¦è¾¹çš„å‰å­ï¼Œç„¶åè·å–å³è¾¹çš„å‰å­ï¼Œå¦‚æœä¸¤ä¸ªå‰å­éƒ½è·å–åˆ°äº†ï¼Œå°±åƒé¥­ï¼Œå¹¶å°†ä¸¤ä¸ªå‰å­éƒ½æ”¾å›åŸå¤„ï¼Œå†æ¬¡å¾ªç¯ã€‚åœ¨è·å–å’Œæ”¾å›å‰å­æ—¶ï¼Œä½¿ç”¨ <code>P</code> å’Œ <code>V</code> å‡½æ•°æ“ä½œä¿¡å·é‡ï¼Œå…¶ä¸­ <code>P</code> è¡¨ç¤ºè·å–é”ï¼Œå¦‚æœé”å·²ç»è¢«å ç”¨ï¼Œåˆ™é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ï¼›<code>V</code> è¡¨ç¤ºé‡Šæ”¾é”ï¼Œå°†é”çš„å€¼åŠ 1ï¼Œå”¤é†’ä¸€ä¸ªç­‰å¾…é”çš„çº¿ç¨‹ã€‚</p>
<hr>
<p>ä¸Šé¢çš„ä»£ç å­˜åœ¨æ­»é”çš„é—®é¢˜ï¼ŒåŸå› æ˜¯å½“æ‰€æœ‰çš„å“²å­¦å®¶åŒæ—¶æ‹¿èµ·è‡ªå·±å·¦è¾¹çš„å‰å­åï¼Œä¼šå‘ç”Ÿæ­»é”ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå‡è®¾å½“å‰æ‰€æœ‰çš„å“²å­¦å®¶éƒ½æ‹¿èµ·äº†è‡ªå·±å·¦è¾¹çš„å‰å­ï¼Œé‚£ä¹ˆæ¯ä¸ªå“²å­¦å®¶éƒ½åœ¨ç­‰å¾…è‡ªå·±çš„å³è¾¹çš„å‰å­è¢«é‡Šæ”¾ï¼Œä»¥ä¾¿æ‹¿èµ·å³è¾¹çš„å‰å­ã€‚ä½†æ˜¯å³è¾¹çš„å‰å­å·²ç»è¢«é‚»åº§çš„å“²å­¦å®¶æ‹¿èµ°äº†ï¼Œä»–ä»¬ä¹Ÿåœ¨ç­‰å¾…ä»–ä»¬å·¦è¾¹çš„å‰å­è¢«é‡Šæ”¾ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å“²å­¦å®¶éƒ½æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œè¿›å…¥äº†æ­»é”çŠ¶æ€ã€‚</p>
<p>ä¸ºäº†é¿å…æ­»é”ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼š</p>
<ol>
<li>å°†æŸä¸ªå“²å­¦å®¶çš„å·¦å³å‰å­åŒæ—¶æ‹¿èµ·æ¥ï¼Œè¿™æ ·ä»–å°±å¯ä»¥å¼€å§‹è¿›é¤äº†ï¼Œé¿å…äº†æ‰€æœ‰å“²å­¦å®¶éƒ½æ‹¿èµ·è‡ªå·±å·¦è¾¹çš„å‰å­å¯¼è‡´çš„æ­»é”ã€‚</li>
<li>æ”¹å˜æŸäº›å“²å­¦å®¶çš„æ‹¿å‰å­é¡ºåºï¼Œä¾‹å¦‚å…ˆæ‹¿å³è¾¹çš„å‰å­å†æ‹¿å·¦è¾¹çš„å‰å­ï¼Œé¿å…äº†æ‰€æœ‰å“²å­¦å®¶éƒ½æ‹¿èµ·è‡ªå·±å·¦è¾¹çš„å‰å­å¯¼è‡´çš„æ­»é”ã€‚</li>
</ol>
<p>æ¥è‡ªå¸¦çˆ¹<a href="https://openai.com/blog/chatgpt" target="_blank" rel="noopener noreffer">ChatGPT</a></p>
</blockquote>
<ul>
<li>æˆåŠŸçš„å°è¯• (ä¸‡èƒ½çš„æ–¹æ³•)</li>
<li><b>OSå“²å­¦ï¼šé€šç”¨ $&gt;$ å°èªæ˜</b>ï¼ˆâ¬›âœ‹ï¼šåˆ«è£…ğŸ…±ï¸ï¼ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">//å·¦å³æ‰‹çš„å‰å­éƒ½åœ¨çš„æ—¶å€™æ‰èƒ½åƒé¥­ï¼Œå¦åˆ™ç­‰ç€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="c1">//ä¸€ä¸‹å­æ‹¿ä¸¤ä¸ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">//ä¸€ä¸‹å­è¿˜å›å»ä¸¤ä¸ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">broadcast</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><font color="red">ä¸ä¸Šé¢é‚£ä¸ªå¤±è´¥çš„ä¾‹å­ç›¸æ¯”ï¼Œè¿™ä¸ªç¨‹åºé‡Œé¢çš„å“²â™‚ï¸å­¦å®¶<b>ä¸€çœ‹çœ‹å·¦å³ä¸¤è¾¹çš„å‰å­</b>ï¼Œ<b>æ‹¿å–å’Œå½’è¿˜ä¹Ÿæ˜¯æŒ‰åŒ</b>ï¼Œä¸ä¼šå†åƒå‰é¢é‚£æ ·ä¸€ä¸ªä¸€ä¸ªæ‹¿ï¼Œæœ€åé€ æˆæ­»é”çš„æƒ…å†µ</font>ã€‚</li>
</ul>
<h3 id="å¿˜äº†ä¿¡å·é‡è®©ä¸€ä¸ªäººé›†ä¸­ç®¡ç†å‰å­å§">å¿˜äº†ä¿¡å·é‡ï¼Œè®©ä¸€ä¸ªäººé›†ä¸­ç®¡ç†å‰å­å§ï¼</h3>
<p>â€œLeader/followerâ€ - ç”Ÿäº§è€…/æ¶ˆè´¹è€…</p>
<ul>
<li>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éå¸¸å¸¸è§çš„è§£å†³æ€è·¯ (HDFS, &hellip;)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Tphilosopher</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">send_request</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">EAT</span><span class="p">);</span> <span class="c1">//å‘waiterè¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">P</span><span class="p">(</span><span class="n">allowed</span><span class="p">[</span><span class="n">id</span><span class="p">]);</span> <span class="c1">// waiter ä¼šæŠŠå‰å­é€’ç»™å“²å­¦å®¶ï¼ˆè¿™ä¸ªè¿‡ç¨‹éœ€è¦ç­‰ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">philosopher_eat</span><span class="p">();</span> <span class="c1">//å¹²é¥­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">send_request</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">DONE</span><span class="p">);</span> <span class="c1">//å‘è¯·æ±‚å½’è¿˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Twaiter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span> <span class="o">=</span> <span class="n">receive_request</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">EAT</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">DONE</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/chapter6-13.png" title="/img/Operating System/chapter6-13.png" data-thumbnail="/img/Operating System/chapter6-13.png" data-sub-html="<h2>å’Œä¸Šé¢çš„ä¾‹å­å¾ˆåƒï¼Œç”¨ä¸€ä¸ªæœåŠ¡å‘˜åšæ€»ç®¡ç†</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter6-13.png"
            data-srcset="/img/Operating%20System/chapter6-13.png, /img/Operating%20System/chapter6-13.png 1.5x, /img/Operating%20System/chapter6-13.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter6-13.png" />
    </a><figcaption class="image-caption"><code>å’Œä¸Šé¢çš„ä¾‹å­å¾ˆåƒï¼Œç”¨ä¸€ä¸ªæœåŠ¡å‘˜åšæ€»ç®¡ç†</code></figcaption>
    </figure>
<ul>
<li>è¿™ä¸ªæ˜¯ä¸€ä¸ª<b>é›†ä¸­å¼ç®—æ³•</b>ï¼Œè¦æ¯”<b>åˆ†å¸ƒå¼ç®—æ³•</b>æ›´å®¹æ˜“æ•´å¯¹,<code>Twaiter</code>æ˜¯ä¸€ä¸ªè°ƒåº¦å™¨</li>
</ul>
<h3 id="å¿˜äº†é‚£äº›å¤æ‚çš„åŒæ­¥ç®—æ³•å§">å¿˜äº†é‚£äº›å¤æ‚çš„åŒæ­¥ç®—æ³•å§ï¼</h3>
<ul>
<li>
<p>ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œç®¡å‰å­çš„äººæ˜¯æ€§èƒ½ç“¶é¢ˆ</p>
<ul>
<li>
<p>ä¸€å¤§æ¡Œäººåƒé¥­ï¼Œæ¯ä¸ªäººéƒ½å«æœåŠ¡å‘˜çš„æ„Ÿè§‰</p>
</li>
<li>
<p>$Premature\ optimization\ is\ the\ root\ of\ all\ evil\ (D. E. Knuth)\newline$</p>
</li>
<li>
<p><b>ä¸æ•°æ®ç»“æ„ä¸åŒï¼ŒOSæ›´å¤šè€ƒè™‘ç°å®æƒ…å†µ</b></p>
</li>
</ul>
</li>
<li>
<p><font color="red"><b>æŠ›å¼€ workload è°ˆä¼˜åŒ–å°±æ˜¯è€æµæ°“</b></font></p>
<ul>
<li>
<p>åƒé¥­çš„æ—¶é—´é€šå¸¸è¿œè¿œå¤§äºè¯·æ±‚æœåŠ¡å‘˜çš„æ—¶é—´</p>
</li>
<li>
<p>å¦‚æœä¸€ä¸ª manager æä¸å®šï¼Œå¯ä»¥åˆ†å¤šä¸ª (fast/slow path)ï¼ˆå¤šä¸ªæœåŠ¡å‘˜+æ€»æœåŠ¡å‘˜ï¼Œæ¯ä¸ªæœåŠ¡å‘˜éƒ½æœ‰ä¸€æŠŠå‰å­ï¼‰</p>
<ul>
<li>æŠŠç³»ç»Ÿè®¾è®¡å¥½ï¼Œä½¿é›†ä¸­ç®¡ç†ä¸æˆä¸ºç“¶é¢ˆ
<ul>
<li><a href="https://www.usenix.org/conference/nsdi20/presentation/brooker" target="_blank" rel="noopener noreffer">Millions of tiny databases</a> (NSDI'20)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æœ¬æ¬¡è¯¾å›ç­”çš„é—®é¢˜</p>
<ul>
<li><strong>Q</strong>: å¦‚ä½•åœ¨å¤šå¤„ç†å™¨ä¸ŠååŒå¤šä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼Ÿ</li>
</ul>
<hr>
<p>Take-away message</p>
<ul>
<li>å®ç°åŒæ­¥çš„æ–¹æ³•
<ul>
<li>æ¡ä»¶å˜é‡ã€ä¿¡å·é‡ï¼›ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</li>
<li>Job queue å¯ä»¥å®ç°å‡ ä¹ä»»ä½•å¹¶è¡Œç®—æ³•</li>
</ul>
</li>
<li>ä¸è¦ â€œè‡ªä½œèªæ˜â€ è®¾è®¡ç®—æ³•ï¼Œå°å¿ƒæ±‚è¯</li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>END<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>in 2023-03-12 15:30</p>
<p>è¿™ç« å¥½â„¢ï¸çš„éš¾ï¼Œæ„Ÿè§‰æ˜¯æœ¬é—¨è¯¾å¬åˆ°ç›®å‰ä¸ºæ­¢é™¤äº†ç¬¬ä¸‰ç« ä»¥å¤–æœ€åƒåŠ›çš„ä¸€èŠ‚è¯¾ä¹‹ä¸€äº†ï¼Œå¯èƒ½ä¹Ÿå’Œå‰ç½®çŸ¥è¯†ç¼ºå¤±æœ‰å…³ï¼ˆæ¯•ç«Ÿä¸æ˜¯å—å¤§âœ‹ï¼‰</p>
<ul>
<li>
<p>è€Œä¸”å‘ç°æœ‰å¾ˆå¤šä¸œè¥¿è¦çœ‹äº†</p>
<ul>
<li>
<p>ã€ŠCSAPPã€‹ç¬¬12ç« </p>
</li>
<li>
<p>ã€ŠUNIXç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹ç¬¬15ç« ï¼ˆä¹‹å‰<a href="https://z217blog.cn" target="_blank" rel="noopener noreffer">z217</a>å­¦é•¿å°±æ¨èäº†è¿™æœ¬ä¹¦ï¼‰</p>
</li>
<li>
<p>C++å¤šçº¿ç¨‹éƒ¨åˆ†çš„æ ‡å‡†åº“ï¼Œä¸ç„¶åŠ›æ‰£çš„é¢˜åšä¸äº†ï¼Œè€Œä¸”åé¢è¿™ä¸ªè¿˜è¦ç”¨</p>
</li>
</ul>
</li>
</ul>
<p><del>æœ‰æ—¶é—´èµ¶ç´§çœ‹(bushi</del></p>
</div>
        </div>
    </div>
<h2 id="è¡¥å……è¿›ç¨‹è°ƒåº¦scheduling">è¡¥å……ï¼šè¿›ç¨‹è°ƒåº¦$(Scheduling)$</h2>
<blockquote>
<p>å‚è€ƒ<b>æ¸…åå¤§å­¦</b>$rCore$è¯¾ç¨‹èµ„æ–™â€”â€”<a href="http://rcore-os.cn/rCore-Tutorial-Book-v3/chapter5/4scheduling.html" target="_blank" rel="noopener noreffer">è¿›ç¨‹è°ƒåº¦</a>â€”â€”è¡¥å……äº2023-4-15</p>
</blockquote>
<h3 id="å¯¼è¯»">å¯¼è¯»</h3>
<ul>
<li>
<p>è®¡ç®—æœºå†…å­˜ä¸­<b><u>å¯æ‰§è¡Œçš„ç¨‹åºä¸ªæ•°å¤§äºå¤„ç†å™¨ä¸ªæ•°æ—¶</u></b>ï¼Œè¿™äº›ç¨‹åºå¯é€šè¿‡å…±äº«å¤„ç†å™¨æ¥å®Œæˆå„è‡ªçš„ä»»åŠ¡ã€‚è€Œæ“ä½œç³»ç»Ÿè´Ÿè´£è®©å®ƒä»¬èƒ½å¤Ÿ<b><u>é«˜æ•ˆåˆç†åœ°å…±äº«å¤„ç†å™¨èµ„æº</u></b>ï¼Œè¿™å°±å¼•å…¥äº†è°ƒåº¦ï¼ˆ<code>scheduling</code>ï¼‰è¿™ä¸ªæ¦‚å¿µã€‚è¿›ç¨‹è°ƒåº¦ï¼ˆä¹Ÿç§°å¤„ç†å™¨è°ƒåº¦ï¼‰æ˜¯è¿›ç¨‹ç®¡ç†çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
</li>
<li>
<p>è°ƒåº¦çš„ä¸€èˆ¬å®šä¹‰</p>
<ul>
<li>åœ¨ä¸€å®šçš„çº¦æŸæ¡ä»¶ä¸‹ï¼ŒæŠŠ<b>æœ‰é™çš„èµ„æº</b>åœ¨æ—¶é—´ä¸Šåˆ†é…ç»™è‹¥å¹²ä¸ªä»»åŠ¡ï¼Œä»¥<b>æ»¡è¶³æˆ–ä¼˜åŒ–ä¸€ä¸ªæˆ–å¤šä¸ªæ€§èƒ½æŒ‡æ ‡</b>ã€‚</li>
<li>å¯¹äºè®¡ç®—æœºç³»ç»Ÿè€Œè¨€ï¼Œå°±æ˜¯åœ¨ä¸€å°è®¡ç®—æœºä¸­è¿è¡Œäº†å¤šä¸ªè¿›ç¨‹ï¼Œæ“ä½œç³»ç»ŸæŠŠæœ‰é™çš„å¤„ç†å™¨åœ¨æ—¶é—´ä¸Šåˆ†é…ç»™å„ä¸ªè¿›ç¨‹ï¼Œä»¥æ»¡è¶³æˆ–ä¼˜åŒ–è¿›ç¨‹æ‰§è¡Œçš„æ€§èƒ½æŒ‡æ ‡ã€‚</li>
</ul>
</li>
<li>
<p>æ ¸å¿ƒé—®é¢˜ï¼š<b>æ“ä½œç³»ç»Ÿå¦‚ä½•é€šè¿‡è¿›ç¨‹è°ƒåº¦æ¥æé«˜è¿›ç¨‹å’Œç³»ç»Ÿçš„æ€§èƒ½</b></p>
</li>
<li>
<p>ç»†åŒ–ä¸ºå­é—®é¢˜</p>
<ul>
<li>è¿è¡Œè¿›ç¨‹çš„çº¦æŸæ¡ä»¶æ˜¯å•¥ï¼Ÿ</li>
<li>æœ‰å“ªäº›è°ƒåº¦ç­–ç•¥å’Œç®—æ³•ï¼Ÿ</li>
<li>è°ƒåº¦çš„æ€§èƒ½æŒ‡æ ‡æ˜¯å•¥ï¼Ÿ</li>
<li>å¦‚ä½•è¯„ä»·è°ƒåº¦ç­–ç•¥å’Œç®—æ³•ï¼Ÿ</li>
</ul>
</li>
</ul>
<h3 id="æ‰¹å¤„ç†ç³»ç»Ÿçš„è°ƒåº¦">æ‰¹å¤„ç†ç³»ç»Ÿçš„è°ƒåº¦</h3>
<ul>
<li>åœ¨æ‰¹å¤„ç†ç³»ç»Ÿä¸‹ï¼Œåº”ç”¨<b>ä»¥ç§‘å­¦è®¡ç®—ä¸ºä¸»ï¼ŒI/Oæ“ä½œè¾ƒå°‘ï¼Œ</b>ä¸”I/Oæ“ä½œä¸»è¦é›†ä¸­åœ¨åº”ç”¨å¼€å§‹å’Œç»“æŸçš„ä¸€å°æ®µæ—¶é—´ï¼Œåº”ç”¨çš„æ‰§è¡Œæ—¶é—´ä¸»è¦æ¶ˆè€—åœ¨å ç”¨å¤„ç†å™¨è¿›è¡Œè®¡ç®—ä¸Šï¼Œä¸”åº”ç”¨çš„å¤§è‡´æ‰§è¡Œæ—¶é—´ä¸€èˆ¬å¯ä»¥é¢„ä¼°åˆ°ã€‚</li>
</ul>
<h4 id="çº¦æŸæ¡ä»¶">çº¦æŸæ¡ä»¶</h4>
<ul>
<li>æ‰¹å¤„ç†ç³»ç»Ÿä¸­çš„è¿›ç¨‹æœ‰å¦‚ä¸‹ä¸€äº›çº¦æŸ/å‰ææ¡ä»¶ï¼š</li>
</ul>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹<b><u>åŒæ—¶åˆ°è¾¾</u></b>ã€‚</li>
<li>æ¯ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ç›¸åŒã€‚ï¼ˆä¸ºäº†è´´åˆå®é™…ä¹Ÿå¯ä»¥æ”¹å˜ä¸€äº›çº¦æŸæ¡ä»¶ï¼Œæ¯”å¦‚å°†æ¡ä»¶2æ”¹ä¸ºï¼š<code>æ¯ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ä¸åŒ</code>ï¼‰</li>
<li>è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´æ˜¯<b>å·²çŸ¥çš„</b>ã€‚</li>
<li>è¿›ç¨‹åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹æœŸé—´å¾ˆå°‘æ‰§è¡ŒI/Oæ“ä½œã€‚ï¼ˆå¯ç†è§£ä¸ºåœ¨æ“ä½œç³»ç»Ÿè°ƒåº¦è¿‡ç¨‹ä¸­ï¼Œ<b><u>å¯ä»¥å¿½ç•¥è¿›ç¨‹æ‰§è¡ŒI/Oæ“ä½œçš„å¼€é”€</u></b>ï¼‰</li>
<li>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­<b>ä¸ä¼šè¢«æŠ¢å </b>ã€‚</li>
</ol>
<h4 id="æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</h4>
<ul>
<li>
<p>æˆ‘ä»¬è¿˜éœ€ç»™å‡ºæ€§èƒ½æŒ‡æ ‡ï¼Œç”¨äºè¡¡é‡ï¼Œæ¯”è¾ƒå’Œè¯„ä»·ä¸åŒçš„è°ƒåº¦ç­–ç•¥ã€‚å¯¹äºæ‰¹å¤„ç†ç³»ç»Ÿä¸­çš„ä¸€èˆ¬åº”ç”¨è€Œè¨€ï¼Œå¯ä»¥åªæœ‰ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡ï¼šå‘¨è½¬æ—¶é—´ï¼ˆ<code>turn around time</code>ï¼‰ï¼Œå³è¿›ç¨‹å®Œæˆæ—¶é—´ä¸è¿›ç¨‹åˆ°è¾¾æ—¶é—´çš„å·®å€¼ï¼š$T_{å‘¨è½¬æ—¶é—´}=T_{å®Œæˆæ—¶é—´}-T_{åˆ°è¾¾æ—¶é—´}$</p>
</li>
<li>
<p>ç”±äºå‰ææ¡ä»¶1 æ˜ç¡®æŒ‡å‡º<b>æ‰€æœ‰è¿›ç¨‹åœ¨åŒä¸€æ—¶é—´åˆ°è¾¾</b>ï¼Œ æ‰€ä»¥$T_{åˆ°è¾¾æ—¶é—´}=0$ï¼Œå› æ­¤$T_{å‘¨è½¬æ—¶é—´}=T_{å®Œæˆæ—¶é—´}-T_{åˆ°è¾¾æ—¶é—´}=T_{å®Œæˆæ—¶é—´}$ã€‚é™¤äº†æ€»çš„å‘¨è½¬æ—¶é—´ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨å¹³å‡å‘¨è½¬æ—¶é—´è¿™æ ·çš„ç»Ÿè®¡å€¼ï¼š</p>
</li>
</ul>
<p>$$
T_{å¹³å‡å‘¨è½¬æ—¶é—´}=\frac{\sum_{i=1}^{å°±ç»ªè¿›ç¨‹ä¸ªæ•°} T_{å‘¨è½¬æ—¶é—´_i}}{å°±ç»ªè¿›ç¨‹ä¸ªæ•°}
$$</p>
<ul>
<li><font color="red"><b>å¯¹äºå•ä¸ªè¿›ç¨‹è€Œè¨€ï¼Œå¹³å‡å‘¨è½¬æ—¶é—´æ˜¯ä¸€ä¸ªæ›´å€¼å¾—å…³æ³¨çš„æ€§èƒ½æŒ‡æ ‡</b></font></li>
</ul>
<h4 id="å…ˆæ¥å…ˆæœåŠ¡">å…ˆæ¥å…ˆæœåŠ¡</h4>
<ul>
<li>
<p>å…ˆæ¥å…ˆæœåŠ¡ï¼ˆ<code>first-come first-severd</code>ï¼Œä¹Ÿç§°<code>First-in first-out</code>ï¼Œå…ˆè¿›å…ˆå‡ºï¼‰è°ƒåº¦ç­–ç•¥çš„åŸºæœ¬æ€è·¯å°±æ˜¯<b><u>æŒ‰è¿›ç¨‹è¯·æ±‚å¤„ç†å™¨çš„å…ˆåé¡ºåºæ¥ä½¿ç”¨å¤„ç†å™¨</u></b>ã€‚åœ¨å…·ä½“å®ç°ä¸Šï¼Œæ“ä½œç³»ç»Ÿé¦–å…ˆä¼šå»ºç«‹ä¸€ä¸ª<b>å°±ç»ªè°ƒåº¦é˜Ÿåˆ—ï¼ˆç®€ç§°å°±ç»ªé˜Ÿåˆ—ï¼‰</b>å’Œä¸€ä¸ª<b>ç­‰å¾…é˜Ÿåˆ—ï¼ˆä¹Ÿç§°é˜»å¡é˜Ÿåˆ—ï¼‰</b>ã€‚</p>
</li>
<li>
<p>å¤§è‡´çš„è°ƒåº¦è¿‡ç¨‹å¦‚ä¸‹</p>
<ul>
<li>æ“ä½œç³»ç»Ÿæ¯æ¬¡æ‰§è¡Œè°ƒåº¦æ—¶ï¼Œéƒ½æ˜¯ä»å°±ç»ªé˜Ÿåˆ—çš„<b>é˜Ÿå¤´</b>å–å‡ºä¸€ä¸ªè¿›ç¨‹æ¥æ‰§è¡Œ</li>
<li><b>å½“ä¸€ä¸ªåº”ç”¨è¢«åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶åˆ›å»ºå¯¹åº”çš„è¿›ç¨‹ï¼Œè®¾ç½®è¿›ç¨‹ä¸º<font color="red">å°±ç»ªè¿›ç¨‹</font></b>ï¼ŒæŒ‰è¿›ç¨‹åˆ°è¾¾çš„å…ˆåé¡ºåºï¼ŒæŠŠè¿›ç¨‹æ”¾å…¥<b><font color="red">å°±ç»ªè°ƒåº¦é˜Ÿåˆ—</font></b>çš„é˜Ÿå°¾</li>
<li>å½“æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹<b>ä¸»åŠ¨æ”¾å¼ƒ</b>å¤„ç†å™¨æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¯¥è¿›ç¨‹æ”¾åˆ°<b>å°±ç»ªé˜Ÿåˆ—<font color="red">æœ«å°¾</font></b>ï¼Œå¹¶ä»<b>å°±ç»ªé˜Ÿåˆ—<font color="red">å¤´</font></b>å–å‡ºä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œ</li>
<li>å½“æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹<b>æ‰§è¡Œå®Œæ¯•</b>æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼š<font color="red"><b>å›æ”¶è¯¥è¿›ç¨‹æ‰€åœ¨èµ„æº</b></font>ï¼Œå¹¶ä»<b>å°±ç»ªé˜Ÿåˆ—<font color="red">å¤´</font></b>å–å‡ºä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œ</li>
<li>å½“æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹éœ€è¦<b>ç­‰å¾…æŸä¸ªäº‹ä»¶æˆ–èµ„æºæ—¶</b>ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¯¥è¿›ç¨‹<b>ä»<font color="red">å°±ç»ªé˜Ÿåˆ—</font>ä¸­ç§»å‡ºï¼Œæ”¾åˆ°<font color="red">ç­‰å¾…é˜Ÿåˆ—</font>ä¸­ï¼ˆ<font color="orange">æ­¤æ—¶è¿™ä¸ªè¿›ç¨‹ä»å°±ç»ªè¿›ç¨‹å˜æˆç­‰å¾…è¿›ç¨‹</font>ï¼‰ï¼Œå¹¶ä»<font color="red">å°±ç»ªé˜Ÿåˆ—å¤´</font>å–å‡ºä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œ</b></li>
<li>å½“ç­‰å¾…è¿›ç¨‹æ‰€<b>ç­‰å¾…çš„æŸä¸ªäº‹ä»¶å‡ºç°æˆ–ç­‰å¾…çš„èµ„æºå¾—åˆ°æ»¡è¶³æ—¶</b>ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠè¯¥è¿›ç¨‹<font color="red"><b>è½¬ä¸ºå°±ç»ªè¿›ç¨‹</b></font>ï¼Œå¹¶ä¼šæŠŠè¯¥è¿›ç¨‹<b>ä»<font color="red">ç­‰å¾…é˜Ÿåˆ—</font>ä¸­ç§»å‡ºï¼Œå¹¶æ”¾åˆ°<font color="red">å°±ç»ªé˜Ÿåˆ—æœ«å°¾</font></b></li>
</ul>
</li>
<li>
<p>è¯¥è°ƒåº¦ç­–ç•¥çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œå®¹æ˜“å®ç°ã€‚å¯¹äºæ»¡è¶³1~5çº¦æŸæ¡ä»¶çš„æ‰§è¡Œç¯å¢ƒï¼Œç”¨è¿™ä¸ªè°ƒåº¦ç­–ç•¥çš„å¹³å‡å‘¨è½¬æ—¶é—´æ€§èƒ½æŒ‡æ ‡ä¹Ÿå¾ˆå¥½ã€‚å¦‚æœåœ¨ä¸€ä¸ªåœ¨è¾ƒé•¿çš„æ—¶é—´æ®µå†…ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½èƒ½ç»“æŸï¼Œé‚£ä¹ˆå…¬å¹³æ€§è¿™ä¸ªæŒ‡æ ‡ä¹Ÿæ˜¯èƒ½å¾—åˆ°ä¿è¯çš„</p>
</li>
<li>
<p>æ“ä½œç³»ç»Ÿä¸ä¼šä¸»åŠ¨æ‰“æ–­è¿›ç¨‹çš„è¿è¡Œ</p>
</li>
</ul>
<h4 id="æœ€çŸ­ä½œä¸šä¼˜å…ˆ">æœ€çŸ­ä½œä¸šä¼˜å…ˆ</h4>
<ul>
<li>
<p>æ»¡è¶³1~5çš„çº¦æŸæ¡ä»¶çš„æ‰§è¡Œç¯å¢ƒå¤ªç®€åŒ–å’Œç†æƒ³åŒ–äº†ï¼Œåœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªåº”ç”¨çš„æ‰§è¡Œæ—¶é—´å¾ˆå¯èƒ½ä¸åŒï¼Œæ‰€ä»¥çº¦æŸæ¡ä»¶2â€œæ¯ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ç›¸åŒâ€å°±ä¸åˆé€‚äº†ã€‚å¦‚æœæŠŠçº¦æŸæ¡ä»¶2æ”¹ä¸º <b>â€œæ¯ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ä¸åŒâ€</b>ï¼Œé‚£ä¹ˆåœ¨é‡‡ç”¨å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç­–ç•¥çš„ç³»ç»Ÿä¸­ï¼Œ<b><u>å¯èƒ½å°±ä¼šå‡ºç°çŸ­è¿›ç¨‹ä¸å¾—ä¸ç­‰é•¿è¿›ç¨‹ç»“æŸåæ‰èƒ½è¿è¡Œçš„ç°è±¡ï¼Œå¯¼è‡´çŸ­è¿›ç¨‹çš„ç­‰å¾…æ—¶é—´å¤ªé•¿ï¼Œä¸”ç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´ä¹Ÿå˜é•¿äº†</u></b></p>
</li>
<li>
<p>å‡è®¾æœ‰ä¸¤ä¸ªè¿›ç¨‹$P_Aã€P_B$ï¼Œå®ƒä»¬å¤§è‡´åŒæ—¶åˆ°è¾¾ï¼Œä½†$P_A$ç¨å¾®å¿«ä¸€ç‚¹ï¼Œè¿›ç¨‹$P_A$æ‰§è¡Œæ—¶é—´ä¸º100ï¼Œè¿›ç¨‹$P_B$çš„æ‰§è¡Œæ—¶é—´ä¸º20ã€‚å¦‚æœæ“ä½œç³»ç»Ÿé‡‡ç”¨<b>å…ˆæ¥å…ˆæœåŠ¡</b>çš„è°ƒåº¦ç­–ç•¥ï¼Œè¿›ç¨‹çš„å¹³å‡å‘¨è½¬æ—¶é—´ä¸ºï¼š$\frac{P_Aå‘¨è½¬æ—¶é—´+P_Bå‘¨è½¬æ—¶é—´}{2}=\frac {100+120}{2} = 110$</p>
</li>
<li>
<p>ä½†å¦‚æœæ“ä½œç³»ç»Ÿå…ˆè°ƒåº¦è¿›ç¨‹$P_B$ï¼Œé‚£ä¹ˆè¿›ç¨‹çš„å¹³å‡å‘¨è½¬æ—¶é—´ä¸ºï¼š$\frac{P_Bå‘¨è½¬æ—¶é—´+P_Aå‘¨è½¬æ—¶é—´}{2}=\frac {20+120}{2} = 70$</p>
</li>
<li>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<b>å¦‚æœé‡‡ç”¨å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç­–ç•¥ï¼Œ<font color="red">æ‰§è¡Œæ—¶é—´çŸ­çš„è¿›ç¨‹ï¼ˆç®€ç§°çŸ­è¿›ç¨‹ï¼‰å¯è¢«æ’åœ¨æ‰§è¡Œæ—¶é—´é•¿çš„è¿›ç¨‹ï¼ˆé•¿è¿›ç¨‹ï¼‰åé¢ï¼Œå¯¼è‡´è¿›ç¨‹çš„å¹³å‡å‘¨è½¬æ—¶é—´å˜é•¿</font>ï¼ˆé•¿è¿›ç¨‹é¦–å…ˆæ‰§è¡Œå¯¼è‡´äº†åé¢çš„è¿›ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼‰</b></p>
</li>
<li>
<p>ä¸ºåº”å¯¹çŸ­è¿›ç¨‹ä¸å¾—ä¸ç­‰é•¿è¿›ç¨‹ç»“æŸåæ‰èƒ½è¿è¡Œçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ä¸€ä¸ªè°ƒåº¦çš„æ–¹æ³•ï¼š<b>ä¼˜å…ˆè®©çŸ­è¿›ç¨‹æ‰§è¡Œã€‚è¿™å°±æ˜¯<font color="red">æœ€çŸ­ä½œä¸šä¼˜å…ˆï¼ˆ<code>Shortest Job First</code>ï¼Œç®€ç§°<code>SJF</code>ï¼‰</font>è°ƒåº¦ç­–ç•¥ã€‚å…¶å®ä¸Šé¢è®©PBå…ˆæ‰§è¡Œçš„è°ƒåº¦æ–¹æ³•ï¼Œå°±æ˜¯é‡‡ç”¨äº†æœ€çŸ­ä½œä¸šä¼˜å…ˆç­–ç•¥</b>ã€‚</p>
</li>
<li>
<p>åœ¨æ›´æ–°çº¦æŸæ¡ä»¶2çš„å‰æä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æŠŠå¹³å‡å‘¨è½¬æ—¶é—´ä½œä¸ºå”¯ä¸€çš„æ€§èƒ½æŒ‡æ ‡ï¼Œé‚£ä¹ˆSJFæ˜¯ä¸€ä¸ªæœ€ä¼˜è°ƒåº¦ç®—æ³•</p>
</li>
<li>
<p>è™½ç„¶SJFè°ƒåº¦ç­–ç•¥åœ¨ç†è®ºä¸Šè¡¨ç°å¾ˆä¸é”™ï¼Œä½†åœ¨å…·ä½“å®ç°ä¸­ï¼Œ<b>éœ€è¦å¯¹å¤„äºå°±ç»ªé˜Ÿåˆ—ä¸Šçš„è¿›ç¨‹æŒ‰æ‰§è¡Œæ—¶é—´è¿›è¡Œæ’åºï¼Œè¿™ä¼šå¼•å…¥ä¸€å®šçš„è°ƒåº¦æ‰§è¡Œå¼€é”€</b>ã€‚<u>è€Œä¸”å¦‚æœè¿›ä¸€æ­¥æ”¾å®½çº¦æŸï¼Œè´´è¿‘å®é™…æƒ…å†µï¼ŒSJFå°±ä¼šæ˜¾ç°å‡ºå®ƒçš„<code>ä¸è¶³</code></u>ã€‚å¦‚æœæˆ‘ä»¬æ”¾å®½çº¦æŸæ¡ä»¶1ï¼š</p>
</li>
</ul>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹å¯ä»¥åœ¨ä¸åŒæ—¶é—´åˆ°è¾¾</li>
</ol>
<blockquote>
<p>é‚£ä¹ˆå¯èƒ½ä¼šå‘ç”Ÿä¸€ç§æƒ…å†µï¼Œå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹è¿˜éœ€ $k$ æ‰§è¡Œæ—¶é—´æ‰èƒ½å®Œæˆï¼Œè¿™æ—¶æ¥äº†ä¸€ä¸ªæ‰§è¡Œæ—¶é—´ä¸º $h$ çš„è¿›ç¨‹ï¼Œä¸” $h &lt; K$ ï¼Œä½†æ ¹æ®<code>çº¦æŸæ¡ä»¶5</code>ï¼Œ<b>æ“ä½œç³»ç»Ÿä¸èƒ½å¼ºåˆ¶åˆ‡æ¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</b>ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€çŸ­ä½œä¸šä¼˜å…ˆçš„<b>å«ä¹‰å°±ä¸æ˜¯é‚£ä¹ˆç¡®åˆ‡äº†</b>ï¼Œ<b>è€Œä¸”åœ¨ç†è®ºä¸Šï¼ŒSJFä¹Ÿå°±ä¸æ˜¯æœ€ä¼˜è°ƒåº¦ç®—æ³•äº†</b></p>
</blockquote>
<ul>
<li>ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿé‡‡ç”¨SJFè°ƒåº¦ç­–ç•¥ï¼ˆä¸æ”¯æŒæŠ¢å è¿›ç¨‹ï¼‰ï¼Œæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œ$P_A$åœ¨æ—¶é—´0åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º100ï¼Œ $P_B$åœ¨æ—¶é—´20åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º20ï¼Œé‚£ä¹ˆå‘¨è½¬æ—¶é—´ä¸º</li>
</ul>
<p>$$
(P_Aæ‰§è¡Œç»“æŸ-P_Aå¼€å§‹æ‰§è¡Œ)+(P_Bæ‰§è¡Œç»“æŸ-P_Bå¼€å§‹æ‰§è¡Œ)=(100-0)+(120-20)=200
$$</p>
<p>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$\frac{200}{2}=100$</p>
<h3 id="äº¤äº’å¼ç³»ç»Ÿçš„è°ƒåº¦">äº¤äº’å¼ç³»ç»Ÿçš„è°ƒåº¦</h3>
<ul>
<li>äº¤äº’å¼ç³»ç»Ÿæ˜¯æŒ‡æ”¯æŒäººæœºäº¤äº’å’Œå„ç§$I/O$äº¤äº’çš„è®¡ç®—æœºç³»ç»Ÿã€‚å¯æŠ¢å ä»»åŠ¡æ‰§è¡Œçš„åˆ†æ—¶å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿå¯¹äººæœºäº¤äº’æ€§å’Œ$I/O$åŠæ—¶å“åº”æ›´åŠ å‹å¥½ï¼Œå¯¹è¿›ç¨‹ç‰¹å¾çš„çº¦æŸæ¡ä»¶è¿›ä¸€æ­¥æ”¾å®½ï¼Œè¿›ç¨‹çš„<b>å¯æŠ¢å ç‰¹æ€§</b>éœ€è¦æˆ‘ä»¬é‡æ–°æ€è€ƒå¦‚ä½•è°ƒåº¦</li>
</ul>
<h4 id="çº¦æŸæ¡ä»¶-1">çº¦æŸæ¡ä»¶</h4>
<ul>
<li>äº¤äº’å¼ç³»ç»Ÿä¸­çš„è¿›ç¨‹æœ‰å¦‚ä¸‹ä¸€äº›çº¦æŸ/å‰ææ¡ä»¶ï¼š</li>
</ul>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹å¯<b>ä¸åŒæ—¶é—´åˆ°è¾¾</b></li>
<li>æ¯ä¸ªè¿›ç¨‹çš„<b>æ‰§è¡Œæ—¶é—´ä¸åŒ</b></li>
<li>è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´æ˜¯å·²çŸ¥çš„</li>
<li><b>è¿›ç¨‹åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹æœŸé—´ä¼šæ‰§è¡Œ$I/O$æ“ä½œ</b></li>
<li><b>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè¢«æŠ¢å </b></li>
</ol>
<ul>
<li>ç›¸å¯¹äºæ‰¹å¤„ç†æ“ä½œç³»ç»Ÿï¼Œçº¦æŸæ¡ä»¶4å‘ç”Ÿäº†å˜åŒ–ï¼Œ<font color="red"><b>è¿™æ„å‘³ç€åœ¨è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿä¸èƒ½å¿½è§†å…¶I/Oæ“ä½œ</b></font>ã€‚çº¦æŸæ¡ä»¶5ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œå³<b><font color="red">è¿›ç¨‹å¯ä»¥è¢«æ“ä½œç³»ç»Ÿéšæ—¶æ‰“æ–­å’ŒæŠ¢å </font></b></li>
</ul>
<h4 id="æ€§èƒ½æŒ‡æ ‡-1">æ€§èƒ½æŒ‡æ ‡</h4>
<ul>
<li>æ“ä½œç³»ç»Ÿæ”¯æŒä»»åŠ¡/è¿›ç¨‹è¢«æŠ¢å çš„ä¸€ä¸ªé‡è¦ç›®æ ‡æ˜¯æé«˜ç”¨æˆ·çš„äº¤äº’æ€§ä½“éªŒå’Œå‡å°‘$I/O$å“åº”æ—¶é—´ã€‚ç”¨æˆ·å¸Œæœ›è®¡ç®—æœºç³»ç»Ÿèƒ½åŠæ—¶å“åº”ä»–å‘å‡ºçš„$I/O$è¯·æ±‚ï¼ˆå¦‚é”®ç›˜ã€é¼ æ ‡ç­‰ï¼‰ï¼Œä½†å¹³å‡å‘¨è½¬æ—¶é—´è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡ä¸è¶³ä»¥åæ˜ äººæœºäº¤äº’æˆ–$I/O$å“åº”çš„æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ–°çš„æ€§èƒ½æŒ‡æ ‡ â€“ å“åº”æ—¶é—´ï¼ˆ<code>response time</code>ï¼‰ï¼š</li>
</ul>
<p>$$
T_{å“åº”æ—¶é—´}=T_{é¦–æ¬¡æ‰§è¡Œ}-T_{åˆ°è¾¾æ—¶é—´}
$$</p>
<ul>
<li>è€Œå¯¹åº”çš„å¹³å‡å“åº”æ—¶é—´æ˜¯ï¼š</li>
</ul>
<p>$$
T_{å¹³å‡å“åº”æ—¶é—´}=\frac{T_{å“åº”æ—¶é—´}}{å°±ç»ªè¿›ç¨‹ä¸ªæ•°}
$$</p>
<blockquote>
<p>ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿé‡‡ç”¨<code>SJF</code>è°ƒåº¦ç­–ç•¥ï¼ˆä¸æ”¯æŒæŠ¢å è¿›ç¨‹ï¼‰ï¼Œæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œ$P_A$åœ¨æ—¶é—´0åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º100ï¼Œ $P_B$åœ¨æ—¶é—´20åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º20ï¼Œé‚£ä¹ˆ$P_A$çš„å“åº”æ—¶é—´ä¸º0ï¼Œ$P_B$ä¸º80ï¼Œå¹³å‡å“åº”æ—¶é—´ä¸º 40 ã€‚</p>
</blockquote>
<h4 id="æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆstcf">æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆï¼ˆ<code>STCF</code>ï¼‰</h4>
<ul>
<li>
<p>ç”±äºçº¦æŸæ¡ä»¶5è¡¨ç¤ºäº†æ“ä½œç³»ç»Ÿå…è®¸æŠ¢å ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å®ç°ä¸€ç§<font color="red">æ”¯æŒè¿›ç¨‹æŠ¢å </font>çš„<b>æ”¹è¿›å‹<code>SJF</code>è°ƒåº¦ç­–ç•¥</b>ï¼Œå³<b>æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆï¼ˆ<code>Shortest Time to Complet First</code>ï¼‰è°ƒåº¦ç­–ç•¥</b>ã€‚</p>
</li>
<li>
<p>åŸºäºå‰è¿°çš„ä¾‹å­ï¼Œæ“ä½œç³»ç»Ÿé‡‡ç”¨STCFè°ƒåº¦ç­–ç•¥ï¼Œæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼ŒPAåœ¨æ—¶é—´0åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º100ï¼Œ PBåœ¨æ—¶é—´20åˆ°è¾¾ï¼Œæ‰§è¡Œæ—¶é—´ä¸º20ï¼Œé‚£ä¹ˆå‘¨è½¬æ—¶é—´ä¸º<b>ï¼ˆæ³¨æ„è¿™é‡Œé¢PBå¯ä»¥æŠ¢å PAäº†ï¼Œæ‰€ä»¥PAçš„å®Œæˆæ—¶é—´å˜æˆäº†$100+20=120$ï¼‰</b>ï¼š</p>
</li>
</ul>
<p>$$
\begin{align}
&amp;(120 - 0) + (40 - 20) = 140\newline
&amp;T_{å¹³å‡å‘¨è½¬æ—¶é—´}=\frac{140}{2}=70\newline
\end{align}
$$</p>
<ul>
<li>
<p>å¹³å‡å‘¨è½¬æ—¶é—´ä¸º 70 ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœé‡‡ç”¨<code>STCF</code>è°ƒåº¦ç­–ç•¥ï¼Œç›¸æ¯”äº<code>SJF</code>è°ƒåº¦ç­–ç•¥ï¼Œ<b>åœ¨<font color="red">å‘¨è½¬æ—¶é—´</font>è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡ä¸Šå¾—åˆ°äº†æ”¹å–„</b></p>
</li>
<li>
<p><b>ä½†å¯¹äº<font color="red">å“åº”æ—¶é—´</font>è€Œè¨€ï¼Œå¯èƒ½å°±ä¸è¿™ä¹ˆå¥½äº†</b>ã€‚è€ƒè™‘ä¸€ä¸ªä¾‹å­ï¼Œæœ‰ä¸¤ä¸ªç”¨æˆ·å‘å‡ºäº†æ‰§è¡Œä¸¤ä¸ªè¿›ç¨‹çš„è¯·æ±‚ï¼Œä¸”ä¸¤ä¸ªè¿›ç¨‹å¤§çº¦åŒæ—¶åˆ°è¾¾ï¼ŒPAå’ŒPBçš„æ‰§è¡Œæ—¶é—´éƒ½ä¸º20ã€‚æˆ‘ä»¬å‘ç°ï¼Œæ— è®ºæ“ä½œç³»ç»Ÿé‡‡ç”¨FIFO/SJF/STCFä¸­çš„å“ªä¸€ç§è°ƒåº¦ç­–ç•¥ï¼Œ<u>æŸä¸€ä¸ªç”¨æˆ·ä¸å¾—ä¸ç­‰å¾…20ä¸ªæ—¶é—´å•ä½åï¼Œæ‰èƒ½è®©ä»–çš„è¿›ç¨‹å¼€å§‹æ‰§è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¸å¥½çš„äº¤äº’ä½“éªŒ</u>ã€‚ä»æ€§èƒ½æŒ‡æ ‡ä¸Šçœ‹ï¼Œå“åº”æ—¶é—´æ¯”è¾ƒå·®ã€‚ è¿™å°±å¼•å…¥äº†æ–°çš„é—®é¢˜ï¼š<b><u>æ“ä½œç³»ç»Ÿå¦‚ä½•æ”¯æŒçœ‹é‡å“åº”æ—¶é—´è¿™ä¸€æŒ‡æ ‡çš„åº”ç”¨ç¨‹åºï¼Ÿ</u></b></p>
</li>
</ul>
<h4 id="åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬">åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬</h4>
<ul>
<li>
<p>å¦‚æœæ“ä½œç³»ç»Ÿåˆ†ç»™æ¯ä¸ªè¿è¡Œçš„è¿›ç¨‹çš„è¿è¡Œæ—¶é—´æ˜¯ä¸€ä¸ªè¶³å¤Ÿå°çš„æ—¶é—´ç‰‡ï¼ˆ<code>time sliceï¼Œquantum</code>ï¼‰ï¼Œ<b>æ—¶é—´ç‰‡ä¸€åˆ°ï¼Œå°±<font color="red">æŠ¢å å½“å‰è¿›ç¨‹å¹¶åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œã€‚</font></b></p>
</li>
<li>
<p>è¿™æ ·è¿›ç¨‹ä»¥æ—¶é—´ç‰‡ä¸ºå•ä½è½®æµå ç”¨å¤„ç†å™¨æ‰§è¡Œã€‚<b><u>å¯¹äºäº¤äº’å¼è¿›ç¨‹è€Œè¨€ï¼Œå°±æœ‰æ¯”è¾ƒå¤§çš„æœºä¼šåœ¨è¾ƒçŸ­çš„æ—¶é—´å†…æ‰§è¡Œï¼Œä»è€Œæœ‰åŠ©äºå‡å°‘å“åº”æ—¶é—´</u></b>ã€‚</p>
</li>
<li>
<p>è¿™ç§è°ƒåº¦ç­–ç•¥ç§°ä¸ºè½®è½¬ï¼ˆ<code>Round-Robin</code>ï¼Œç®€ç§°<code>RR</code>ï¼‰è°ƒåº¦ï¼Œå³<b><u><font color="red">åŸºæœ¬æ€è·¯å°±æ˜¯ä»å°±ç»ªé˜Ÿåˆ—å¤´å–å‡ºä¸€ä¸ªè¿›ç¨‹ï¼Œè®©å®ƒè¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œç„¶åæŠŠå®ƒæ”¾å›åˆ°é˜Ÿåˆ—å°¾ï¼Œå†ä»é˜Ÿåˆ—å¤´å–ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œï¼Œå‘¨è€Œå¤å§‹</font></u></b></p>
</li>
</ul>
<hr>
<ul>
<li>åœ¨å…·ä½“å®ç°ä¸Šï¼Œéœ€è¦è€ƒè™‘æ—¶é—´ç‰‡çš„å¤§å°ï¼Œä¸€èˆ¬æ—¶é—´ç‰‡çš„å¤§å°ä¼šè®¾ç½®ä¸º<b>æ—¶é’Ÿä¸­æ–­çš„æ—¶é—´é—´éš”çš„æ•´æ•°å€</b>ã€‚æ¯”å¦‚ï¼Œæ—¶é’Ÿä¸­æ–­é—´éš”ä¸º1msï¼Œæ—¶é—´ç‰‡å¯è®¾ç½®ä¸º10msï¼Œä¸¤ä¸ªç”¨æˆ·å‘å‡ºäº†æ‰§è¡Œä¸¤ä¸ªè¿›ç¨‹çš„è¯·æ±‚ï¼Œä¸”ä¸¤ä¸ªè¿›ç¨‹å¤§çº¦åŒæ—¶åˆ°è¾¾ï¼ŒPAå’ŒPBçš„æ‰§è¡Œæ—¶é—´éƒ½ä¸º20s(å³20,000ms)ã€‚å¦‚æœé‡‡ç”¨è½®è½¬è°ƒåº¦ï¼Œé‚£ä¹ˆè¿›ç¨‹çš„å“åº”æ—¶é—´ä¸º</li>
</ul>
<blockquote>
<p>0+10 = 10ms</p>
</blockquote>
<ul>
<li>å¹³å‡å“åº”æ—¶é—´ä¸ºï¼š</li>
</ul>
<blockquote>
<p>$\frac{0+10}{2} = 5ms$</p>
</blockquote>
<ul>
<li>è¿™ä¸¤ä¸ªå€¼éƒ½è¿œå°äºé‡‡ç”¨ä¹‹å‰ä»‹ç»çš„ä¸‰ç§è°ƒåº¦ç­–ç•¥çš„ç»“æœ</li>
<li>ç›´è§‚ä¸Šå¯ä»¥è¿›ä¸€æ­¥å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬è¿›ä¸€æ­¥<b>å‡å°‘æ—¶é—´ç‰‡çš„å¤§å°</b>ï¼Œé‚£ä¹ˆé‡‡ç”¨è½®è½¬è°ƒåº¦ç­–ç•¥ä¼šå¾—åˆ°<b>æ›´å¥½çš„å“åº”æ—¶é—´</b>ã€‚ä½†å…¶å®è¿™æ˜¯<b><font color="red">æœ‰æ½œåœ¨é—®é¢˜çš„ï¼Œå› ä¸ºæ¯æ¬¡è¿›ç¨‹åˆ‡æ¢æ˜¯æœ‰åˆ‡æ¢ä»£ä»·çš„</font></b>ï¼Œå‚è€ƒä¹‹å‰ä»‹ç»çš„è¿›ç¨‹åˆ‡æ¢çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿›ç¨‹åˆ‡æ¢æ¶‰åŠå¤šä¸ªå¯„å­˜å™¨çš„ä¿å­˜å’Œå›å¤æ“ä½œï¼Œé¡µè¡¨çš„åˆ‡æ¢æ“ä½œç­‰ã€‚</li>
</ul>
<blockquote>
<p>å¦‚æœè¿›ç¨‹åˆ‡æ¢çš„æ—¶é—´å¼€é”€æ˜¯0.5msï¼Œæ—¶é—´ç‰‡è®¾ç½®ä¸º1msï¼Œé‚£ä¹ˆä¼šæœ‰å¤§çº¦50%çš„æ—¶é—´ç”¨äºè¿›ç¨‹åˆ‡æ¢ï¼Œè¿™æ ·è¿›ç¨‹å®é™…çš„æ•´ä½“æ‰§è¡Œæ—¶é—´å°±å¤§å¤§å‡å°‘äº†</p>
</blockquote>
<ul>
<li>
<p>æ‰€ä»¥ï¼Œ<b>æˆ‘ä»¬éœ€è¦é€šè¿‡åœ¨å“åº”æ—¶é—´å’Œè¿›ç¨‹åˆ‡æ¢å¼€é”€ä¹‹é—´è¿›è¡Œæƒè¡¡</b>ã€‚ä¸èƒ½æŠŠæ—¶é—´ç‰‡è®¾ç½®å¾—å¤ªå°ï¼Œä¸”è®©å“åº”æ—¶é—´åœ¨ç”¨æˆ·å¯ä»¥æ¥å—çš„èŒƒå›´å†…</p>
</li>
<li>
<p>çœ‹æ¥è½®è½¬è°ƒåº¦å¯¹äºå“åº”æ—¶é—´è¿™ä¸ªæŒ‡æ ‡å¾ˆå‹å¥½ã€‚ä½†<b>å¦‚æœç”¨æˆ·ä¹Ÿè¦è€ƒè™‘å‘¨è½¬æ—¶é—´è¿™ä¸ªæŒ‡æ ‡</b>ï¼Œé‚£è½®è½¬è°ƒåº¦å°±å˜å¾—ä¸è¡Œäº†</p>
</li>
</ul>
<blockquote>
<p>è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒPAå’ŒPBä¸¤ä¸ªè¿›ç¨‹<b>å‡ ä¹éƒ½åœ¨40så·¦å³æ‰ç»“æŸ</b>ï¼Œè¿™æ„å‘³ç€å¹³å‡å‘¨è½¬æ—¶é—´ä¸ºï¼š</p>
<p>$\frac{40+40}{2}=40s$</p>
</blockquote>
<ul>
<li>è¿™å¤§äºåŸºäº<code>SJF</code>çš„å¹³å‡å‘¨è½¬æ—¶é—´ï¼š</li>
</ul>
<blockquote>
<p>$\frac{(20 - 0) + (40 - 0)}{2} = 30s$</p>
</blockquote>
<ul>
<li>
<p>å¦‚æœæ´»è·ƒè¿›ç¨‹çš„æ•°é‡å¢åŠ ï¼Œæˆ‘ä»¬ä¼šå‘ç°è½®è½¬è°ƒåº¦çš„å¹³å‡å‘¨è½¬æ—¶é—´ä¼šè¿›ä¸€æ­¥åŠ å¼ºã€‚ä¹Ÿè®¸æœ‰åŒå­¦ä¼šè¯´ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´æ—¶é—´ç‰‡ï¼ŒæŠŠæ—¶é—´ç‰‡æ‹‰é•¿ï¼Œè¿™æ ·å°±ä¼šå‡å°‘å¹³å‡å‘¨è½¬æ—¶é—´äº†ã€‚ä½†è¿™æ ·åˆä¼šæŠŠå“åº”æ—¶é—´ä¹Ÿç»™å¢å¤§äº†ã€‚è€Œä¸”å¦‚æœæŠŠæ—¶é—´ç‰‡æ— é™æ‹‰é•¿ï¼Œè½®è½¬è°ƒåº¦å°±å˜æˆäº†<code>FCFS</code>è°ƒåº¦äº†ã€‚</p>
</li>
<li>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çœ‹åˆ°ä»¥<code>SJF</code>ä¸ºä»£è¡¨çš„è°ƒåº¦ç­–ç•¥å¯¹å‘¨è½¬æ—¶é—´è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡å¾ˆå‹å¥½ï¼Œ<u>è€Œä»¥è½®è½¬è°ƒåº¦ä¸ºä»£è¡¨çš„è°ƒåº¦ç­–ç•¥å¯¹å“åº”æ—¶é—´è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡å¾ˆå‹å¥½ã€‚ä½†é±¼å’Œç†ŠæŒéš¾ä»¥å…¼å¾—</u>ã€‚</p>
</li>
</ul>
<h3 id="é€šç”¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">é€šç”¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</h3>
<blockquote>
<p>ä¸ªäººè®¡ç®—æœºå’Œäº’è”ç½‘çš„å‘å±•æ¨åŠ¨äº†è®¡ç®—æœºçš„å¹¿æ³›ä½¿ç”¨ï¼Œå¹¶å‡ºç°äº†æ–°çš„ç‰¹ç‚¹ï¼Œå†…å­˜è¶Šæ¥è¶Šå¤§ï¼Œå„ç§I/Oè®¾å¤‡æˆä¸ºè®¡ç®—æœºç³»ç»Ÿçš„åŸºæœ¬é…ç½®ï¼Œä¸€èˆ¬ç”¨æˆ·ç»å¸¸å’Œéšæ—¶ä½¿ç”¨äº¤äº’å¼åº”ç”¨ï¼ˆå¦‚å­—å¤„ç†ã€ä¸Šç½‘ç­‰ï¼‰ï¼Œé©»ç•™åœ¨å†…å­˜ä¸­çš„åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨çš„å¯åŠ¨æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´æ— æ³•æå‰çŸ¥é“ã€‚è€Œä¸”å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¤„ç†å™¨å¤§éƒ¨åˆ†æ—¶é—´å¤„äºç©ºé—²çŠ¶æ€ï¼Œåœ¨ç­‰å¾…ç”¨æˆ·æˆ–å…¶å®ƒå„ç§å¤–è®¾çš„è¾“å…¥è¾“å‡ºæ“ä½œã€‚</p>
</blockquote>
<h4 id="çº¦æŸæ¡ä»¶-2">çº¦æŸæ¡ä»¶</h4>
<ul>
<li>è¿™æ ·ï¼Œæˆ‘ä»¬çš„çº¦æŸæ¡ä»¶ä¹Ÿéšä¹‹å‘ç”Ÿäº†æ–°çš„å˜åŒ–ï¼š</li>
</ul>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹å¯<b>ä¸åŒæ—¶é—´åˆ°è¾¾</b></li>
<li>æ¯ä¸ªè¿›ç¨‹çš„<b>æ‰§è¡Œæ—¶é—´ä¸åŒ</b></li>
<li><b>è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´æ˜¯æœªçŸ¥çš„</b></li>
<li><b>è¿›ç¨‹åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹æœŸé—´ä¼šæ‰§è¡ŒI/Oæ“ä½œ</b></li>
<li><b>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè¢«æŠ¢å </b></li>
</ol>
<ul>
<li>å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­çš„ç¬¬3ç‚¹æ”¹å˜äº†ï¼Œå¯¼è‡´è¿›ç¨‹çš„ç‰¹ç‚¹ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ã€‚æœ‰äº›è¿›ç¨‹ä¸º<b><font color="red">I/Oå¯†é›†å‹</font>çš„è¿›ç¨‹ï¼Œå¤§å¤šæ•°æ—¶é—´ç”¨äºç­‰å¾…å¤–è®¾I/Oæ“ä½œçš„å®Œæˆï¼Œéœ€è¦è¿›ç¨‹èƒ½åŠæ—¶å“åº”ã€‚æœ‰äº›è¿›ç¨‹æ˜¯<font color="red">CPUå¯†é›†å‹</font>çš„ï¼Œå¤§éƒ¨åˆ†æ—¶é—´å ç”¨å¤„ç†å™¨è¿›è¡Œå„ç§è®¡ç®—ï¼Œä¸éœ€è¦åŠæ—¶å“åº”ã€‚</b>è¿˜æœ‰ä¸€ç±»<b><font color="red">æ··åˆå‹</font></b>ç‰¹ç‚¹çš„è¿›ç¨‹ï¼Œå®ƒåœ¨ä¸åŒçš„æ‰§è¡Œé˜¶æ®µæœ‰I/Oå¯†é›†å‹æˆ–CPUå¯†é›†å‹çš„ç‰¹ç‚¹ã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„è°ƒåº¦ç­–ç•¥éœ€è¦èƒ½å¤Ÿæ ¹æ®è¿›ç¨‹çš„åŠ¨æ€è¿è¡ŒçŠ¶æ€è¿›è¡Œè°ƒæ•´ï¼Œä»¥åº”å¯¹å„ç§å¤æ‚çš„æƒ…å†µã€‚</li>
</ul>
<h4 id="æ€§èƒ½æŒ‡æ ‡-2">æ€§èƒ½æŒ‡æ ‡</h4>
<ul>
<li>
<p>å¦‚æœæŠŠå„ä¸ªè¿›ç¨‹è¿è¡Œæ—¶é—´çš„å…¬å¹³æ€§è€ƒè™‘ä¹Ÿä½œä¸ºæ€§èƒ½æŒ‡æ ‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å®šä¹‰ä½•ä¸ºå…¬å¹³ã€‚æˆ‘ä»¬å…ˆç»™å‡ºä¸€ä¸ªå…¬å¹³çš„æè¿°æ€§å®šä¹‰ï¼š<b>åœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…ï¼Œæ“ä½œç³»ç»Ÿå¯¹æ¯ä¸ª<font color="red">å¤„äºå°±ç»ªçŠ¶æ€</font>çš„è¿›ç¨‹å‡åŒ€åˆ†é…<font color="red">å ç”¨å¤„ç†å™¨çš„æ—¶é—´</font></b></p>
</li>
<li>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œ<u>ä¸ºäº†æé«˜ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡ï¼Œå¯èƒ½ä¼šä»¥ç‰ºç‰²å…¶ä»–æ€§èƒ½æŒ‡æ ‡ä½œä¸ºä»£ä»·ã€‚æ‰€ä»¥ï¼Œè°ƒåº¦ç­–ç•¥éœ€è¦ç»¼åˆè€ƒè™‘å’Œæƒè¡¡å„ä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚åœ¨å…¶ä¸­<b>æ‰¾åˆ°ä¸€ä¸ªæŠ˜è¡·æˆ–è€…å¹³è¡¡</b></u></p>
</li>
</ul>
<h4 id="å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦">å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦</h4>
<ul>
<li>
<p>åœ¨æ— æ³•æå‰çŸ¥é“è¿›ç¨‹æ‰§è¡Œæ—¶é—´çš„å‰æä¸‹ï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªèƒ½åŒæ—¶å‡å°‘å“åº”æ—¶é—´å’Œå‘¨è½¬æ—¶é—´çš„è°ƒåº¦ç­–ç•¥æ˜¯ä¸€ä¸ªæŒ‘æˆ˜</p>
</li>
<li>
<p>ä¸è¿‡è®¡ç®—æœºç§‘å­¦å®¶æ—©å°±å¯¹æ­¤è¿›è¡Œæ·±å…¥åˆ†æå¹¶æå‡ºäº†äº†è§£å†³æ–¹æ¡ˆ</p>
</li>
<li>
<p>åœ¨1962å¹´ï¼Œ<code>MIT</code>çš„è®¡ç®—æœºç³»æ•™æˆ$Fernando\ Jose\ Corbato$(1990å¹´å›¾çµå¥–è·å¾—è€…)é¦–æ¬¡æå‡ºå¤šçº§åé¦ˆé˜Ÿåˆ—ï¼ˆ$Multi-level\ Feedback\ Queue$ï¼Œç®€ç§°<code>MLFQ</code>ï¼‰è°ƒåº¦ç­–ç•¥ï¼Œå¹¶ç”¨äºå½“æ—¶çš„<code>CTSS</code>ï¼ˆå…¼å®¹æ—¶åˆ†å…±äº«ç³»ç»Ÿï¼‰æ“ä½œç³»ç»Ÿä¸­</p>
</li>
<li>
<p><code>Corbato</code>æ•™æˆçš„æ€è·¯å¾ˆå·§å¦™ï¼Œç”¨å››ä¸ªå­—æ¥æ€»ç»“ï¼Œå°±æ˜¯<b>ä»¥å²ä¸ºé‰´</b></p>
<ul>
<li><b>æ ¹æ®è¿›ç¨‹è¿‡å»ä¸€æ®µçš„æ‰§è¡Œç‰¹å¾æ¥é¢„æµ‹å…¶æœªæ¥ä¸€æ®µæ—¶é—´çš„æ‰§è¡Œæƒ…å†µï¼Œå¹¶ä»¥æ­¤å‡è®¾ä¸ºä¾æ®æ¥åŠ¨æ€è®¾ç½®è¿›ç¨‹çš„ä¼˜å…ˆçº§</b>ï¼Œè°ƒåº¦å­ç³»ç»Ÿé€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹æ‰§è¡Œã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ<b>è¿›ç¨‹æœ‰äº†ä¼˜å…ˆçº§çš„å±æ€§ï¼Œè€Œä¸”è¿›ç¨‹çš„ä¼˜å…ˆçº§æ˜¯å¯ä»¥æ ¹æ®è¿‡å»è¡Œä¸ºçš„åé¦ˆæ¥åŠ¨æ€è°ƒæ•´çš„ï¼Œä¸åŒä¼˜å…ˆçº§çš„è¿›ç¨‹ä½äºä¸åŒçš„å°±ç»ªé˜Ÿåˆ—ä¸­</b></li>
</ul>
</li>
</ul>
<h5 id="å›ºå®šä¼˜å…ˆçº§çš„å¤šçº§æ— åé¦ˆé˜Ÿåˆ—">å›ºå®šä¼˜å…ˆçº§çš„å¤šçº§æ— åé¦ˆé˜Ÿåˆ—</h5>
<ul>
<li>
<p><code>MLFQ</code>è°ƒåº¦ç­–ç•¥çš„å…³é”®åœ¨äºå¦‚ä½•è®¾ç½®ä¼˜å…ˆçº§ã€‚<font color="orange"><b>ä¸€æ—¦è®¾ç½®è¿›ç¨‹çš„å¥½ä¼˜å…ˆçº§ï¼Œ<code>MLFQ</code>æ€»æ˜¯ä¼˜å…ˆæ‰§è¡Œå”¯æœ‰é«˜ä¼˜å…ˆçº§å°±ç»ªé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹</b></font>ã€‚<b>å¯¹äºæŒ‚åœ¨åŒä¸€ä¼˜å…ˆçº§å°±ç»ªé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹ï¼Œé‡‡ç”¨<font color="red">è½®è½¬è°ƒåº¦ç­–ç•¥</font></b></p>
</li>
<li>
<p>å…ˆè€ƒè™‘ç®€å•æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æå‰çŸ¥é“æŸäº›è¿›ç¨‹æ˜¯<code>I/O</code>å¯†é›†å‹çš„ï¼ŒæŸäº›è¿›ç¨‹æ˜¯<code>CPU</code>å¯†é›†å‹çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»™<b><code>I/O</code>å¯†é›†å‹è®¾ç½®é«˜ä¼˜å…ˆçº§</b>ï¼Œè€Œ<b><code>CPU</code>å¯†é›†å‹è¿›ç¨‹è®¾ç½®ä½ä¼˜å…ˆçº§</b>ã€‚è¿™æ ·å°±ç»ªé˜Ÿåˆ—å°±å˜æˆäº†ä¸¤ä¸ªï¼Œä¸€ä¸ªåŒ…å«<code>I/O</code>å¯†é›†å‹è¿›ç¨‹çš„é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å¤„ç†å™¨å¯†é›†å‹çš„ä½ä¼˜å…ˆçº§é˜Ÿåˆ—</p>
</li>
<li>
<p><b><font color="red">é‚£æˆ‘ä»¬å¦‚ä½•è°ƒåº¦å‘¢ï¼ŸMLFQè°ƒåº¦ç­–ç•¥æ˜¯å…ˆæŸ¥çœ‹é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å°±ç»ªè¿›ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œå°±æ‰§è¡Œå®ƒï¼Œç„¶ååŸºäºæ—¶é—´ç‰‡è¿›è¡Œè½®è½¬ã€‚ç”±äºä½äºæ­¤é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹éƒ½æ˜¯I/Oå¯†é›†å‹è¿›ç¨‹ï¼Œæ‰€ä»¥å®ƒä»¬å¾ˆå¿«å°±ä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼ˆè¿›å…¥é˜»å¡é˜Ÿåˆ—ï¼‰ï¼Œç­‰å¾…I/Oè®¾å¤‡çš„æ“ä½œå®Œæˆï¼Œè¿™å°±ä¼šå¯¼è‡´é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­æ²¡æœ‰å°±ç»ªè¿›ç¨‹</font></b></p>
</li>
<li>
<p>åœ¨é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—æ²¡æœ‰å°±ç»ªè¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œ<code>MLFQ</code>è°ƒåº¦ç­–ç•¥å°±ä¼šä»ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­é€‰æ‹©CPUå¯†é›†å‹å°±ç»ªè¿›ç¨‹ï¼ŒåŒæ ·æŒ‰ç…§æ—¶é—´ç‰‡è½®è½¬çš„æ–¹å¼è¿›è¡Œè°ƒåº¦</p>
<ul>
<li>
<p>å¦‚æœåœ¨<code>CPU</code>å¯†é›†å‹è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŸä¸ª<code>I/O</code>å¯†é›†å‹è¿›ç¨‹æ‰€ç­‰å¾…çš„<code>I/O</code>è®¾å¤‡çš„æ“ä½œå®Œæˆäº†ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¼šæ‰“æ–­<code>CPU</code>å¯†é›†å‹è¿›ç¨‹çš„æ‰§è¡Œï¼Œä»¥åŠæ—¶å“åº”è¯¥ä¸­æ–­ï¼Œå¹¶è®©æ­¤<code>I/O</code>å¯†é›†å‹è¿›ç¨‹ä»é˜»å¡çŠ¶æ€å˜æˆå°±ç»ªæ€ï¼Œé‡æ–°æ¥å…¥åˆ°é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—çš„å°¾éƒ¨</p>
</li>
<li>
<p>è¿™æ—¶è°ƒåº¦å­ç³»ç»Ÿä¼šä¼˜å…ˆé€‰æ‹©é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹æ‰§è¡Œï¼Œä»è€ŒæŠ¢å äº†<code>CPU</code>å¯†é›†å‹è¿›ç¨‹çš„æ‰§è¡Œ</p>
</li>
</ul>
</li>
<li>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†<code>MLFQ</code>çš„åŸºæœ¬è®¾è®¡è§„åˆ™</p>
</li>
</ul>
<ol>
<li>å¦‚æœè¿›ç¨‹<code>PA</code>çš„ä¼˜å…ˆçº§ &gt; <code>PB</code>çš„ä¼˜å…ˆçº§ï¼ŒæŠ¢å å¹¶è¿è¡Œ<code>PA</code></li>
<li>å¦‚æœè¿›ç¨‹<code>PA</code>çš„ä¼˜å…ˆçº§ = <code>PB</code>çš„ä¼˜å…ˆçº§ï¼Œè½®è½¬è¿è¡Œ<code>PA</code>å’Œ<code>PB</code></li>
</ol>
<ul>
<li>ä½†è¿˜æ˜¯æœ‰äº›å‡è®¾è¿‡äºç®€å•åŒ–äº†ï¼Œæ¯”å¦‚ï¼š</li>
</ul>
<ol>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<b>æ“ä½œç³»ç»Ÿå¹¶ä¸èƒ½æå‰çŸ¥é“è¿›ç¨‹æ˜¯<code>I/O</code>å¯†é›†å‹è¿˜æ˜¯<code>CPU</code>å¯†é›†å‹çš„</b></li>
<li><b><code>I/O</code>å¯†é›†å‹è¿›ç¨‹çš„å¯†é›†ç¨‹åº¦ä¸ä¸€å®šä¸€æ ·</b>ï¼Œæ‰€ä»¥æŠŠå®ƒä»¬æ”¾åœ¨ä¸€ä¸ªé«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ä½“ç°ä¸å‡ºå·®å¼‚</li>
<li>è¿›ç¨‹åœ¨ä¸åŒçš„æ‰§è¡Œé˜¶æ®µä¼šæœ‰ä¸åŒçš„ç‰¹å¾ï¼Œ<b>å¯èƒ½å‰ä¸€é˜¶æ®µæ˜¯<code>I/O</code>å¯†é›†å‹ï¼Œåä¸€é˜¶æ®µåˆå˜æˆäº†<code>CPU</code>å¯†é›†å‹</b></li>
</ol>
<ul>
<li>è€Œåœ¨è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­å›ºå®šè¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå°†éš¾ä»¥åº”å¯¹ä¸Šè¿°æƒ…å†µ</li>
</ul>
<h5 id="å¯é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—">å¯é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—</h5>
<ul>
<li>
<p>æ”¹è¿›çš„MLFQè°ƒåº¦ç­–ç•¥éœ€è¦<b>æ„ŸçŸ¥è¿›ç¨‹çš„è¿‡å»æ‰§è¡Œç‰¹å¾</b>ï¼Œå¹¶<b>æ ¹æ®è¿™ç§ç‰¹å¾æ¥é¢„æµ‹è¿›ç¨‹çš„æœªæ¥ç‰¹å¾</b></p>
<ul>
<li><u>å¦‚æœè¿›ç¨‹åœ¨è¿‡å»ä¸€æ®µæ—¶é—´æ˜¯<code>I/O</code>å¯†é›†å‹ç‰¹å¾ï¼Œå°±è°ƒé«˜è¿›ç¨‹çš„ä¼˜å…ˆçº§</u></li>
<li><u>å¦‚æœè¿›ç¨‹åœ¨è¿‡å»ä¸€æ®µæ—¶é—´æ˜¯<code>CPU</code>å¯†é›†å‹ç‰¹å¾ï¼Œå°±é™ä½è¿›ç¨‹çš„ä¼˜å…ˆçº§</u></li>
</ul>
</li>
<li>
<p>ç”±äºä¼šåŠ¨æ€è°ƒæ•´è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥ï¼Œæ“ä½œç³»ç»Ÿé¦–å…ˆéœ€è¦ä»¥ä¼˜å…ˆçº§çš„æ•°é‡æ¥å»ºç«‹å¤šä¸ªé˜Ÿåˆ—</p>
<ul>
<li>è¿™ä¸ªæ•°é‡æ˜¯ä¸€ä¸ªç»éªŒå€¼ï¼Œæ¯”å¦‚<code>Linux</code>æ“ä½œç³»ç»Ÿè®¾ç½®äº†140ä¸ªä¼˜å…ˆçº§</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>å¦‚ä½•åŠ¨æ€è°ƒæ•´è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Ÿ</p>
<ul>
<li>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾æ–°åˆ›å»ºçš„è¿›ç¨‹æ˜¯<code>I/O</code>å¯†é›†å‹çš„ï¼Œå¯ä»¥<b>æŠŠå®ƒè®¾ç½®ä¸ºæœ€é«˜ä¼˜å…ˆçº§</b></p>
</li>
<li>
<p>æ¥ä¸‹æ¥æ ¹æ®å®ƒçš„æ‰§è¡Œè¡¨ç°æ¥è°ƒæ•´å…¶ä¼˜å…ˆçº§ã€‚å¦‚æœåœ¨åˆ†é…ç»™å®ƒçš„æ—¶é—´é…é¢å†…ï¼Œ<b>å®ƒç¡çœ æˆ–ç­‰å¾…<code>I/O</code>äº‹ä»¶å®Œæˆè€Œä¸»åŠ¨æ”¾å¼ƒäº†å¤„ç†å™¨</b>ï¼Œ<u>æ“ä½œç³»ç»Ÿé¢„æµ‹å®ƒæ¥ä¸‹æ¥çš„æ—¶é—´é…é¢é˜¶æ®µå¾ˆå¤§å¯èƒ½è¿˜æ˜¯å…·æœ‰<code>I/O</code>å¯†é›†å‹ç‰¹å¾ï¼Œæ‰€ä»¥å°±ä¿æŒå…¶ä¼˜å…ˆçº§ä¸å˜</u></p>
</li>
<li>
<p><u>å¦‚æœè¿›ç¨‹ç”¨å®Œäº†åˆ†é…ç»™å®ƒçš„æ—¶é—´é…é¢ï¼Œæ“ä½œç³»ç»Ÿé¢„æµ‹å®ƒæ¥ä¸‹æ¥æœ‰å¾ˆå¤§å¯èƒ½è¿˜æ˜¯å…·æœ‰<code>CPU</code>å¯†é›†å‹ç‰¹å¾ï¼Œå°±ä¼šé™ä½å…¶ä¼˜å…ˆçº§</u></p>
<ul>
<li>è¿™é‡Œçš„æ—¶é—´é…é¢çš„å…·ä½“å€¼æ˜¯ä¸€ä¸ª<b>ç»éªŒå€¼</b>ï¼Œ<u>ä¸€èˆ¬æ˜¯æ—¶é—´ç‰‡çš„æ•´æ•°å€</u></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p><u>å¦‚æœä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´å°äºåˆ†é…ç»™å®ƒçš„ä¸€ä¸ªæˆ–å‡ ä¸ªæ—¶é—´é…é¢</u>ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„è¿›ç¨‹ç§°ä¸º<b>çŸ­è¿›ç¨‹</b>ã€‚é‚£ä¹ˆè¿™ä¸ªçŸ­è¿›ç¨‹ä¼šä»¥æ¯”è¾ƒé«˜çš„ä¼˜å…ˆçº§è¿…é€Ÿåœ°ç»“æŸ</p>
</li>
<li>
<p>è€Œå¦‚æœä¸€ä¸ªè¿›ç¨‹æœ‰å¤§é‡çš„<code>I/O</code>æ“ä½œï¼Œé‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<b>å®ƒä¼šåœ¨æ—¶é—´é…é¢ç»“æŸå‰ä¸»åŠ¨æ”¾å¼ƒå¤„ç†å™¨ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œä¸€æ—¦è¢«å”¤é†’ï¼Œä¼šä»¥åŸæœ‰çš„é«˜ä¼˜å…ˆçº§ç»§ç»­æ‰§è¡Œ</b></p>
</li>
<li>
<p>å¦‚æœä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´è¿œå¤§äºå‡ ä¸ªæ—¶é—´é…é¢ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„è¿›ç¨‹ç§°ä¸º<b>é•¿è¿›ç¨‹</b>ã€‚é‚£ä¹ˆè¿™ä¸ªå¸¸è¿›ç¨‹ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä¼šå¤„äºä¼˜å…ˆçº§<b>æœ€åº•éƒ¨</b>çš„é˜Ÿåˆ—ï¼Œ<u>åªæœ‰åœ¨æ²¡æœ‰é«˜ä¼˜å…ˆçº§è¿›ç¨‹å°±ç»ªçš„æƒ…å†µä¸‹ï¼Œå®ƒæ‰ä¼šç»§ç»­æ‰§è¡Œï¼Œä»è€Œä¸ä¼šå½±å“äº¤äº’å¼è¿›ç¨‹çš„å“åº”æ—¶é—´</u></p>
</li>
</ul>
<hr>
<ul>
<li>è¿™æ ·ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ‰©å±•äº†<code>MLFQ</code>çš„åŸºæœ¬è§„åˆ™</li>
</ul>
<ol start="3">
<li>
<p>åˆ›å»ºè¿›ç¨‹å¹¶è®©è¿›ç¨‹é¦–æ¬¡è¿›å…¥å°±ç»ªé˜Ÿåˆ—æ—¶ï¼Œè®¾ç½®è¿›ç¨‹çš„ä¼˜å…ˆçº§ä¸º<b>æœ€é«˜ä¼˜å…ˆçº§</b></p>
</li>
<li>
<p>è¿›ç¨‹<b>ç”¨å®Œå…¶æ—¶é—´é…é¢åï¼Œå°±ä¼šé™ä½å…¶ä¼˜å…ˆçº§</b></p>
</li>
</ol>
<hr>
<ul>
<li>è™½ç„¶è¿™æ ·çš„è°ƒåº¦çœ‹èµ·æ¥å¯¹çŸ­è¿›ç¨‹ã€<code>I/O</code>å¯†é›†å‹è¿›ç¨‹æˆ–é•¿è¿›ç¨‹çš„æ”¯æŒéƒ½è¿˜ä¸é”™ã€‚ä½†è¿™æ ·çš„è°ƒåº¦åªæœ‰é™ä½ä¼˜å…ˆçº§çš„æ“ä½œï¼Œå¯¹äºæŸäº›æƒ…å†µè¿˜æ˜¯ä¼šåº”å¯¹ä¸è¶³</li>
</ul>
<ol>
<li>
<p>ä¸€ä¸ªè¿›ç¨‹å…ˆæ‰§è¡Œäº†ä¸€æ®µæ¯”è¾ƒé•¿æ—¶é—´çš„<code>CPU</code>å¯†é›†å‹ä»»åŠ¡ï¼Œå¯¼è‡´å®ƒåˆ°äº†åº•éƒ¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œç„¶åå®ƒåœ¨ä¸‹ä¸€é˜¶æ®µæ‰§è¡Œ<code>I/O</code>å¯†é›†å‹ä»»åŠ¡ï¼Œä½†è¢«å…¶ä»–é«˜ä¼˜å…ˆçº§ä»»åŠ¡é˜»æŒ¡äº†ï¼Œéš¾ä»¥å‡å°‘å“åº”æ—¶é—´</p>
</li>
<li>
<p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­æœ‰å¤§é‡çš„äº¤äº’å‹è¿›ç¨‹ï¼Œè™½ç„¶æ¯ä¸ªè¿›ç¨‹æ‰§è¡Œæ—¶é—´çŸ­ï¼Œä½†å®ƒä»¬è¿˜æ˜¯ä¼šæŒç»­åœ°å ç”¨å¤„ç†å™¨ï¼Œè¿½å¯¼è‡´ä½äºä½ä¼˜å…ˆçº§çš„é•¿è¿›ç¨‹ä¸€ç›´æ— æ³•æ‰§è¡Œï¼Œå‡ºç°é¥¥é¥¿ï¼ˆ<code>starvation</code>ï¼‰ç°è±¡</p>
</li>
</ol>
<ul>
<li>è¿™ä¸»è¦æ˜¯è°ƒåº¦ç­–ç•¥è¿˜ç¼ºå°‘æå‡ä¼˜å…ˆçº§çš„çµæ´»è§„åˆ™</li>
</ul>
<h5 id="å¯æå‡é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—">å¯æå‡/é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—</h5>
<ul>
<li>
<p>å¯¹äºå¯é™ä½ä¼˜å…ˆçº§çš„å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç­–ç•¥éš¾ä»¥è§£å†³çš„ä¸Šè¿°æƒ…å†µ1å’Œ2ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¦‚ä½•æå‡æŸäº›è¿›ç¨‹çš„ä¼˜å…ˆçº§</p>
</li>
<li>
<p>ä¸€ä¸ªå¯ä»¥ç®€å•å®ç°çš„ä¼˜åŒ–æ€è·¯æ˜¯ï¼Œ<u>æ¯è¿‡ä¸€æ®µæ—¶é—´ï¼Œå‘¨æœŸæ€§åœ°æŠŠæ‰€æœ‰è¿›ç¨‹çš„ä¼˜å…ˆçº§éƒ½è®¾ç½®ä¸ºæœ€é«˜ä¼˜å…ˆçº§</u></p>
<ul>
<li>
<p>è¿™æ ·é•¿è¿›ç¨‹ä¸ä¼šé¥¿æ­»</p>
</li>
<li>
<p>è€Œè¢«é™åˆ°æœ€ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œå¦‚æœå½“å‰å¤„äºI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œè‡³å°‘åœ¨ä¸€æ®µæ—¶é—´åï¼Œä¼šé‡æ–°å‡å°‘å…¶å“åº”æ—¶é—´</p>
</li>
</ul>
</li>
<li>
<p>ä¸è¿‡è¿™ä¸ªâ€œä¸€æ®µæ—¶é—´â€çš„å…·ä½“å€¼å¦‚ä½•è®¾ç½®ï¼Ÿçœ‹èµ·æ¥åˆæ˜¯ä¸€ä¸ªç»éªŒå€¼ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åˆæ‰©å±•äº†<code>MLFQ</code>çš„åŸºæœ¬è§„åˆ™</p>
</li>
</ul>
<ol start="5">
<li>ç»è¿‡ä¸€æ®µæ—¶é—´ï¼ŒæŠŠæ‰€æœ‰å°±ç»ªè¿›ç¨‹é‡æ–°åŠ å…¥æœ€é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—</li>
</ol>
<hr>
<ul>
<li>
<p>ä½†è¿™æ ·å°±å½»åº•è§£å†³é—®é¢˜äº†å—ï¼Ÿå…¶å®è¿˜ä¸å¤Ÿï¼Œ<u>æ¯”å¦‚å¯¹äºä¼˜å…ˆçº§ä½ä¸”å¤„äºI/Oå¯†é›†å‹ä»»åŠ¡çš„è¿›ç¨‹ï¼Œå¿…é¡»ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œæ‰èƒ½é‡æ–°åŠ å…¥åˆ°æœ€é«˜ä¼˜å…ˆçº§ï¼Œæ‰èƒ½å‡å°‘å“åº”æ—¶é—´ã€‚<b>éš¾é“è¿™æ ·çš„è¿›ç¨‹ä¸èƒ½ä¸ç”¨ç­‰å¾…ä¸€æ®µæ—¶é—´å—ï¼Ÿ</b></u></p>
</li>
<li>
<p>è€Œå¯¹äºé•¿è¿›ç¨‹ï¼Œå¦‚æœæœ‰ä¸å°‘é•¿è¿›ç¨‹ä½äºæœ€ä½ä¼˜å…ˆçº§ï¼Œä¸€ä¸‹å­æŠŠå®ƒä»¬éƒ½æå‡ä¸ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œå°±å¯èƒ½å½±å“æœ¬æ¥å¤„äºæœ€é«˜ä¼˜å…ˆçº§çš„äº¤äº’å¼è¿›ç¨‹çš„å“åº”æ—¶é—´ã€‚çœ‹æ¥ï¼Œç¬¬5æ¡è§„åˆ™è¿˜æœ‰è¿›ä¸€æ­¥æ”¹è¿›çš„ç©ºé—´ï¼Œæå‡ä¼˜å…ˆçº§çš„æ–¹æ³•å¯ä»¥æ›´çµæ´»ä¸€äº›</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>å…ˆçœ‹é•¿è¿›ç¨‹ï¼Œå¯ä»¥å‘ç°ï¼Œæ‰€è°“é•¿è¿›ç¨‹â€œé¥¥é¥¿â€ï¼Œæ˜¯æŒ‡<b>å®ƒæœ‰å¾ˆé•¿æ—¶é—´æ²¡æœ‰å¾—åˆ°æ‰§è¡Œäº†</b></p>
</li>
<li>
<p><u>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç»Ÿè®¡å…¶åœ¨å°±ç»ªæ€æ²¡æœ‰è¢«æ‰§è¡Œçš„ç­‰å¾…æ—¶é—´é•¿åº¦ï¼Œå°±å¯ä»¥åŸºäºè¿™ä¸ªåŠ¨æ€å˜é‡æ¥é€æ­¥æå‡å…¶ä¼˜å…ˆçº§</u></p>
<ul>
<li>æ¯”å¦‚æ¯è¿‡ä¸€æ®µæ—¶é—´ï¼ŒæŸ¥çœ‹å°±ç»ªè¿›ç¨‹çš„ç­‰å¾…æ—¶é—´ï¼ˆè¿›ç¨‹åœ¨å°±ç»ªæ€çš„ç­‰å¾…æ—¶é—´ï¼‰é•¿åº¦ï¼Œè®©å…¶ç­‰å¾…æ—¶é—´é•¿åº¦ä¸å…¶ä¼˜å…ˆçº§æˆåæ¯”ï¼Œä»è€Œèƒ½å¤Ÿé€æ­¥ç¬¬åŠ¨æ€æå‡é•¿è¿›ç¨‹çš„ä¼˜å…ˆçº§</li>
</ul>
</li>
<li>
<p>å†çœ‹ä¼˜å…ˆçº§ä½ä¸”å¤„äº<code>I/O</code>å¯†é›†å‹ä»»åŠ¡çš„è¿›ç¨‹ï¼Œå¯ä»¥å‘ç°ï¼Œå®ƒä¹Ÿæœ‰å¾ˆé•¿æ—¶é—´æ²¡æœ‰å¾—åˆ°æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œè¿™å¯ä»¥é€šè¿‡ä¸Šé¢çš„é€æ­¥æå‡ä¼˜å…ˆçº§çš„æ–¹æ³•è·å¾—æ‰§è¡Œçš„æœºä¼šï¼Œå¹¶åœ¨æ‰§è¡Œ<code>I/O</code>æ“ä½œå¹¶å¤„äºç­‰å¾…çŠ¶æ€ï¼Œä½†æ­¤æ—¶çš„ä¼˜å…ˆçº§è¿˜ä¸å¤Ÿé«˜</p>
</li>
<li>
<p>ä½†æ“ä½œç³»ç»Ÿåœ¨<code>I/O</code>æ“ä½œå®Œæˆçš„ä¸­æ–­å¤„ç†è¿‡ç¨‹ä¸­ï¼Œç»Ÿè®¡å…¶<code>I/O</code>ç­‰å¾…æ—¶é—´ï¼ˆè¿›ç¨‹åœ¨é˜»å¡æ€ä¸‹çš„ç­‰å¾…æ—¶é—´ï¼‰ï¼Œ<b>è¯¥è¿›ç¨‹çš„<code>I/O</code>ç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œé‚£ä¹ˆå…¶ä¼˜å…ˆçº§çš„æå‡åº¦å°±è¶Šé«˜ï¼Œè¿™å¯ä»¥ä½¿å…¶å°½å¿«åˆ°è¾¾æœ€é«˜ä¼˜å…ˆçº§</b></p>
</li>
</ul>
<hr>
<ul>
<li>è¿™æ ·æ ¹æ®å°±ç»ªç­‰å¾…æ—¶é—´å’Œé˜»å¡ç­‰å¾…æ—¶é—´æ¥æå‡è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå¯ä»¥æ¯”è¾ƒå¥½ç¬¬åº”å¯¹ä¸Šé¢çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥æ”¹è¿›ç¬¬5æ¡è§„åˆ™ï¼š</li>
</ul>
<ol start="5">
<li>å®šæœŸç»Ÿè®¡è¿›ç¨‹åœ¨å°±ç»ªæ€/é˜»å¡æ€çš„ç­‰å¾…æ—¶é—´ï¼Œ<b><font color="red">ç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œå…¶ä¼˜å…ˆçº§çš„æå‡åº¦å°±è¶Šé«˜</font></b></li>
</ol>
<ul>
<li><b><font color="red">å¯¹äºå°±ç»ªæ€ç­‰å¾…æ—¶é—´å¯¹åº”çš„ä¼˜å…ˆçº§æå‡åº¦ä¸€èˆ¬æ—¶å°äºé˜»å¡æ€ç­‰å¾…æ—¶é—´å¯¹åº”çš„ä¼˜å…ˆçº§æå‡åº¦ï¼Œä»è€Œè®©è°ƒåº¦ç­–ç•¥ä¼˜å…ˆè°ƒåº¦å½“å‰å…·æœ‰I/Oå¯†é›†å‹ä»»åŠ¡çš„è¿›ç¨‹</font></b></li>
</ul>
<blockquote>
<p>ç»è¿‡æˆ‘ä»¬æ€»ç»“å‡ºæ¥çš„<code>MLFQ</code>è°ƒåº¦è§„åˆ™ï¼Œä½¿å¾—æ“ä½œç³»ç»Ÿä¸éœ€è¦å¯¹è¿›ç¨‹çš„è¿è¡Œæ–¹å¼æœ‰å…ˆéªŒçŸ¥è¯†ï¼Œè€Œæ˜¯é€šè¿‡è§‚æµ‹å’Œç»Ÿè®¡è¿›ç¨‹çš„è¿è¡Œç‰¹å¾æ¥ç»™å‡ºå¯¹åº”çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—æ“ä½œç³»ç»Ÿèƒ½çµæ´»æ”¯æŒå„ç§è¿è¡Œç‰¹å¾çš„åº”ç”¨åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­é«˜æ•ˆæ‰§è¡Œ</p>
</blockquote>
<h4 id="å…¬å¹³ä»½é¢è°ƒåº¦">å…¬å¹³ä»½é¢è°ƒåº¦</h4>
<blockquote>
<p>åœ¨å¤§å…¬å¸çš„æ•°æ®ä¸­å¿ƒä¸­æœ‰ç€å¤§é‡çš„è®¡ç®—æœºæœåŠ¡å™¨ï¼Œç»™äº’è”ç½‘ä¸Šçš„äººä»¬æä¾›å„ç§å„æ ·çš„æœåŠ¡ã€‚åœ¨è¿™æ ·çš„æœåŠ¡å™¨ä¸­ï¼Œæœ‰ç€ç›¸å¯¹ä¸ªäººè®¡ç®—æœºè€Œè¨€æ›´åŠ å·¨å¤§çš„å†…å­˜å’Œå¼ºå¤§çš„è®¡ç®—å¤„ç†èƒ½åŠ›ï¼Œç»™ä¸åŒç”¨æˆ·æä¾›æœåŠ¡çš„å„ç§è¿›ç¨‹çš„æ•°é‡ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚<b>è¿™ä¸ªæ—¶å€™ï¼Œé¢å‘ç”¨æˆ·æˆ–è¿›ç¨‹ç›¸å¯¹çš„å…¬å¹³æ€§å°±æ˜¯ä¸å¾—ä¸è€ƒè™‘çš„ä¸€ä¸ªé—®é¢˜ï¼Œç”šè‡³æ—¶è¦ä¼˜å…ˆè€ƒè™‘çš„æ€§èƒ½æŒ‡æ ‡</b>ã€‚æ¯”å¦‚ï¼Œåœ¨æä¾›äº‘ä¸»æœºçš„æ•°æ®ä¸­å¿ƒä¸­ï¼Œç”¨æˆ·å¯èƒ½ä¼šå¸Œæœ›åˆ†é…20%çš„å¤„ç†å™¨æ—¶é—´ç»™<code>Windows</code>è™šæ‹Ÿæœºï¼Œ80%çš„å¤„ç†å™¨æ—¶é—´ç»™<code>Linux</code>ç³»ç»Ÿï¼Œå¦‚æœé‡‡ç”¨å…¬å¹³ä»½é¢è°ƒåº¦çš„æ–¹å¼å¯ä»¥æ›´ç®€å•é«˜æ•ˆ</p>
</blockquote>
<ul>
<li>ä»æŸç§ç¨‹åº¦ä¸Šçœ‹ï¼Œ<code>MLFQ</code>è°ƒåº¦ç­–ç•¥æ€»æåˆ°çš„ä¼˜å…ˆçº§å°±æ˜¯å¯¹å…¬å¹³æ€§çš„ä¸€ç§åˆ’åˆ†æ–¹å¼ï¼Œæœ‰äº›è¿›ç¨‹ä¼˜å…ˆçº§é«˜ï¼Œä¼šæ›´å¿«åœ°å¾—åˆ°å¤„ç†å™¨æ‰§è¡Œï¼Œæ‰€åˆ†é…åˆ°çš„å¤„ç†å™¨æ—¶é—´ä¹Ÿå¤šä¸€äº›ã€‚<u>ä½†<code>MLFQ</code>å¹¶ä¸æ˜¯æŠŠå…¬å¹³æ€§æ”¾åœ¨ç¬¬ä¸€ä½</u></li>
</ul>
<hr>
<ul>
<li>
<p>æˆ‘ä»¬å°±å¯ä»¥è®¾è®¡å‡ºå¦å¤–ä¸€ç±»è°ƒåº¦ç­–ç•¥ â€“ å…¬å¹³ä»½é¢ï¼ˆ$Fair\ Share$ï¼Œåˆç§°ä¸º æ¯”ä¾‹ä»½é¢ï¼Œ$Proportional\ Share$ï¼‰è°ƒåº¦ã€‚å…¶<b>åŸºæœ¬æ€è·¯æ˜¯åŸºäºæ¯ä¸ªè¿›ç¨‹çš„é‡è¦æ€§<font color="red">ï¼ˆå³ä¼˜å…ˆçº§ï¼‰çš„æ¯”ä¾‹å…³ç³»ï¼Œ</font>åˆ†é…ç»™è¯¥è¿›ç¨‹<font color="red">åŒæ¯”ä¾‹</font>çš„å¤„ç†å™¨æ‰§è¡Œæ—¶é—´</b></p>
</li>
<li>
<p>åœ¨1993~1994å¹´ï¼Œ<code>MIT</code>çš„è®¡ç®—æœºç³»åšå£«ç”Ÿ$Carl\ A.\ Waldspurger$ å’Œä»–çš„å¯¼å¸ˆ$ William\ E.\ Weihl$æå‡ºäº†ä¸ä¼—ä¸åŒçš„è°ƒåº¦ç­–ç•¥ï¼šå½©ç¥¨è°ƒåº¦ï¼ˆ$Lottery\ Scheduling$ï¼‰å’Œæ­¥é•¿è°ƒåº¦ï¼ˆ$Stride\ Scheduling$ï¼‰ã€‚å®ƒä»¬éƒ½å±äºå…¬å¹³ä»½é¢è°ƒåº¦ç­–ç•¥ã€‚å½©ç¥¨è°ƒåº¦å¾ˆæœ‰æ„æ€ï¼Œå®ƒæ˜¯ä»ç»æµå­¦çš„çš„å½©ç¥¨è¡Œä¸ºä¸­å¸å–è¥å…»ï¼Œæ¨¡æ‹Ÿäº†è´­ä¹°å½©ç¥¨å’Œä¸­å¥–çš„éšæœºæ€§ï¼Œç»™æ¯ä¸ªè¿›ç¨‹å‘å½©ç¥¨ï¼Œè¿›ç¨‹ä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ‰€å¾—åˆ°çš„å½©ç¥¨å°±è¶Šå¤šï¼›ç„¶åæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚ï¼Œä¸€ä¸ªæ—¶é—´ç‰‡ï¼‰ï¼Œä¸¾è¡Œä¸€æ¬¡å½©ç¥¨æŠ½å¥–ï¼ŒæŠ½å‡ºæ¥çš„å·å±äºå“ªä¸ªè¿›ç¨‹ï¼Œå“ªä¸ªè¿›ç¨‹å°±èƒ½è¿è¡Œã€‚</p>
<ul>
<li>
<p>ä¾‹å¦‚ï¼Œè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªè¿›ç¨‹PAå’ŒPBï¼Œä¼˜å…ˆçº§åˆ†åˆ«ä¸º2å’Œ8ï¼Œè¿™æ ·å®ƒä»¬åˆ†åˆ«æ‹¥æœ‰2å¼ ï¼ˆç¼–å·ä¸º0-1ï¼‰å’Œ8å¼ å½©ç¥¨ï¼ˆç¼–å·ä¸º2-9ï¼‰ï¼ŒæŒ‰ç…§å½©ç¥¨è°ƒåº¦ç­–ç•¥ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ†é…PAå¤§çº¦20%çš„å¤„ç†å™¨æ—¶é—´ï¼Œè€ŒPBä¼šåˆ†é…åˆ°å¤§çº¦80%çš„å¤„ç†å™¨æ—¶é—´</p>
</li>
<li>
<p>è¿™ä¸ªå½©ç¥¨è°ƒåº¦çš„ä¼˜åŠ¿æœ‰ä¸¤ç‚¹</p>
<ul>
<li><b>ç¬¬ä¸€ç‚¹æ˜¯å¯ä»¥è§£å†³é¥¥é¥¿é—®é¢˜</b>ï¼Œå³ä½¿æŸä¸ªä½ä¼˜å…ˆçº§è¿›ç¨‹è·å¾—çš„å½©ç¥¨æ¯”è¾ƒå°‘ï¼Œä½†ç»è¿‡æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼ŒæŒ‰ç…§æ¦‚ç‡ï¼Œä¼šæœ‰è·å¾—å¤„ç†å™¨æ‰§è¡Œçš„æ—¶é—´ç‰‡</li>
<li><b>ç¬¬äºŒç‚¹æ˜¯è°ƒåº¦ç­–ç•¥çš„å®ç°å¼€é”€å°</b>ï¼Œå› ä¸ºå®ƒä¸åƒä¹‹å‰çš„è°ƒåº¦ç­–ç•¥ï¼Œè¿˜éœ€è¦è®°å½•ã€ç»Ÿè®¡ã€æ’åºã€æŸ¥æ‰¾å†å²ä¿¡æ¯ï¼ˆå¦‚ç»Ÿè®¡å°±ç»ªæ€ç­‰å¾…æ—¶é—´ç­‰ï¼‰ï¼Œå½©ç¥¨è°ƒåº¦å‡ ä¹ä¸éœ€è¦è®°å½•ä»»ä½•å†å²ä¿¡æ¯ï¼Œåªéœ€ç”Ÿäº§ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åæŸ¥æ‰¾è¯¥éšæœºæ•°åº”è¯¥å±äºé‚£ä¸ªè¿›ç¨‹å³å¯</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ä½†å½©ç¥¨è°ƒåº¦è™½ç„¶æƒ³æ³•æ–°é¢–ï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•ä¸ºè¿›ç¨‹åˆ†é…å½©ç¥¨ï¼Ÿ</p>
<ul>
<li>å¦‚æœåˆ›å»ºè¿›ç¨‹çš„ç”¨æˆ·æ¸…æ¥šè¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå¹¶ç»™è¿›ç¨‹åˆ†é…å¯¹åº”æ¯”ä¾‹çš„å½©ç¥¨ï¼Œé‚£ä¹ˆçœ‹èµ·æ¥è¿™ä¸ªé—®é¢˜å°±è§£å†³äº†</li>
<li>ä½†å½©ç¥¨è°ƒåº¦æ˜¯åœ¨è¿è¡Œæ—¶çš„æŸä¸ªæ—¶åˆ»äº§ç”Ÿä¸€ä¸ªéšæœºå€¼ï¼Œå¹¶çœ‹è¿™ä¸ªéšæœºå€¼å±äºå½“å‰æ­£åœ¨è¿è¡Œä¸­çš„è¿›ç¨‹é›†åˆä¸­çš„å“ªä¸€ä¸ªè¿›ç¨‹</li>
<li><b>è€Œç”¨æˆ·æ— æ³•é¢„çŸ¥ï¼Œæœªæ¥çš„è¿™ä¸ªæ—¶åˆ»ï¼Œä»–åˆ›å»ºçš„è¿›ç¨‹ä¸å½“æ—¶çš„é‚£äº›è¿›ç¨‹ä¹‹é—´çš„ä¼˜å…ˆçº§ç›¸å¯¹å…³ç³»ï¼Œè¿™ä¼šå¯¼è‡´å…¬å¹³æ€§ä¸ä¸€å®šèƒ½å¾—åˆ°ä¿è¯</b></li>
</ul>
</li>
<li>
<p>å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒåŸºäºæ¦‚ç‡çš„æ“ä½œæ–¹æ³•çš„éšæœºæ€§ä¼šå¸¦æ¥ä¸ç¡®å®šæ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸€ä¸ªæ¯”è¾ƒçŸ­çš„æ—¶é—´æ®µé‡Œé¢ï¼Œè¿›ç¨‹é—´çš„ä¼˜å…ˆçº§æ¯”ä¾‹å…³ç³»ä¸å®ƒä»¬è·å¾—çš„å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ¯”ä¾‹å…³ç³»ä¹‹é—´æœ‰æ¯”è¾ƒå¤§çš„åå·®ï¼Œåªæœ‰åœ¨æ‰§è¡Œæ—¶é—´å¾ˆé•¿çš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¾—åˆ°çš„å¤„ç†å™¨æ‰§è¡Œæ—¶é—´æ¯”ä¾‹ä¼šæ¯”è¾ƒæ¥è¿‘ä¼˜å…ˆçº§æ¯”ä¾‹</p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p>èƒ½å¦ç”¨å½©ç¥¨æ¥è¡¨ç¤ºå„ç§è®¡ç®—æœºèµ„æºçš„ä»½é¢ï¼Ÿ</p>
</li>
<li>
<p>å½©ç¥¨è°ƒåº¦ä¸­çš„å½©ç¥¨è¡¨ç¤ºäº†è¿›ç¨‹<b>æ‰€å å¤„ç†å™¨æ—¶é—´</b>çš„ç›¸å¯¹æ¯”ä¾‹ï¼Œé‚£ä¹ˆèƒ½å¦ç”¨å½©ç¥¨æ¥è¡¨ç¤ºè¿›ç¨‹<b>å ç”¨å†…å­˜æˆ–å…¶ä»–èµ„æº</b>çš„ç›¸å¯¹æ¯”ä¾‹ï¼Ÿ</p>
</li>
</ul>
</blockquote>
<ul>
<li>ä¸ºäº†è§£å†³å½©ç¥¨è°ƒåº¦ç­–ç•¥ä¸­çš„å¶ç„¶å‡ºç°ä¸å‡†ç¡®çš„è¿›ç¨‹æ‰§è¡Œæ—¶é—´æ¯”ä¾‹çš„é—®é¢˜ã€‚<code>Waldspurger</code>ç­‰è¿›ä¸€æ­¥æå‡ºäº†æ­¥é•¿è°ƒåº¦ï¼ˆ<code>Stride Scheduling</code>ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªç¡®å®šæ€§çš„å…¬å¹³é…é¢è°ƒåº¦ç­–ç•¥
<ul>
<li>å…¶åŸºæœ¬æ€è·¯æ˜¯ï¼šæ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªæ­¥é•¿ï¼ˆ<code>Stride</code>ï¼‰å±æ€§å€¼ï¼Œè¿™ä¸ªå€¼ä¸è¿›ç¨‹ä¼˜å…ˆçº§æˆåæ¯”ï¼Œæ“ä½œç³»ç»Ÿä¼šå®šæœŸè®°å½•æ¯ä¸ªè¿›ç¨‹çš„æ€»æ­¥é•¿ï¼Œå³è¡Œç¨‹ï¼ˆ<code>pass</code>ï¼‰ï¼Œå¹¶é€‰æ‹©æ‹¥æœ‰æœ€å°è¡Œç¨‹å€¼çš„è¿›ç¨‹è¿è¡Œ</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>ä¾‹å¦‚ï¼Œè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªè¿›ç¨‹PAå’ŒPBå‡ ä¹åŒæ—¶åˆ°è¾¾ï¼Œä¼˜å…ˆçº§åˆ†åˆ«ä¸º2å’Œ8ï¼Œç”¨ä¸€ä¸ªé¢„è®¾çš„å¤§æ•´æ•°ï¼ˆå¦‚1000ï¼‰å»é™¤ä»¥ä¼˜å…ˆçº§ï¼Œå°±å¯è·å¾—å¯¹åº”çš„æ­¥é•¿</li>
<li>è¿™æ ·å®ƒä»¬çš„æ­¥é•¿åˆ†åˆ«æ˜¯500å’Œ125åœ¨å…·ä½“æ‰§è¡Œæ—¶ï¼Œå…ˆé€‰æ‹©PAæ‰§è¡Œï¼Œå®ƒåœ¨æ‰§è¡Œäº†ä¸€ä¸ªæ—¶é—´ç‰‡åï¼Œå…¶è¡Œç¨‹ä¸º500ï¼›åœ¨æ¥ä¸‹æ¥çš„4ä¸ªæ—¶é—´ç‰‡ï¼Œå°†é€‰æ‹©æ‰§è¡Œè¡Œç¨‹å°‘çš„PBæ‰§è¡Œï¼Œå®ƒåœ¨è¿ç»­æ‰§è¡Œæ‰§è¡Œ4ä¸ªæ—¶é—´ç‰‡åï¼Œå…¶å½¢æˆä¹Ÿè¾¾åˆ°äº†500</li>
<li>å¹¶è¿™æ ·å‘¨è€Œå¤å§‹åœ°æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°è¿›ç¨‹æ‰§è¡Œç»“æŸã€‚ï¼ŒæŒ‰ç…§æ­¥é•¿è°ƒåº¦è°ƒåº¦ç­–ç•¥ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ†é…PAå¤§çº¦20%çš„å¤„ç†å™¨æ—¶é—´ï¼Œè€ŒPBä¼šåˆ†é…åˆ°å¤§çº¦80%çš„å¤„ç†å™¨æ—¶é—´</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>æ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤ç§è°ƒåº¦ç­–ç•¥ï¼Œå¯ä»¥çœ‹å‡º<b>å½©ç¥¨è°ƒåº¦ç®—æ³•åªèƒ½åœ¨ä¸€æ®µæ¯”è¾ƒé•¿çš„æ—¶é—´åï¼ŒåŸºäºæ¦‚ç‡ä¸Šå®ç°ä¼˜å…ˆçº§ç­‰æ¯”çš„æ—¶é—´åˆ†é…ï¼Œè€Œæ­¥é•¿è°ƒåº¦ç®—æ³•å¯ä»¥åœ¨æ¯ä¸ªè°ƒåº¦å‘¨æœŸååšåˆ°å‡†ç¡®çš„ä¼˜å…ˆçº§ç­‰æ¯”çš„æ—¶é—´åˆ†é…</b></li>
<li>ä½†å½©ç¥¨ç®—æ³•çš„ä¼˜åŠ¿æ˜¯å‡ ä¹ä¸éœ€è¦å…¨å±€ä¿¡æ¯ï¼Œè¿™<b>åœ¨åˆç†å¤„ç†æ–°åŠ å…¥çš„è¿›ç¨‹æ—¶å¾ˆç²¾ç‚¼</b></li>
<li>æ¯”å¦‚ä¸€ä¸ªæ–°è¿›ç¨‹å¼€å§‹æ‰§è¡Œæ—¶ï¼ŒæŒ‰ç…§æ­¥é•¿è°ƒåº¦ç­–ç•¥ï¼Œå…¶è¡Œç¨‹å€¼ä¸º0ï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å°†åœ¨ä¸€æ®µæ¯”è¾ƒé•¿çš„æ—¶é—´å†…ä¸€ç›´å ç”¨å¤„ç†å™¨æ‰§è¡Œï¼Œè¿™å°±æœ‰ç‚¹ä¸å…¬å¹³äº†</li>
<li><b>å¦‚æœè¦è®¾ç½®ä¸€ä¸ªåˆç†çš„è¿›ç¨‹å€¼ï¼Œå°±éœ€è¦å…¨å±€åœ°ç»Ÿè®¡æ¯ä¸ªè¿›ç¨‹çš„è¡Œç¨‹å€¼ï¼Œè¿™å°±å¸¦æ¥äº†æ¯”è¾ƒå¤§çš„æ‰§è¡Œå¼€é”€ã€‚ä½†å½©ç¥¨è°ƒåº¦ç­–ç•¥ä¸éœ€è¦ç»Ÿè®¡æ¯ä¸ªè¿›ç¨‹çš„å½©ç¥¨æ•°ï¼Œåªéœ€ç”¨æ–°è¿›ç¨‹çš„ç¥¨æ•°æ›´æ–°å…¨å±€çš„æ€»ç¥¨æ•°å³å¯</b></li>
</ul>
</blockquote>
<h3 id="å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</h3>
<blockquote>
<p>è®¡ç®—æœºç³»ç»Ÿçš„åº”ç”¨é¢†åŸŸéå¸¸å¹¿æ³›ï¼Œå¦‚æœºå™¨äººã€ç‰©è”ç½‘ã€å†›äº‹ã€å·¥ä¸šæ§åˆ¶ç­‰ã€‚åœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œè¦æ±‚è®¡ç®—æœºç³»ç»Ÿèƒ½å¤Ÿå®æ—¶å“åº”ï¼Œå¦‚æœé‡‡ç”¨ä¸Šè¿°è°ƒåº¦æ–¹å¼ï¼Œä¸èƒ½æ»¡è¶³è¿™äº›éœ€æ±‚ï¼Œè¿™å¯¹æ“ä½œç³»ç»Ÿæå‡ºäº†æ–°çš„æŒ‘æˆ˜</p>
</blockquote>
<ul>
<li>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£å®æ—¶çš„å«ä¹‰ã€‚å®æ—¶è®¡ç®—æœºç³»ç»Ÿé€šå¸¸å¯ä»¥åˆ†ä¸ºç¡¬å®æ—¶ï¼ˆ<code>Hard Real Time</code>ï¼‰å’Œè½¯å®æ—¶ï¼ˆ<code>Soft Real Time</code>ï¼‰ä¸¤ç±»ï¼Œç¡¬å®æ—¶æ˜¯æŒ‡ä»»åŠ¡å®Œæˆæ—¶é—´å¿…é¡»åœ¨ç»å¯¹çš„æˆªæ­¢æ—¶é—´å†…ï¼Œå¦‚æœè¶…è¿‡æ„å‘³ç€é”™è¯¯å’Œå¤±è´¥ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡åæœã€‚è½¯å®æ—¶æ˜¯æŒ‡ä»»åŠ¡å®Œæˆæ—¶é—´å°½é‡åœ¨ç»å¯¹çš„æˆªæ­¢æ—¶é—´å†…ï¼Œå¶å°”è¶…è¿‡å¯ä»¥æ¥å—</p>
</li>
<li>
<p><b>å®æ—¶çš„ä»»åŠ¡æ˜¯ç”±ä¸€ç»„è¿›ç¨‹æ¥å®ç°ï¼Œå…¶ä¸­æ¯ä¸ªè¿›ç¨‹çš„è¡Œä¸ºæ˜¯å¯é¢„æµ‹å’Œæå‰ç¡®å®šçš„ã€‚</b>è¿™äº›è¿›ç¨‹ç§°ä¸º<b>å®æ—¶è¿›ç¨‹</b>ï¼Œå®ƒä»¬çš„<b>æ‰§è¡Œæ—¶é—´ä¸€èˆ¬è¾ƒçŸ­</b>ã€‚<b>æ”¯æŒå®æ—¶ä»»åŠ¡çš„æ“ä½œç³»ç»Ÿç§°ä¸ºå®æ—¶æ“ä½œç³»ç»Ÿ</b></p>
</li>
</ul>
<h4 id="çº¦æŸæ¡ä»¶-3">çº¦æŸæ¡ä»¶</h4>
<ul>
<li>
<p><b>å®æ—¶è®¡ç®—æœºç³»ç»Ÿ</b>æ˜¯ä¸€ç§ä»¥ç¡®å®šçš„æ—¶é—´èŒƒå›´èµ·åˆ°ä¸»å¯¼ä½œç”¨çš„è®¡ç®—æœºç³»ç»Ÿï¼Œ<b>ä¸€æ—¦å¤–è®¾å‘ç»™è®¡ç®—æœºä¸€ä¸ªäº‹ä»¶ï¼ˆå¦‚æ—¶é’Ÿä¸­æ–­ã€ç½‘ç»œåŒ…åˆ°è¾¾ç­‰ï¼‰ï¼Œè®¡ç®—æœº<font color="red">å¿…é¡»åœ¨ä¸€ä¸ªç¡®å®šæ—¶é—´èŒƒå›´å†…åšå‡ºå“åº”</font></b></p>
</li>
<li>
<p>å®æ—¶è®¡ç®—æœºç³»ç»Ÿä¸­çš„äº‹ä»¶å¯ä»¥æŒ‰ç…§å“åº”æ–¹å¼è¿›ä¸€æ­¥åˆ†ç±»ä¸ºå‘¨æœŸæ€§ï¼ˆä»¥è§„åˆ™çš„æ—¶é—´é—´éš”å‘ç”Ÿï¼‰äº‹ä»¶æˆ–éå‘¨æœŸæ€§ï¼ˆå‘ç”Ÿæ—¶é—´ä¸å¯é¢„çŸ¥ï¼‰äº‹ä»¶ã€‚ä¸€ä¸ªç³»ç»Ÿå¯èƒ½è¦å“åº”å¤šä¸ªå‘¨æœŸæ€§äº‹ä»¶æµã€‚æ ¹æ®æ¯ä¸ªäº‹ä»¶éœ€è¦å¤„ç†æ—¶é—´çš„é•¿çŸ­ï¼Œç³»ç»Ÿç”šè‡³æœ‰å¯èƒ½æ— æ³•å¤„ç†å®Œæ‰€æœ‰çš„äº‹ä»¶</p>
</li>
<li>
<p>è¿™æ ·ï¼Œå®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„çº¦æŸæ¡ä»¶ä¹Ÿéšä¹‹å‘ç”Ÿäº†æ–°çš„å˜åŒ–ï¼š</p>
</li>
</ul>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹<b>å¯ä¸åŒæ—¶é—´åˆ°è¾¾</b></li>
<li>æ¯ä¸ªè¿›ç¨‹çš„<b>æ‰§è¡Œæ—¶é—´ä¸åŒ</b></li>
<li><b>è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´æ˜¯æœªçŸ¥çš„</b></li>
<li><b>è¿›ç¨‹åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹æœŸé—´ä¼šæ‰§è¡ŒI/Oæ“ä½œ</b></li>
<li><b>è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè¢«æŠ¢å </b></li>
<li><b>è¿›ç¨‹çš„è¡Œä¸ºæ˜¯å¯é¢„æµ‹å’Œæå‰ç¡®å®šçš„ï¼Œ<font color="red">å³è¿›ç¨‹åœ¨ç‹¬å å¤„ç†å™¨çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œæ—¶é—´çš„ä¸Šé™æ˜¯å¯ä»¥æå‰ç¡®å®šçš„</font></b></li>
<li>è§¦å‘è¿›ç¨‹è¿è¡Œçš„äº‹ä»¶éœ€è¦è¿›ç¨‹å®æ—¶å“åº”ï¼Œå³<b><font color="red">è¿›ç¨‹è¦åœ¨æŒ‡å®šçš„ç»å¯¹æˆªæ­¢æ—¶é—´å†…å®Œæˆå¯¹å„ç§äº‹ä»¶çš„å¤„ç†</font></b></li>
</ol>
<ul>
<li>è¿™é‡Œä¸»è¦å¢åŠ äº†ç¬¬6å’Œ7ç‚¹ã€‚ç¬¬6ç‚¹è¯´æ˜äº†å®æ—¶è¿›ç¨‹çš„ç‰¹ç‚¹ï¼Œç¬¬7ç‚¹è¯´æ˜äº†æ“ä½œç³»ç»Ÿè°ƒåº¦çš„ç‰¹ç‚¹</li>
</ul>
<h4 id="æ€§èƒ½æŒ‡æ ‡-3">æ€§èƒ½æŒ‡æ ‡</h4>
<ul>
<li>
<p>å¯¹äºå®æ—¶è®¡ç®—æœºç³»ç»Ÿè€Œè¨€ï¼Œè¿›ç¨‹çš„å‘¨è½¬æ—¶é—´å¿«å’Œå“åº”æ—¶é—´ä½è¿™æ ·çš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸æ˜¯æœ€ä¸»è¦çš„ï¼Œ<b><font color="red">è¿›ç¨‹è¦åœ¨æŒ‡å®šçš„ç»å¯¹çš„æˆªæ­¢æ—¶é—´å†…å®Œæˆæ˜¯ç¬¬ä¸€è¦åŠ¡</font></b></p>
</li>
<li>
<p>è¿™é‡Œé¦–å…ˆéœ€è¦ç†è§£å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„å¯è°ƒåº¦æ€§ã€‚å¦‚æœæœ‰$m$ä¸ªå‘¨æœŸäº‹ä»¶ï¼Œäº‹ä»¶$i$ä»¥å‘¨æœŸæ—¶é—´$P_i$ å‘ç”Ÿï¼Œå¹¶éœ€è¦$C_i$ æ—¶é—´å¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆè®¡ç®—æœºç³»ç»Ÿå¯ä»¥å¤„ç†ä»»åŠ¡é‡ï¼ˆä¹Ÿç§°è´Ÿè½½ï¼‰çš„æ¡ä»¶æ˜¯ï¼š</p>
</li>
</ul>
<p>$$
SUM(\frac{C_i}{P_i}) \le 1
$$</p>
<ul>
<li>
<p><b><font color="red">èƒ½æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å®æ—¶è®¡ç®—æœºç³»ç»Ÿæ˜¯å¯å®æ—¶è°ƒåº¦çš„</font></b></p>
</li>
<li>
<p>æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å®æ—¶ç³»ç»Ÿç§°ä¸ºæ˜¯å¯è°ƒåº¦çš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªå‘¨æœŸæ€§äº‹ä»¶çš„è®¡ç®—æœºç³»ç»Ÿï¼Œå…¶äº‹ä»¶å‘¨æœŸåˆ†åˆ«æ˜¯20msã€80msã€‚å¦‚æœè¿™äº›äº‹ä»¶åˆ†åˆ«éœ€è¦10msã€20msæ¥è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆè¯¥è®¡ç®—æœºç³»ç»Ÿæ˜¯å¯å®æ—¶è°ƒåº¦çš„ï¼Œå› ä¸º</p>
</li>
</ul>
<p>$$
\frac {10}{20} + \frac{20}{80} = 0.75 \le 1
$$</p>
<ul>
<li>å¦‚æœå†å¢åŠ ç¬¬ä¸‰ä¸ªå‘¨æœŸäº‹ä»¶ï¼Œå…¶å‘¨æœŸæ˜¯100msï¼Œéœ€è¦50msçš„æ—¶é—´æ¥å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°</li>
</ul>
<p>$$
\frac {10}{20} + \frac{20}{80} + \frac{50}{100} = 1.25 \ge 1
$$</p>
<ul>
<li>è¿™è¯´æ˜è¯¥è®¡ç®—æœºç³»ç»Ÿæ˜¯<b>ä¸å¯å®æ—¶è°ƒåº¦çš„</b></li>
</ul>
<hr>
<ul>
<li>
<p>å®æ—¶è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥/ç®—æ³•å¯ä»¥æ˜¯é™æ€æˆ–åŠ¨æ€çš„</p>
<ul>
<li>
<p><b>é™æ€è°ƒåº¦åœ¨è¿›ç¨‹å¼€å§‹è¿è¡Œä¹‹å‰å°±ä½œå‡ºè°ƒåº¦å†³ç­–</b></p>
</li>
<li>
<p><b>åŠ¨æ€è°ƒåº¦è¦åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è¿›è¡Œè°ƒåº¦å†³ç­–</b></p>
</li>
<li>
<p><b>åªæœ‰åœ¨é¢„çŸ¥è¿›ç¨‹è¦æ‰€å®Œæˆçš„å·¥ä½œæ—¶é—´ä¸Šé™ä»¥åŠå¿…é¡»æ»¡è¶³çš„æˆªæ­¢æ—¶é—´ç­‰å…¨éƒ¨ä¿¡æ¯æ—¶ï¼Œé™æ€è°ƒåº¦æ‰èƒ½å·¥ä½œ</b></p>
</li>
<li>
<p><b>è€ŒåŠ¨æ€è°ƒåº¦åˆ™ä¸éœ€è¦è¿™äº›å‰ææ¡ä»¶</b></p>
</li>
</ul>
</li>
</ul>
<h4 id="é€Ÿç‡å•è°ƒè°ƒåº¦">é€Ÿç‡å•è°ƒè°ƒåº¦</h4>
<ul>
<li>
<p>é€Ÿç‡å•è°ƒè°ƒåº¦ï¼ˆ$Rate\ Monotonic\ Schedulingï¼ŒRMS$ï¼‰ç®—æ³•æ˜¯ç”±åˆ˜ç‚¯æœ—ï¼ˆ$Chung\ Laung\ Liu$ï¼‰æ•™æˆå’Œ$James\ W.\ Layland$åœ¨1973å¹´æå‡ºçš„</p>
</li>
<li>
<p>è¯¥ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯æ ¹æ®è¿›ç¨‹å“åº”äº‹ä»¶çš„æ‰§è¡Œå‘¨æœŸçš„é•¿çŸ­æ¥è®¾å®šè¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå³<b><font color="red">æ‰§è¡Œå‘¨æœŸè¶ŠçŸ­çš„è¿›ç¨‹ä¼˜å…ˆçº§è¶Šé«˜</font></b></p>
</li>
<li>
<p>æ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦è¿‡ç¨‹ä¸­ï¼Œ<b><font color="red">é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„å°±ç»ªè¿›ç¨‹æ‰§è¡Œï¼Œé«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ä¼šæŠ¢å ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹</font></b></p>
</li>
</ul>
<hr>
<ul>
<li>è¯¥è°ƒåº¦ç®—æ³•æœ‰å¦‚ä¸‹çš„å‰æå‡è®¾</li>
</ul>
<ol>
<li>æ¯ä¸ªå‘¨æœŸæ€§è¿›ç¨‹<b>å¿…é¡»åœ¨å…¶æ‰§è¡Œå‘¨æœŸå†…å®Œæˆ</b>ï¼Œä»¥å®Œæˆå¯¹å‘¨æœŸæ€§äº‹ä»¶çš„å“åº”</li>
<li><b><font color="red">è¿›ç¨‹æ‰§è¡Œä¸ä¾èµ–äºä»»ä½•å…¶ä»–è¿›ç¨‹</font></b></li>
<li><b><font color="red">è¿›ç¨‹çš„ä¼˜å…ˆçº§åœ¨æ‰§è¡Œå‰å°±è¢«ç¡®å®šï¼Œæ‰§è¡ŒæœŸé—´ä¸å˜</font></b></li>
<li><b>è¿›ç¨‹å¯è¢«æŠ¢å </b></li>
</ol>
<ul>
<li>
<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>RMS</code>è°ƒåº¦ç®—æ³•åœ¨æ¯ä¸ªè¿›ç¨‹æ‰§è¡Œå‰å°±åˆ†é…ç»™è¿›ç¨‹ä¸€ä¸ªå›ºå®šçš„ä¼˜å…ˆçº§ï¼Œ<b><font color="red">ä¼˜å…ˆçº§ç­‰æ¯”äºè¿›ç¨‹æ‰€å“åº”çš„äº‹ä»¶å‘ç”Ÿçš„å‘¨æœŸé¢‘ç‡</font></b></p>
</li>
<li>
<p>å³<b>è¿›ç¨‹ä¼˜å…ˆçº§ä¸è¿›ç¨‹æ‰§è¡Œçš„é€Ÿç‡ï¼ˆå•ä½æ—¶é—´å†…è¿è¡Œè¿›ç¨‹çš„æ¬¡æ•°ï¼‰æˆçº¿æ€§å…³ç³»</b>ï¼Œè¿™æ­£æ˜¯ä¸ºä»€ä¹ˆå°†å…¶ç§°ä¸ºé€Ÿç‡å•è°ƒçš„åŸå› </p>
</li>
<li>
<p><b><font color="red">ä¾‹å¦‚ï¼Œå¿…é¡»æ¯20msè¿è¡Œä¸€æ¬¡ï¼ˆæ¯ç§’è¦æ‰§è¡Œ50æ¬¡ï¼‰çš„è¿›ç¨‹çš„ä¼˜å…ˆçº§ä¸º50ï¼Œå¿…é¡»æ¯50msè¿è¡Œä¸€æ¬¡ï¼ˆæ¯ç§’20æ¬¡ï¼‰çš„è¿›ç¨‹çš„ä¼˜å…ˆçº§ä¸º20</font></b></p>
</li>
<li>
<p><code>Liu</code>å’Œ<code>Layland</code>è¯æ˜äº†åœ¨<b><font color="orange">é™æ€å®æ—¶è°ƒåº¦ç®—æ³•ä¸­ï¼ŒRMSæ˜¯æœ€ä¼˜çš„</font></b></p>
</li>
<li>
<p><b>ä»»åŠ¡æ‰§è¡Œä¸­é—´æ—¢ä¸æ¥æ”¶æ–°çš„è¿›ç¨‹ï¼Œä¹Ÿä¸è¿›è¡Œä¼˜å…ˆçº§çš„è°ƒæ•´æˆ–è¿›è¡ŒCPUæŠ¢å </b></p>
</li>
<li>
<p><b>å› æ­¤è¿™ç§ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ç³»ç»Ÿæ¶ˆè€—å°ï¼Œç¼ºç‚¹æ˜¯ä¸çµæ´»ã€‚ä¸€æ—¦è¯¥ç³»ç»Ÿçš„ä»»åŠ¡å†³å®šäº†ï¼Œå°±ä¸èƒ½å†æ¥æ”¶æ–°çš„ä»»åŠ¡</b></p>
</li>
<li>
<p>é‡‡ç”¨æŠ¢å çš„ã€é™æ€ä¼˜å…ˆçº§çš„ç­–ç•¥ï¼Œè°ƒåº¦å‘¨æœŸæ€§ä»»åŠ¡</p>
</li>
</ul>
<h4 id="edfè°ƒåº¦">EDFè°ƒåº¦</h4>
<ul>
<li>
<p>å¦ä¸€ä¸ªå…¸å‹çš„å®æ—¶è°ƒåº¦ç®—æ³•æ˜¯æœ€æ—©æˆªæ­¢æ—¶é—´ä¼˜å…ˆï¼ˆ$Earliest\ Deadline\ Firstï¼ŒEDF$ï¼‰ç®—æ³•ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯æ ¹æ®è¿›ç¨‹çš„æˆªæ­¢æ—¶é—´æ¥ç¡®å®šä»»åŠ¡çš„ä¼˜å…ˆçº§</p>
<ul>
<li>
<p><b>æˆªæ­¢æ—¶é—´è¶Šæ—©ï¼Œå…¶ä¼˜å…ˆçº§å°±è¶Šé«˜</b></p>
</li>
<li>
<p><b>å¦‚æœè¿›ç¨‹çš„æˆªæ­¢æœŸç›¸åŒï¼Œåˆ™å¤„ç†æ—¶é—´çŸ­çš„è¿›ç¨‹ä¼˜å…ˆçº§é«˜</b></p>
</li>
<li>
<p>æ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„å°±ç»ªè¿›ç¨‹æ‰§è¡Œï¼Œ<b>é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ä¼šæŠ¢å ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹</b></p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>è¯¥è°ƒåº¦ç®—æ³•æœ‰å¦‚ä¸‹çš„å‰æå‡è®¾</li>
</ul>
<ol>
<li>è¿›ç¨‹å¯ä»¥æ˜¯<b>å‘¨æœŸæ€§æˆ–éå‘¨æœŸæ€§çš„</b></li>
<li><b>è¿›ç¨‹æ‰§è¡Œä¸ä¾èµ–äºä»»ä½•å…¶ä»–è¿›ç¨‹</b></li>
<li>è¿›ç¨‹çš„ä¼˜å…ˆçº§åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šåŸºäºè¿›ç¨‹çš„æˆªæ­¢æœŸ<b>åŠ¨æ€å˜åŒ–</b></li>
<li>è¿›ç¨‹å¯è¢«æŠ¢å </li>
</ol>
<hr>
<ul>
<li>
<p><code>EDF</code>è°ƒåº¦ç®—æ³•æŒ‰ç…§è¿›ç¨‹çš„æˆªæ­¢æ—¶é—´çš„æ—©æ™šæ¥åˆ†é…ä¼˜å…ˆçº§ï¼Œ<b>æˆªæ­¢æ—¶é—´è¶Šè¿‘çš„è¿›ç¨‹ä¼˜å…ˆçº§è¶Šé«˜</b></p>
</li>
<li>
<p><b>æ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œè¿›ç¨‹è°ƒåº¦æ—¶ï¼Œä¼šæ ¹æ®å„ä¸ªè¿›ç¨‹çš„æˆªæ­¢æ—¶é—´é‡æ–°è®¡ç®—è¿›ç¨‹ä¼˜å…ˆçº§</b>ï¼Œå¹¶é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹æ‰§è¡Œï¼Œå³æ“ä½œç³»ç»Ÿæ€»æ˜¯ä¼˜å…ˆè¿è¡Œæœ€ç´§è¿«çš„è¿›ç¨‹</p>
</li>
<li>
<p>åœ¨ä¸åŒæ—¶åˆ»ï¼Œä¸¤ä¸ªå‘¨æœŸæ€§è¿›ç¨‹çš„æˆªæ­¢æ—¶é—´çš„æ—©æ™šå…³ç³»å¯èƒ½ä¼šå˜åŒ–ï¼Œæ‰€ä»¥<b><code>EDF</code>è°ƒåº¦ç®—æ³•æ˜¯ä¸€ç§<font color="red">åŠ¨æ€ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•</font></b></p>
</li>
</ul>
<h4 id="å®æ—¶è°ƒåº¦å®ä¾‹">å®æ—¶è°ƒåº¦å®ä¾‹</h4>
<blockquote>
<ul>
<li>ç³»ç»Ÿä¸­æœ‰ä¸‰ä¸ªå‘¨æœŸæ€§è¿›ç¨‹PAã€PBå’ŒPCï¼Œå®ƒä»¬åœ¨ä¸€å¼€å§‹å°±å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå®ƒä»¬çš„æ‰§è¡Œå‘¨æœŸåˆ†åˆ«æ˜¯20msã€50mså’Œ100ms</li>
<li>å®ƒä»¬å“åº”äº‹ä»¶çš„å¤„ç†æ—¶é—´åˆ†åˆ«ä¸º5msã€20mså’Œ25ms</li>
</ul>
</blockquote>
<ul>
<li>
<p>æ“ä½œç³»ç»Ÿéœ€è¦è€ƒè™‘å¦‚ä½•è°ƒåº¦PAã€PBå’ŒPCï¼Œä»¥ç¡®ä¿å®ƒä»¬åœ¨å‘¨æœŸæ€§çš„æˆªæ­¢æ—¶é—´ï¼ˆæœ€ç»ˆæ—¶é™ï¼Œå³å½“å‰æ‰§è¡Œå‘¨æœŸçš„ç»å¯¹æ—¶é—´ï¼‰åˆ°æ¥å‰éƒ½èƒ½å®Œæˆå„è‡ªçš„ä»»åŠ¡</p>
</li>
<li>
<p>è®¡ç®—å¯è°ƒåº¦æ€§</p>
</li>
</ul>
<p>$$
\frac{5}{20} + \frac{20}{50} + \frac{25}{100} = 0.25 + 0.4 + 0.25 = 0.9 \le 1
$$</p>
<ul>
<li>å¯ä»¥çœ‹åˆ°å¤„ç†å™¨åœ¨ç†è®ºä¸Šæœ‰10%çš„ç©ºé—²æ—¶é—´ï¼Œä¸ä¼šè¢«è¶…é¢æ‰§è¡Œï¼Œæ‰€ä»¥æ‰¾åˆ°ä¸€ä¸ªåˆç†çš„è°ƒåº¦åº”è¯¥æ˜¯å¯èƒ½çš„</li>
</ul>
<hr>
<ul>
<li>
<p><code>RMS</code>è°ƒåº¦ç®—æ³•</p>
</li>
<li>
<p>ç”±äºè¿›ç¨‹çš„ä¼˜å…ˆçº§åªä¸è¿›ç¨‹çš„æ‰§è¡Œå‘¨æœŸæˆçº¿æ€§å…³ç³»ï¼Œæ‰€ä»¥ä¸‰ä¸ªè¿›ç¨‹çš„ä¼˜å…ˆçº§åˆ†åˆ«ä¸º50ã€20å’Œ10</p>
</li>
<li>
<p>è°ƒåº¦æ‰§è¡Œè¿‡ç¨‹</p>
<ul>
<li>
<p>t=0ï¼šåœ¨t=0æ—¶åˆ»ï¼Œä¼˜å…ˆçº§æœ€é«˜çš„PAå…ˆæ‰§è¡Œï¼ˆPAçš„ç¬¬ä¸€ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼Œå¹¶åœ¨5msæ—¶å®Œæˆ</p>
</li>
<li>
<p>t=5ï¼šåœ¨PAå®Œæˆåï¼ŒPBæ¥ç€æ‰§è¡Œ</p>
</li>
<li>
<p>t=20ï¼šåœ¨æ‰§è¡Œåˆ°20msæ—¶ï¼ˆPAçš„ç¬¬äºŒä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæŠ¢å PBå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°25mæ—¶ç»“æŸ</p>
</li>
<li>
<p>t=25ï¼šç„¶åè¢«æ‰“æ–­çš„PBç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°30msæ—¶ç»“æŸ</p>
</li>
<li>
<p>t=30ï¼šæ¥ç€PCå¼€å§‹æ‰§è¡Œï¼ˆPCçš„ç¬¬ä¸€ä¸ªå‘¨æœŸå¼€å§‹ï¼‰</p>
</li>
<li>
<p>t=40ï¼šåœ¨æ‰§è¡Œåˆ°40msæ—¶ï¼ˆPAçš„ç¬¬ä¸‰ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæŠ¢å PCå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°45msç»“æŸ</p>
</li>
<li>
<p>t=45ï¼šç„¶åè¢«æ‰“æ–­çš„PCç»§ç»­æ‰§è¡Œ</p>
</li>
<li>
<p>t=50ï¼šç„¶ååœ¨50msæ—¶ï¼ˆPBçš„ç¬¬äºŒä¸ªå‘¨æœŸï¼‰ï¼ŒPBæŠ¢å PCå¹¶å†æ¬¡æ‰§è¡Œ</p>
</li>
<li>
<p>t=60ï¼šç„¶ååœ¨60msæ—¶ï¼ˆPAçš„ç¬¬å››ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæŠ¢å PBå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°65msæ—¶ç»“æŸ</p>
</li>
<li>
<p>t=65ï¼šæ¥ç€PBç»§ç»­æ‰§è¡Œï¼Œå¹¶åœ¨80msæ—¶ç»“æŸ</p>
</li>
<li>
<p>t=80ï¼šæ¥ç€PAç»§ç»­æŠ¢å PCï¼ˆPAçš„ç¬¬äº”ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼Œåœ¨85msæ—¶ç»“æŸ</p>
</li>
<li>
<p>t=85ï¼šç„¶åPCå†æ¬¡æ‰§è¡Œï¼Œåœ¨90msæ—¶ç»“æŸ</p>
</li>
</ul>
</li>
<li>
<p>è¿™æ ·ï¼Œåœ¨100msçš„æ—¶é—´å†…ï¼ŒPAæ‰§è¡Œäº†5ä¸ªå‘¨æœŸä»»åŠ¡ï¼ŒPBæ‰§è¡Œäº†2ä¸ªå‘¨æœŸä»»åŠ¡ï¼ŒPCæ‰§è¡Œäº†1ä¸ªå‘¨æœŸä»»åŠ¡ã€‚åœ¨ä¸‹ä¸€ä¸ª100msçš„æ—¶é—´å†…ï¼Œä¸Šè¿°è¿‡ç¨‹å†æ¬¡é‡å¤</p>
</li>
</ul>
<hr>
<ul>
<li>å¯¹äº<code>EDF</code>è°ƒåº¦ç®—æ³•è€Œè¨€ï¼Œå…·æœ‰å¦‚ä¸‹çš„è°ƒåº¦æ‰§è¡Œè¿‡ç¨‹
<ul>
<li>t=0ï¼šé¦–å…ˆé€‰æ‹©æˆªæ­¢æ—¶é—´æœ€çŸ­çš„PAï¼Œæ‰€ä»¥å®ƒå…ˆæ‰§è¡Œï¼ˆPAçš„ç¬¬ä¸€ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼Œå¹¶åœ¨5msæ—¶å®Œæˆ</li>
<li>t=5ï¼šåœ¨PAå®Œæˆåï¼Œæˆªæ­¢æ—¶é—´ç¬¬äºŒçš„PBæ¥ç€æ‰§è¡Œ</li>
<li>t=20ï¼šåœ¨æ‰§è¡Œåˆ°20msæ—¶ï¼ˆPAçš„ç¬¬äºŒä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæˆªæ­¢æ—¶é—´40mså°äºPBæˆªæ­¢æ—¶é—´50msï¼Œæ‰€ä»¥æŠ¢å PBå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°25mæ—¶ç»“æŸ</li>
<li>t=25ï¼šç„¶åè¢«æ‰“æ–­çš„PBç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°30msæ—¶ç»“æŸ</li>
<li>t=30ï¼šæ¥ç€PCå¼€å§‹æ‰§è¡Œï¼ˆPCçš„ç¬¬ä¸€ä¸ªå‘¨æœŸå¼€å§‹ï¼‰</li>
<li>t=40ï¼šåœ¨æ‰§è¡Œåˆ°40msæ—¶ï¼ˆPAçš„ç¬¬ä¸‰ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæˆªæ­¢æ—¶é—´40mså°äºPCæˆªæ­¢æ—¶é—´100msï¼ŒPAæŠ¢å PCå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°45msç»“æŸ</li>
<li>t=45ï¼šç„¶åè¢«æ‰“æ–­çš„PCç»§ç»­æ‰§è¡Œ</li>
<li>t=50ï¼šç„¶ååœ¨50msæ—¶ï¼ˆPBçš„ç¬¬äºŒä¸ªå‘¨æœŸï¼‰ï¼ŒPBæˆªæ­¢æ—¶é—´100mså°äºç­‰äºPCæˆªæ­¢æ—¶é—´100msï¼ŒPBæŠ¢å PCå¹¶å†æ¬¡æ‰§è¡Œ</li>
<li>t=60ï¼šç„¶ååœ¨60msæ—¶ï¼ˆPAçš„ç¬¬å››ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼ŒPAæˆªæ­¢æ—¶é—´80mså°äºPBæˆªæ­¢æ—¶é—´100msï¼ŒPAæŠ¢å PBå¹¶å†æ¬¡æ‰§è¡Œï¼Œç›´åˆ°65msæ—¶ç»“æŸ</li>
<li>t=65ï¼šæ¥ç€PBç»§ç»­æ‰§è¡Œï¼Œå¹¶åœ¨80msæ—¶ç»“æŸ</li>
<li>t=80ï¼šæ¥ç€PAæˆªæ­¢æ—¶é—´100mså°äºç­‰äºPCæˆªæ­¢æ—¶é—´100msï¼ŒPAç»§ç»­æŠ¢å PCï¼ˆPAçš„ç¬¬äº”ä¸ªå‘¨æœŸå¼€å§‹ï¼‰ï¼Œåœ¨85msæ—¶ç»“æŸ</li>
<li>t=85ï¼šç„¶åPCå†æ¬¡æ‰§è¡Œï¼Œåœ¨90msæ—¶ç»“æŸ</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>ä¸Šè¿°ä¾‹å­çš„ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡æ˜¯ï¼Œè™½ç„¶RMSè°ƒåº¦ç®—æ³•ä¸EDFçš„è°ƒåº¦ç­–ç•¥ä¸åŒï¼Œä½†å®ƒä»¬çš„è°ƒåº¦è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ã€‚æ³¨æ„ï¼Œè¿™ä¸æ˜¯æ™®éç°è±¡ï¼Œä¹Ÿæœ‰ä¸€äº›ä¾‹å­ä¼šå‡ºç°äºŒè€…è°ƒåº¦è¿‡ç¨‹ä¸åŒçš„æƒ…å†µï¼Œç”šè‡³RMSè°ƒåº¦æ— æ³•æ»¡è¶³è¿›ç¨‹çš„æ—¶é™è¦æ±‚ï¼Œè€ŒEDFèƒ½æ»¡è¶³è¿›ç¨‹çš„æ—¶é™è¦æ±‚</li>
</ul>
<h3 id="å¤šå¤„ç†å™¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦">å¤šå¤„ç†å™¨è®¡ç®—æœºç³»ç»Ÿçš„è°ƒåº¦</h3>
<blockquote>
<p>åœ¨2000å¹´å‰ï¼Œå¤šå¤„ç†å™¨è®¡ç®—æœºçš„å…¸å‹ä»£è¡¨æ˜¯å°‘è§çš„é«˜ç«¯æœåŠ¡å™¨å’Œè¶…çº§è®¡ç®—æœºï¼Œä½†åˆ°äº†2000å¹´åï¼Œå•é æé«˜å¤„ç†å™¨çš„é¢‘ç‡è¶Šæ¥è¶Šå›°éš¾ï¼Œè€ŒèŠ¯ç‰‡çš„é›†æˆåº¦è¿˜åœ¨è¿›ä¸€æ­¥æå‡ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªèŠ¯ç‰‡ä¸Šé›†æˆå¤šä¸ªå¤„ç†å™¨æ ¸æˆä¸ºä¸€ç§è‡ªç„¶çš„é€‰æ‹©ã€‚åˆ°ç›®å‰ä½ç½®ï¼Œåœ¨ä¸ªäººè®¡ç®—æœºã€ä»¥æ‰‹æœºä¸ºä»£è¡¨çš„ç§»åŠ¨ç»ˆç«¯ä¸Šï¼Œå¤šæ ¸å¤„ç†å™¨ï¼ˆ<code>Multi Core</code>ï¼‰å·²æˆä¸ºä¸€ç§æ™®éçš„ç°è±¡ï¼Œå¤šä¸ªå¤„ç†å™¨æ ¸èƒ½å¤Ÿå¹¶è¡Œæ‰§è¡Œï¼Œä¸”å¯ä»¥å…±äº«<code>Cache</code>å’Œå†…å­˜</p>
</blockquote>
<h4 id="çº¦æŸæ¡ä»¶-4">çº¦æŸæ¡ä»¶</h4>
<ul>
<li>
<p>ä¸ºäº†ç†è§£å¤šå¤„ç†å™¨è°ƒåº¦éœ€è¦è§£å†³çš„æ–°é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£å•å¤„ç†å™¨è®¡ç®—æœºä¸å¤šå¤„ç†å™¨è®¡ç®—æœºçš„åŸºæœ¬åŒºåˆ«</p>
<ul>
<li>
<p>å¯¹äºå¤šå¤„ç†å™¨è®¡ç®—æœºè€Œè¨€ï¼Œæ¯ä¸ªå¤„ç†å™¨æ ¸å¿ƒä¼šæœ‰å…±äº«çš„<code>Cache</code>ï¼Œä¹Ÿä¼šæœ‰å®ƒä»¬ç§æœ‰çš„<code>Cache</code>ï¼Œè€Œå„è‡ªçš„ç§æœ‰<code>Cache</code>ä¸­çš„æ•°æ®æœ‰ç¡¬ä»¶æ¥ä¿è¯æ•°æ®çš„<code>Cache</code>ä¸€è‡´æ€§ï¼ˆä¹Ÿç§°ç¼“å­˜ä¸€è‡´æ€§ï¼‰</p>
</li>
<li>
<p>ç®€å•åœ°è¯´ï¼Œä½äºä¸åŒç§æœ‰<code>Cache</code>ä¸­çš„æœ‰æ•ˆæ•°æ®ï¼ˆæ˜¯æŸä¸€å†…å­˜å•å…ƒçš„å€¼ï¼‰è¦ä¿è¯æ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·å¤„ç†å™¨æ‰èƒ½å–å¾—æ­£ç¡®çš„æ•°æ®ï¼Œä¿è¯è®¡ç®—çš„æ­£ç¡®æ€§ï¼Œè¿™å°±æ˜¯<code>Cache</code>ä¸€è‡´æ€§çš„åŸºæœ¬å«ä¹‰</p>
</li>
<li>
<p>ä¿è¯ä¸€è‡´æ€§çš„æ§åˆ¶é€»è¾‘æ˜¯ç”±ç¡¬ä»¶æ¥å®Œæˆçš„ï¼Œå¯¹æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè€Œè¨€ï¼Œæ˜¯é€æ˜çš„</p>
</li>
</ul>
</li>
<li>
<p>åœ¨å…±äº«<code>Cache</code>å’Œå†…å­˜å±‚é¢ï¼Œç”±äºå¤šä¸ªå¤„ç†å™¨å¯ä»¥å¹¶è¡Œè®¿é—®ä½äºå…±äº«<code>Cache</code>å’Œå†…å­˜ä¸­çš„å…±äº«æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦æœ‰åé¢ç« èŠ‚è®²è§£çš„åŒæ­¥äº’æ–¥æœºåˆ¶æ¥ä¿è¯ç¨‹åºæ‰§è¡Œçš„æ­£ç¡®æ€§</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>åŸºæœ¬æ€è·¯</p>
</li>
<li>
<p>ä»¥ç»™åˆ›å»ºçš„æ–°å­è¿›ç¨‹è®¾ç½®è¿›ç¨‹å·ä¸ºä¾‹</p>
<ul>
<li>
<p>åœ¨å•å¤„ç†å™¨æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿç”¨ä¸€ä¸ªæ•´å‹å…¨å±€å˜é‡ä¿å­˜å½“å‰å¯ç”¨è¿›ç¨‹å·ï¼Œåˆå§‹å€¼ä¸º 0 ã€‚ç»™æ–°è¿›ç¨‹è®¾ç½®æ–°è¿›ç¨‹å·çš„è¿‡ç¨‹å¾ˆç®€å•ï¼š</p>
<ul>
<li>æ–°è¿›ç¨‹å·= å½“å‰å¯ç”¨è¿›ç¨‹å·</li>
<li>å½“å‰å¯ç”¨è¿›ç¨‹å· = å½“å‰å¯ç”¨è¿›ç¨‹å· + 1</li>
</ul>
</li>
<li>
<p>åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹ï¼Œå‡è®¾ä¸¤ä¸ªä½äºä¸åŒå¤„ç†å™¨ä¸Šçš„è¿›ç¨‹éƒ½å‘èµ·äº†åˆ›å»ºå­è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨è¯·æ±‚ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥å¹¶è¡Œåœ°æ‰§è¡Œåˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹ï¼Œè€Œä¸”éœ€è¦ç»™å­è¿›ç¨‹è®¾ç½®ä¸€ä¸ªæ–°çš„è¿›ç¨‹å·ã€‚å¦‚æœæ²¡æœ‰ä¸€äº›åŒæ­¥äº’æ–¥çš„æ‰‹æ®µï¼Œé‚£ä¹ˆå¯èƒ½å‡ºç°å¦‚ä¸‹çš„æƒ…å†µ:</p>
</li>
<li>
<p>$t_o:ID_{PA} = CurlD\ and \ ID_{PB} = CurlD\newline t_1: CurlD = CurlD+1\ and\ CurlD= CurlD + 1$</p>
</li>
<li>
<p>è¿™æ ·ä¸¤ä¸ªæ–°è¿›ç¨‹çš„è¿›ç¨‹å·å°±æ˜¯ä¸€æ ·çš„äº†ï¼Œè¿™å°±ä¼šåœ¨åç»­çš„æ‰§è¡Œä¸­å‡ºç°å„ç§é—®é¢˜ã€‚ä¸ºäº†æ­£ç¡®å¤„ç†å…±äº«å˜é‡ï¼Œå°±éœ€è¦ç”¨ç±»ä¼¼äº’æ–¥é”ï¼ˆ<code>Mutex</code>ï¼‰çš„æ–¹æ³•ï¼Œè®©åœ¨ä¸åŒå¤„ç†å™¨ä¸Šæ‰§è¡Œçš„æ§åˆ¶æµäº’æ–¥åœ°è®¿é—®å…±äº«å˜é‡ï¼Œè¿™æ ·å°±èƒ½è§£å†³æ­£ç¡®æ€§é—®é¢˜</p>
</li>
<li>
<p>æ‰€ä»¥ï¼Œå¯¹äºå¤šå¤„ç†å™¨ä¸‹è¿è¡Œçš„è¿›ç¨‹è€Œè¨€ï¼Œæ–°å¢åŠ äº†å¦‚ä¸‹çš„å‡è®¾æ¡ä»¶</p>
<ul>
<li>è¿è¡Œåœ¨ä¸åŒå¤„ç†å™¨ä¸Šçš„å¤šä¸ªè¿›ç¨‹å¯ç”¨å¹¶è¡Œæ‰§è¡Œï¼Œ<b><font color="red">ä½†å¯¹äºå…±äº«èµ„æº/å˜é‡çš„å¤„ç†ï¼Œéœ€è¦æœ‰åŒæ­¥äº’æ–¥ç­‰æœºåˆ¶çš„æ­£ç¡®æ€§ä¿è¯</font></b></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="æ€§èƒ½æŒ‡æ ‡-4">æ€§èƒ½æŒ‡æ ‡</h4>
<ul>
<li>è¿™é‡Œçš„æ€§èƒ½æŒ‡æ ‡ä¸ä¹‹å‰æè¿°çš„åŸºäºå•å¤„ç†å™¨çš„é€šç”¨è®¡ç®—æœºç³»ç»Ÿä¸€æ ·ï¼Œä¸»è¦æ˜¯å‘¨è½¬æ—¶é—´ã€å“åº”æ—¶é—´å’Œå…¬å¹³æ€§</li>
</ul>
<h4 id="å•é˜Ÿåˆ—è°ƒåº¦">å•é˜Ÿåˆ—è°ƒåº¦</h4>
<ul>
<li>
<p>å¯¹äºå¤šå¤„ç†å™¨ç³»ç»Ÿè€Œè¨€ï¼Œä¸¤ä¸ªè¿›ç¨‹æ•°é‡å¤šäºå¤„ç†å™¨ä¸ªæ•°ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªå¤„ç†å™¨éƒ½æ‰§è¡Œè¿›ç¨‹</p>
</li>
<li>
<p>è¿™ä¸€ç‚¹æ˜¯ä¹‹å‰å•å¤„ç†å™¨è°ƒåº¦ä¸ä¼šç¢°åˆ°çš„æƒ…å†µã€‚å•å¤„ç†å™¨çš„è°ƒåº¦åªéœ€ä¸æ–­åœ°è§£ç­”ï¼šâ€œæ¥ä¸‹æ¥åº”è¯¥è¿è¡Œå“ªä¸ªè¿›ç¨‹ï¼Ÿâ€ï¼Œè€Œåœ¨å¤šå¤„ç†æœºä¸­ï¼Œ<b>è°ƒåº¦è¿˜éœ€è§£ç­”ä¸€ä¸ªé—®é¢˜ï¼š<font color="red">â€œè¦è¿è¡Œçš„è¿›ç¨‹åœ¨å“ªä¸€ä¸ªCPUä¸Šè¿è¡Œï¼Ÿâ€</font></b>ã€‚è¿™å°±å¢åŠ äº†è°ƒåº¦çš„å¤æ‚æ€§</p>
</li>
<li>
<p>å¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å•å¤„ç†å™¨è°ƒåº¦çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„é‡ç‚¹å°±æ˜¯æ”¾ç½®å°±ç»ªè¿›ç¨‹çš„å°±ç»ªé˜Ÿåˆ—æˆ–å…¶ä»–ä¸è°ƒåº¦ç›¸å…³çš„æ•°æ®ç»“æ„ã€‚<b><font color="red">é‚£ä¹ˆè¿™äº›æ•°æ®ç»“æ„å°±æ˜¯éœ€è¦äº’æ–¥è®¿é—®çš„å…±äº«æ•°æ®</font></b></p>
</li>
<li>
<p>ä¸ºç®€åŒ–åˆ†æè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä»¥è½®è½¬è°ƒåº¦é‡‡ç”¨çš„å•å°±ç»ªé˜Ÿåˆ—ä¸ºä¾‹ï¼Œ<b><font color="red">é¢å‘å¤šå¤„ç†å™¨çš„å•é˜Ÿåˆ—è°ƒåº¦çš„ç­–ç•¥é€»è¾‘æ²¡æœ‰æ”¹å˜ï¼Œåªæ˜¯åœ¨è¯»å†™/ä¿®æ”¹å°±ç»ªé˜Ÿåˆ—ç­‰å…±äº«æ•°æ®æ—¶ï¼Œéœ€è¦ç”¨åŒæ­¥äº’æ–¥çš„ä¸€äº›æ“ä½œä¿æŠ¤èµ·æ¥ï¼Œç¡®ä¿å¯¹è¿™äº›å…±äº«æ•°æ®è®¿é—®çš„æ­£ç¡®æ€§</font></b></p>
</li>
<li>
<p>é‡‡ç”¨å•é˜Ÿåˆ—è°ƒåº¦çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œ<b>å®ƒæ”¯æŒè‡ªåŠ¨è´Ÿè½½å¹³è¡¡ï¼Œå› ä¸ºå†³ä¸ä¼šå‡ºç°ä¸€ä¸ªCPUç©ºé—²è€Œå…¶ä»–CPUè¿‡è½½çš„æƒ…å†µ</b></p>
</li>
</ul>
<h5 id="å¤„ç†å™¨äº²å’Œæ€§">å¤„ç†å™¨äº²å’Œæ€§</h5>
<ul>
<li>å¦å¤–ï¼Œè¿˜éœ€è€ƒè™‘çš„ä¸€ä¸ªæ€§èƒ½é—®é¢˜æ˜¯è°ƒåº¦ä¸­çš„å¤„ç†å™¨äº²å’Œæ€§ï¼ˆä¹Ÿç§°ç¼“å­˜äº²å’Œæ€§ã€è°ƒåº¦äº²å’Œæ€§ï¼‰é—®é¢˜</li>
<li>å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼Œ<b>å°½é‡ä½¿ä¸€ä¸ªè¿›ç¨‹åœ¨å®ƒå‰ä¸€æ¬¡è¿è¡Œè¿‡çš„åŒä¸€ä¸ªCPUä¸Šè¿è¡Œ</b></li>
<li>å…¶åŸå› æ˜¯ï¼Œç°ä»£çš„å¤„ç†å™¨éƒ½æœ‰ç§æœ‰Cacheï¼ŒåŸºäºå±€éƒ¨æ€§çš„è€ƒè™‘ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿåœ¨ä¸‹æ¬¡è°ƒåº¦æ—¶è¦ç»™è¯¥è¿›ç¨‹é€‰æ‹©å¤„ç†å™¨ï¼Œä¼šä¼˜å…ˆé€‰æ‹©è¯¥è¿›ç¨‹ä¸Šæ¬¡æ‰§è¡Œæ‰€åœ¨çš„å¤„ç†å™¨ï¼Œä»è€Œä½¿å¾—Cacheä¸­ç¼“å­˜çš„æ•°æ®å¯é‡ç”¨ï¼Œæé«˜äº†è¿›ç¨‹æ‰§è¡Œçš„å±€éƒ¨æ€§</li>
</ul>
<h4 id="å¤šé˜Ÿåˆ—è°ƒåº¦">å¤šé˜Ÿåˆ—è°ƒåº¦</h4>
<ul>
<li>
<p>å¦‚æœå¤„ç†å™¨çš„ä¸ªæ•°è¾ƒå¤šï¼Œé¢‘ç¹å¯¹å…±äº«æ•°æ®æ‰§è¡ŒåŒæ­¥äº’æ–¥æ“ä½œçš„å¼€é”€ä¼šå¾ˆå¤§</p>
</li>
<li>
<p>ä¸ºæ­¤ï¼Œèƒ½æƒ³åˆ°çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼Œè¿˜æ˜¯ä¿æŒå•å¤„ç†å™¨è°ƒåº¦ç­–ç•¥çš„åŸºæœ¬é€»è¾‘ï¼Œä½†æŠŠå°±ç»ªé˜Ÿåˆ—æˆ–å’Œä»–ä¸è°ƒåº¦ç›¸å…³çš„æ•°æ®ç»“æ„æŒ‰å¤„ç†å™¨ä¸ªæ•°<b>å¤åˆ¶</b>å¤šä»½ï¼Œè¿™æ ·æ“ä½œç³»ç»Ÿåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªéœ€è®¿é—®æœ¬å¤„ç†å™¨ç»‘å®šçš„è°ƒåº¦ç›¸å…³æ•°æ®ç»“æ„ï¼Œå°±å¯ç”¨å®Œæˆè°ƒåº¦æ“ä½œ</p>
</li>
<li>
<p>è¿™æ ·åœ¨ä¸€ä¸ªè°ƒåº¦æ§åˆ¶æ¡†æ¶ä¸‹å°±åŒ…å«<b>å¤šä¸ªè°ƒåº¦é˜Ÿåˆ—</b></p>
</li>
<li>
<p>å½“è¦æŠŠä¸€ä¸ªæ–°è¿›ç¨‹æˆ–è¢«å”¤é†’çš„è¿›ç¨‹æ”¾å…¥å°±ç»ªé˜Ÿåˆ—æ—¶ï¼Œ<b>æ“ä½œç³»ç»Ÿå¯æ ¹æ®ä¸€äº›å¯å‘å¼æ–¹æ³•ï¼ˆå¦‚éšæœºé€‰æ‹©æŸä¸ªå¤„ç†å™¨ä¸Šçš„å°±ç»ªé˜Ÿåˆ—æˆ–é€‰æ‹©å°±ç»ªè¿›ç¨‹æ•°é‡æœ€å°‘çš„å°±ç»ªé˜Ÿåˆ—ï¼‰æ¥æ”¾ç½®è¿›ç¨‹åˆ°æŸä¸ªå°±ç»ªé˜Ÿåˆ—</b></p>
</li>
<li>
<p>æ“ä½œç³»ç»Ÿé€šè¿‡è®¿é—®æœ¬å¤„ç†å™¨ä¸Šçš„è°ƒåº¦ç›¸å…³æ•°æ®ç»“æ„ï¼Œå°±å¯ä»¥é€‰æ‹©å‡ºè¦æ‰§è¡Œçš„è¿›ç¨‹ï¼Œ<b>è¿™æ ·å°±é¿å…äº†å¼€é”€å¤§çš„åŒæ­¥äº’æ–¥æ“ä½œ</b></p>
</li>
</ul>
<hr>
<ul>
<li>å¤šé˜Ÿåˆ—è°ƒåº¦æ¯”å•é˜Ÿåˆ—è°ƒåº¦å…·æœ‰æ›´å¥½çš„å¯æ‰©å±•æ€§ï¼Œå¤šé˜Ÿåˆ—çš„æ•°é‡ä¼šéšç€å¤„ç†å™¨çš„å¢åŠ è€Œå¢åŠ ï¼Œä¹Ÿå…·æœ‰è‰¯å¥½çš„ç¼“å­˜äº²å’Œåº¦ã€‚å½“å¤šé˜Ÿåˆ—è°ƒåº¦ä¹Ÿæœ‰å®ƒè‡ªå·±çš„é—®é¢˜ï¼šè´Ÿè½½å‡è¡¡ï¼ˆ<code>Load Balance</code>ï¼‰é—®é¢˜</li>
</ul>
<blockquote>
<ul>
<li>è€ƒè™‘å¦‚ä¸‹çš„ä¾‹å­ï¼Œåœ¨ä¸€ä¸ªæœ‰4ä¸ªè¿›ç¨‹ï¼Œä¸¤ä¸ªå¤„ç†å™¨çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæœ‰ä¸¤ä¸ªå°±ç»ªé˜Ÿåˆ—ï¼ŒPAå’ŒPBåœ¨å°±ç»ªé˜Ÿåˆ—Q1ï¼ŒPCå’ŒPDåœ¨å°±ç»ªé˜Ÿåˆ—Q2</li>
<li>å¦‚æœé‡‡ç”¨åŸºäºè½®è½¬è°ƒåº¦çš„å¤šé˜Ÿåˆ—è°ƒåº¦ï¼Œé‚£ä¹ˆä¸¤ä¸ªå¤„ç†å™¨å¯ä»¥å‡åŒ€åœ°è®©4ç»™è¿›ç¨‹åˆ†æ—¶ä½¿ç”¨å¤„ç†å™¨ã€‚è¿™æ˜¯ä¸€ç§ç†æƒ³çš„æƒ…å†µ</li>
<li><b>å¦‚æœè¿›ç¨‹PBç»“æŸï¼Œè€Œè°ƒåº¦ä¸è¿›è¡Œè¿›ä¸€æ­¥çš„å¹²é¢„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°PAç‹¬å å¤„ç†å™¨1</b>ï¼ŒPCå’ŒPDåˆ†æ—¶å…±äº«å¤„ç†å™¨2</li>
<li><b>å¦‚æœPAä¹Ÿç»“æŸäº†ï¼Œè€Œè°ƒåº¦è¿˜ä¸è¿›è¡Œè¿›ä¸€æ­¥çš„å¹²é¢„ï¼Œé‚£ä¹ˆï¼ˆ<code>Load Imbalance</code>ï¼‰å°±ä¼šå‡ºç°</b>â€”â€”å¤„ç†å™¨1ç©ºé—²ï¼Œè€Œå¤„ç†å™¨2ç¹å¿™çš„æƒ…å†µï¼Œè¿™å°±æ˜¯å…¸å‹çš„è´Ÿè½½ä¸å‡è¡¡ï¼ˆ<code>Load Imbalance</code>ï¼‰çš„ç°è±¡äº†ã€‚è¿™å°±æ²¡æœ‰è¾¾åˆ°è½®è½¬è°ƒåº¦çš„æ„å›¾</li>
</ul>
</blockquote>
<ul>
<li>
<p>æ‰€ä»¥<b>å¤šé˜Ÿåˆ—è°ƒåº¦éœ€è¦è§£å†³è´Ÿè½½ä¸å‡è¡¡</b>çš„é—®é¢˜</p>
<ul>
<li>
<p>ä¸€ä¸ªç®€å•çš„æ€è·¯å°±æ˜¯<b>å…è®¸è¿›ç¨‹æ ¹æ®å¤„ç†å™¨çš„è´Ÿè½½æƒ…å†µä»ä¸€ä¸ªå¤„ç†å™¨è¿ç§»åˆ°å¦å¤–ä¸€ä¸ªå¤„ç†å™¨ä¸Š</b></p>
<ul>
<li>å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœæ˜¯å¤„ç†å™¨1ç©ºé—²ï¼Œå¤„ç†å™¨2ç¹å¿™çš„è€Œæƒ…å†µï¼Œæ“ä½œç³»ç»Ÿåªéœ€æŠŠå¤„ç†å™¨2ä¸Šçš„è¿›ç¨‹åˆ†ä¸€åŠï¼Œè¿ç§»åˆ°å¤„ç†å™¨1å³å¯</li>
</ul>
</li>
<li>
<p>å½“å¦‚æœæ˜¯å¤„ç†å™¨1ä¸Šè¿è¡Œäº†PAï¼Œå¤„ç†å™¨2ä¸Šè¿è¡Œäº†PCå’ŒPDï¼Œè¿™å°±éœ€è¦ç»Ÿè®¡æ¯ä¸ªè¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œæ ¹æ®è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œè®©è¿›ç¨‹åœ¨ä¸¤ä¸ªå¤„ç†å™¨é—´ä¸åœçš„è¿ç§»ï¼Œè¾¾åˆ°åœ¨ä¸€å®šæ—¶é—´æ®µå†…ï¼Œæ¯ä¸ªè¿›ç¨‹æ‰€å ç”¨çš„å¤„ç†å™¨æ—¶é—´å¤§è‡´ç›¸åŒï¼Œè¿™å°±è¾¾åˆ°äº†è½®è½¬è°ƒåº¦çš„æ„å›¾ï¼Œå¹¶è¾¾åˆ°äº†è´Ÿè½½å‡è¡¡</p>
</li>
</ul>
</li>
<li>
<p>æ¯”å¦‚ä¸‹é¢çš„è°ƒåº¦æ–¹å¼</p>
</li>
</ul>
<p>$$
\begin{align}
&amp;å¤„ç†å™¨1ï¼šA\rightarrow A\rightarrow C \rightarrow A \rightarrow A \rightarrow C \rightarrow \dots \newline
&amp;å¤„ç†å™¨2ï¼šC\rightarrow D\rightarrow D\rightarrow C\rightarrow D \rightarrow D \rightarrow \dots \newline
&amp;æˆ–è€…æ˜¯ï¼š\newline
&amp;å¤„ç†å™¨1ï¼šA\rightarrow C\rightarrow A \rightarrow A \rightarrow C \rightarrow A \rightarrow \dots \newline
&amp;å¤„ç†å™¨2ï¼šC\rightarrow D\rightarrow D\rightarrow C\rightarrow D \rightarrow D \rightarrow \dots \newline
\end{align}
$$</p>
<ul>
<li>
<p>å½“ç„¶ï¼Œè¿™ä¸ªä¾‹å­æ˜¯ä¸€ç§ç®€å•çš„ç†æƒ³æƒ…å†µï¼Œå®é™…çš„å¤šå¤„ç†å™¨è®¡ç®—æœºç³»ç»Ÿä¸­è¿è¡Œçš„è¿›ç¨‹è¡Œä¸ºä¼šå¾ˆå¤æ‚ï¼Œé™¤äº†å¹¶è¡Œæ‰§è¡Œï¼Œè¿˜æœ‰åŒæ­¥äº’æ–¥æ‰§è¡Œã€å„ç§/Oæ“ä½œç­‰ï¼Œè¿™äº›éƒ½ä¼šå¯¹è°ƒåº¦ç­–ç•¥äº§ç”Ÿå½±å“</p>
</li>
<li>
<p><u>å¦‚æœéœ€è¦äº†è§£å®é™…çš„æ“ä½œç³»ç»Ÿè°ƒåº¦ç­–ç•¥å’Œç®—æ³•ï¼Œå»ºè®®é˜…è¯»å…³äº<code>UNIX</code>ã€<code>Linux</code>ã€<code>Windows</code>å’Œå„ç§<code>RTOS</code>ç­‰æ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¹¦ç±å’Œæ–‡ç« ï¼Œå…¶ä¸­æœ‰å…³äºè¿™äº›æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥å’Œç®—æ³•çš„æ·±å…¥è®²è§£</u></p>
</li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Completed<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">2023-4-16 Finished at 23:43 PM</div>
        </div>
    </div>
<p><b>å£°æ˜ï¼šæœ¬æ–‡ç« å¼•ç”¨èµ„æ–™ä¸å›¾åƒå‡å·²åšæ ‡æ³¨ï¼Œå¦‚æœ‰ä¾µæƒæœ¬äººä¼šé©¬ä¸Šåˆ é™¤</b></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/operating-system/">Operating System</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>æ›´æ–°äº 2023-03-10</span>
            </div><div class="post-info-mod"></div>
        </div><div class="post-info-share">
            <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥" data-hashtags="Operating System"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-hashtag="Operating System"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Linkedin" data-sharer="linkedin" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° WhatsApp" data-sharer="whatsapp" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥"><i class="fab fa-line fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Myspace" data-sharer="myspace" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Blogger" data-sharer="blogger" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° ç™¾åº¦" data-sharer="baidu" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥"><i data-svg-src="/lib/simple-icons/icons/baidu.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter6/" data-title="Operating System Chapter6 å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥"><i class="fab fa-evernote fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="/posts/operating-system/operating-system-chapter5/" class="prev" rel="prev" title="Operating System Chapter5 å¹¶å‘æ§åˆ¶ï¼šäº’æ–¥"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/operating-system/operating-system-chapter7/" class="next" rel="next" title="Operating System Chapter7 çœŸå®ä¸–ç•Œçš„å¹¶å‘ç¼–ç¨‹">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.105.0">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/Jungle430">Jungle</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
</div>
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker
        .register('/sw.min.js?version=0.0.1', { scope: '/' })
        .then(() => {
            console.info('Jungle\u0027s Blog\u00A0Service Worker Registered');
        }, err => console.error('Jungle\u0027s Blog\u00A0Service Worker registration failed: ', err));

    navigator.serviceWorker
        .ready
        .then(() => {
            console.info('Jungle\u0027s Blog\u00A0Service Worker Ready');
        });
}
</script>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/auto-render.min.js"></script><script src="/lib/katex/copy-tex.min.js"></script><script src="/lib/katex/mhchem.min.js"></script><script src="/lib/mermaid/mermaid.min.js"></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":100},"comment":{},"data":{"id-1":"graph TB\nS(start)\nS----A\nS----B\nS----C\nA(T_prod)\nB(T_cons)\nC(T_cons)\nD(\"printf(â€œ(â€);\")\nE(wait)\nF(wait)\nD1(signal)\nE1(\"printf(â€œ)â€);\")\nE2(signal)\nF1(\"printf(â€œ)â€);\")\nA----D----D1\nB----E\nC----F\nE====D1\nE----E1----E2\nF====E2\nF----F1"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.js"></script></body></html>
