<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>æ‰€æœ‰æ–‡ç«  - Jungle&#39;s Blog</title>
        <link>https://Jungle430.github.io/posts/</link>
        <description>æ‰€æœ‰æ–‡ç«  | Jungle&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>1239946358@qq.com (Jungle)</managingEditor>
            <webMaster>1239946358@qq.com (Jungle)</webMaster><lastBuildDate>Sat, 04 Mar 2023 15:47:02 &#43;0800</lastBuildDate><atom:link href="https://Jungle430.github.io/posts/" rel="self" type="application/rss+xml" /><item>
    <title>Linux x86 Program Start Up or - How the heck do we get to main()?</title>
    <link>https://Jungle430.github.io/posts/operating-system/support2/</link>
    <pubDate>Sat, 04 Mar 2023 15:47:02 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/operating-system/support2/</guid>
    <description><![CDATA[<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>
<ul>
<li>
<p>æ–‡ç« ä»‹ç»äº†X86ç³»ç»Ÿmainå‡½æ•°è°ƒç”¨å‰åçš„ä¸€äº›ç»†èŠ‚ï¼Œå¹¶é˜è¿°äº†Cç¨‹åºçš„<b>æ„é€ å‡½æ•°</b>å’Œ<b>ææ„å‡½æ•°</b>ï¼Œ<u>ä»¥åŠ<code>.init</code>,<code>.fini</code>,<code>init_array</code>å’Œ<code>fini_array</code>å„sectionç›¸å¯¹äºmainå‡½æ•°åŠå½¼æ­¤çš„æ‰§è¡Œé¡ºåºã€‚é—æ†¾çš„æ˜¯è¿™ç¯‡æ–‡ç« æ˜¯åŸºäº32ä½CPUæ¶æ„æ¥ç ”ç©¶çš„</u></p>
</li>
<li>
<p>æ–‡ç« å¯¹$debug$ <code>main</code>å‡½æ•°ä¹‹å‰çš„ä»£ç æœ‰ä¸€å®šçš„å¸®åŠ©æ•ˆæœ</p>
</li>
<li>
<p>ä¸»è¦ä»‹ç»äº†X86 ELFæ–‡ä»¶çš„åŠ¨æ€åŠ è½½è¿‡ç¨‹</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/support2-1.png" title="/img/Operating System/support2-1.png" data-thumbnail="/img/Operating System/support2-1.png" data-sub-html="<h2>æ€»ä½“æµç¨‹å›¾</h2>">
        
    </a><figcaption class="image-caption">æ€»ä½“æµç¨‹å›¾</figcaption>
    </figure>
<h2 id="è°ƒç”¨è¿‡ç¨‹åˆ†æ">è°ƒç”¨è¿‡ç¨‹åˆ†æ</h2>
<h3 id="mainå‡½æ•°çš„è°ƒç”¨">mainå‡½æ•°çš„è°ƒç”¨</h3>
<ul>
<li>å…ˆå†™ä¸€ä¸ªæœ€ç®€å•çš„Cç¨‹åºprog1.c</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç¼–è¯‘ä¸€ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -ggdb -o prog1 prog1.c
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨ï¼š<code>-ggdb</code>çš„é€‰é¡¹ä½œç”¨ï¼šç”Ÿæˆ<code>gdb</code>ä¸“ç”¨çš„è°ƒè¯•ä¿¡æ¯ï¼Œä¼šæœ‰ä¸€äº›<code>gdb</code>ä¸“ç”¨çš„æ‰©å±•</p>
</blockquote>
<ul>
<li>ç„¶åæˆ‘ä»¬ç”¨objdumpåšä¸€ä¸‹åæ±‡ç¼–</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">objdump -d prog1 &gt; prog1.asm
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ä»æˆ‘ä»¬ç»ˆç«¯æ•²å›è½¦åˆ°ç¨‹åºè¢«è½½å…¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ">ä»æˆ‘ä»¬ç»ˆç«¯æ•²å›è½¦åˆ°ç¨‹åºè¢«è½½å…¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h4>
<ul>
<li>å½“æˆ‘ä»¬ä»ç»ˆç«¯è¾“å…¥è¦è¿è¡Œçš„ç¨‹åºæˆ–è€…æ˜¯ä»æœ‰å…³çš„<code>gui</code>ç•Œé¢ç‚¹å‡»ç›¸å…³çš„buttonçš„æ—¶å€™ï¼Œ<b>shell</b>æˆ–è€…<b>gui</b>å°±ä¼šè°ƒç”¨<code>execve()</code>ã€‚è¿™é‡Œä¸æ˜¯æˆ‘ä»¬é‡ç‚¹å…³å¿ƒçš„åœ°æ–¹ï¼Œç®€å•æ¥è¯´ï¼Œexecve()ä¼šè®¾ç«‹ä¸€ä¸ªæ ˆï¼Œç„¶åå°†å‚æ•°<code>argc</code>ï¼Œ<code>argv</code>å’Œ<code>envp</code>å‹å…¥æ ˆä¸­ã€‚æ–‡ä»¶æè¿°ç¬¦0ï¼Œ1ï¼Œ2ï¼ˆstdin, stdoutå’Œstderrï¼‰ç”±ä¹‹å‰çš„shellè®¾ç½®ï¼ŒåŠ è½½å™¨ä¼šå¸®æˆ‘ä»¬å®Œæˆæœ‰å…³é‡å®šä½çš„è®¸å¤šå·¥ä½œï¼Œå½“æ‰€æœ‰æå®šä¹‹åï¼Œæ§åˆ¶æƒä¼šä¼ é€’ç»™<code>_start()</code></li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/support2-2.png" title="/img/Operating System/support2-2.png" data-thumbnail="/img/Operating System/support2-2.png" data-sub-html="<h2>shellè¾“å…¥man execveä¹‹åçš„å‡½æ•°å£°æ˜å’Œæ‰€åœ¨ä½ç½®</h2>">
        
    </a><figcaption class="image-caption">shellè¾“å…¥<code>man execve</code>ä¹‹åçš„å‡½æ•°å£°æ˜å’Œæ‰€åœ¨ä½ç½®</figcaption>
    </figure>
<h4 id="_start">_start()</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">080482e0 &lt;_start&gt;:
</span></span><span class="line"><span class="cl">80482e0:       31 ed                   xor    %ebp,%ebp
</span></span><span class="line"><span class="cl">80482e2:       5e                      pop    %esi
</span></span><span class="line"><span class="cl">80482e3:       89 e1                   mov    %esp,%ecx
</span></span><span class="line"><span class="cl">80482e5:       83 e4 f0                and    $0xfffffff0,%esp
</span></span><span class="line"><span class="cl">80482e8:       50                      push   %eax
</span></span><span class="line"><span class="cl">80482e9:       54                      push   %esp
</span></span><span class="line"><span class="cl">80482ea:       52                      push   %edx
</span></span><span class="line"><span class="cl">80482eb:       68 00 84 04 08          push   $0x8048400
</span></span><span class="line"><span class="cl">80482f0:       68 a0 83 04 08          push   $0x80483a0
</span></span><span class="line"><span class="cl">80482f5:       51                      push   %ecx
</span></span><span class="line"><span class="cl">80482f6:       56                      push   %esi
</span></span><span class="line"><span class="cl">80482f7:       68 94 83 04 08          push   $0x8048394
</span></span><span class="line"><span class="cl">80482fc:       e8 c3 ff ff ff          call   80482c4 &lt;__libc_start_main@plt&gt;
</span></span><span class="line"><span class="cl">8048301:       f4                      hlt
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä»»ä½•å€¼<code>xor</code>è‡ªèº«å¾—åˆ°çš„ç»“æœéƒ½æ˜¯0ã€‚æ‰€ä»¥<code>xor %ebp,%ebp</code>è¯­å¥ä¼šæŠŠ<code>%ebp</code>è®¾ç½®ä¸º0ã€‚ABIï¼ˆApplication Binary Interface specificationï¼‰æ¨èè¿™ä¹ˆåšï¼Œç›®çš„æ˜¯ä¸ºäº†æ ‡è®°æœ€å¤–å±‚å‡½æ•°çš„é¡µå¸§ï¼ˆframeï¼‰</li>
<li>æ¥ä¸‹æ¥ï¼Œä»æ ˆä¸­å¼¹å‡ºæ ˆé¡¶çš„å€¼ä¿å­˜åˆ°<code>%esi</code>ã€‚åœ¨æœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬æŠŠ<code>argc</code>ï¼Œ<code>argv</code>å’Œ<code>envp</code>æ”¾åˆ°äº†æ ˆé‡Œï¼Œæ‰€ä»¥ç°åœ¨çš„<code>pop</code>è¯­å¥ä¼šæŠŠ<code>argc</code>æ”¾åˆ°<code>%esi</code>ä¸­</li>
<li>è¿™é‡Œåªæ˜¯ä¸´æ—¶ä¿å­˜ä¸€ä¸‹ï¼Œç¨åæˆ‘ä»¬ä¼šæŠŠå®ƒå†æ¬¡å‹å›æ ˆä¸­</li>
<li>å› ä¸ºæˆ‘ä»¬å¼¹å‡ºäº†<code>argc</code>ï¼Œæ‰€ä»¥<code>%ebp</code>ç°åœ¨æŒ‡å‘çš„æ˜¯<code>argv</code>ã€‚<code>mov</code>æŒ‡ä»¤æŠŠ<code>argv</code>æ”¾åˆ°äº†<code>%ecx</code>ä¸­ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç§»åŠ¨æ ˆæŒ‡é’ˆ</li>
<li><u>ç„¶åï¼Œå°†æ ˆæŒ‡é’ˆå’Œä¸€ä¸ªå¯ä»¥æ¸…é™¤åå››ä½çš„æ©ç åš<code>and</code>æ“ä½œã€‚æ ¹æ®å½“å‰æ ˆæŒ‡é’ˆçš„ä½ç½®ä¸åŒï¼Œæ ˆæŒ‡é’ˆå°†ä¼šå‘ä¸‹ç§»åŠ¨0åˆ°15ä¸ªå­—èŠ‚ã€‚è¿™ä¹ˆåšï¼Œä¿è¯äº†ä»»ä½•æƒ…å†µä¸‹ï¼Œæ ˆæŒ‡é’ˆéƒ½æ˜¯16å­—èŠ‚çš„å¶æ•°å€å¯¹é½çš„ã€‚å¯¹é½çš„ç›®çš„æ˜¯ä¿è¯æ ˆä¸Šæ‰€æœ‰çš„å˜é‡éƒ½èƒ½å¤Ÿè¢«å†…å­˜å’Œcacheå¿«é€Ÿçš„è®¿é—®</u></li>
<li><u>è¦æ±‚è¿™ä¹ˆåšçš„æ˜¯SSEï¼Œå°±æ˜¯æŒ‡ä»¤éƒ½èƒ½åœ¨å•ç²¾åº¦æµ®ç‚¹æ•°ç»„ä¸Šå·¥ä½œçš„é‚£ä¸ª<b>ï¼ˆæ‰©å±•æŒ‡ä»¤é›†ï¼‰</b></u></li>
<li>ä¾‹å­ï¼šæŸæ¬¡è¿è¡Œæ—¶ï¼Œ<code>_start</code>å‡½æ•°åˆšè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>%esp</code>å¤„äº<code>0xbffff770</code>ã€‚åœ¨æˆ‘ä»¬ä»æ ˆä¸Šå¼¹å‡º<code>argc</code>åï¼Œ<code>%esp</code>æŒ‡å‘<code>0xbffff774</code>ã€‚å®ƒå‘é«˜åœ°å€ç§»åŠ¨äº†ï¼ˆæ ˆå‘ä¸‹å¢é•¿ï¼‰ã€‚å½“å¯¹æ ˆæŒ‡é’ˆæ‰§è¡Œäº†<code>and</code>æ“ä½œåï¼Œæ ˆæŒ‡é’ˆå›åˆ°äº†<code>0xbffff770</code></li>
</ul>
<h4 id="__libc_start_main">__libc_start_main</h4>
<ul>
<li>ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ<code>__libc_start_main</code>å‡½æ•°çš„å‚æ•°å‹å…¥æ ˆä¸­ã€‚ç¬¬ä¸€ä¸ªå‚æ•°<code>%eax</code>è¢«å‹å…¥æ ˆä¸­ï¼Œé‡Œé¢ä¿å­˜äº†æ— æ•ˆä¿¡æ¯ï¼ŒåŸå› æ˜¯ç¨åä¼šæœ‰ä¸ƒä¸ªå‚æ•°å°†è¢«å‹å…¥æ ˆä¸­ï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯16å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥éœ€è¦ç¬¬å…«ä¸ªå‚æ•°ã€‚è¿™ä¸ªå€¼ä¹Ÿå¹¶ä¸ä¼šè¢«ç”¨åˆ°ã€‚<code>__libc_start_main</code>æ˜¯åœ¨é“¾æ¥çš„æ—¶å€™ä»glibcå¤åˆ¶è¿‡æ¥çš„ã€‚åœ¨glibcçš„ä»£ç ä¸­ï¼Œå®ƒä½äº<code>csu/libc-start.c</code>æ–‡ä»¶é‡Œã€‚<code>__libc_start_main</code>çš„å®šä¹‰å¦‚ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">__libc_start_main</span><span class="p">(</span>  <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">main</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span> <span class="n">ubp_av</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtld_fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">stack_end</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/support2-3.jpg" title="/img/Operating System/support2-3.jpg" data-thumbnail="/img/Operating System/support2-3.jpg" data-sub-html="<h2>å‚æ•°è¯´æ˜</h2>">
        
    </a><figcaption class="image-caption">å‚æ•°è¯´æ˜</figcaption>
    </figure>
<ul>
<li>__libc_csu_finiå‡½æ•°ä¹Ÿæ˜¯ä»glibcè¢«é“¾æ¥è¿›æˆ‘ä»¬ä»£ç çš„ï¼Œå®ƒçš„æºä»£ç ä½äºcsu/elf-init.cä¸­</li>
</ul>
<h4 id="ç¯å¢ƒå˜é‡å“ªé‡Œå»äº†">ç¯å¢ƒå˜é‡å“ªé‡Œå»äº†ï¼Ÿ</h4>
<ul>
<li>
<p>æˆ‘ä»¬å¹¶æ²¡æœ‰è·å–envpï¼ˆæ ˆé‡ŒæŒ‡å‘æˆ‘ä»¬ç¯å¢ƒå˜é‡çš„æŒ‡é’ˆï¼‰ï¼Ÿå®ƒå¹¶ä¸æ˜¯<code>__libc_start_main</code>å‡½æ•°çš„å‚æ•°ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“mainå‡½æ•°çš„åŸå‹å…¶å®æ˜¯<code>int main(int argc, char** argv, char** envp)</code>ã€‚æ‰€ä»¥ï¼Œåˆ°åº•æ€ä¹ˆå›äº‹ï¼Ÿ</p>
</li>
<li>
<p>å…¶å®ï¼Œ<code>__libc_start_main</code>å‡½æ•°ä¼šè°ƒç”¨<code>__libc_init_first</code>ï¼Œè¿™ä¸ªå‡½æ•°ä¼šä½¿ç”¨å†…éƒ¨ä¿¡æ¯å»æ‰¾åˆ°ç¯å¢ƒå˜é‡ï¼ˆå®é™…ä¸Šç¯å¢ƒå˜é‡å°±ä½äº<code>argv</code>çš„ç»ˆæ­¢å­—ç¬¦nullçš„åé¢ï¼‰ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªå…¨å±€å˜é‡<code>__environ</code>ï¼Œè¿™ä¸ªå…¨å±€å˜é‡å¯ä»¥è¢«<code>__libc_start_main</code>å‡½æ•°å†…éƒ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼ŒåŒ…æ‹¬è°ƒç”¨mainå‡½æ•°æ—¶ã€‚å½“<code>envp</code>å»ºç«‹äº†ä¹‹åï¼Œ<code>__libc_start_main</code>å‡½æ•°ä¼šä½¿ç”¨ç›¸åŒçš„å°æŠ€å·§ï¼Œè¶Šè¿‡envpæ•°ç»„ä¹‹åçš„<code>NULL</code>å­—ç¬¦ï¼Œè·å–å¦ä¸€ä¸ªå‘é‡â€”â€”ELFè¾…åŠ©å‘é‡ï¼ˆåŠ è½½å™¨ä½¿ç”¨å®ƒç»™è¿›ç¨‹ä¼ é€’ä¸€äº›ä¿¡æ¯ï¼‰</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">__libc_init_first</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">arg0</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arg0</span><span class="p">,</span> <span class="o">**</span><span class="n">envp</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">argv</span><span class="p">[</span><span class="n">argc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">__environ</span> <span class="o">=</span> <span class="n">envp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">__libc_init</span> <span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿è¡Œç¨‹åºå‰ï¼Œè®¾ç½®ç¯å¢ƒå˜é‡<code>LD_SHOW_AUXV=1</code>,å¯ä»¥æŸ¥çœ‹é‡Œé¢çš„å†…å®¹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ <span class="nv">LD_SHOW_AUXV</span><span class="o">=</span><span class="m">1</span> ./prog1
</span></span><span class="line"><span class="cl">AT_SYSINFO:      0xe62414
</span></span><span class="line"><span class="cl">AT_SYSINFO_EHDR: 0xe62000
</span></span><span class="line"><span class="cl">AT_HWCAP:    fpu vme de pse tsc msr pae mce cx8 apic
</span></span><span class="line"><span class="cl">             mtrr pge mca cmov pat pse36 clflush dts
</span></span><span class="line"><span class="cl">             acpi mmx fxsr sse sse2 ss ht tm pbe
</span></span><span class="line"><span class="cl">AT_PAGESZ:       <span class="m">4096</span>
</span></span><span class="line"><span class="cl">AT_CLKTCK:       <span class="m">100</span>
</span></span><span class="line"><span class="cl">AT_PHDR:         0x8048034
</span></span><span class="line"><span class="cl">AT_PHENT:        <span class="m">32</span>
</span></span><span class="line"><span class="cl">AT_PHNUM:        <span class="m">8</span>
</span></span><span class="line"><span class="cl">AT_BASE:         0x686000
</span></span><span class="line"><span class="cl">AT_FLAGS:        0x0
</span></span><span class="line"><span class="cl">AT_ENTRY:        0x80482e0
</span></span><span class="line"><span class="cl">AT_UID:          <span class="m">1002</span>
</span></span><span class="line"><span class="cl">AT_EUID:         <span class="m">1002</span>
</span></span><span class="line"><span class="cl">AT_GID:          <span class="m">1000</span>
</span></span><span class="line"><span class="cl">AT_EGID:         <span class="m">1000</span>
</span></span><span class="line"><span class="cl">AT_SECURE:       <span class="m">0</span>
</span></span><span class="line"><span class="cl">AT_RANDOM:       0xbff09acb
</span></span><span class="line"><span class="cl">AT_EXECFN:       ./prog1
</span></span><span class="line"><span class="cl">AT_PLATFORM:     i686
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å„ç§å„æ ·çš„ä¿¡æ¯ã€‚<code>AT_ENTRY</code>æ˜¯<code>_start</code>çš„åœ°å€ï¼Œè¿˜æœ‰æˆ‘ä»¬çš„UIDã€æœ‰æ•ˆUIDå’ŒGID</p>
</li>
<li>
<p><b>__libc_start_mainåŠŸèƒ½æ€»ç»“</b></p>
<ul>
<li>å¤„ç†å…³äºsetuidã€setgidç¨‹åºçš„å®‰å…¨é—®é¢˜</li>
<li>å¯åŠ¨çº¿ç¨‹</li>
<li>æŠŠ<code>fini</code>å‡½æ•°å’Œ<code>rtld_fini</code>å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>at_exit</code>è°ƒç”¨ï¼Œä½¿å®ƒä»¬åœ¨<code>at_exit</code>é‡Œè¢«è°ƒç”¨ï¼Œä»è€Œå®Œæˆç”¨æˆ·ç¨‹åºå’ŒåŠ è½½å™¨çš„è°ƒç”¨ç»“æŸä¹‹åçš„æ¸…ç†å·¥ä½œ</li>
<li>è°ƒç”¨å…¶<code>init</code>å‚æ•°</li>
<li>è°ƒç”¨<code>main</code>å‡½æ•°ï¼Œå¹¶æŠŠ<code>argc</code>å’Œ<code>argv</code>å‚æ•°ã€ç¯å¢ƒå˜é‡ä¼ é€’ç»™å®ƒ</li>
<li>è°ƒç”¨<code>exit</code>å‡½æ•°ï¼Œå¹¶å°†mainå‡½æ•°çš„è¿”å›å€¼ä¼ é€’ç»™å®ƒ</li>
</ul>
</li>
</ul>
<h2 id="ç›¸å…³å‚è€ƒèµ„æ–™">ç›¸å…³å‚è€ƒèµ„æ–™</h2>
<ul>
<li>å‚è€ƒæ–‡ç« 
<ul>
<li><a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html" target="_blank" rel="noopener noreffer">ã€ŠLinux x86 Program Start Up or - How the heck do we get to main()? by Patrick Horganã€‹</a></li>
<li><a href="https://luomuxiaoxiao.com/?p=516" target="_blank" rel="noopener noreffer">ã€ŠLinux X86 ç¨‹åºå¯åŠ¨ â€“ mainå‡½æ•°æ˜¯å¦‚ä½•è¢«æ‰§è¡Œçš„ï¼Ÿâ€”â€”è½æœ¨è§è§çš„åšå®¢ã€‹</a>ï¼ˆå·²ä¸ä½œè€…æ²Ÿé€šï¼ŒåŒæ„éƒ¨åˆ†è½¬è½½ï¼‰</li>
</ul>
</li>
</ul>
]]></description>
</item>
<item>
    <title>é€Ÿé€šBigInteger</title>
    <link>https://Jungle430.github.io/posts/java/biginteger/</link>
    <pubDate>Tue, 28 Feb 2023 23:59:46 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/java/biginteger/</guid>
    <description><![CDATA[<h1 id="é€Ÿé€šbiginteger">é€Ÿé€šBigInteger</h1>
<ul>
<li>é¦–å…ˆéœ€è¦å¯¼åŒ…</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><table border="2" >
	<tr>
		<td colspan="2">BigIntegerçš„ä¸€äº›æ–¹æ³•</td>
    </tr>
    <tr>
        <td>BigInteger bigInteger = new BigInteger("123456");</td>
        <td>ä½¿ç”¨Stringè¿›è¡Œåˆå§‹åŒ–</td>
    </tr>
    <tr>
        <td>abs()</td>
        <td>è¿”å›ä¸€ä¸ªBigIntegerã€‚å€¼ä¸ºå½“å‰å¯¹è±¡çš„ç»å¯¹å€¼</td>
    </tr>
    <tr>
        <td>add(BigInteger)</td>
        <td>ç›¸åŠ :<br>
            bigInteger = bigInteger.add(new BigInteger("123456"));</td>
    </tr>
    <tr>
        <td>and(BigInteger)</td>
        <td>äºŒè¿›åˆ¶AND(&)è¿ç®—ç¬¦:<br>
            bigInteger = bigInteger.and(new BigInteger("123456"));</td>
    </tr>
    <tr>
        <td>andNot(BigInteger)</td>
        <td>äºŒè¿›åˆ¶æŒ‰ä½ä¸éè¿ç®—ç¬¦,ç­‰åŒäºand(BigTnteger.not()):<br>
            bigInteger = bigInteger.andNot(new BigInteger("123456"));</td>
    </tr>
    <tr>
        <td>bitCount()</td>
        <td>è¯¥æ–¹æ³•ç”¨äºè¿”å›è¯¥BigIntegerçš„<u>è¡¥ç è¡¨ç¤ºä¸­ä¸ç¬¦å·ä½ä¸åŒçš„ä½æ•°</u></td>
    </tr>
    <tr>
        <td>bitLength()</td>
        <td>è¿”å›äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„é•¿åº¦</td>
    </tr>
    <tr>
        <td>compareTo(BigInteger)</td>
        <td>è¿”å›äºŒè€…æ¯”è¾ƒç»“æœ:å°äº -1ï¼Œ ç­‰äº 0ï¼Œ å¤§äº 1</td>
    </tr>
    <tr>
        <td>divide(BigInteger)</td>
        <td>ç›¸é™¤ï¼Œç›¸å½“äº"/"</td>
    </tr>
    <tr>
        <td>divideAndRemainder(BigInteger)</td>
        <td>è¿”å›ä¸€ä¸ªBigIntegeræ•°ç»„ï¼Œç¬¬ä¸€ä½æ˜¯æˆªæ–­ç»“æœ(/)ï¼Œç¬¬äºŒä½æ˜¯ä½™æ•°(%)</td>
    </tr>
    <tr>
        <td>doubleValue()</td>
        <td>è¿”å›å¯¹åº”çš„doubleå€¼</td>
    </tr>
    <tr>
        <td>gcd()</td>
        <td>gcd(abs(val1), abs(val2)),ä½¿ç”¨gcdç®—æ³•</td>
    </tr>
    <tr>
        <td>intValue(), longValue()</td>
        <td>è¿”å›å¯¹åº”ç±»å‹çš„å€¼</td>
    </tr>
    <tr>
        <td>max(), min()</td>
        <td>æœ€å¤§æœ€å°å€¼</td>
    </tr>
    <tr>
        <td>mod(BigInteger)</td>
        <td>ç›¸å½“äº%</td>
    </tr>
    <tr>
        <td>multiply(BigInteger)</td>
        <td>ç›¸å½“äºX</td>
    </tr>
    <tr>
    	<td>negate()</td>
        <td>å–ç›¸åæ•°</td>
    </tr>
    <tr>
        <td>pow(int)</td>
        <td>ä»¥è¯¥å¯¹è±¡ä¸ºåŸºåº•ï¼Œå‚æ•°ä¸ºå¹‚</td>
    </tr>
    <tr>
        <td>isProbablePrime(int certainty)</td>
        <td>æ˜¯å¦æ˜¯è´¨æ•°,certaintyÂ - è¿™ä¸€æªæ–½çš„è°ƒç”¨è€…èƒ½å®¹å¿çš„ä¸ç¡®å®šæ€§,æ­¤æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´æ­£æ¯”äºè¯¥å‚æ•°çš„å€¼</td>
    </tr>
    <tr>
        <td>shiftLeft(),shiftRight()</td>
        <td>å·¦ç§»,å³ç§»</td>
    </tr>
    <tr>
        <td>subtract()</td>
        <td>ç›¸å‡</td>
    </tr>
</table>    
]]></description>
</item>
<item>
    <title>Chapter2-éƒ¨åˆ†äºŒåˆ·-ä¸ªäººç†è§£System call</title>
    <link>https://Jungle430.github.io/posts/operating-system/support1/</link>
    <pubDate>Sun, 26 Feb 2023 21:02:57 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/operating-system/support1/</guid>
    <description><![CDATA[<h1 id="äºŒåˆ·éƒ¨åˆ†chapter2-longrightarrow-å¦‚ä½•ç†è§£system-call">äºŒåˆ·éƒ¨åˆ†Chapter2 $\Longrightarrow$ å¦‚ä½•ç†è§£<code>System call</code></h1>
<h2 id="é—®é¢˜æ„é€ æœ€å°çš„hello-worldç¨‹åº">é—®é¢˜ï¼šæ„é€ æœ€å°çš„â€Hello worldâ€ç¨‹åº</h2>
<h3 id="åŸºæœ¬ç¨‹åºå’Œé™æ€ç¼–è¯‘">åŸºæœ¬ç¨‹åºå’Œé™æ€ç¼–è¯‘</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hello world&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -static hello.c -o hello <span class="o">&amp;&amp;</span> ./hello
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘å‡ºæ¥å¾ˆå¤§(Ubuntuä¸Šçº¦900KB)</p>
<ul>
<li>å¦‚æœåªç¼–è¯‘ï¼Œä¸é“¾æ¥ï¼Œçœ‹ä¸€ä¸‹objæ–‡ä»¶çš„åæ±‡ç¼–</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc -c hello.c <span class="o">&amp;&amp;</span> objdump -d hello.o
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hello.oï¼š     æ–‡ä»¶æ ¼å¼ elf64-x86-64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disassembly of section .text:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0000000000000000</span> &lt;main&gt;:
</span></span><span class="line"><span class="cl">   0:	f3 0f 1e fa          	endbr64 
</span></span><span class="line"><span class="cl">   4:	<span class="m">55</span>                   	push   %rbp
</span></span><span class="line"><span class="cl">   5:	<span class="m">48</span> <span class="m">89</span> e5             	mov    %rsp,%rbp
</span></span><span class="line"><span class="cl">   8:	<span class="m">48</span> 8d <span class="m">05</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 	lea    0x0<span class="o">(</span>%rip<span class="o">)</span>,%rax        <span class="c1"># f &lt;main+0xf&gt;</span>
</span></span><span class="line"><span class="cl">   f:	<span class="m">48</span> <span class="m">89</span> c7             	mov    %rax,%rdi
</span></span><span class="line"><span class="cl">  12:	b8 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>       	mov    <span class="nv">$0</span>x0,%eax
</span></span><span class="line"><span class="cl">  17:	e8 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>       	call   1c &lt;main+0x1c&gt;
</span></span><span class="line"><span class="cl">  1c:	b8 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>       	mov    <span class="nv">$0</span>x0,%eax
</span></span><span class="line"><span class="cl">  21:	5d                   	pop    %rbp
</span></span><span class="line"><span class="cl">  22:	c3                   	ret    
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å°±å’Œæ™®é€šçš„å‡½æ•°å·®ä¸å¤šï¼Œåªæœ‰å‚æ•°å‹æ ˆï¼Œcallå’Œå‚æ•°å‡ºæ ˆçš„è¿‡ç¨‹
<ul>
<li>æ™®é€šå‡½æ•°<code>fun.c</code></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -c fun.c <span class="o">&amp;&amp;</span> objdump -d fun.o 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fun.oï¼š     æ–‡ä»¶æ ¼å¼ elf64-x86-64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disassembly of section .text:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0000000000000000</span> &lt;f&gt;:
</span></span><span class="line"><span class="cl">   0:	f3 0f 1e fa          	endbr64 
</span></span><span class="line"><span class="cl">   4:	<span class="m">55</span>                   	push   %rbp
</span></span><span class="line"><span class="cl">   5:	<span class="m">48</span> <span class="m">89</span> e5             	mov    %rsp,%rbp
</span></span><span class="line"><span class="cl">   8:	<span class="m">90</span>                   	nop
</span></span><span class="line"><span class="cl">   9:	5d                   	pop    %rbp
</span></span><span class="line"><span class="cl">   a:	c3                   	ret
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å¯ä»¥çœ‹åˆ°ä¸é“¾æ¥çš„è¯å’Œæ™®é€šçš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹å·®ä¸å¤š</p>
</li>
<li>
<p>é“¾æ¥å¤±è´¥ï¼</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â—‹ â†’ ld hello.o
</span></span><span class="line"><span class="cl">ld: è­¦å‘Š: æ— æ³•æ‰¾åˆ°é¡¹ç›®ç¬¦å· _start<span class="p">;</span> ç¼ºçœä¸º <span class="m">0000000000401000</span>
</span></span><span class="line"><span class="cl">ld: hello.o: in <span class="k">function</span> <span class="sb">`</span>main<span class="s1">&#39;:
</span></span></span><span class="line"><span class="cl"><span class="s1">hello.c:(.text+0x18): undefined reference to `printf&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æœ¬æ¥ä»¥ä¸ºæ‰¾çš„<code>main</code>ï¼Œä½†æ˜¯å®ƒå®é™…ä¸Šåœ¨æ‰¾<code>_start</code>è¿™ä¸ªä¸œè¥¿ï¼Ÿ</li>
</ul>
<h3 id="é‚£æˆ‘ä»¬å°±æŠŠmainæ”¹æˆ_start">é‚£æˆ‘ä»¬å°±æŠŠ<code>main</code>æ”¹æˆ<code>_start</code></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">_start</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hello world&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/support1-1.png" title="/img/Operating System/support1-1.png" data-thumbnail="/img/Operating System/support1-1.png" data-sub-html="<h2>ldä»ç„¶ä¸äºˆé€šè¿‡-&gt; æ‰¾ä¸åˆ°printf?</h2>">
        
    </a><figcaption class="image-caption"><code>ldä»ç„¶ä¸äºˆé€šè¿‡</code>-&gt; æ‰¾ä¸åˆ°printf?</figcaption>
    </figure>
<ul>
<li>é‚£æŠŠprintfä¹Ÿç»™å»äº†</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">_start</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç¼–è¯‘ä¸é“¾æ¥å…¨éƒ¨æˆåŠŸï¼</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â—‹ â†’ gcc -c hello.c <span class="o">&amp;&amp;</span> objdump -d hello.o <span class="o">&amp;&amp;</span> ld hello.o
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hello.oï¼š     æ–‡ä»¶æ ¼å¼ elf64-x86-64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disassembly of section .text:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0000000000000000</span> &lt;_start&gt;:
</span></span><span class="line"><span class="cl">   0:	f3 0f 1e fa          	endbr64 
</span></span><span class="line"><span class="cl">   4:	<span class="m">55</span>                   	push   %rbp
</span></span><span class="line"><span class="cl">   5:	<span class="m">48</span> <span class="m">89</span> e5             	mov    %rsp,%rbp
</span></span><span class="line"><span class="cl">   8:	<span class="m">90</span>                   	nop
</span></span><span class="line"><span class="cl">   9:	5d                   	pop    %rbp
</span></span><span class="line"><span class="cl">   a:	c3                   	ret    
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>ç¨‹åºå¾ˆå°ï¼Œåªæœ‰99ä¸ªå­—èŠ‚</p>
</li>
<li>
<p>ä½†æ˜¯è¿è¡Œ $\Longrightarrow$ æ®µé”™è¯¯ï¼</p>
</li>
<li>
<p>ä½†æ˜¯é‡Œé¢åŠ å…¥while(1)è¿™ç§æ­»å¾ªç¯å°±æ²¡äº‹äº†</p>
</li>
</ul>
<hr>
<ul>
<li>å¯¹äºæ²¡æœ‰while(1)çš„a.outï¼Œä½¿ç”¨gdbç‹ ç‹ çš„æ‹·æ‰“è°ƒè¯•</li>
</ul>
<a class="lightgallery" href="/img/Operating%20System/support1-2.jpg" title="/img/Operating System/support1-2.jpg" data-thumbnail="/img/Operating System/support1-2.jpg">
        
    </a>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çœ‹åˆ°rspçš„åœ°å€æ˜¯åˆæ³•çš„ï¼Œé‡Œé¢çš„å€¼æ˜¯1ï¼Œå½“æ‰§è¡Œretåï¼Œrspå°†æ ˆé¡¶çš„å€¼1èµ‹ç»™äº†pcï¼Œgdbæ˜¾ç¤ºpcè®¿é—®äº†éæ³•ä½ç½®</p>
<figure><a class="lightgallery" href="/img/Operating%20System/support1-3.png" title="/img/Operating System/support1-3.png" data-thumbnail="/img/Operating System/support1-3.png" data-sub-html="<h2>ğŸ¤¡å‘¦å¼ï¼Œå´©æºƒäº†ï¼</h2>">
        
    </a><figcaption class="image-caption">ğŸ¤¡å‘¦å¼ï¼Œå´©æºƒäº†ï¼</figcaption>
    </figure>
<ul>
<li>CPUåªä¼šæ‰§è¡ŒæŒ‡ä»¤ï¼Œè¯¥æ€ä¹ˆåœä¸‹æ¥ï¼Ÿ(mov,addè¿™äº›æŒ‡ä»¤åœä¸ä¸‹æ¥)</li>
<li>éœ€è¦ä»€ä¹ˆæŒ‡ä»¤è®©å®ƒåœä¸‹æ¥ï¼Ÿ $\Longrightarrow$ <code>System call</code> ä¹Ÿå°±æ˜¯ç®¡æ€</li>
</ul>
<h3 id="æœ€å°çš„hello-worldç¨‹åº">æœ€å°çš„<code>Hello world</code>ç¨‹åº</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;sys/syscall.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="n">globl</span> <span class="n">_start</span>
</span></span><span class="line"><span class="cl"><span class="nl">_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">SYS_write</span><span class="p">,</span> <span class="o">%</span><span class="n">rax</span>   <span class="err">#</span> <span class="n">write</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span>         <span class="o">%</span><span class="n">rdi</span>   <span class="err">#</span>   <span class="n">fd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">st</span><span class="p">,</span>        <span class="o">%</span><span class="n">rsi</span>   <span class="err">#</span>   <span class="n">buf</span><span class="o">=</span><span class="n">st</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="p">(</span><span class="n">ed</span> <span class="o">-</span> <span class="n">st</span><span class="p">),</span> <span class="o">%</span><span class="n">rdx</span>   <span class="err">#</span>   <span class="n">count</span><span class="o">=</span><span class="n">ed</span><span class="o">-</span><span class="n">st</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span>                 <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">SYS_exit</span><span class="p">,</span>  <span class="o">%</span><span class="n">rax</span>   <span class="err">#</span> <span class="n">exit</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span>         <span class="o">%</span><span class="n">rdi</span>   <span class="err">#</span>   <span class="n">status</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span>                 <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">st</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="n">ascii</span> <span class="s">&#34;</span><span class="se">\033</span><span class="s">[01;31mHello, OS World</span><span class="se">\033</span><span class="s">[0m</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">ed</span><span class="p">:</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®ƒåœ¨å¹²ä»€ä¹ˆ
<ul>
<li>ç»™è®¸å¤šå¯„å­˜å™¨èµ‹å€¼ï¼Œç„¶åcalläº†syscall</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/support1-4.png" title="/img/Operating System/support1-4.png" data-thumbnail="/img/Operating System/support1-4.png" data-sub-html="<h2>ç¼–è¯‘åæŸ¥çœ‹åæ±‡ç¼–ä»£ç </h2>">
        
    </a><figcaption class="image-caption">ç¼–è¯‘åæŸ¥çœ‹åæ±‡ç¼–ä»£ç </figcaption>
    </figure>
<ul>
<li>ldé“¾æ¥ï¼Œç¼–è¯‘æˆåŠŸï¼Œè¿è¡ŒæˆåŠŸï¼</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â—‹ â†’ objdump -d a.out <span class="p">|</span> less
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/support1-5.png" title="/img/Operating System/support1-5.png" data-thumbnail="/img/Operating System/support1-5.png" data-sub-html="<h2>æŸ¥çœ‹åæ±‡ç¼–ä»£ç </h2>">
        
    </a><figcaption class="image-caption">æŸ¥çœ‹åæ±‡ç¼–ä»£ç </figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/support1-6.png" title="/img/Operating System/support1-6.png" data-thumbnail="/img/Operating System/support1-6.png" data-sub-html="<h2>man syscallæŸ¥çœ‹syscallçš„æ–‡æ¡£</h2>">
        
    </a><figcaption class="image-caption"><code>man syscall</code>æŸ¥çœ‹syscallçš„æ–‡æ¡£</figcaption>
    </figure>
<p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œsyscallä¼šå‘Šè¯‰æˆ‘ä»¬åœ¨å„ç§æ¶æ„çš„è®¡ç®—æœºä¸­è¯¥å¦‚ä½•é€šè¿‡å¯„å­˜å™¨ä¸ºsyscallä¼ å…¥å‚æ•°,<code>man syscalls</code>ä¼šå‘Šè¯‰æˆ‘ä»¬Linuxæ“ä½œç³»ç»Ÿçš„æ¥å£</p>
<ul>
<li>æ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œæ¨¡å¼</li>
</ul>
<div class="mermaid" id="id-1"></div>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>æ„Ÿè°¢<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="typeit"><div id="id-2" class=""></div></div>
<p>æ„Ÿè°¢jyyäº’åŠ©ç¾¤é‡Œ<b>zweix</b>å¤§ä½¬æä¾›çš„<a href="https://github.com/zweix123/jyyslide-md" target="_blank" rel="noopener noreffer">
jyyslide-md</a></p>
<p>ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å› ä¸ºWindowså¾ˆçƒ‚çš„ç¼–ç é—®é¢˜å§‹ç»ˆä¼šå‡ºç°gbkè§£ç é”™è¯¯çš„errorï¼Œå’Œ<b>zweix</b>å¤§ä½¬å·®ä¸å¤šæ²Ÿé€šäº†å¤§åŠä¸ªä¸‹åˆï¼Œç”±äºæ‡’å¾—ç»™vscodeé…ç¯å¢ƒç›´æ¥æ”¹æˆæ‰‹åŠ¨printçœ‹æ•°æ®ğŸ¤£ï¼Œæ„Ÿè§‰å°±æ˜¯å‘½ä»¤è¡Œä¼ å‚ç¼–ç çš„é—®é¢˜ï¼Œæœ€åç»ˆäºæ‰¾åˆ°äº†è§£å†³æ–¹æ³•ğŸ˜†ï¼Œåªèƒ½è¯´Windowsè¿™ä¸ªç¼–ç è®¾ç½®ä¹Ÿæ˜¯æ²¡è°äº†ã€‚</p>
</div>
        </div>
    </div>
]]></description>
</item>
<item>
    <title>ã€ŠC&#43;&#43; Primerã€‹ å­—ç¬¦ä¸²ï¼Œå‘é‡å’Œæ•°ç»„</title>
    <link>https://Jungle430.github.io/posts/cpp-primer/chapter3/</link>
    <pubDate>Wed, 22 Feb 2023 22:31:49 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/cpp-primer/chapter3/</guid>
    <description><![CDATA[<h1 id="c-primer">C++ Primer</h1>
<h2 id="å­—ç¬¦ä¸²å‘é‡å’Œæ•°ç»„">å­—ç¬¦ä¸²ï¼Œå‘é‡å’Œæ•°ç»„</h2>
<h3 id="æ ‡å‡†åº“ç±»å‹string">æ ‡å‡†åº“ç±»å‹string</h3>
<ul>
<li>æ ‡å‡†åº“ç±»å‹<code>string</code>è¡¨ç¤ºå¯å˜é•¿çš„å­—ç¬¦åºåˆ—ï¼Œä½¿ç”¨<code>string</code>ç±»å‹å¿…é¡»å…ˆåŒ…å«å¤´æ–‡ä»¶ï¼Œ<code>string</code>å®šä¹‰åœ¨å‘½åç©ºé—´<code>std</code>ä¸­</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®šä¹‰å’Œåˆå§‹åŒ–<code>string</code>å¯¹è±¡</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">åˆå§‹åŒ–stringå¯¹è±¡çš„æ–¹å¼</td>
	</tr>
	<tr>
		<td>string s1</td>
		<td>é»˜è®¤åˆå§‹åŒ–ï¼Œs1æ˜¯ä¸€ä¸ªç©ºä¸²</td>
	</tr>
	<tr>
		<td>string s2(s1)</td>
        <td>s2æ˜¯s1çš„å‰¯æœ¬</td>
	</tr>
	<tr>
		<td>string s2 = s1</td>
		<td>ç­‰ä»·äºs2(s1),s2æ˜¯s1çš„å‰¯æœ¬</td>
	</tr>
	<tr>
		<td>string s3("value")</td>
		<td>s3æ˜¯å­—é¢å€¼"value"çš„å‰¯æœ¬ï¼Œé™¤äº†å­—é¢å€¼æœ€åçš„é‚£ä¸ªç©ºå­—ç¬¦å¤–</td>
	</tr>
	<tr>
		<td>string s3 = "value"</td>
		<td>ç­‰ä»·äºs3("value"),s3æ˜¯å­—é¢å€¼"value"çš„å‰¯æœ¬
	</tr>
	<tr>
		<td>string s4(n, 'c')</td>
		<td>æŠŠs4åˆå§‹åŒ–ä¸ºç”±è¿ç»­nä¸ªå­—ç¬¦cç»„æˆçš„ä¸²</td>
	</tr>
</table>
<ul>
<li>
<p>ç›´æ¥åˆå§‹åŒ–å’Œæ‹·è´åˆå§‹åŒ–</p>
<ul>
<li>ä½¿ç”¨ç­‰å·(=) $\rightarrow$ <strong>æ‹·è´åˆå§‹åŒ–</strong>(copy initialization),ç¼–è¯‘å™¨æŠŠç­‰å·å³ä¾§çš„åˆå§‹å€¼æ‹·è´åˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ä¸­å»</li>
<li>ä¸ä½¿ç”¨ç­‰å·ï¼Œæ‰§è¡Œçš„æ˜¯<strong>ç›´æ¥åˆå§‹åŒ–</strong>(direct initialization)</li>
</ul>
</li>
<li>
<p>å¦‚ä½•ä½¿ç”¨</p>
<ul>
<li>åˆå§‹åŒ–éœ€è¦ä¸€ä¸ªå€¼ï¼šæ‹·è´åˆå§‹åŒ–å’Œç›´æ¥åˆå§‹åŒ–éƒ½è¡Œ</li>
<li>åˆå§‹åŒ–éœ€è¦å¤šä¸ªå€¼
<ul>
<li>å°½é‡ç”¨ç›´æ¥åˆå§‹åŒ–</li>
<li>æ‹·è´åˆå§‹åŒ–éœ€è¦æ˜¾å¼åœ°åˆ›å»ºä¸€ä¸ªï¼ˆä¸´æ—¶ï¼‰å¯¹è±¡æ¥è¿›è¡Œæ‹·è´ï¼š<code>string s8 = string(10, 'c');</code>ï¼ˆå¯è¯»æ€§å·®ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•è¡¥å¿ä¼˜åŠ¿ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>string</code>å¯¹è±¡ä¸Šçš„æ“ä½œ</p>
</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">stringçš„æ“ä½œ</td>
	</tr>
	<tr>
		<td>os << s</td>
		<td>å°†så†™åˆ°è¾“å‡ºæµoså½“ä¸­ï¼Œè¿”å›os</td>
	</tr>
	<tr>
		<td>is >> s</td>
		<td>ä»isä¸­è¯»å–å­—ç¬¦ä¸²èµ‹ç»™sï¼Œå­—ç¬¦ä¸²ä»¥ç©ºç™½åˆ†éš”ï¼Œè¿”å›is</td>
	</tr>
	<tr>
		<td>getline(is, s)</td>
		<td>ä»isä¸­è¯»å–ä¸€è¡Œèµ‹ç»™sï¼Œè¿”å›is(æ¢è¡Œç¬¦ä¹Ÿè¢«è¯»äº†è¿›æ¥,ä½†æ˜¯ä¸ä¼šå­˜å…¥è¯»å…¥çš„å­—ç¬¦ä¸²ä¸­å»)</td>
	</tr>
	<tr>
		<td>s.empty()</td>
		<td>sä¸ºç©ºè¿”å›trueï¼Œå¦åˆ™è¿”å›false</td>
	</tr>
	<tr>
		<td>s.size()</td>
		<td>è¿”å›sä¸­å­—ç¬¦çš„ä¸ªæ•°</td>
	</tr>
	<tr>
		<td>s[n]</td>
		<td>è¿”å›sä¸­ç¬¬nä¸ªå­—ç¬¦çš„<b>å¼•ç”¨</b></td>
	</tr>
    <tr>
        <td>s1 + s2</td>
        <td>è¿”å›s1å’Œs2è¿æ¥åçš„ç»“æœ</td>
    </tr>
    <tr>
        <td>s1 = s2</td>
        <td>ç”¨s2çš„å‰¯æœ¬æ›¿ä»£s1ä¸­åŸæ¥çš„å­—ç¬¦</td>
    </tr>
    <tr>
    	<td>s1 == s2</td>
        <td>å¦‚æœs1ä¸ªs2ä¸­æ‰€å«çš„å­—ç¬¦å®Œå…¨ä¸€æ ·ï¼Œåˆ™è¿”å›true,å¦åˆ™è¿”å›false</td>
    </tr>
    <tr>
    	<td>s1 != s2</td>
        <td>ç­‰æ€§åˆ¤æ–­å¯¹å­—æ¯çš„å¤§å°å†™æ•æ„Ÿ</td>
    </tr>
    <tr>
        <td><, <=, >, >=</td>
        <td>åˆ©ç”¨å­—å…¸åºè¿›è¡Œæ¯”è¾ƒï¼Œå¯¹å­—æ¯å¤§å°å†™æ•æ„Ÿ</td>
    </tr>
</table>    
<ul>
<li>æŠ€å·§:è¯»å–æœªçŸ¥æ•°é‡çš„stringå¯¹è±¡</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">word</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">word</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸç†ï¼š<u>CTRL+Z/è¯»åˆ°æ–‡ä»¶æœ«å°¾ -&gt; å¼•å‘å¼‚å¸¸ -&gt; è®°å½•å¼‚å¸¸ -&gt; fail() è¿”å›true-&gt; operator void*() è¿”å› 0 -&gt; whileç»“æŸ</u>ï¼Œå‚è€ƒæ–‡ç« :<a href="https://www.zhangjiee.com/blog/2013/deep-into-while-cin.html" target="_blank" rel="noopener noreffer">C++ æ·±å…¥æ¢ç©¶ while(cin)</a></p>
<ul>
<li>å¦‚æœæ˜¯æŒ‰è¡Œè¯»</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">line</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">getline</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">line</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>string::size_typeç±»å‹</p>
<ul>
<li>
<p>stringç±»çš„sizeå‡½æ•°è¿”å›çš„æ˜¯æ˜¯ä¸€ä¸ªstring::size_typeç±»å‹çš„å€¼ï¼Œæ— ç¬¦å·ç±»å‹ï¼Œè¶³ä»¥å­˜æ”¾ä¸‹ä»»ä½•<code>string</code>å¯¹è±¡çš„å¤§å°ï¼Œä¸‹æ ‡è¿ç®—ç¬¦å‚æ•°ç±»å‹ä¹Ÿæ˜¯å¦‚æ­¤</p>
</li>
<li>
<p>stringç±»ä»¥åŠå…¶ä»–å¤§å¤šæ•°æ ‡å‡†åº“ç±»å‹éƒ½å®šä¹‰äº†å‡ ç§é…å¥—çš„ç±»å‹ã€‚<u>è¿™äº›é…å¥—ç±»å‹ä½“ç°äº†æ ‡å‡†åº“ç±»å‹ä¸æœºå™¨æ— å…³çš„ç‰¹æ€§ï¼Œç±»å‹<b>size_type</b>å³æ˜¯å…¶ä¸­çš„ä¸€ç§</u>ã€‚æ ‡å‡†åº“ä¼šæ ¹æ®è¿è¡Œçš„æœºå™¨å‹å·åˆ†é…é€‚å½“çš„ç±»å‹ï¼Œæˆ‘ä»¬ä¸éœ€è¿‡å¤šå…³å¿ƒï¼Œå¦‚æœè¦çœ‹ç±»å‹åœ¨C++11ä»¥åå¯ä»¥å€ŸåŠ©<code>auto</code>å’Œ<code>decltype</code>æ¥æ¨æ–­å˜é‡ç±»å‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">len</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç”±äºstring::size_typeæ˜¯ä¸€ä¸ªæ— ç¬¦å·ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œæœ‰å…³sizeçš„ç›¸å…³æ“ä½œæ—¶ï¼Œå°½é‡é¿å…intä¸unsignedæ··ç”¨ï¼Œå¦åˆ™ä¼šç”±äºåè¡¥ç æœºåˆ¶å‡ºç°æ„æƒ³ä¸åˆ°çš„ä¸€äº›bugï¼Œæ­£ç¡®åšæ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">line</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="k">decltype</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">............</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>å­—å…¸åºç›¸å…³æ¯”è¾ƒæœºåˆ¶</p>
</li>
</ul>
<ol>
<li>è¾ƒçŸ­çš„stringå¯¹è±¡å°äºè¾ƒé•¿çš„stringå¯¹è±¡(å‰é¢çš„å†…å®¹éƒ½å®Œå…¨ç›¸åŒ)</li>
<li>å¦‚æœä¸¤ä¸ªstringå¯¹è±¡åœ¨æŸäº›å¯¹åº”çš„ä½ç½®ä¸Šä¸ä¸€è‡´ï¼Œåˆ™stringå¯¹è±¡æ¯”è¾ƒçš„ç»“æœå…¶å®æ˜¯stringå¯¹è±¡ä¸­ç¬¬ä¸€å¯¹ç›¸å¼‚å­—ç¬¦æ¯”è¾ƒçš„ç»“æœ</li>
</ol>
<ul>
<li>
<p>å­—é¢å€¼å’Œstringå¯¹è±¡ç›¸åŠ </p>
<ul>
<li>
<p>é€šè¿‡é‡è½½+å’Œ+=è¿ç®—ç¬¦å®ç°ï¼Œä½¿ç”¨æ—¶ä¸€å®šè¦æ³¨æ„è¿”å›å€¼çš„é—®é¢˜ï¼Œä¸è¦ä¸¤è¾¹ç±»å‹ä¸åŒ¹é…ï¼ˆä¾‹å¦‚ä¸¤ä¸ªå­—é¢å€¼ç›¸åŠ ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="s">&#34;, &#34;</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">+</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>é˜²æ­¢ä¸Šè¿°é—®é¢˜ï¼š<b>å¿…é¡»ç¡®ä¿æ¯ä¸ªåŠ æ³•è¿ç®—ç¬¦(+)çš„ä¸¤ä¾§è¿ç®—å¯¹è±¡è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯string</b></p>
</li>
</ul>
</li>
<li>
<p>å¤„ç†stringå¯¹è±¡ä¸­çš„å­—ç¬¦</p>
<ul>
<li>ä¸»è¦åˆ©ç”¨åˆ°äº†å¤´æ–‡ä»¶<code>&lt;cctype&gt;</code></li>
</ul>
</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">&ltccytpe&gtä¸­çš„å¸¸ç”¨å‡½æ•°</td>
	</tr>
    <tr>
        <td>isdigit(c)</td>
        <td>å½“cæ˜¯æ•°å­—çš„æ—¶å€™ä¸ºçœŸ</td>
    </tr>
    <tr>
        <td>islower(c)</td>
        <td>cæ˜¯å°å†™å­—æ¯çš„æ—¶å€™ä¸ºçœŸ</td>
    </tr>
    <tr>
        <td>isupper(c)</td>
        <td>cæ˜¯å¤§å†™å­—æ¯çš„æ—¶å€™ä¸ºçœŸ</td>
    </tr>
    <tr>
        <td>isspace(c)</td>
        <td>cæ˜¯ç©ºæ ¼çš„æ—¶å€™ä¸ºçœŸ</td>
    </tr>
    <tr>
        <td>tolower(c)</td>
        <td>å¦‚æœcæ˜¯å¤§å†™å­—æ¯ï¼Œåˆ™è¾“å‡ºå¯¹åº”çš„å°å†™å­—æ¯ï¼Œå¦åˆ™åŸæ ·è¾“å‡ºc</td>
    </tr>
    <tr>
        <td>toupper(c)</td>
        <td>å¦‚æœcæ˜¯å°å†™å­—æ¯ï¼Œåˆ™è¾“å‡ºå¯¹åº”çš„å¤§å†™å­—æ¯ï¼Œå¦åˆ™åŸæ ·è¾“å‡ºc</td>
    </tr>
</table> 
<blockquote>
<p>ä¸ºäº†å‘åå…¼å®¹Cï¼ŒC++ä¿ç•™äº†Cçš„æ ‡å‡†åº“ï¼Œä½†æ˜¯ä¸ºäº†æ›´å¥½åœ°ç¬¦åˆC++çš„è¦æ±‚ï¼ŒC++è‡ªå·±åˆå¼€å‘å‡ºäº†ä¸€å¥—æ–°çš„æ ‡å‡†åº“ï¼Œå»æ‰Cåº“ä¸­çš„.h,å‰é¢åŠ ä¸Šcï¼Œå³&lt;name.h&gt; $\rightarrow$ &lt;cname&gt;ï¼Œä¸Šé¢&lt;cctype&gt;å°±æ˜¯ç”±Cä¸­çš„&lt;ctype.h&gt;è¡ç”Ÿè¿‡æ¥çš„ï¼ŒC++åº“ä¸­çš„å‡½æ•°ä¸ºäº†é˜²æ­¢ä¸Cæ ‡å‡†åº“ä¸­çš„å†…å®¹å‘ç”Ÿå‘½åå†²çªï¼Œéƒ½åœ¨stdå‘½åç©ºé—´ä¸­</p>
</blockquote>
<ul>
<li>åŸºäºèŒƒå›´çš„forè¯­å¥
<ul>
<li>C++11çš„æ–°ç‰¹æ€§</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nl">declaration</span> <span class="p">:</span> <span class="n">expression</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">statement</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//example    
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">str</span><span class="p">(</span><span class="s">&#34;Some string&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">c</span> <span class="p">:</span> <span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>é‡è½½çš„ä¸‹æ ‡è¿ç®—ç¬¦
<ul>
<li>operator[] -&gt; æ¥æ”¶è¾“å…¥æ˜¯std::string::size_typeç±»å‹çš„å€¼ï¼Œè¿”å›stringå¯¹åº”ä½ç½®å­—ç¬¦çš„å¼•ç”¨</li>
<li>è¶…å‡ºèŒƒå›´ä¸‹æ ‡å°†å¼•å‘ä¸å¯é¢„çŸ¥çš„ç»“æœï¼ˆå†…å­˜éæ³•è¶Šç•Œè®¿é—®æˆ–è€…è®¿é—®åˆ°<code>nullptr</code> $\rightarrow$ ç©ºå­—ç¬¦ä¸²ï¼ŒC++ä¸ºäº†æ€§èƒ½å¹¶ä¸ä¼šåƒJavaé‚£æ ·åœ¨ä¸‹æ ‡è®¿é—®æ—¶è¿›è¡Œæ£€æŸ¥ï¼Œä¼šæœ‰å¾ˆå¤§é£é™©ï¼‰</li>
</ul>
</li>
</ul>
<h3 id="æ ‡å‡†åº“ç±»å‹vector">æ ‡å‡†åº“ç±»å‹vector</h3>
<ul>
<li>
<p>vectoræœ¬è´¨æ˜¯ä¸€ç§å˜é•¿æ•°ç»„</p>
</li>
<li>
<p>vectorä¹Ÿæ˜¯ä¸€ç§å®¹å™¨(container)</p>
</li>
<li>
<p>vectoråŒ…å«äºå¤´æ–‡ä»¶&lt;vector&gt;ä¸­ï¼Œå®šä¹‰åœ¨stdå‘½åç©ºé—´ä¸‹</p>
</li>
<li>
<p>vectoræ˜¯ç±»æ¨¡æ¿ï¼Œä½¿ç”¨æ—¶å¿…é¡»å£°æ˜å…¶ç±»å‹ï¼ˆå…¶å®åœ¨Modern C++ä¸­ç¼–è¯‘å™¨ä¹Ÿèƒ½è‡ªå·±æ¨å¯¼ä¸€éƒ¨åˆ†äº†ï¼‰ï¼Œç¼–è¯‘å™¨æ ¹æ®æ¨¡æ¿åˆ›å»ºç±»æˆ–å‡½æ•°å‡½æ•°çš„è¿‡ç¨‹ç§°ä¸º<b>å®ä¾‹åŒ–</b>(instantiation),ç”±äºC++çš„åˆ†ç¦»å¼ç¼–è¯‘ï¼Œ<b>è‡ªå·±å†™æ¨¡æ¿çš„æ—¶å€™ä¸€å®šè¦å°†å£°æ˜ä¸å®ç°éƒ½å†™åœ¨.hé‡Œï¼Œä¸è¦å°†å®ç°åˆ†ç¦»åˆ°.cppä¸­ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥</b></p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/C&#43;&#43;%20Primer/chapter3-1.jpg" title="/img/C&#43;&#43; Primer/chapter3-1.jpg" data-thumbnail="/img/C&#43;&#43; Primer/chapter3-1.jpg" data-sub-html="<h2>ç”±äºæ¨¡æ¿çš„å£°æ˜ä¸å®ç°åˆ†ç¦»å¯¼è‡´ç¼–è¯‘å¤±è´¥</h2>">
        
    </a><figcaption class="image-caption"><code>ç”±äºæ¨¡æ¿çš„å£°æ˜ä¸å®ç°åˆ†ç¦»å¯¼è‡´ç¼–è¯‘å¤±è´¥</code></figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/C&#43;&#43;%20Primer/chapter3-2.jpg" title="/img/C&#43;&#43; Primer/chapter3-2.jpg" data-thumbnail="/img/C&#43;&#43; Primer/chapter3-2.jpg" data-sub-html="<h2>å…¨éƒ¨å†™å…¥å¤´æ–‡ä»¶åç¼–è¯‘æˆåŠŸ</h2>">
        
    </a><figcaption class="image-caption"><code>å…¨éƒ¨å†™å…¥å¤´æ–‡ä»¶åç¼–è¯‘æˆåŠŸ</code></figcaption>
    </figure>
<ul>
<li>vectorèƒ½å®¹çº³ç»å¤§å¤šæ•°ç±»å‹çš„å¯¹è±¡ä½œä¸ºå…¶å…ƒç´ ï¼Œä½†æ˜¯å› ä¸º<u>å¼•ç”¨ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸å­˜åœ¨åŒ…å«å¼•ç”¨çš„vector</u></li>
</ul>
<hr>
<ul>
<li>å®šä¹‰å’Œåˆå§‹åŒ–vectorå¯¹è±¡</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">åˆå§‹åŒ–vectorå¯¹è±¡çš„æ–¹æ³•</td>
	</tr>
    <tr>
        <td>vector&ltT&gt v1</td>
        <td>v1æ˜¯ä¸€ä¸ªç©ºvectorï¼Œå®ƒæ½œåœ¨çš„å…ƒç´ æ˜¯Tç±»å‹çš„ï¼Œæ‰§è¡Œé»˜è®¤åˆå§‹åŒ–</td>
    </tr>
    <tr>
    	<td>vector&ltT&gt v2(v1)</td>
        <td>v2ä¸­åŒ…å«æœ‰v1æ‰€æœ‰å…ƒç´ çš„å‰¯æœ¬</td>
    </tr>
    <tr>
        <td>vector&ltT&gt v2 = v1</td>
        <td>ç­‰ä»·äºv2(v1),v2ä¸­åŒ…å«æœ‰v1æ‰€æœ‰å…ƒç´ çš„å‰¯æœ¬</td>
    </tr>
    <tr>
        <td>vector&ltT&gt v3(n, val)</td>
        <td>v3åŒ…å«äº†nä¸ªé‡å¤å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ çš„å€¼éƒ½æ˜¯val</td>
    </tr>
    <tr>
    	<td>vector&ltT&gt v4(n)</td>
        <td>v4é‡å¤åŒ…å«äº†nä¸ªé‡å¤åœ°æ‰§è¡Œäº†å€¼åˆå§‹åŒ–çš„å¯¹è±¡ï¼ˆé»˜è®¤åˆå§‹åŒ–ï¼‰</td>
    </tr>
    <tr>
        <td>vector&ltT&gt v5{a, b, c, ...}</td>
        <td>v5åŒ…å«äº†åˆå§‹å€¼ä¸ªæ•°çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½è¢«èµ‹äºˆäº†ç›¸åº”çš„åˆå§‹å€¼(æ³¨æ„ä½¿ç”¨èŠ±æ‹¬å·)</td>
    </tr>
    <tr>
        <td>vector&ltT&gt v5 = {a, b, c, ...}</td>
        <td>ç­‰ä»·äºv5{a, b, c, ...}</td>
    </tr>
</table>    
<ul>
<li>
<p>åœ†æ‹¬å·ä¸èŠ±æ‹¬å·</p>
<ul>
<li>åœ†æ‹¬å·æ˜¯æä¾›çš„å€¼ç”¨æ¥æ„é€ (construct)vectorå¯¹è±¡çš„</li>
<li>èŠ±æ‹¬å·æ˜¯ç”¨æ¥è¿›è¡Œåˆ—è¡¨åˆå§‹åŒ–çš„(list initialize),åˆå§‹åŒ–è¿‡ç¨‹ä¼šå°½å¯èƒ½çš„æŠŠèŠ±æ‹¬å·å†…çš„å€¼å½“æˆæ˜¯å…ƒç´ åˆå§‹å€¼çš„åˆ—è¡¨æ¥å¤„ç†ï¼Œåªæœ‰åœ¨<u>æ— æ³•æ‰§è¡Œåˆ—è¡¨åˆå§‹åŒ–æ—¶æ‰ä¼šè€ƒè™‘å…¶ä»–åˆå§‹åŒ–æ–¹å¼</u> $\Longrightarrow$ åˆ—è¡¨å†…æ•°æ®ä¸æ‰€éœ€å…ƒç´ ç±»å‹ä¸åŒ</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v1</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="c1">// -&gt; {0, 0, 0, 0, 0, 0, 0, 0, 0, 0} 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v2</span><span class="p">{</span><span class="mi">10</span><span class="p">};</span> <span class="c1">// -&gt; {10}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// -&gt; {1, 1, 1, 1, 1, 1, 1, 1, 1, 1}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v4</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span> <span class="c1">// -&gt; {10, 1}
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>åˆ—è¡¨åˆå§‹åŒ–æ„é€ å¤±è´¥è½¬ä¸ºç›´æ¥æ„é€ </li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">v5</span><span class="p">{</span><span class="mi">10</span><span class="p">};</span> <span class="c1">//10ä¸ªé»˜è®¤åˆå§‹åŒ–string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">v8</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#34;hi&#34;</span><span class="p">};</span> <span class="c1">//10ä¸ª&#34;hi&#34;
</span></span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>vectoræœ‰å…³æ“ä½œ</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">vectoræ”¯æŒçš„æ“ä½œ</td>
	</tr>
    <tr>
        <td>v.empty()</td>
        <td>è¿”å›å…ƒç´ ä¸ªæ•°æ˜¯å¦ä¸ºç©º</td>
    </tr>
    <tr>
        <td>v.size()</td>
        <td>è¿”å›å…ƒç´ ä¸ªæ•°</td>
    </tr>
    <tr>
        <td>v.push_back(t)</td>
        <td>å‘vçš„å°¾ç«¯æ·»åŠ ä¸€ä¸ªå€¼ä¸ºtçš„å…ƒç´ </td>
    </tr>
    <tr>
        <td>v[n]</td>
        <td>ä¸‹æ ‡è®¿é—®ï¼Œè¿”å›ç¬¬nä¸ªä½ç½®ä¸Šå…ƒç´ çš„å¼•ç”¨</td>
    </tr>
    <tr>
        <td>v1 = v2</td>
        <td>ç”¨v2ä¸­å…ƒç´ çš„æ‹·è´æ›¿æ¢v1ä¸­çš„å…ƒç´ </td>
    </tr>
    <tr>
        <td>v1 = {a, b, c...}</td>
        <td>ç”¨åˆ—è¡¨ä¸­çš„å…ƒç´ æ‹·è´æ›¿æ¢v1ä¸­çš„å…ƒç´ </td>
    </tr>
    <tr>
        <td>v1 == v2; v1 != v2</td>
        <td>åˆ¤ç­‰æ¡ä»¶ï¼šå…ƒç´ æ•°é‡ç›¸ç­‰ä¸”å¯¹åº”ä½ç½®çš„å…ƒç´ å€¼ç›¸ç­‰(å¯¹è±¡éœ€è¦é‡è½½==å’Œ!=è¿ç®—ç¬¦)</td>
    </tr>
    <tr>
        <td>&lt, &lt=, &gt, &gt=</td>
        <td>å­—å…¸åºæ¯”è¾ƒï¼Œå¯¹è±¡éœ€è¦é‡è½½ç›¸åº”è¿ç®—ç¬¦</td>
    </tr>
</table> 
<ul>
<li>æœ‰å…³ä½¿ç”¨push_backçš„å»ºè®®</li>
</ul>
<ol>
<li>ä¸éœ€è¦åœ¨åˆ›å»º<code>vector</code>æ—¶ç¡®å®šå…¶ä¸­çš„å…ƒç´ åŠå…¶å¤§å°ï¼Œåç»­ä½¿ç”¨push_backå³å¯</li>
<li>åœ¨å¾ªç¯ä½“å†…éƒ¨åŒ…å«å‘<code>vector</code>å¯¹è±¡æ·»åŠ å…ƒç´ çš„æ“ä½œæ—¶ï¼Œä¸åº”è¯¥ä½¿ç”¨<code>foreach</code>å¾ªç¯</li>
</ol>
<ul>
<li>
<p>size()è¿”å›çš„ç±»å‹ä¸ºvector::size_type,åŒstring::size_type,ç”±å¤´æ–‡ä»¶å’Œæœºå™¨æ¥å†³å®šç±»å‹ï¼Œä¸‹æ ‡è¿ç®—ç¬¦å‚æ•°ç±»å‹ä¹Ÿæ˜¯å¦‚æ­¤(åŒstring)</p>
</li>
<li>
<p>è™½ç„¶vectorå¯ä»¥æ‰©å®¹ï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡ä¸‹æ ‡æ¥æ·»åŠ å…ƒç´ ï¼Œé€šè¿‡ä¸‹æ ‡è®¿é—®ä¸å­˜åœ¨çš„å…ƒç´ ä¼šäº§ç”Ÿéå¸¸ä¸¥é‡çš„åæœï¼Œä¾‹å¦‚ç¼“å†²åŒºæº¢å‡º(<code>buffer overflow</code>),ä¼šå¯¼è‡´å‡ºç°å®‰å…¨é—®é¢˜</p>
</li>
</ul>
<h3 id="è¿­ä»£å™¨ä»‹ç»ä¸ä½¿ç”¨">è¿­ä»£å™¨ä»‹ç»ä¸ä½¿ç”¨</h3>
<ul>
<li>ç›®çš„ï¼šè®¿é—®å¯¹è±¡ä¸­çš„å…ƒç´ </li>
<li>è¿­ä»£å™¨ç±»ä¼¼äºæŒ‡é’ˆç±»å‹ï¼Œ<u>ä¹Ÿæä¾›äº†å¯¹å¯¹è±¡çš„é—´æ¥è®¿é—®</u>ï¼Œä½¿ç”¨è¿­ä»£å™¨å¯ä»¥è®¿é—®æŸä¸ªå…ƒç´ ï¼Œä¹Ÿå¯ä»¥ä»ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå…ƒç´ </li>
<li>æœ‰æ•ˆä¸æ— æ•ˆè¿­ä»£å™¨
<ul>
<li>æœ‰æ•ˆï¼šè¿­ä»£å™¨æŒ‡å‘<u>æŸä¸ªå…ƒç´ æˆ–è€…å®¹å™¨ä¸­å°¾å…ƒç´ çš„ä¸‹ä¸€ä½ç½®</u></li>
<li>æ— æ•ˆï¼šé™¤äº†ä¸Šè¿°æŒ‡å‘çš„è¿­ä»£å™¨éƒ½æ— æ•ˆ</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>è·å–è¿­ä»£å™¨ï¼šè·å–è¿­ä»£å™¨ä¸èƒ½ä½¿ç”¨å–åœ°å€ç¬¦ï¼Œæœ‰ä¸“é—¨çš„æ–¹æ³•è¿›è¡Œè·å–ï¼Œå®¹å™¨ä¸€èˆ¬éƒ½æ”¯æŒ<b>begin</b>å’Œ<b>end</b>æ–¹æ³•
<ul>
<li>beginè¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨</li>
<li>endè¿”å›æŒ‡å‘å®¹å™¨<b>â€œå°¾å…ƒç´ çš„ä¸‹ä¸€ä½ç½®(one past the end)â€çš„è¿­ä»£å™¨</b>,è¿™æ ·çš„è¿­ä»£å™¨æ²¡æœ‰ä»€ä¹ˆå®é™…æ„ä¹‰ï¼Œåªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œè¡¨ç¤ºæˆ‘ä»¬å·²ç»å¤„ç†å®Œäº†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚endæˆå‘˜è¿”å›çš„è¿­ä»£å™¨é€šå¸¸è¢«ç§°ä¸º<b>å°¾åè¿­ä»£å™¨(off-the-end iterator)æˆ–å°¾è¿­ä»£å™¨(end iterator)</b></li>
<li><b>å¦‚æœå®¹å™¨ä¸ºç©ºï¼Œbeginå’Œendè¿”å›çš„æ˜¯åŒä¸€ä¸ªè¿­ä»£å™¨,éƒ½æ˜¯å°¾åè¿­ä»£å™¨(å¯ä»¥ä½œä¸ºå®¹å™¨çš„åˆ¤ç©ºæ‰‹æ®µï¼‰</b></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">b</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><table border="2" >
	<tr>
		<td colspan="2">æ ‡å‡†å®¹å™¨è¿­ä»£å™¨çš„è¿ç®—ç¬¦</td>
	</tr>
    <tr>
        <td>*iter</td>
        <td>è¿”å›è¿­ä»£å™¨iteræ‰€æŒ‡å…ƒç´ çš„å¼•ç”¨</td>
    </tr>
    <tr>
        <td>iter->men</td>
        <td>è§£å¼•ç”¨iterå¹¶è·å¾—è¯¥å…ƒç´ çš„åä¸ºmençš„æˆå‘˜ï¼Œç­‰ä»·äº(*iter).men</td>
    </tr>
    <tr>
        <td>++iter</td>
        <td>ä»¤iteræŒ‡ç¤ºå®¹å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </td>
    </tr>
    <tr>
        <td>--iter</td>
        <td>ä»¤iteræŒ‡ç¤ºå®¹å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </td>
    </tr>
    <tr>
        <td>iter1 == iter2; iter1 != iter2</td>
        <td>åˆ¤ç­‰æ¡ä»¶ï¼šä¸¤ä¸ªè¿­ä»£å™¨æŒ‡ç¤ºçš„æ˜¯åŒä¸€ä¸ªå…ƒç´ æˆ–è€…ä»–ä»¬æ˜¯åŒä¸€ä¸ªå®¹å™¨çš„å°¾åè¿­ä»£å™¨ï¼Œåˆ™ç›¸ç­‰ï¼›åä¹‹åˆ™ä¸ç­‰</td>
    </tr>
</table>    
<ul>
<li>è¯•å›¾è§£å¼•ç”¨ä¸€ä¸ªéæ³•è¿­ä»£å™¨æˆ–è€…å°¾åè¿­ä»£å™¨ä¹Ÿæ˜¯å±é™©è¡Œä¸ºï¼</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">string</span> <span class="nf">s</span><span class="p">(</span><span class="s">&#34;Some thing&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">())</span> <span class="p">{</span> <span class="c1">// -&gt; is empty?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="n">it</span> <span class="o">=</span> <span class="n">toupper</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€èˆ¬å¾ªç¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">ii</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å¤§å¤šæ•°æ ‡å‡†åº“å®¹å™¨çš„è¿­ä»£å™¨éƒ½å®šä¹‰äº†<code>==</code>å’Œ<code>!=</code>ï¼Œä½†æ˜¯å®ƒä»¬ä¸­çš„å¤§å¤šæ•°éƒ½æ²¡æœ‰å®šä¹‰<code>&lt;</code>è¿ç®—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨è¿­ä»£å™¨æ˜¯å°½é‡ä½¿ç”¨<code>==</code>å’Œ<code>!=</code></p>
</li>
<li>
<p>è¿­ä»£å™¨ç±»å‹</p>
<ul>
<li>iteratorå¯è¯»å¯å†™</li>
<li>const_iteratoråªè¯»</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">const_iterator</span> <span class="n">it</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å®é™…ä½¿ç”¨ä¸­ä½¿ç”¨autoè®©ç¼–è¯‘å™¨å†³å®šå³å¯</p>
</li>
<li>
<p><code>begin()</code>å’Œ<code>end</code>è‡ªå·±å†³å®šè¿”å›çš„æ˜¯å¦ä¸ºconstï¼Œå¦‚æœå¿…é¡»è¦ç”¨const_iterator,ä½¿ç”¨<code>cbegin()</code>å’Œ<code>cend()</code>å³å¯<code>C++ 11</code></p>
</li>
<li>
<p>æ³¨æ„ï¼Œå‡¡æ˜¯ä½¿ç”¨äº†è¿­ä»£å™¨çš„å¾ªç¯ä½“ï¼Œéƒ½ä¸è¦å‘è¿­ä»£å™¨æ‰€å±çš„å®¹å™¨ä¸­æ·»åŠ å…ƒç´ ï¼Œå¦åˆ™å¯èƒ½ä¼šé€ æˆè¿­ä»£å™¨å¤±æ•ˆ</p>
</li>
</ul>
<hr>
<ul>
<li>è¿­ä»£å™¨è¿ç®—</li>
</ul>
<table border="2" >
	<tr>
		<td colspan="2">è¿­ä»£å™¨è¿ç®—</td>
	</tr>
    <tr>
        <td>iter + n</td>
        <td>è¿­ä»£å™¨åŠ ä¸Šäº†ä¸€ä¸ªæ•´æ•°å€¼ä»å¾—ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡ç¤ºçš„æ–°ä½ç½®ä¸åŸæ¥ç›¸æ¯”å‘åç§»åŠ¨äº†è‹¥å¹²å…ƒç´ </td>
    </tr>
    <tr>
        <td>iter - n</td>
        <td>è¿­ä»£å™¨å‡å»äº†ä¸€ä¸ªæ•´æ•°å€¼ä»å¾—ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡ç¤ºçš„æ–°ä½ç½®ä¸åŸæ¥ç›¸æ¯”å‘å‰ç§»åŠ¨äº†è‹¥å¹²å…ƒç´ </td>
    </tr>
    <tr>
        <td>iter += n</td>
        <td>iter = iter + n</td>
    </tr>
    <tr>
        <td>iter -= n</td>
        <td>iter = iter - n</td>
    </tr>
    <tr>
        <td>iter1 - iter2</td>
        <td>ä¸¤ä¸ªè¿­ä»£å™¨ç›¸å‡çš„ç»“æœæ˜¯å®ƒä»¬ä¹‹é—´çš„è·ç¦»ï¼Œä¸¤ä¸ªè¿­ä»£å™¨å¿…é¡»æ˜¯åŒä¸€ä¸ªå®¹å™¨çš„æœ‰æ•ˆè¿­ä»£å™¨ï¼Œè¿”å›å€¼ç±»å‹ä¸º<b>difference_type(å¸¦ç¬¦å·ç±»å‹)</b></td>
    </tr>
    <tr>
        <td>&gt, &gt=, &lt, &lt=</td>
        <td>å…³ç³»è¿ç®—ç¬¦ï¼Œæ³¨æ„ä¸¤ä¸ªè¿­ä»£å™¨å¿…é¡»æ˜¯åŒä¸€ä¸ªå®¹å™¨çš„æœ‰æ•ˆè¿­ä»£å™¨</td>
    </tr>
</table>    
<h3 id="æ•°ç»„">æ•°ç»„</h3>
<ul>
<li>ç¼–è¯‘çš„æ—¶å€™æ•°ç»„çš„ç»´åº¦åº”è¯¥æ˜¯å·²çŸ¥çš„ï¼Œ<b>ç»´åº¦å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼</b></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span> <span class="c1">// ä¸æ˜¯å¸¸é‡è¡¨è¾¾å¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">constexpr</span> <span class="kt">unsigned</span> <span class="n">sz</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>  <span class="c1">//å¸¸é‡è¡¨è¾¾å¼
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><u>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¼šè¢«é»˜è®¤åˆå§‹åŒ–</u> $\Longrightarrow$ <b>è¿™é‡Œæ³¨æ„å¦‚æœé‡åˆ°äº†<code>new</code>å’Œ<code>delete</code>ç›¸å…³çš„ä¸€äº›æ“ä½œï¼Œä¸€å®šè¦é˜²æ­¢é»˜è®¤åˆå§‹åŒ–æ”¹å˜æŒ‡é’ˆæœ€åå¯¼è‡´<code>delete</code>é‡Šæ”¾å†…å­˜çš„æ—¶å€™ç¨‹åºå´©æºƒ</b></li>
</ul>
<figure><a class="lightgallery" href="/img/C&#43;&#43;%20Primer/chapter3-3.png" title="/img/C&#43;&#43; Primer/chapter3-3.png" data-thumbnail="/img/C&#43;&#43; Primer/chapter3-3.png" data-sub-html="<h2>HEAP CORRUPTION DETECTEDæŠ¥é”™è¯´æ˜åŠè§£å†³æ–¹æ¡ˆ</h2>">
        
    </a><figcaption class="image-caption"><a href="https://blog.csdn.net/weixin_44426759/article/details/107194567?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167729932416800182739726%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167729932416800182739726&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-107194567-null-null.142%5ev73%5ewechat,201%5ev4%5eadd_ask,239%5ev2%5einsert_chatgpt&amp;utm_term=heap%20corruption%20detected&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener noreffer">HEAP CORRUPTION DETECTEDæŠ¥é”™è¯´æ˜åŠè§£å†³æ–¹æ¡ˆ</a></figcaption>
    </figure>
<ul>
<li>æ˜¾å¼åˆå§‹åŒ– $\Longrightarrow$ é€šè¿‡åˆ—è¡¨åˆå§‹åŒ–æ•°ç»„</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">unsigned</span> <span class="n">sz</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">ia1</span><span class="p">[</span><span class="n">sz</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a2</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span> <span class="c1">//ç»´åº¦ä¸º3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">a3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span> <span class="c1">// {0, 1, 2, 0, 0} åé¢ä¼šé»˜è®¤åˆå§‹åŒ–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">a5</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span> <span class="c1">//é”™è¯¯ï¼Œåˆå§‹å€¼è¿‡å¤š
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å­—ç¬¦æ•°ç»„
<ul>
<li>å­—ç¬¦æ•°ç»„å¯ä»¥ç”¨å­—ç¬¦ä¸²å­—é¢å€¼è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯è¦æ³¨æ„æœ€åè¿˜æœ‰ä¸€ä¸ªç»ˆæ­¢ç¬¦</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">a</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello world&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;Daniel&#34;</span><span class="p">;</span> <span class="c1">//é”™è¯¯ï¼Œå¿½ç•¥äº†æœ€åçš„&#39;\0&#39;
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸èƒ½å°†æ•°ç»„çš„å†…å®¹æ‹·è´ç»™å…¶ä»–æ•°ç»„ä½œä¸ºå…¶åˆå§‹å€¼ï¼Œä¹Ÿä¸èƒ½ç”¨æ•°ç»„ä¸ºå…¶ä»–æ•°ç»„èµ‹å€¼</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[]{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a2</span><span class="p">[]</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="c1">//é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="c1">//é”™è¯¯
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æœ¬è´¨æ˜¯æŒ‡é’ˆçš„æ‹·è´ï¼Œæœ€åå®¹æ˜“å¯¼è‡´å‡ºç°å†…å­˜æ³„æ¼å’Œé‡æŒ‡é’ˆé—®é¢˜ï¼Œè™½ç„¶éƒ¨åˆ†ç¼–è¯‘å™¨æ”¯æŒä¸Šè¿°è¡Œä¸ºï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨æ€§å’Œé€šç”¨æ€§ï¼Œå°½é‡ä¸è¦å‡ºç°ä¸Šè¿°ä»£ç </p>
</blockquote>
<ul>
<li>
<p>é˜…è¯»æ•°ç»„å£°æ˜å«ä¹‰ï¼šç”±å†…å‘å¤–è¯»</p>
</li>
<li>
<p>æ•°ç»„ä¹Ÿå¯ä»¥ç”¨åŸºäºèŒƒå›´çš„forå¾ªç¯</p>
</li>
<li>
<p>è®¿é—®æ•°ç»„å…ƒç´ ä½¿ç”¨çš„ä¸‹æ ‡ç”¨çš„ç±»å‹ä¸º<code>size_t</code>ï¼Œä¹Ÿæ˜¯ä¸€ç§æœºå™¨ç›¸å…³ç±»å‹ï¼Œå¤´æ–‡ä»¶Cï¼š<b>&lt;stddef.h&gt;</b> $\Longrightarrow$ C++ï¼š<b>&lt;cstddef&gt;</b>ï¼Œä½†æ˜¯å†…ç½®ä¸‹æ ‡è¿ç®—ç¬¦ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°(ä¸åŒäºvectorå’Œstring)</p>
</li>
<li>
<p>æ•°ç»„çš„ä¸‹æ ‡è®¿é—®åŒæ ·åªç”±ç¨‹åºå‘˜è´Ÿè´£æ£€æŸ¥ï¼Œä¸€å®šè¦é˜²æ­¢éæ³•è®¿é—®</p>
</li>
<li>
<p><code>auto</code>è¿”å›çš„æ˜¯æŒ‡é’ˆ,<code>decltype</code>è¿”å›çš„æ˜¯æ•°ç»„</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//æŒ‡é’ˆè¿­ä»£å™¨ç”¨æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">]{};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">e</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span> <span class="n">b</span> <span class="o">!=</span> <span class="n">e</span><span class="p">;</span> <span class="n">b</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">do_something</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>C++11åå¼•å…¥äº†beginå’Œendå‡½æ•°(å®šä¹‰äº&lt;iterator&gt;ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå‡½æ•°è·å¾—çš„æŒ‡é’ˆæ¥æ¨¡æ‹Ÿè¿­ä»£å™¨</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">arr</span><span class="p">[]{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="o">*</span><span class="n">begin</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="o">*</span><span class="n">end</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">end</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(;</span> <span class="n">begin</span> <span class="o">!=</span> <span class="n">end</span><span class="p">;</span> <span class="n">begin</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">begin</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>ä¸¤ä¸ªæŒ‡é’ˆç›¸å‡çš„ç»“æœç±»å‹æ˜¯<code>ptrdiff_t</code>çš„æœºå™¨ç›¸å…³æœ‰ç¬¦å·ç±»å‹ï¼Œå®šä¹‰äº&lt;cstddef&gt;æ–‡ä»¶ä¸­</p>
</li>
<li>
<p>åŒä¸€æ•°ç»„çš„ä¸¤ä¸ªæœ‰æ•ˆæŒ‡é’ˆå¯ä»¥è¿›è¡Œæ¯”è¾ƒ</p>
</li>
<li>
<p>Cé£æ ¼çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ä½äºå¤´æ–‡ä»¶&lt;cstring&gt;ä¸­ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿æ€§å’Œå®‰å…¨æ€§ï¼ŒC++ç¨‹åºä¸­å°½é‡ä½¿ç”¨std::string</p>
</li>
<li>
<p>Cé£æ ¼çš„å­—ç¬¦ä¸²æ¯”è¾ƒå®é™…æ˜¯åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²æ•°ç»„é¦–åœ°å€</p>
</li>
<li>
<p>æ—§ä»£ç æ¥å£</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">string</span> <span class="n">s</span> <span class="p">{</span><span class="s">&#34;Hello world&#34;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ä½†æ˜¯åœ¨åç»­ç”±äºæ‰©å®¹ç­‰æœºåˆ¶c_str()çš„æŒ‡é’ˆå¯èƒ½ä¼šå¤±å»ä½œç”¨ï¼Œæœ€å¥½é€šè¿‡s.c_str()æ‹·è´å¤åˆ¶ä¸€ä»½
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">arr</span><span class="p">[]{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="p">(</span><span class="n">begin</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">end</span><span class="p">(</span><span class="n">arr</span><span class="p">));</span> <span class="c1">// -&gt; {0, 1, 2, 3, 4, 5}
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><u>å»ºè®®ï¼šå°½é‡ä½¿ç”¨æ ‡å‡†åº“è€ŒéæŒ‡é’ˆå’Œæ•°ç»„</u></li>
</ul>
<blockquote>
<p>å¤šç»´æ•°ç»„åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼Œé™¤äº†æœ€å†…å±‚ï¼Œå…¶ä»–æ‰€æœ‰å¾ªç¯çš„æ§åˆ¶å˜é‡éƒ½åº”è¯¥æ˜¯å¼•ç”¨ï¼ˆè½¬åŒ–ä¸ºæ•°ç»„ï¼Œå¦‚æœä¸æ˜¯å¼•ç”¨ä¼šè½¬åŒ–ä¸ºæŒ‡é’ˆ)</p>
<p>for (auto &amp;i : arr)</p>
<p>â€‹	for (auto &amp;j : i)</p>
<p>â€‹		for (auto k : j) {</p>
<p>â€‹			do_something(k);</p>
<p>}</p>
</blockquote>
<div id="id-1"><strong>Ending</strong></div>
]]></description>
</item>
<item>
    <title>CMU 15-445 Lecture #01: Course Overview &amp; Relational Model</title>
    <link>https://Jungle430.github.io/posts/cmu-15-445-database-systems/chapter1/</link>
    <pubDate>Wed, 22 Feb 2023 15:23:14 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/cmu-15-445-database-systems/chapter1/</guid>
    <description><![CDATA[<h1 id="cmu-15-445-database-systems">CMU 15-445 Database Systems</h1>
<h2 id="lecture-01-course-overview--relational-model">Lecture #01: Course Overview &amp; Relational Model</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>Course Logistics</li>
<li>Relational Model</li>
<li>Relational Algebra</li>
</ul>
<h3 id="course-overiew">Course overiew</h3>
<ul>
<li>This course is about the design/implementation of database management systems (<code>DBMSs</code>)</li>
<li>This is <strong>not</strong> a course ($\rightarrow Key\ point\ is\ the\ theory\ and\ the\ concept$) about how to use a DBMS to build applications or how to administer a DBMS.â†’ See <a href="http://www.heinz.cmu.edu/academic-resources/course-results/course-details/index.aspx?cid=273" target="_blank" rel="noopener noreffer">CMU 95-703</a> (Heinz College)</li>
</ul>
<h3 id="projects">PROJECTS</h3>
<ul>
<li>
<p>All projects will use the CMU DB Group <a href="https://github.com/cmu-db/bustub" target="_blank" rel="noopener noreffer">BusTub</a> academic DBMS.</p>
<ul>
<li>â†’ Each project builds on the previous one.</li>
<li>â†’ We will not teach you how to write/debug C++17</li>
</ul>
</li>
<li>
<p><strong>complete <a href="https://15445.courses.cs.cmu.edu/fall2022/project0/" target="_blank" rel="noopener noreffer">Project #0</a> ! ! !</strong></p>
</li>
</ul>
<h3 id="database">Database</h3>
<ul>
<li>
<p><strong>Organized collection of inter-related data that models some aspect of the real-world</strong></p>
</li>
<li>
<p><strong>Databases are the core component of most computer applications</strong></p>
</li>
</ul>
<h4 id="example">Example</h4>
<p>Create a database that models a digital music store to keep track of artists and albums</p>
<ul>
<li>Things we need for our store
<ul>
<li>Information about <code>Artists</code></li>
<li>What <code>Albums</code> those Artists released</li>
</ul>
</li>
</ul>
<h5 id="flat-file-strawman">FLAT FILE STRAWMAN</h5>
<ul>
<li>
<p>Store our database as <strong>comma-separated value (CSV)</strong> files that we manage ourselves in our application code</p>
<ul>
<li>
<p>Use a separate file per entity</p>
</li>
<li>
<p>The application must parse the files each time they want to read/update records</p>
</li>
</ul>
</li>
<li>
<p>Create a database that models a digital music store</p>
</li>
</ul>
<p>Artist(name, year, country)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;Wu-Tang Clan&#34;</span><span class="err">,</span><span class="mi">1992</span><span class="err">,</span><span class="s2">&#34;USA&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Notorious BIG&#34;</span><span class="err">,</span><span class="mi">1992</span><span class="err">,</span><span class="s2">&#34;USA&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;GZA&#34;</span><span class="err">,</span><span class="mi">1990</span><span class="err">,</span><span class="s2">&#34;USA&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Album(name, artist, year)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;Enter the Wu-Tang&#34;</span><span class="err">,</span><span class="s2">&#34;Wu-Tang Clan&#34;</span><span class="err">,</span><span class="mi">1993</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;St.Ides Mix Tape&#34;</span><span class="err">,</span><span class="s2">&#34;Wu-Tang Clan&#34;</span><span class="err">,</span><span class="mi">1994</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Liquid Swords&#34;</span><span class="err">,</span><span class="s2">&#34;GZA&#34;</span><span class="err">,</span><span class="mi">1990</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="our-code">Our Code</h5>
<ul>
<li>Example: Get the year that GZA went solo $\rightarrow$ Artist</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="n">record</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;GZA&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="problem-about-flat-files-rightarrow-data-integrity">Problem about FLAT FILES $\rightarrow$ DATA-INTEGRITY</h4>
<ul>
<li>
<p>How do we ensure that the artist is the same for each album entry?</p>
</li>
<li>
<p>What if somebody overwrites the album year with an invalid string?</p>
</li>
<li>
<p>What if there are multiple artists on an album?</p>
</li>
<li>
<p>What happens if we delete an artist that has albums?</p>
</li>
</ul>
<h4 id="problem-about-flat-files-rightarrow-implementation">Problem about FLAT FILES $\rightarrow$ IMPLEMENTATION</h4>
<ul>
<li>
<p>How do you find a particular record?</p>
</li>
<li>
<p>What if we now want to create a new application that uses the same database?</p>
</li>
<li>
<p>What if two threads try to write to the same file at the same time?</p>
</li>
</ul>
<h4 id="problem-about-flat-files-rightarrow-durability">Problem about FLAT FILES $\rightarrow$ DURABILITY</h4>
<ul>
<li>
<p>What if the machine crashes while our program is updating a record?</p>
</li>
<li>
<p>What if we want to replicate the database on multiple machines for high availability?</p>
</li>
</ul>
<h3 id="database-management-system">DATABASE MANAGEMENT SYSTEM</h3>
<ul>
<li>
<p>A <u>database management system</u> (<strong>DBMS</strong>) is software that allows applications to <strong>store and analyze information in a database</strong></p>
</li>
<li>
<p>A general-purpose DBMS supports the <u>definition, creation, querying, update, and administration of databases</u> in accordance with some <u>data model</u></p>
</li>
</ul>
<h4 id="early-dbmss">EARLY DBMSs</h4>
<blockquote>
<p>Early database applications were difficult to build and maintain on available DBMSs in the 1960s</p>
<blockquote>
<p>Examples: IDS, IMS, CODASYL</p>
<p>Computers were expensive, humans were cheapğŸ˜‚</p>
</blockquote>
</blockquote>
<ul>
<li><u>Tight coupling</u> between <strong>logical</strong> and <strong>physical</strong> layers</li>
<li>Programmers had to (roughly) know what queries the application would execute before they could deploy the databaseğŸ˜Ÿ</li>
</ul>
<blockquote>
<p><strong>Ted Codd</strong> was a <u>mathematician</u> working at IBM Research in the late 1960s</p>
<p>He saw IBM&rsquo;s developers spending their time <strong>rewriting database programs</strong> every time <u>the databaseâ€™s schema or layout changed</u>ğŸ˜¨</p>
<p>Devised the <strong>relational model</strong> in 1969</p>
</blockquote>
<h3 id="relational-model">RELATIONAL MODEL</h3>
<ul>
<li>
<p>The relational model defines a database abstraction based on relations to avoid maintenance overhead</p>
</li>
<li>
<p>Key tenets</p>
<ul>
<li>Store database in simple data structures (relations)</li>
<li>Physical storage left up to the DBMS implementation</li>
<li>Access data through high-level language, DBMS figures out best execution strategy</li>
</ul>
</li>
<li>
<p><strong>Structure:</strong> The definition of the database&rsquo;s relations and their contents</p>
</li>
<li>
<p><strong>Integrity:</strong> Ensure the database&rsquo;s contents satisfy constraints</p>
</li>
<li>
<p><strong>Manipulation:</strong> Programming interface for accessing and modifying a database&rsquo;s contents</p>
</li>
</ul>
<hr>
<ul>
<li>A <u>relation</u> is an unordered set that contain the relationship of attributes that represent entities</li>
<li>A <u>tuple</u> is a set of attribute values (also known as its <u>domain</u>) in the relation
<ul>
<li>Values are (normally) atomic/scalar</li>
<li>The special value <strong>NULL</strong> is a member of every domain (if allowed)</li>
</ul>
</li>
</ul>
<p>Artist(name, year, country)</p>
<table>
<thead>
<tr>
<th>name</th>
<th>year</th>
<th>country</th>
</tr>
</thead>
<tbody>
<tr>
<td>Wu-Tang Clan</td>
<td>1992</td>
<td>USA</td>
</tr>
<tr>
<td>Notorious BIG</td>
<td>1992</td>
<td>USA</td>
</tr>
<tr>
<td>GZA</td>
<td>1990</td>
<td>USA</td>
</tr>
</tbody>
</table>
<p>$$
n-ary\ Relation=Table\ with\ n\ columns\newline
$$</p>
<h4 id="relational-model-primary-keys">RELATIONAL MODEL: PRIMARY KEYS</h4>
<ul>
<li>A relation&rsquo;s <u>primary key</u> <strong>uniquely</strong> identifies a single tuple</li>
<li>Some <code>DBMSs</code> automatically create an internal primary key if a table does not define one</li>
<li>Auto-generation of unique integer primary keys
<ul>
<li>â†’ <strong>SEQUENCE</strong> (SQL:2003)</li>
<li>â†’ <strong>AUTO_INCREMENT</strong> (MySQL)</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>year</th>
<th>country</th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>Wu-Tang Clan</td>
<td>1992</td>
<td>USA</td>
</tr>
<tr>
<td>456</td>
<td>Notorious BIG</td>
<td>1992</td>
<td>USA</td>
</tr>
<tr>
<td>789</td>
<td>GZA</td>
<td>1990</td>
<td>USA</td>
</tr>
</tbody>
</table>
<h4 id="relational-model-foreign-keys">RELATIONAL MODEL: FOREIGN KEYS</h4>
<ul>
<li>A <u>foreign key</u> specifies that an attribute <strong>from one relation</strong> has to <strong>map to a tuple in another relation</strong></li>
</ul>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-1.png" title="/img/CMU 15-445 Database Systems/chapter1-1.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-1.png">
        
    </a>
<h3 id="data-models">DATA MODELS</h3>
<ul>
<li>
<p>A <u>data model</u> is a collection of concepts for describing the data in a database</p>
</li>
<li>
<p>A <u>schema</u> is a description of a particular collection of data, <u>using a given data model</u></p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Example</p>
<ul>
<li>
<p><strong>Relational</strong> $\leftarrow This\ Course\newline$</p>
</li>
<li>
<p>Key/Value</p>
</li>
<li>
<p>Graph</p>
</li>
<li>
<p>Document / Object</p>
</li>
<li>
<p>Wide-Column / Column-family</p>
</li>
<li>
<p>Array / Matrix / Vectors</p>
</li>
<li>
<p>Hierarchical</p>
</li>
<li>
<p>Network</p>
</li>
<li>
<p>Multi-Value</p>
</li>
</ul>
</li>
</ul>
<h3 id="data-manipulation-languages-dml">DATA MANIPULATION LANGUAGES (DML)</h3>
<ul>
<li>
<p>Methods to store and retrieve information from a database</p>
</li>
<li>
<p><strong>Procedural:</strong></p>
<ul>
<li>â†’ The query specifies the (high-level) strategy to find the desired result based on sets / bags $\leftarrow Relational\ Algebra\newline$</li>
</ul>
</li>
<li>
<p><strong>Non-Procedural (Declarative):</strong></p>
<ul>
<li>â†’ The query specifies only what data is wanted and not how to find it. $\leftarrow Relational\ Calculus\newline$</li>
</ul>
</li>
</ul>
<h3 id="relational-algebra">RELATIONAL ALGEBRA</h3>
<ul>
<li>
<p>Fundamental operations to retrieve and manipulate tuples in a relation</p>
<ul>
<li>â†’ Based on set algebra</li>
</ul>
</li>
<li>
<p>Each operator takes one or more relations as its inputs and outputs a new relation</p>
<ul>
<li>â†’ We can &ldquo;chain&rdquo; operators together to create more complex operations</li>
</ul>
</li>
</ul>
<p>$$
\begin{align}
&amp;\sigma\Longrightarrow Select\newline
&amp;\prod\Longrightarrow Projection\newline
&amp;\cup\Longrightarrow Union\newline
&amp;\cap\Longrightarrow Intersection\newline
&amp;-\Longrightarrow Difference\newline
&amp;\times\Longrightarrow Product\newline
&amp;\bowtie\Longrightarrow Join\newline
\end{align}
$$</p>
<h4 id="select">SELECT</h4>
<ul>
<li>
<p>Choose a subset of the tuples from a relation that satisfies a selection predicate</p>
<ul>
<li>
<p>Predicate acts as a filter to retain only tuples that fulfill its qualifying requirement</p>
</li>
<li>
<p>Can combine multiple predicates using conjunctions / disjunctions</p>
</li>
</ul>
</li>
</ul>
<p>$$
Syntax:\sigma_{predicate}(R)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-2.png" title="/img/CMU 15-445 Database Systems/chapter1-2.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-2.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">a_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;a2&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">b_id</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">102</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="projection">PROJECTION</h4>
<ul>
<li>
<p>Generate a relation with tuples that contains only the specified attributes</p>
<ul>
<li>
<p>Can rearrange attributesâ€™ ordering</p>
</li>
<li>
<p>Can manipulate the values</p>
</li>
</ul>
</li>
</ul>
<p>$$
Syntax:\prod_{A_1, A_2, &hellip;A_n}(R)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-3.png" title="/img/CMU 15-445 Database Systems/chapter1-3.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-3.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">b_id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">a_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;a2&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="union">UNION</h4>
<ul>
<li>Generate a relation that contains all tuples that <strong>appear in either only one or both input relations</strong></li>
</ul>
<p>$$
Syntax:(R\cup S)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-4.png" title="/img/CMU 15-445 Database Systems/chapter1-4.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-4.png">
        
    </a>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-5.png" title="/img/CMU 15-445 Database Systems/chapter1-5.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-5.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="intersection">INTERSECTION</h4>
<ul>
<li>Generate a relation that contains only the tuples that <strong>appear in both of the input relations</strong></li>
</ul>
<p>$$
Syntax:(R\cap S)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-6.png" title="/img/CMU 15-445 Database Systems/chapter1-6.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-6.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="k">INTERSECT</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="difference">DIFFERENCE</h4>
<ul>
<li>Generate a relation that contains only the tuples that appear in the first and not the second of the input relations</li>
</ul>
<p>$$
Syntax:(R-S)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-7.png" title="/img/CMU 15-445 Database Systems/chapter1-7.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-7.png">
        
    </a>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-8.png" title="/img/CMU 15-445 Database Systems/chapter1-8.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-8.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="k">EXCEPT</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="product">PRODUCT</h4>
<ul>
<li>Generate a relation that contains all possible combinations of tuples from the input relations(<code>combination</code>)</li>
</ul>
<p>$$
Syntax:(R\times S)
$$</p>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-9.png" title="/img/CMU 15-445 Database Systems/chapter1-9.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-9.png">
        
    </a>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">CROSS</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="join-">JOIN !</h4>
<ul>
<li>Generate a relation that contains all tuples that are a combination of two tuples (one from each input relation) with a common value(s) for one or more attributes</li>
</ul>
<p>$$
Syntax:(R\bowtie S)
$$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>R</li>
</ul>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>1</td>
</tr>
<tr>
<td>b</td>
<td>2</td>
</tr>
</tbody>
</table>
<ul>
<li>S</li>
</ul>
<table>
<thead>
<tr>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>x</td>
</tr>
<tr>
<td>1</td>
<td>y</td>
</tr>
<tr>
<td>3</td>
<td>z</td>
</tr>
</tbody>
</table>
<ul>
<li>$R\bowtie S$</li>
</ul>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>1</td>
<td>x</td>
</tr>
<tr>
<td>a</td>
<td>1</td>
<td>y</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">a_id</span><span class="p">,</span><span class="w"> </span><span class="n">b_id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-10.png" title="/img/CMU 15-445 Database Systems/chapter1-10.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-10.png">
        
    </a>
<h4 id="extra-operators">EXTRA OPERATORS</h4>
<ul>
<li>
<p>Rename($\rho$)</p>
</li>
<li>
<p>Assignment($R \leftarrow S$)</p>
</li>
<li>
<p>Duplicate Elimination($\delta$)</p>
</li>
<li>
<p>Aggregation($\gamma$)</p>
</li>
<li>
<p>Sorting($\tau$)</p>
</li>
<li>
<p>Division($R\div S$)</p>
</li>
</ul>
<h4 id="observation">OBSERVATION</h4>
<blockquote>
<p>Relational algebra is a procedural language because it defines the high level-steps of how to compute a query. For example, $\sigma_{b_id=102}(R\bowtie S)$ is saying to first do the join of R and S and then do the select,whereas $(R \bowtie (\sigma_{b_id=102}(S)))$ will do the select on S first, and then do the join. These two statements will actually produce the same answer, but if there is only 1 tuple in S with b_id=102 out of a billion tuples, then$(R \bowtie (\sigma_{b_id=102}(S)))$ will be significantly faster than $\sigma_{b_id=102}(R\bowtie S)$ğŸ˜‚</p>
</blockquote>
<blockquote>
<p>A better approach is to say the result you want (state $\rightarrow$<u>retrieve the joined tuples from R and S where b_id equals 102</u>), and let the DBMS decide the steps it wants to take to compute the query. SQL will do exactly this,and it is the de facto standard for writing queries on relational model databasesğŸ®</p>
</blockquote>
<h4 id="queries">QUERIES</h4>
<ul>
<li>
<p>The relational model is independent of any query language implementation.</p>
</li>
<li>
<p><strong>SQL</strong> is the <em>de facto</em> standard (many dialects)</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="n">record</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;GZA&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">artists</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;GZA&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="document-data-model">DOCUMENT DATA MODEL</h3>
<ul>
<li>Embed data hierarchy into a single objectâŒ</li>
</ul>
<a class="lightgallery" href="/img/CMU%2015-445%20Database%20Systems/chapter1-11.png" title="/img/CMU 15-445 Database Systems/chapter1-11.png" data-thumbnail="/img/CMU 15-445 Database Systems/chapter1-11.png">
        
    </a>
<div class="mermaid" id="id-1"></div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Artist</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">year</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Album</span> <span class="n">albums</span><span class="o">[];</span>
</span></span><span class="line"><span class="cl"><span class="o">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Album</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">year</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>$$
\Downarrow
$$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;GZA&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="mi">1990</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;albums&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Liquid Swords&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="mi">1995</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Beneath the Surface&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;year&#34;</span><span class="p">:</span> <span class="mi">1999</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="conclusion">CONCLUSION</h3>
<ul>
<li>
<p>Databases are ubiquitous</p>
</li>
<li>
<p>Relational algebra defines the primitives for processing queries on a relational database.</p>
</li>
<li>
<p>We will see relational algebra again when we talk about query optimization + execution</p>
</li>
</ul>
]]></description>
</item>
<item>
    <title>Computer Organization and Architecture Parallel Process &amp; Multicore Computers</title>
    <link>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-parallel-process-multicore-computers/</link>
    <pubDate>Wed, 01 Feb 2023 01:31:38 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-parallel-process-multicore-computers/</guid>
    <description><![CDATA[<h1 id="computer-organization-and-architecture">Computer Organization and Architecture</h1>
<h2 id="parallel-process--multicore-computers">Parallel Process &amp; Multicore Computers</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>
<p>Parallel Processing</p>
<ul>
<li>Multiple Processor Organizations</li>
<li>Symmetric Multiprocessors</li>
<li>Clusters</li>
<li>Nonuniform Memory Access</li>
<li>Vector Computation</li>
</ul>
</li>
<li>
<p>Multicore Computers</p>
</li>
</ul>
<h3 id="multiple-processor-organizations">Multiple Processor Organizations</h3>
<h4 id="types-of-multiple-processor">Types of multiple processor</h4>
<ul>
<li>
<p>Single instruction, single data stream â€“ <code>SISD</code></p>
</li>
<li>
<p>Single instruction, multiple data stream â€“ <code>SIMD</code></p>
</li>
<li>
<p>Multiple instruction, single data stream â€“ <code>MISD</code></p>
</li>
<li>
<p>Multiple instruction, multiple data stream - <code>MIMD</code></p>
</li>
</ul>
<h4 id="sisd-organizations">SISD Organizations</h4>
<div class="mermaid" id="id-1"></div>
<ul>
<li>
<p>SISDçš„ç»“æ„ä¸­åŒ…å«1ä¸ªCUæ§åˆ¶å•å…ƒï¼Œ1ä¸ªPUå¤„ç†å•å…ƒï¼Œä»¥åŠ1ä¸ªMUå­˜å‚¨å•å…ƒ</p>
</li>
<li>
<p>CUå‘PUå‘é€æŒ‡ä»¤æµï¼ŒMUå‘PUå‘é€æ•°æ®æµ</p>
</li>
<li>
<p>PUæ ¹æ®CUå‘é€çš„æŒ‡ä»¤æµï¼Œå¯¹æ¥è‡ªMUçš„æ•°æ®æµè¿›è¡Œæ“ä½œï¼Œå¹¶äº§ç”Ÿç»“æœã€‚</p>
</li>
<li>
<p>SISDå¹¶æ²¡æœ‰å¹¶è¡Œçš„èƒ½åŠ›ï¼ŒPUæŒ‰ç…§CUæä¾›çš„æŒ‡ä»¤æµï¼Œè¿›è¡Œç›¸åº”çš„æ“ä½œ</p>
</li>
</ul>
<div class="mermaid" id="id-2"></div>
<ul>
<li>
<p>SIMDï¼Œå•æŒ‡ä»¤å¤šæ•°æ®æµï¼Œç»“æ„ä¸­åŒ…å«1ä¸ªæ§åˆ¶å•å…ƒï¼Œå¤šä¸ªå¤„ç†å•å…ƒã€‚æ¯ä¸ªå¤„ç†å•å…ƒæœ‰è‡ªå·±çš„å­˜å‚¨å™¨</p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒå°†æŒ‡ä»¤æµå‘é€ç»™å¤šä¸ªå¤„ç†å•å…ƒè¿›è¡ŒåŒæ­¥å¤„ç†ï¼ŒåŒæ­¥å¤„ç†é‡‡ç”¨çš„æ˜¯é”æ­¥æ–¹å¼</p>
</li>
<li>
<p>ä¸åŒçš„å¤„ç†å™¨åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šæ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œäº§ç”Ÿä¸åŒçš„å¤„ç†ç»“æœ</p>
</li>
<li>
<p>å®è´¨æ˜¯å¯¹ä¸åŒçš„æ•°æ®é›†è¿›è¡Œç›¸åŒçš„å¤„ç†ï¼Œé€šè¿‡å¹¶è¡Œå¾—åˆ°ä¸€ç»„ç»“æœï¼Œå¹¶è¡Œå¤„ç†æé«˜æ•ˆç‡</p>
</li>
<li>
<p>çŸ¢é‡å’Œé˜µåˆ—å¤„ç†å™¨å±äºSIMDç±»å‹</p>
</li>
</ul>
<h4 id="misd">MISD</h4>
<ul>
<li>
<p>Sequence of data</p>
</li>
<li>
<p>Transmitted to set of processors</p>
</li>
<li>
<p>Each processor executes different instruction sequence</p>
</li>
<li>
<p>Never been implemented</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter17-1.png" title="/img/Computer Organization and Architecture/chapter17-1.png" data-thumbnail="/img/Computer Organization and Architecture/chapter17-1.png" data-sub-html="<h2>MIMD Organizations</h2>">
        
    </a><figcaption class="image-caption"><code>MIMD Organizations</code></figcaption>
    </figure>
<ul>
<li>
<p>MIMDï¼Œå¤šæŒ‡ä»¤å¤šæ•°æ®æµæ¶æ„ï¼Œå¤šä¸ªæ§åˆ¶å•å…ƒCUï¼Œå¤šä¸ªå¤„ç†å•å…ƒPUã€‚å­˜å‚¨æ–¹é¢ï¼Œæœ‰ä¸¤ç§ç»“æ„</p>
<ul>
<li>
<p>å…±äº«å­˜å‚¨å™¨ï¼šæ‰€æœ‰çš„PUå…±äº«ä¸€ä¸ªå­˜å‚¨å™¨ï¼Œæ•°æ®éƒ½å­˜å‚¨åœ¨å…±äº«å­˜å‚¨å™¨ä¸­</p>
</li>
<li>
<p>åˆ†å¸ƒå¼å­˜å‚¨ï¼šæ¯ä¸ªPUéƒ½æœ‰è‡ªå·±çš„LMï¼Œè¿™äº›æœºå™¨é€šè¿‡äº’è”ç½‘è¿æ¥åœ¨ä¸€èµ·</p>
</li>
</ul>
</li>
<li>
<p>ä¸€ç»„å¤„ç†å™¨ï¼Œèƒ½å¤ŸåŒæ—¶æ‰§è¡Œä¸åŒçš„æŒ‡ä»¤åºåˆ—ã€‚æ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„æ•°æ®é›†ã€‚</p>
</li>
<li>
<p>å¯¹ç§°å¤šå¤„ç†SMPï¼Œé›†ç¾¤ï¼Œéå‡åŒ€å­˜å‚¨å™¨è®¿é—®NUMAç­‰ï¼Œéƒ½å±äºMIMDæ¶æ„</p>
</li>
</ul>
<h3 id="symmetric-multiprocessors">Symmetric Multiprocessors</h3>
<h4 id="smp">SMP</h4>
<ul>
<li>
<p>Tightly Coupled</p>
</li>
<li>
<p>Processors share memory and I/O</p>
<ul>
<li>
<p>Share single memory or pool</p>
</li>
<li>
<p>Shared bus to access memory</p>
</li>
<li>
<p>Public area set in shared storage stores status information to achieve communication between processors</p>
</li>
<li>
<p>Memory access time to given area of memory is approximately the same for each processor</p>
</li>
</ul>
</li>
</ul>
<h4 id="characteristic-of-smp">Characteristic of SMP</h4>
<ul>
<li>
<p>Two or more processors with similar function</p>
<ul>
<li>
<p>All processors share memory and I/O</p>
</li>
<li>
<p>All processors share access to I/O</p>
</li>
<li>
<p>Perform the same function</p>
</li>
</ul>
</li>
<li>
<p>Controlled by a centralized operating system</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter17-2.png" title="/img/Computer Organization and Architecture/chapter17-2.png" data-thumbnail="/img/Computer Organization and Architecture/chapter17-2.png" data-sub-html="<h2>Symmetric Multiprocessor Organization</h2>">
        
    </a><figcaption class="image-caption"><code>Symmetric Multiprocessor Organization</code></figcaption>
    </figure>
<ul>
<li>
<p>æ¯ä¸ªå¤„ç†å™¨æœ‰è‡ªå·±çš„$L1\ cache$ï¼Œä¹Ÿå¯èƒ½ä¼šé…ç½®å„è‡ªçš„$L2\ cache\newline$</p>
</li>
<li>
<p>å¤„ç†å™¨éƒ½æŒ‚åœ¨å…±äº«çš„ç³»ç»Ÿæ€»çº¿ä¸Šï¼Œå…±äº«å¯¹ä¸»å­˜å‚¨å™¨çš„è®¿é—®</p>
</li>
<li>
<p>I/Oç³»ç»Ÿä¹ŸæŒ‚åœ¨ç³»ç»Ÿæ€»çº¿ä¸Šï¼Œå„ä¸ªå¤„ç†å™¨å¯¹I/Oç³»ç»Ÿè¿›è¡Œå…±äº«è®¿é—®</p>
</li>
</ul>
<h4 id="smp-advantages">SMP Advantages</h4>
<ul>
<li>
<p>High performance</p>
<ul>
<li>Greatly improved performance if some work can be done in parallel</li>
</ul>
</li>
<li>
<p>High availability</p>
<ul>
<li>
<p>All processors can perform the same functions</p>
</li>
<li>
<p>Failure of a single processor does not halt the system</p>
</li>
</ul>
</li>
<li>
<p>Incremental growth</p>
<ul>
<li>
<p>Flexible system expansion</p>
</li>
<li>
<p>User can enhance performance by adding additional processors</p>
</li>
</ul>
</li>
<li>
<p>Scaling</p>
<ul>
<li>
<p>Vendors can offer range of products based on number of processors</p>
</li>
<li>
<p>Different products have different prices and performance, which can give users more choices</p>
</li>
</ul>
</li>
</ul>
<h4 id="design-issues">Design issues</h4>
<ul>
<li>
<p>SMP system is managed by a unified operating system</p>
</li>
<li>
<p>Operating system is responsible for scheduling processes and resources</p>
</li>
<li>
<p>Operating system needs to complete</p>
<ul>
<li>
<p>Simultaneous concurrent processes</p>
</li>
<li>
<p>Scheduling</p>
</li>
<li>
<p>Synchronization</p>
</li>
<li>
<p>Memory management</p>
</li>
<li>
<p>Reliability and fault tolerance</p>
</li>
</ul>
</li>
<li>
<p>Simultaneous concurrent processes</p>
<ul>
<li>
<p>Allow multiple processors to execute the same piece of OS code at the same time</p>
</li>
<li>
<p>Manage OS tables and other structures to avoid deadlocks</p>
</li>
</ul>
</li>
<li>
<p>Scheduling</p>
<ul>
<li>Reasonably schedule the processor execution process</li>
</ul>
</li>
<li>
<p>Synchronization</p>
<ul>
<li>Provide synchronization mechanism to ensure mutual exclusion and order of memory and I/O access</li>
</ul>
</li>
<li>
<p>Memory management</p>
<ul>
<li>Solve concurrency and consistency problems</li>
<li>Ensure the performance and correctness under multiprocessors</li>
</ul>
</li>
<li>
<p>Reliability and fault tolerance</p>
<ul>
<li>For a processor failure, the operating system shall be able to reconstruct the system so that the system can be degraded for use</li>
</ul>
</li>
</ul>
<h3 id="clusters">Clusters</h3>
<ul>
<li>
<p>Loosely Coupled</p>
</li>
<li>
<p>Collection of independent uniprocessors or <code>SMPs</code></p>
</li>
<li>
<p>Interconnected to form a cluster</p>
</li>
<li>
<p>Communication via fixed path or network connections</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Composition of cluster</p>
<ul>
<li>
<p>A group of interconnected whole computers</p>
</li>
<li>
<p>Working together as unified resource</p>
</li>
<li>
<p>Illusion of being one machine</p>
</li>
<li>
<p>Each computer called a node</p>
</li>
</ul>
</li>
<li>
<p>Characteristics</p>
<ul>
<li>
<p>High performance</p>
</li>
<li>
<p>High availability</p>
</li>
<li>
<p>Alternative to SMP</p>
</li>
</ul>
</li>
<li>
<p>Server applications</p>
</li>
</ul>
<h4 id="cluster-benefits">Cluster Benefits</h4>
<ul>
<li>
<p>Absolute scalability</p>
<ul>
<li>
<p>Build hundreds of thousands of independent computers into a large cluster system, and the processing capacity may far exceed that of the largest independent computer</p>
</li>
<li>
<p>Each machine in the cluster can be a single processing system or a multiprocessor architecture</p>
</li>
</ul>
</li>
<li>
<p>Incremental scalability</p>
<ul>
<li>
<p>New nodes can be added to the cluster system step by step to improve processing capacity and gradually expand</p>
</li>
<li>
<p>Very flexible capacity expansion</p>
</li>
</ul>
</li>
<li>
<p>High availability</p>
<ul>
<li>
<p>Each node is an independent computer</p>
</li>
<li>
<p>The failure of one or more nodes will not affect the use of the cluster system</p>
</li>
<li>
<p>Node fault diagnosis and fault tolerance are automatically completed by the system</p>
</li>
</ul>
</li>
<li>
<p>Superior price/performance</p>
<ul>
<li>
<p>Combine mature commercial computers into a cluster</p>
</li>
<li>
<p>The system performance is far greater than that of a single large server</p>
</li>
<li>
<p>High cost performance</p>
</li>
</ul>
</li>
</ul>
<h4 id="blade-servers">Blade Servers</h4>
<ul>
<li>
<p><strong>Common implementation of cluster</strong></p>
</li>
<li>
<p>Server houses multiple server modules (blades) in single chassis</p>
<ul>
<li>
<p>Save space</p>
</li>
<li>
<p>Improve system management</p>
</li>
<li>
<p>Chassis provides power supply</p>
</li>
<li>
<p>Each blade has processor, memory, disk</p>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter17-3.png" title="/img/Computer Organization and Architecture/chapter17-3.png" data-thumbnail="/img/Computer Organization and Architecture/chapter17-3.png" data-sub-html="<h2>Blade Servers</h2>">
        
    </a><figcaption class="image-caption"><code>Blade Servers</code></figcaption>
    </figure>
<h4 id="cluster-v-smp">Cluster v. SMP</h4>
<ul>
<li>
<p>Both provide multiprocessor support to high demand applications</p>
</li>
<li>
<p>Both available commercially</p>
</li>
<li>
<p>SMP for longer</p>
</li>
</ul>
<hr>
<ul>
<li>
<p><code>SMP</code></p>
<ul>
<li>
<p>Easier to manage and control</p>
</li>
<li>
<p>Closer to single processor systems</p>
</li>
<li>
<p>Scheduling is important</p>
</li>
<li>
<p>Less physical space</p>
</li>
<li>
<p>Lower power consumption</p>
</li>
</ul>
</li>
<li>
<p>Clustering</p>
<ul>
<li>
<p>Superior incremental &amp; absolute scalability</p>
</li>
<li>
<p>Superior availability</p>
<ul>
<li>Redundancy</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="nonuniform-memory-access">Nonuniform Memory Access</h3>
<h4 id="numa">NUMA</h4>
<ul>
<li>
<p>Tightly Coupled</p>
</li>
<li>
<p>Nonuniform memory access</p>
<ul>
<li>Access times to different regions of memory may differ</li>
</ul>
</li>
<li>
<p>Main object</p>
<ul>
<li>
<p>Overcoming the limitation on the number of processors in SMP</p>
</li>
<li>
<p>It solves the problem caused by the independent memory used by each node in the cluster system</p>
</li>
</ul>
</li>
<li>
<p>Alternative to SMP &amp; clustering</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Uniform memory access</p>
<ul>
<li>
<p>All processors have access to all parts of memory</p>
</li>
<li>
<p>Using load &amp; store</p>
</li>
<li>
<p>Access time to all regions of memory is the same</p>
</li>
<li>
<p>Access time to memory for different processors same</p>
</li>
<li>
<p>As used by SMP</p>
</li>
</ul>
</li>
</ul>
<h4 id="nonuniform-memory-access-1">Nonuniform Memory Access</h4>
<ul>
<li>
<p>All processors have access to all parts of memory</p>
</li>
<li>
<p>Using load &amp; store</p>
</li>
<li>
<p>Access time of processor differs depending on region of memory</p>
</li>
<li>
<p>Different processors access different regions of memory at different speeds</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Cache coherent NUMA(<code>CC-NUMA</code>)</p>
<ul>
<li>
<p>Cache coherence is maintained among the caches of the various processors</p>
</li>
<li>
<p>For a system without cache consistency maintenance, it is similar to a cluster system</p>
</li>
<li>
<p><code>CC-NUMA</code> is discussed here</p>
</li>
<li>
<p>Significantly different from SMP and clusters</p>
</li>
</ul>
</li>
</ul>
<h4 id="motivation">Motivation</h4>
<ul>
<li>
<p>SMP has practical limit to number of processors</p>
<ul>
<li>Bus traffic limits to between 16 and 64 processors</li>
</ul>
</li>
<li>
<p>In clusterï¼Œeach node has own memory</p>
<ul>
<li>Apps do not see large global memory</li>
<li>Coherence maintained by software not hardware</li>
</ul>
</li>
<li>
<p>NUMA retains SMP flavour while giving large scale multiprocessing</p>
<ul>
<li>e.g. Silicon Graphics Origin NUMA 1024 MIPS R10000 processors</li>
</ul>
</li>
<li>
<p>Objective</p>
<ul>
<li>
<p>maintain transparent system wide memory while permitting multiprocessor nodes</p>
</li>
<li>
<p>each with own bus or internal interconnection system</p>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter17-4.png" title="/img/Computer Organization and Architecture/chapter17-4.png" data-thumbnail="/img/Computer Organization and Architecture/chapter17-4.png" data-sub-html="<h2>CC-NUMA Organization</h2>">
        
    </a><figcaption class="image-caption"><code>CC-NUMA Organization</code></figcaption>
    </figure>
<ul>
<li>
<p>NUMAç³»ç»Ÿç”±å¤šä¸ªç»“ç‚¹ç»„æˆã€‚æ¯ä¸ªèŠ‚ç‚¹åŒ…å«æœ‰è‹¥å¹²ä¸ªå¤„ç†å™¨ï¼Œæ¯ä¸ªå¤„ç†å™¨æœ‰è‡ªå·±çš„L1 cacheå’ŒL2 cacheï¼Œæœ‰è‡ªå·±çš„å†…éƒ¨æ€»çº¿ï¼Œå¹¶ä¸”æœ‰è‡ªå·±çš„ä¸»å­˜å’ŒI/O</p>
</li>
<li>
<p>å¤„ç†å™¨è®¿é—®å­˜å‚¨å™¨çš„æ—¶å€™ï¼Œé¦–å…ˆçœ‹æ˜¯å¦åœ¨cacheä¸­ï¼Œå¦‚æœä¸åœ¨ï¼Œcacheä¼šå»è®¿é—®æœ¬åœ°å­˜å‚¨å™¨ã€‚å¦‚æœåœ¨çš„è¯ï¼Œå°±é€šè¿‡å†…éƒ¨æ€»çº¿å–è¿‡æ¥ã€‚å¦‚æœä¸åœ¨æœ¬åœ°å­˜å‚¨å™¨ä¸­ï¼Œcacheä¼šå‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œé€šè¿‡äº’è”ç½‘ç»œä»è¿œç«¯å–è¿‡æ¥ï¼Œæ”¾åˆ°æ€»çº¿ä¸Šï¼Œå‘å‡ºè¯·æ±‚çš„cacheä»æ€»çº¿ä¸Šè¯»å–ã€‚è¿™äº›åŠ¨ä½œéƒ½æ˜¯è‡ªåŠ¨çš„ï¼Œå¯¹å¤„ç†å™¨å’Œcacheéƒ½æ˜¯é€æ˜çš„ã€‚</p>
</li>
</ul>
<h3 id="vector-computation">Vector Computation</h3>
<ul>
<li>
<p>Maths problems involving physical processes present different difficulties for computation</p>
<ul>
<li>
<p>Aerodynamics, seismology, meteorology</p>
</li>
<li>
<p>Continuous field simulation</p>
</li>
</ul>
</li>
<li>
<p>Requirement</p>
<ul>
<li>
<p>High precision</p>
</li>
<li>
<p>Repeated floating point calculations on large arrays of numbers</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>Solution 1: supercomputer</p>
<ul>
<li>
<p>Hundreds of millions of float</p>
</li>
<li>
<p>Optimized for Vector Computation</p>
</li>
<li>
<p>$10-15 million</p>
</li>
<li>
<p>Limited market</p>
</li>
<li>
<p>Research, government agencies, meteorology</p>
</li>
</ul>
</li>
<li>
<p>Solution 2:  Array processor</p>
<ul>
<li>
<p>Alternative to supercomputer</p>
</li>
<li>
<p>Configured as peripherals to mainframe &amp; mini</p>
</li>
<li>
<p>Just run vector portion of problems</p>
</li>
</ul>
</li>
</ul>
<h3 id="multicore-computers">Multicore Computers</h3>
<h4 id="what-is-multicore-computers">What is Multicore Computers?</h4>
<ul>
<li>
<p>Also known as single chip multiprocessor</p>
</li>
<li>
<p>Two or more processors are integrated on a single chip, and each processor is called a core</p>
</li>
<li>
<p>Each core consists of all components of an independent processor, including register set, ALU, pipeline hardware, control unit, and L1 data and instruction cache</p>
</li>
<li>
<p>Some multicore processors also include L2 cache and L3 cache on the chip</p>
</li>
</ul>
<h3 id="hardware-performance-issues">Hardware Performance Issues</h3>
<ul>
<li>
<p>Microprocessors have seen an exponential increase in performance</p>
<ul>
<li>
<p>Improved organization</p>
</li>
<li>
<p>Increased clock frequency</p>
</li>
</ul>
</li>
<li>
<p>Increase in Parallelism</p>
<ul>
<li>
<p>Pipelining</p>
</li>
<li>
<p>Superscalar</p>
</li>
<li>
<p>Simultaneous multithreading</p>
</li>
</ul>
</li>
</ul>
<h4 id="simultaneous-multithreading">Simultaneous multithreading</h4>
<ul>
<li>
<p>åŒæ­¥å¤šçº¿ç¨‹èƒ½å¤Ÿä»å¤šä¸ªçº¿ç¨‹ä¸­å–å‡ºæŒ‡ä»¤æ¥è¿è¡Œï¼Œå®ƒèƒ½å¤ŸåŒæ—¶æ‰§è¡Œä¸åŒçº¿ç¨‹çš„æŒ‡ä»¤</p>
</li>
<li>
<p>åŒæ­¥å¤šçº¿ç¨‹æ¶æ„ä¸­ï¼Œé…ç½®äº†å¤šä¸ªPCå’Œå¤šä¸ªå¯„å­˜å™¨ç»„ï¼Œåº•å±‚å…±äº«æŒ‡ä»¤cacheå’Œæ•°æ®cacheã€‚è¿™æ ·å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«æµæ°´çº¿èµ„æº</p>
</li>
<li>
<p>é€šè¿‡åŒæ­¥å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œç³»ç»Ÿèƒ½å¤ŸåŠ¨æ€è°ƒæ•´ç³»ç»Ÿç¯å¢ƒï¼Œå¦‚æœ‰å¯èƒ½åŒæ—¶æ‰§è¡Œä¸åŒçº¿ç¨‹çš„æŒ‡ä»¤ã€‚å½“ä¸€ä¸ªçº¿ç¨‹é‡åˆ°é•¿å»¶è¿Ÿäº‹ä»¶æ—¶ï¼Œå…è®¸å¦ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨æ‰€æœ‰çš„å¤„ç†å•å…ƒ</p>
</li>
</ul>
<h4 id="hardware-performance-issues-1">Hardware Performance Issues</h4>
<ul>
<li>
<p>Processor performance continues to improve</p>
<ul>
<li>
<p>Adjustment of chip architecture</p>
</li>
<li>
<p>Improvement of main frequency</p>
</li>
</ul>
</li>
<li>
<p>Diminishing returns</p>
<ul>
<li>
<p>More complexity requires more logic</p>
</li>
<li>
<p>Need more chip area for coordinating and signal transfer logic</p>
</li>
<li>
<p>Harder to design, make and debug</p>
</li>
<li>
<p>Hardware performance reaches the bottleneck, which is very difficult to improve</p>
</li>
</ul>
</li>
</ul>
<h4 id="power-consumption">Power consumption</h4>
<ul>
<li>
<p>Power requirements grow exponentially with chip density and clock frequency</p>
</li>
<li>
<p>Increased power consumption causes CPU cooling problems</p>
</li>
<li>
<p>It is increasingly difficult to improve performance by improving chip integration</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>One solution is use more chip area for cache</p>
<ul>
<li>
<p>Storage transistors require low power consumption</p>
</li>
<li>
<p>Cache is close to CPU and fast</p>
</li>
<li>
<p>By 2015ï¼Œ100 billion transistors on 300mm2 ï¼ŒCache of 100MB ï¼Œ1 billion transistors for logic</p>
</li>
</ul>
</li>
<li>
<p>Large capacity cache provides basic resources for multi-core processors</p>
</li>
</ul>
<h4 id="pollacks-rule">Pollackâ€™s rule</h4>
<ul>
<li>
<p>Pollackâ€™s rule</p>
<ul>
<li>
<p>Performance is roughly proportional to square root of increase in complexity</p>
</li>
<li>
<p>Double complexity gives 40% more performance</p>
</li>
</ul>
</li>
<li>
<p>So,integrating multiple processor cores on one chip becomes a better solution</p>
<ul>
<li>
<p>Multicore makes performance close to linear improvement</p>
</li>
<li>
<p>Unlikely that one core can use all cache effectively</p>
</li>
</ul>
</li>
</ul>
<h3 id="software-performance-issues">Software Performance Issues</h3>
<ul>
<li>
<p>Performance benefits dependent on effective exploitation of parallel resources</p>
<ul>
<li>
<p>Amdahlâ€™s Law</p>
</li>
<li>
<p>Even small amounts of serial code impact performance</p>
</li>
<li>
<p>10% inherently serial on 8 processor system gives only 4.7 times performance</p>
</li>
</ul>
</li>
<li>
<p>Other factors affecting performance: communication, distribution of work and cache coherence overheads</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter17-5.png" title="/img/Computer Organization and Architecture/chapter17-5.png" data-thumbnail="/img/Computer Organization and Architecture/chapter17-5.png" data-sub-html="<h2>Performance Effect of Multiple Cores</h2>">
        
    </a><figcaption class="image-caption"><code>Performance Effect of Multiple Cores</code></figcaption>
    </figure>
<ul>
<li>
<p>å›¾ï¼ˆaï¼‰ç»™å‡ºäº†ä¸²è¡Œä»£ç æ¯”ä¾‹å¯¹åŠ é€Ÿæ¯”çš„å½±å“ã€‚å¦‚æœæ²¡æœ‰ä¸²è¡Œä»£ç ï¼Œç†è®ºä¸ŠåŠ é€Ÿæ¯”å’Œæ€§èƒ½çš„æå‡æˆæ­£æ¯”ã€‚ä½†æ˜¯ï¼Œç”±äºä¸²è¡Œå¤„ç†çš„é—®é¢˜ï¼Œå¯¼è‡´åŠ é€Ÿæ¯”æ¯”ç†è®ºå€¼å°äº†å¾ˆå¤šã€‚</p>
</li>
<li>
<p>å›¾ï¼ˆbï¼‰æŒ‡å‡ºç®¡ç†å¼€é”€å¯¹åŠ é€Ÿæ¯”çš„å½±å“ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨5ä¸ªå¤„ç†å™¨çš„æ—¶å€™ï¼ŒåŠ é€Ÿæ¯”æœ€å¤§ï¼Œéšç€æ ¸æ•°çš„å¢åŠ ï¼Œç®¡ç†å¼€é”€ä¼šå¯¼è‡´æ€§èƒ½æ”¶ç›Šé€’å‡</p>
</li>
</ul>
<h4 id="effective-applications">Effective Applications</h4>
<ul>
<li>
<p>Some applications effectively exploit multicore processors</p>
<ul>
<li>
<p>Database</p>
</li>
<li>
<p>Servers handling independent transactions</p>
</li>
<li>
<p>Multi-threaded native applicationsï¼Œsuch as Lotus Domino, Siebel CRM</p>
</li>
<li>
<p>Multi-process applications, such as Oracle, SAP, PeopleSoft</p>
</li>
</ul>
</li>
<li>
<p>Java applications</p>
<ul>
<li>
<p><code>JVM</code> is multi-thread with scheduling and memory management</p>
</li>
<li>
<p>Sunâ€™s Java Application Server, BEAâ€™s Weblogic, IBM Websphere, Tomcat</p>
</li>
</ul>
</li>
<li>
<p>Multi-instance applications</p>
<ul>
<li>One application running multiple times</li>
</ul>
</li>
<li>
<p>Game Software</p>
</li>
</ul>
<h3 id="multicore-organization">Multicore Organization</h3>
<ul>
<li>
<p>Number of core processors on chip</p>
</li>
<li>
<p>Number of levels of cache on chip</p>
</li>
<li>
<p>Amount of shared cache</p>
</li>
<li>
<p>Next slide examples of each organization</p>
<ul>
<li>
<p>(a) ARM11 MPCore</p>
</li>
<li>
<p>(b) AMD Opteron</p>
</li>
<li>
<p>(c) Intel Core Duo</p>
</li>
<li>
<p>(d) Intel Core i7</p>
</li>
</ul>
</li>
</ul>
<h4 id="individual-core-architecture">Individual Core Architecture</h4>
<ul>
<li>
<p>Intel Core Duo uses superscalar cores</p>
</li>
<li>
<p>Intel Core i7 uses simultaneous multi-threading (SMT)</p>
<ul>
<li>Scales up number of threads supported</li>
<li>4 SMT cores, each supporting 4 threads appears as 16 core</li>
</ul>
</li>
</ul>
<h3 id="intel-x86-multicore-organization">Intel x86 Multicore Organization</h3>
<p>Example: Core Duo and Core i7</p>
<h3 id="arm11-mpcore">ARM11 MPCore</h3>
<ul>
<li>
<p>Up to 4 processors each with own L1 instruction and data cache</p>
</li>
<li>
<p>Distributed interrupt controller</p>
</li>
<li>
<p>Timer per CPU</p>
</li>
<li>
<p>Watchdog</p>
<ul>
<li>Warning alerts for software failures</li>
<li>Counts down from predetermined values</li>
<li>Issues warning at zero</li>
</ul>
</li>
<li>
<p>CPU interface</p>
<ul>
<li>Interrupt acknowledgement, masking and completion acknowledgement</li>
</ul>
</li>
<li>
<p>CPU</p>
<ul>
<li>Single ARM11 called MP11</li>
</ul>
</li>
<li>
<p>Vector floating-point unit</p>
<ul>
<li>FP co-processor</li>
</ul>
</li>
<li>
<p>L1 cache</p>
</li>
<li>
<p>Snoop control unit</p>
<ul>
<li>Maintain L1 cache coherency</li>
</ul>
</li>
</ul>
<h4 id="summary-of-parallel">Summary of parallel</h4>
<ul>
<li>
<p>Internal of CPU</p>
<ul>
<li>
<p>Pipeline</p>
</li>
<li>
<p>Superscalar</p>
</li>
<li>
<p>simultaneous multi-threading(SMT)</p>
</li>
</ul>
</li>
<li>
<p>On chip</p>
<ul>
<li>Multicore</li>
</ul>
</li>
<li>
<p>Internal of machine</p>
<ul>
<li>
<p>SMP</p>
</li>
<li>
<p>NUMA</p>
</li>
<li>
<p>Array processor</p>
</li>
</ul>
</li>
<li>
<p>Multi-machine</p>
<ul>
<li>Cluster</li>
</ul>
</li>
</ul>
]]></description>
</item>
<item>
    <title>Computer Organization and Architecture Control Unit Operation &amp; Microprogrammed Control</title>
    <link>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-control-unit-operation-microprogrammed-control/</link>
    <pubDate>Tue, 31 Jan 2023 15:20:52 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-control-unit-operation-microprogrammed-control/</guid>
    <description><![CDATA[<h1 id="computer-organization-and-architecture">Computer Organization and Architecture</h1>
<h2 id="control-unit-operation--microprogrammed-control">Control Unit Operation &amp; Microprogrammed Control</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>
<p>Control Unit Operation</p>
<ul>
<li>
<p>Micro-Operations</p>
</li>
<li>
<p>Control of the Processor</p>
</li>
<li>
<p>Hardwired Implementation</p>
</li>
</ul>
</li>
<li>
<p>Microprogrammed Control</p>
<ul>
<li>Basic Concepts</li>
<li>Microinstruction Sequencing</li>
<li>Microinstruction Execution</li>
</ul>
</li>
</ul>
<h3 id="control-unit-operation">Control Unit Operation</h3>
<h4 id="the-function-of-a-processor">The function of a processor</h4>
<ul>
<li>
<p>Instruction Fetch and Execute</p>
<ul>
<li>Execute program</li>
</ul>
</li>
<li>
<p>Interrupts</p>
<ul>
<li>Handling performance differences between CPU and other components</li>
</ul>
</li>
<li>
<p>I/O Function</p>
<ul>
<li>Inter-working with peripherals</li>
</ul>
</li>
</ul>
<h4 id="composition-of-instructions">Composition of instructions</h4>
<ul>
<li>
<p>Instructions include opcodes and operands</p>
</li>
<li>
<p>Opcodes</p>
<ul>
<li>Determines what type of operation the instruction does</li>
</ul>
</li>
<li>
<p>Operands</p>
<ul>
<li>
<p>Determine the object of instruction operation</p>
</li>
<li>
<p>Operands may be in registers, memory, I/O, or immediate</p>
</li>
<li>
<p>Finding operands through addressing mode</p>
</li>
</ul>
</li>
</ul>
<h4 id="micro-operations">Micro-operations</h4>
<ul>
<li>
<p>A computer executes a program to complete user specified functions</p>
<ul>
<li>
<p>Program contains many instructions</p>
</li>
<li>
<p>Instruction execution includes several cycles, such as fetch cycle, execution cycle, indirect cycle, etc</p>
</li>
</ul>
</li>
<li>
<p><strong>Each cycle has a number of steps</strong></p>
<ul>
<li>
<p><strong>Called micro-operations</strong></p>
</li>
<li>
<p><strong>Each step does very little</strong></p>
</li>
<li>
<p><strong>Atomic operation of CPU</strong></p>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-1.png" title="/img/Computer Organization and Architecture/chapter15-1.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-1.png" data-sub-html="<h2>Constituent of program</h2>">
        
    </a><figcaption class="image-caption"><code>Constituent of program</code></figcaption>
    </figure>
<ul>
<li>
<p><strong>ç¨‹åºçš„æ‰§è¡Œæ˜¯ç”±è‹¥å¹²ä¸ªæŒ‡ä»¤æ‰§è¡Œç»„æˆçš„</strong></p>
</li>
<li>
<p><strong>æ¯ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œå°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤å‘¨æœŸ</strong></p>
</li>
<li>
<p><strong>æŒ‡ä»¤å‘¨æœŸç”±è‹¥å¹²ä¸ªå­å‘¨æœŸç»„æˆï¼Œæ¯”å¦‚å–æŒ‡å‘¨æœŸã€æ‰§è¡Œå‘¨æœŸç­‰</strong></p>
</li>
<li>
<p><strong>æ¯ä¸ªå­å‘¨æœŸåŒ…å«è‹¥å¹²ä¸ªæ›´å°çš„æ“ä½œï¼Œè¿™äº›æ“ä½œç§°ä¸ºå¾®æ“ä½œ</strong></p>
</li>
</ul>
<h5 id="fetch">Fetch</h5>
<ul>
<li>
<p>Program Counter (PC)</p>
<ul>
<li>Holds address of next instruction to be fetched</li>
</ul>
</li>
<li>
<p>Memory Address Register (MAR)</p>
<ul>
<li>
<p>Connected to address bus</p>
</li>
<li>
<p>Specifies address for read or write op</p>
</li>
</ul>
</li>
<li>
<p>Memory Buffer Register (MBR)</p>
<ul>
<li>
<p>Connected to data bus</p>
</li>
<li>
<p>Holds data to write or last data read</p>
</li>
</ul>
</li>
<li>
<p>Instruction Register (IR)</p>
<ul>
<li>Holds last instruction fetched</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Step1</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-2.png" title="/img/Computer Organization and Architecture/chapter15-2.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-2.png">
        
    </a>
<ul>
<li>
<p><strong>ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€æ˜¯æ”¾åœ¨PCé‡Œ</strong></p>
</li>
<li>
<p><strong>MARæ˜¯ä¸åœ°å€æ€»çº¿è¿æ¥çš„å”¯ä¸€å¯„å­˜å™¨</strong></p>
</li>
<li>
<p><strong>å–æŒ‡çš„ç¬¬ä¸€æ­¥æ˜¯PCæŠŠä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€ç»™MAR</strong></p>
</li>
<li>
<p><strong>ç»è¿‡ç¬¬ä¸€æ­¥ä¹‹åï¼ŒPCå¯„å­˜å™¨çš„å†…å®¹å¤åˆ¶åˆ°MARå¯„å­˜å™¨ä¸­</strong></p>
</li>
</ul>
<hr>
<p><strong>Step2</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-3.png" title="/img/Computer Organization and Architecture/chapter15-3.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-3.png">
        
    </a>
<ul>
<li>
<p>MARæ”¶åˆ°åœ°å€åï¼ŒæŠŠåœ°å€æ”¾åˆ°åœ°å€æ€»çº¿ä¸Š</p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒå‘ä¸€ä¸ªè¯»å‘½ä»¤åˆ°æ§åˆ¶æ€»çº¿ä¸Š</p>
</li>
<li>
<p>å­˜å‚¨å™¨æ”¶åˆ°è¯»å‘½ä»¤åï¼Œæ ¹æ®åœ°å€è¯»å‡ºæŒ‡ä»¤å†…å®¹ï¼Œå¹¶æ”¾åˆ°æ•°æ®æ€»çº¿</p>
</li>
<li>
<p>æ•°æ®æ€»çº¿ä¸Šçš„æ•°æ®è¯»åˆ°MBR</p>
</li>
<li>
<p>PCä¸­è¿˜éœ€è¦é€’å¢ä¸€ä¸ªæŒ‡ä»¤é•¿åº¦ï¼Œä»¥å¾—åˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€</p>
</li>
</ul>
<hr>
<p><strong>Step3</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-4.png" title="/img/Computer Organization and Architecture/chapter15-4.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-4.png">
        
    </a>
<ul>
<li>
<p>MBRçš„å†…å®¹ä¼ é€ç»™IR</p>
</li>
<li>
<p>ä¼ é€å®Œæˆåï¼ŒMBRå°±å¯ä»¥é‡Šæ”¾ï¼Œç”¨äºä¸‹ä¸€æ­¥æ“ä½œ</p>
</li>
<li>
<p>IRä¸­ä¿å­˜çš„å°±æ˜¯ä¸‹ä¸€ä¸ªéœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤</p>
</li>
<li>
<p>é€šè¿‡è¿™å‡ ä¸ªå¾®æ“ä½œï¼Œå®Œæˆäº†å–æŒ‡</p>
</li>
</ul>
<hr>
<p><strong>Fetch sequence</strong></p>
<ul>
<li>
<p>å–æŒ‡å‘¨æœŸå®é™…ä¸Šç”±ä¸‰æ­¥ã€å››ä¸ªå¾®æ“ä½œç»„æˆã€‚æ¯ä¸ªå¾®æ“ä½œéƒ½æ¶‰åŠåˆ°æ•°æ®åœ¨å¯„å­˜å™¨ä¹‹é—´çš„æµåŠ¨</p>
</li>
<li>
<p>å¦‚æœæ•°æ®çš„æµåŠ¨æ˜¯ç‹¬ç«‹çš„ï¼Œè¿™äº›æ“ä½œå¯ä»¥åœ¨åŒä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å®Œæˆ</p>
</li>
<li>
<p>PCé€’å¢å¾®æ“ä½œï¼Œæ—¢å¯ä»¥åœ¨t2å®Œæˆï¼Œä¹Ÿå¯ä»¥åœ¨t3å®Œæˆ</p>
</li>
</ul>
<hr>
<p><strong>Rules for Micro-operations grouping</strong></p>
<ul>
<li>
<p>Proper sequence must be followed</p>
<ul>
<li>MAR &lt;- (PC) must precede MBR &lt;- (memory)</li>
</ul>
</li>
<li>
<p>Conflicts must be avoided</p>
<ul>
<li>
<p>Must not read &amp; write same register at same time</p>
</li>
<li>
<p>MBR &lt;- (memory) &amp; IR &lt;- (MBR) must not be in same cycle</p>
</li>
</ul>
</li>
<li>
<p>Also: PC &lt;- (PC) +1 involves addition</p>
<ul>
<li>
<p>Use ALU</p>
</li>
<li>
<p>May need additional micro-operations</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Indirect cycle</strong></p>
<ul>
<li>In indirect addressing, it is necessary to get the address of the operand from the memory first. This process is called indirect cycle</li>
</ul>
<hr>
<p><strong>Interrupt cycle</strong></p>
<ul>
<li>
<p>After instruction processing is completed, check whether there is an interrupt</p>
</li>
<li>
<p>Interrupt cycle needs to complete these operations</p>
<ul>
<li>
<p>The instruction address before the interrupt needs to be saved</p>
</li>
<li>
<p>Get the instruction address of the start of the interrupt handler to the PC</p>
</li>
</ul>
</li>
<li>
<p>After the PC gets the interrupt processing address, it enters the index retrieval cycle</p>
</li>
</ul>
<hr>
<p><strong>Execute cycle</strong></p>
<ul>
<li>
<p>Fetching, indirect and interruption cycle can be determined in advance</p>
<ul>
<li>Each cycle contains a fixed sequence of micro operations</li>
</ul>
</li>
<li>
<p>For execution cycle</p>
<ul>
<li>
<p>Different operation codes correspond to different operations</p>
</li>
<li>
<p>Each operation has a specific micro operation sequence</p>
</li>
</ul>
</li>
</ul>
<h4 id="flowchart-for-instruction-cycle">Flowchart for instruction cycle</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-5.png" title="/img/Computer Organization and Architecture/chapter15-5.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-5.png">
        
    </a>
<ul>
<li>
<p>å–æŒ‡å‘¨æœŸåï¼Œçœ‹æ˜¯å¦æ˜¯é—´æ¥å¯»å€ã€‚å¦‚æœæ˜¯é—´æ¥å¯»å€ï¼Œè¿›å…¥01é—´æ¥å‘¨æœŸï¼Œå¦‚æœä¸æ˜¯ï¼Œè¿›å…¥æ‰§è¡Œå‘¨æœŸã€‚</p>
</li>
<li>
<p>é—´æ¥å‘¨æœŸåï¼Œè¯»å–åœ°å€ï¼Œç„¶åè¿›å…¥10æ‰§è¡Œå‘¨æœŸ</p>
</li>
<li>
<p>æ‰§è¡Œå‘¨æœŸï¼Œæ ¹æ®æ“ä½œç æ¥ç¡®å®šåšä»€ä¹ˆæ“ä½œã€‚ç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ä¸­æ–­ã€‚å¦‚æœæœ‰ä¸­æ–­ï¼Œè¿›å…¥11ä¸­æ–­å‘¨æœŸã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿›å…¥00å–æŒ‡å‘¨æœŸã€‚</p>
</li>
<li>
<p>ä¸­æ–­å‘¨æœŸï¼Œè®¾ç½®ä¸­æ–­ï¼Œç„¶åè¿›å…¥ä¸­æ–­å¤„ç†ç¨‹åºçš„å–æŒ‡å‘¨æœŸï¼Œç»§ç»­å–æŒ‡</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Control of the Processor</p>
<ul>
<li>
<p>Functional Requirements</p>
</li>
<li>
<p>Control Signals</p>
</li>
<li>
<p>A Control Signals Example</p>
</li>
<li>
<p>Internal Processor Organization</p>
</li>
</ul>
</li>
</ul>
<h4 id="functional-requirement">Functional requirement</h4>
<ul>
<li>
<p>Micro-operations are the most basic function of the processor</p>
</li>
<li>
<p>Three elements of the controller include</p>
<ul>
<li>
<p>Basic elements of processor</p>
</li>
<li>
<p>Micro-operations that processor performs</p>
</li>
<li>
<p>How to control</p>
</li>
<li>
<p>ALU</p>
</li>
<li>
<p>Registers</p>
</li>
<li>
<p>Internal data paths</p>
</li>
<li>
<p>External data paths</p>
</li>
<li>
<p>Control Unit</p>
</li>
</ul>
</li>
</ul>
<h4 id="types-of-micro-operation">Types of micro-operation</h4>
<ul>
<li>
<p>Micro-operations can be divided into the following four categories</p>
<ul>
<li>
<p>Transfer data between registers</p>
</li>
<li>
<p>Transfer data from register to external</p>
</li>
<li>
<p>Transfer data from external to register</p>
</li>
<li>
<p>Perform arithmetic or logical ops</p>
</li>
</ul>
</li>
</ul>
<h4 id="functions-of-control-unit">Functions of control unit</h4>
<ul>
<li>
<p>Operation object and operation type have been determined</p>
</li>
<li>
<p>Function of the controller is to determine how to do it</p>
<ul>
<li>
<p>Sequencing</p>
</li>
<li>
<p>Execution</p>
</li>
<li>
<p>This is done using Control Signals</p>
</li>
</ul>
</li>
</ul>
<h4 id="model-of-control-unit">Model of control unit</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-6.png" title="/img/Computer Organization and Architecture/chapter15-6.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-6.png">
        
    </a>
<ul>
<li>
<p>æ§åˆ¶å™¨çš„è¾“å…¥åŒ…æ‹¬ï¼šæ—¶é’Ÿä¿¡å·ï¼Œå„ç§æ ‡å¿—ï¼ŒæŒ‡ä»¤å¯„å­˜å™¨ä¸­çš„æŒ‡ä»¤ï¼Œæ¥è‡ªæ§åˆ¶æ€»çº¿çš„æ§åˆ¶ä¿¡å·(ä¸­æ–­)</p>
</li>
<li>
<p>æ§åˆ¶å™¨çš„è¾“å‡ºåŒ…æ‹¬ï¼šCPUå†…éƒ¨çš„æ§åˆ¶ä¿¡å·ï¼Œåˆ°æ§åˆ¶æ€»çº¿çš„æ§åˆ¶ä¿¡å·</p>
</li>
<li>
<p><strong>æ§åˆ¶å™¨å†…éƒ¨å°±æ˜¯å¦‚ä½•æ ¹æ®è¾“å…¥ï¼Œæ¥ç”Ÿæˆæ§åˆ¶ä¿¡å·</strong></p>
</li>
</ul>
<hr>
<p><strong>Control signals</strong></p>
<ul>
<li>
<p>Clock</p>
<ul>
<li>Provide clock signal for timing of controller</li>
<li>One micro-instruction (or set of parallel micro-instructions) per clock cycle</li>
</ul>
</li>
<li>
<p>Instruction register</p>
<ul>
<li>
<p>Op-code for current instruction</p>
</li>
<li>
<p>Addressing mode</p>
</li>
<li>
<p>Determines which micro-instructions are performed</p>
</li>
</ul>
</li>
<li>
<p>Flags</p>
<ul>
<li>
<p>State of CPU</p>
</li>
<li>
<p>Results of previous operations</p>
</li>
</ul>
</li>
<li>
<p>Control signal from control bus</p>
<ul>
<li>
<p>Interrupts</p>
</li>
<li>
<p>Acknowledgements</p>
</li>
</ul>
</li>
<li>
<p>output</p>
<ul>
<li>
<p>Within CPU</p>
<ul>
<li>
<p>Cause data movement</p>
</li>
<li>
<p>Activate specific functions</p>
</li>
</ul>
</li>
<li>
<p>Via control bus</p>
<ul>
<li>
<p>To memoryï¼Œcontrol read or write</p>
</li>
<li>
<p>To I/O modules</p>
</li>
</ul>
</li>
<li>
<p><strong>It generates three types of output control signals</strong></p>
<ul>
<li>
<p>Data paths: the signals control the internal flow of data</p>
</li>
<li>
<p>ALU: the signals control the operation of the ALU</p>
</li>
<li>
<p>System bus: the control unit sends these signals to the control lines of the system bus</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="internal-organization">Internal organization</h4>
<ul>
<li>
<p>CPU adopts single bus structure</p>
<ul>
<li>
<p>All components, including ALU and registers, are connected to the bus</p>
</li>
<li>
<p>A gate is set between each component and the bus to control the data transmission between the component and the bus</p>
</li>
</ul>
</li>
<li>
<p>Data transfer to and from external systems bus is controlled by the control signal</p>
</li>
<li>
<p>Temporary registers needed for proper operation of ALU</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-7.png" title="/img/Computer Organization and Architecture/chapter15-7.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-7.png" data-sub-html="<h2>Internal processor organization</h2>">
        
    </a><figcaption class="image-caption"><code>Internal processor organization</code></figcaption>
    </figure>
<ul>
<li>
<p>å„ä¸ªå¯„å­˜å™¨éƒ½é“¾æ¥åˆ°å†…éƒ¨æ€»çº¿ä¸Šã€‚å¯„å­˜å™¨å’Œå†…éƒ¨æ€»çº¿ä¹‹é—´æœ‰ä¸ªé€»è¾‘é—¨ï¼Œç”¨äºå¯„å­˜å™¨å’Œå†…éƒ¨æ€»çº¿çš„è¿æ¥æ§åˆ¶</p>
</li>
<li>
<p>ALUæ²¡æœ‰å†…éƒ¨å­˜å‚¨éƒ¨ä»¶ã€‚å¦‚æœALUçš„æ“ä½œæ¶‰åŠ2ä¸ªæ“ä½œæ•°çš„è¯ï¼Œä¸€ä¸ªç”±å†…éƒ¨æ€»çº¿å¾—åˆ°ï¼Œå¦ä¸€ä¸ªå¿…é¡»é€šè¿‡å…¶ä»–çš„æ•°æ®æºæ¥å¾—åˆ°ï¼Œä¸èƒ½éƒ½åœ¨å†…éƒ¨æ€»çº¿ä¸Šã€‚éœ€è¦å¢åŠ ä¸€ä¸ªYå¯„å­˜å™¨ï¼Œç”¨äºä¸´æ—¶ä¿å­˜æºæ“ä½œæ•°</p>
</li>
<li>
<p>ALUè¿˜éœ€è¦æœ‰ä¸€ä¸ªå¯„å­˜å™¨ï¼Œæ¥ä¸´æ—¶ä¿å­˜è¾“å‡ºç»“æœã€‚è¿™ä¸ªç»“æœä¸èƒ½æ€»çº¿ä¸Šï¼Œå› ä¸ºå¦‚æœæ”¾æ€»çº¿ä¸Šçš„è¯ï¼Œå®ƒåˆä¼šå½“ä½œALUçš„è¾“å…¥</p>
</li>
</ul>
<h4 id="implementation-of-control-unit">Implementation of control unit</h4>
<ul>
<li>
<p>The control unit implementation can be done by two methods</p>
<ul>
<li>
<p>Hardwired implementation</p>
</li>
<li>
<p>Microprogrammed implementation</p>
</li>
</ul>
</li>
<li>
<p>Hardwired implementation: the control unit is a combinational circuit</p>
<ul>
<li>The input signals are transferred into a set of output control signals</li>
</ul>
</li>
<li>
<p>æ—¶é’Ÿå‘ç”Ÿå™¨ï¼šäº§ç”Ÿæ—¶é’Ÿä¿¡å·ï¼Œå¹¶æä¾›è®¡æ•°å™¨</p>
</li>
<li>
<p>è¯‘ç å™¨ï¼šæ ¹æ®æŒ‡ä»¤å¯„å­˜å™¨ä¸­çš„æŒ‡ä»¤æ“ä½œç ï¼Œç”Ÿæˆæ“ä½œç å¯¹åº”çš„å”¯ä¸€è¾“å‡ºï¼Œæä¾›ç»™è¾“å‡ºæ§åˆ¶å•å…ƒ</p>
</li>
<li>
<p>æ ‡å¿—ï¼šä¸ºæ§åˆ¶å•å…ƒæä¾›ç›¸å…³çš„æ ‡å¿—ä¿¡å·</p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒï¼šæ˜¯æ§åˆ¶å™¨çš„æ ¸å¿ƒï¼Œè´Ÿè´£äº§ç”Ÿæ§åˆ¶ä¿¡å·</p>
</li>
</ul>
<h4 id="control-matrix">Control matrix</h4>
<ul>
<li>
<p>Programmable arrays may also be numerous</p>
</li>
<li>
<p>Large control matrices are implemented hierarchically for speed</p>
</li>
</ul>
<h4 id="problems-with-hard-wired">Problems With Hard Wired</h4>
<ul>
<li>
<p>Complex micro-operation logic</p>
</li>
<li>
<p>Difficult to design and test</p>
</li>
<li>
<p>Inflexible design</p>
</li>
<li>
<p>Difficult to add new instructions</p>
</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>
<p>The instructions are divided into a sequence of stages</p>
</li>
<li>
<p>Fetch, indirect, execute, interrupt</p>
</li>
<li>
<p>Each stage is further divided into a sequence of microoperations</p>
<ul>
<li>T1, T2, T3, â€¦</li>
</ul>
</li>
<li>
<p>Each micro-operation occupies one clock unit</p>
</li>
<li>
<p>The function of the control unit is to produce a sequence of timed control signals to control the data paths and ALU operations</p>
</li>
<li>
<p>The control unit is a combinational circuit that transfers inputs to a group of control signals</p>
<ul>
<li>
<p>Inputs: flags, instruction registers, clock, control signals from system bus</p>
</li>
<li>
<p>Outputs: control signals to system bus and within CPU</p>
</li>
</ul>
</li>
</ul>
<h3 id="microprogrammed-control">Microprogrammed Control</h3>
<h4 id="basic-concepts">Basic Concepts</h4>
<ul>
<li>
<p>Control unit can be implemented by a more flexible technique called microprogrammed control unit</p>
<ul>
<li>
<p>The logic of the control unit is specified by a microprogram</p>
</li>
<li>
<p>Each line in microprogram describes a group of micro-operations in one timeï¼Œcalled microinstruction</p>
</li>
<li>
<p>Construct a control word corresponding to this microinstruction</p>
</li>
<li>
<p>The control word determines the opening or closing of all doors</p>
</li>
</ul>
</li>
<li>
<p>å¾®æŒ‡ä»¤ä¸­åŒ…æ‹¬CPUå†…æ§åˆ¶ä¿¡å·ã€ç³»ç»Ÿæ€»çº¿æ§åˆ¶ä¿¡å·ã€è·³è½¬æ¡ä»¶ã€å¾®æŒ‡ä»¤åœ°å€</p>
</li>
<li>
<p>æ‰§è¡Œè¿™æ¡å¾®æŒ‡ä»¤çš„æ•ˆæœæ˜¯ï¼Œæ‰“å¼€CPUå†…å¤–æ‰€æœ‰ä¸º1çš„æ§åˆ¶çº¿ï¼Œå…³é—­æ‰€æœ‰ä¸º0çš„æ§åˆ¶çº¿</p>
</li>
<li>
<p>å¦‚æœæ¡ä»¶æ¡ä»¶ä¸ºå‡ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸‹ä¸€ä¸ªé¡ºåºçš„å¾®æŒ‡ä»¤</p>
</li>
<li>
<p>å¦‚æœè·³è½¬æ¡ä»¶ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œâ€œå¾®æŒ‡ä»¤åœ°å€â€ä¸­å¯¹åº”çš„å¾®æŒ‡ä»¤</p>
</li>
</ul>
<p><strong>Micro-instruction Types</strong></p>
<ul>
<li>
<p><strong>horizontal microinstruction</strong></p>
<ul>
<li>
<p>æ°´å¹³å¾®æŒ‡ä»¤åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†</p>
<ul>
<li>å†…éƒ¨æ§åˆ¶ä¿¡å·ï¼šCPUå†…çš„æ¯ä¸€ä¸ªæ§åˆ¶çº¿éƒ½æœ‰ç›¸åº”çš„1ä½</li>
<li>æ€»çº¿æ§åˆ¶ä¿¡å·ï¼šæ¯ä¸€ä¸ªç³»ç»Ÿæ§åˆ¶æ€»çº¿éƒ½æœ‰ç›¸åº”çš„1ä½</li>
<li>æ¡ä»¶å­—æ®µï¼šæŒ‡ç¤ºè½¬ç§»å‘ç”Ÿæ¡ä»¶çš„å­—æ®µ</li>
<li>å¾®æŒ‡ä»¤åœ°å€ï¼šè½¬ç§»çš„ç›®æ ‡æŒ‡ä»¤åœ°å€</li>
</ul>
</li>
<li>
<p>æ‰“å¼€ä½å€¼ä¸º1çš„æ§åˆ¶çº¿ï¼Œå…³é—­æ‰€æœ‰ä½å€¼ä¸º0çš„æ§åˆ¶çº¿ã€‚æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå¾®æ“ä½œ</p>
</li>
<li>
<p>å¦‚æœè·³è½¬æ¡ä»¶ä¸ºå‡ï¼Œé¡ºåºæ‰§è¡Œä¸‹ä¸€ä¸ªæŒ‡ä»¤ã€‚å¦‚æœè·³è½¬æ¡ä»¶ä¸ºçœŸï¼Œæ‰§è¡Œâ€œå¾®æŒ‡ä»¤åœ°å€â€ æŒ‡å‘çš„å¾®æŒ‡ä»¤</p>
</li>
<li>
<p><strong>Characteristic</strong></p>
<ul>
<li>
<p>Each control line inside the CPU and bus needs to have a separate control bit</p>
<ul>
<li>The width of the control word is very large</li>
</ul>
</li>
<li>
<p>Each line is a separate control bit</p>
<ul>
<li>Each control line can be controlled independently</li>
<li>More kinds of micro operations that can be supported</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The control lines are controlled by one bit of the control word independently</p>
<ul>
<li>The coding of control signal is not compact</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>vertical microinstruction</strong></p>
<ul>
<li>
<p>å‚ç›´å¾®æŒ‡ä»¤ä¹ŸåŒ…æ‹¬æ¡ä»¶å’Œè·³è½¬å¾®æŒ‡ä»¤åœ°å€ï¼Œè·Ÿæ°´å¹³å¾®æŒ‡ä»¤ç±»ä¼¼</p>
</li>
<li>
<p>åœ¨æ§åˆ¶æ–¹é¢ï¼Œå’Œæ°´å¹³å¾®æŒ‡ä»¤çš„æ¯ä¸€ä½å¯¹åº”ä¸€ä¸ªæ§åˆ¶çº¿ä¸åŒï¼Œå‚ç›´å¾®æŒ‡ä»¤åˆåšäº†ä¸€æ¬¡ç¼–ç </p>
</li>
<li>
<p>è§£å†³æ°´å¹³å¾®æŒ‡ä»¤çš„æ§åˆ¶å­—å¤ªé•¿çš„é—®é¢˜</p>
</li>
<li>
<p>ç¼–ç åï¼Œç”±ä¸€ä¸ªè§£ç å™¨å†ç¿»è¯‘æˆæ§åˆ¶çº¿çš„æ§åˆ¶ä¿¡å·</p>
</li>
<li>
<p><strong>Characteristic</strong></p>
<ul>
<li>
<p>Width is narrow</p>
<ul>
<li>
<p>n control signals encoded into $\log_2 n$ bits($n \rightarrow 2^n$)</p>
</li>
<li>
<p>Limited number of micro operations supported</p>
</li>
</ul>
</li>
<li>
<p>Additional steps required</p>
<ul>
<li>External memory word decode is needed</li>
<li>Identify the exact control line being manipulated</li>
<li>Send control signal</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="micro-program-word-length">Micro-program Word Length</h4>
<ul>
<li>
<p><strong>Word length is an important factor in microprogram</strong></p>
</li>
<li>
<p><strong>Word length is determined by three factors</strong>\</p>
<ul>
<li>
<p><strong>Maximum number of simultaneous micro-operations supported</strong></p>
</li>
<li>
<p><strong>The way control information is represented or encoded</strong></p>
</li>
<li>
<p><strong>The way in which the next micro-instruction address is specified</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Compromise</strong></p>
<ul>
<li>
<p>Divide control signals into disjoint groups</p>
</li>
<li>
<p>Implement each group as separate field in memory word</p>
</li>
<li>
<p>Supports reasonable levels of parallelism without too much complexity</p>
</li>
</ul>
<h4 id="the-control-memory">The control memory</h4>
<ul>
<li>
<p>The control words are put into a special memory block called control memory, with each word having a unique address</p>
</li>
<li>
<p>The microinstructions are organized as different routines</p>
<ul>
<li>
<p>The microinstructions in each routine are executed sequentially</p>
</li>
<li>
<p>Each routine ends with a branch instruction points to the next routine</p>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-8.png" title="/img/Computer Organization and Architecture/chapter15-8.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-8.png" data-sub-html="<h2>Control memory</h2>">
        
    </a><figcaption class="image-caption"><code>Control memory</code></figcaption>
    </figure>
<ul>
<li>
<p>å­˜å‚¨æ§åˆ¶å™¨ä¸­å­˜å‚¨äº†å–æŒ‡ä¾‹ç¨‹ã€é—´æ¥ä¾‹ç¨‹ã€ä¸­æ–­ä¾‹ç¨‹ã€æ‰§è¡Œä¾‹ç¨‹ç­‰ï¼Œè¿™äº›ä¾‹ç¨‹è§„å®šäº†åœ¨æ¯ä¸ªå‘¨æœŸå†…éœ€è¦æ‰§è¡Œçš„å¾®æ“ä½œåºåˆ—</p>
</li>
<li>
<p>ä¾‹ç¨‹ä¸­è¿˜è§„å®šäº†åœ¨æ‰§è¡Œç»“æŸåè½¬ç§»åˆ°ä¸‹é¢å“ªä¸€ä¸ªä¾‹ç¨‹ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šäº†å‘¨æœŸçš„æ‰§è¡Œé¡ºåº</p>
</li>
<li>
<p>ä¾‹å¦‚ï¼Œå–æŒ‡å‘¨æœŸåï¼Œå¯èƒ½ä¼šåˆ°é—´æ¥å‘¨æœŸï¼Œä¹Ÿå¯èƒ½åˆ°æ‰§è¡Œå‘¨æœŸï¼Œéœ€è¦æ ¹æ®å–æŒ‡å‘¨æœŸæ¥ç¡®å®š</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter15-9.png" title="/img/Computer Organization and Architecture/chapter15-9.png" data-thumbnail="/img/Computer Organization and Architecture/chapter15-9.png" data-sub-html="<h2>Control Unit Microarchitecture</h2>">
        
    </a><figcaption class="image-caption"><code>Control Unit Microarchitecture</code></figcaption>
    </figure>
<ul>
<li>
<p><strong>Sequencing logic</strong></p>
</li>
<li>
<p><strong>Control address register</strong></p>
</li>
<li>
<p><strong>Control memory</strong></p>
</li>
<li>
<p><strong>Control buffer register</strong></p>
</li>
<li>
<p>æ§åˆ¶å­˜å‚¨å™¨ï¼šå­˜å‚¨å¾®æŒ‡ä»¤</p>
</li>
<li>
<p>æ§åˆ¶åœ°å€å¯„å­˜å™¨ï¼šåŒ…å«ä¸‹ä¸€ä¸ªå°†è¦è¢«è¯»å–çš„å¾®æŒ‡ä»¤åœ°å€ã€‚ç±»ä¼¼äºPC</p>
</li>
<li>
<p>æ§åˆ¶ç¼“å†²å¯„å­˜å™¨ï¼šå¾®æŒ‡ä»¤ç”±æ§åˆ¶å­˜å‚¨å™¨è¯»å–ä¹‹åï¼Œæ”¾åˆ°æ§åˆ¶ç¼“å†²å¯„å­˜å™¨ä¸­ã€‚æ§åˆ¶ç¼“å†²å¯„å­˜å™¨çš„å·¦åŠéƒ¨åˆ†ç›´æ¥å’Œæ§åˆ¶çº¿è¿æ¥ï¼Œè¯»å–å¾®æŒ‡ä»¤ç›´æ¥ç”Ÿæˆæ§åˆ¶ä¿¡å·ï¼Œæ§åˆ¶é—¨çš„å¼€æˆ–å…³</p>
</li>
<li>
<p>å®šåºé€»è¾‘ï¼šè´Ÿè´£ä¸ºæ§åˆ¶åœ°å€å¯„å­˜å™¨æä¾›åœ°å€ï¼Œå¹¶å‘å‡ºè¯»å‘½ä»¤</p>
</li>
</ul>
<h4 id="control-unit-function">Control Unit Function</h4>
<ul>
<li>
<p>Sequence logic unit issues read command</p>
<ul>
<li>
<p>Word specified in control address register is read into control buffer register</p>
</li>
<li>
<p>Control buffer register contents generates control signals and next address information</p>
</li>
</ul>
</li>
<li>
<p>Sequence logic loads new address into control address register based on next address information from control buffer register and ALU flags</p>
</li>
</ul>
<h4 id="next-address-decision">Next Address Decision</h4>
<ul>
<li>
<p>Sequencing logic needs to determine the next microinstruction</p>
<ul>
<li>At the end of each microinstruction, the next microinstruction address is loaded into the control address register</li>
</ul>
</li>
<li>
<p>Depending on ALU flags and control buffer register</p>
<ul>
<li>
<p>Next microinstruction in sequence</p>
</li>
<li>
<p>Jump to a new routine based on jump instructions</p>
</li>
<li>
<p>Jump to a machine instruction routine</p>
</li>
</ul>
</li>
</ul>
<h4 id="next-address">Next Address</h4>
<ul>
<li>
<p>Next microinstruction in sequence</p>
<ul>
<li>Add 1 to control address register</li>
</ul>
</li>
<li>
<p>Jump to new routine based on jump microinstruction</p>
<ul>
<li>Load address field of control buffer register into control address register</li>
</ul>
</li>
<li>
<p>Jump to machine instruction routine</p>
<ul>
<li>Load control address register based on opcode in IR</li>
</ul>
</li>
</ul>
<hr>
<ol>
<li>
<p>æŒ‡ä»¤è¯‘ç å™¨æ˜¯å°†æŒ‡ä»¤å¯„å­˜å™¨ä¸­çš„æ“ä½œç ç¿»è¯‘æˆæ§åˆ¶å¯„å­˜å™¨åœ°å€</p>
</li>
<li>
<p>æ§åˆ¶åœ°å€å¯„å­˜å™¨åˆ°æ§åˆ¶å­˜å‚¨å™¨ä¸­æ‰¾åˆ°æ§åˆ¶å­—ï¼Œå¹¶æ”¾åˆ°æ§åˆ¶ç¼“å†²å¯„å­˜å™¨ä¸­</p>
</li>
<li>
<p><strong>æ§åˆ¶ç¼“å†²å¯„å­˜å™¨è¿›è¡Œæ§åˆ¶æ“ä½œã€‚å¦‚æœæ˜¯å‚ç›´å¾®æŒ‡ä»¤ï¼Œåˆ™éœ€è¦è¯‘ç å™¨è¿›è¡Œè¯‘ç åç”Ÿæˆæ§åˆ¶ä¿¡å·</strong></p>
</li>
<li>
<p>æ§åˆ¶ä¿¡å·è¯‘ç å™¨ç”¨äºå‚ç›´å¾®æŒ‡ä»¤ï¼Œå°†æ§åˆ¶å­—ç¿»è¯‘æˆæ§åˆ¶çº¿çš„æ§åˆ¶ä¿¡å·ï¼Œå‘é€åˆ°CPUå†…éƒ¨å’Œç³»ç»Ÿæ€»çº¿</p>
</li>
<li>
<p>å¯¹äºå‚ç›´å¾®æŒ‡ä»¤ï¼Œæœ‰ä¸€ä¸ªé™„åŠ é€»è¾‘å’Œæ—¶é—´å»¶è¿Ÿ</p>
</li>
<li>
<p>ä¸‹ä¸€ä¸ªå¾®æŒ‡ä»¤åœ°å€ç»™å®šåºé€»è¾‘ï¼Œä»¥ç¡®å®šæ‰§è¡Œå“ªä¸€ä¸ªå¾®æŒ‡ä»¤</p>
</li>
</ol>
<h4 id="simple-summary">Simple summary</h4>
<ul>
<li>
<p>All the control unit does is generate a set of control signals</p>
<ul>
<li>
<p>Control the opening and closing of each gate</p>
</li>
<li>
<p>Use one control bit to represent the control signal of a door</p>
</li>
<li>
<p>Control bits of all gates constitute control words</p>
</li>
</ul>
</li>
<li>
<p>Have a control word for each group of micro-operations in one time</p>
</li>
<li>
<p>The next microinstruction can be specified in the microinstruction and executed conditionally</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>For machine code instruction</p>
<ul>
<li>
<p>It is generally divided into multiple cycles, such as fetch cycle, execution cycle, etc</p>
</li>
<li>
<p>Multiple microoperations need to be completed</p>
</li>
<li>
<p>Each microoperation corresponds to one control word</p>
</li>
<li>
<p>A group of control words realizes the control function of a machine code</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>Todayâ€™s large microprocessor</p>
<ul>
<li>
<p>Many instructions and associated register-level hardware</p>
</li>
<li>
<p>Many control points to be manipulated</p>
</li>
</ul>
</li>
<li>
<p>This results in control memory that</p>
<ul>
<li>
<p>Contains a large number of wordsï¼Œco-responding to the number of instructions to be executed</p>
</li>
<li>
<p>Has a wide word widthï¼Œdue to the large number of control points to be manipulated</p>
</li>
</ul>
</li>
</ul>
<h4 id="advantages-and-disadvantages">Advantages and Disadvantages</h4>
<ul>
<li>
<p>Advantages</p>
<ul>
<li>
<p>Simplifies design of control unit</p>
</li>
<li>
<p>Cheaper</p>
</li>
<li>
<p>Less error-prone</p>
</li>
</ul>
</li>
<li>
<p>Disadvantages</p>
<ul>
<li>
<p>Additional processing required</p>
</li>
<li>
<p>Slower</p>
</li>
</ul>
</li>
</ul>
<h4 id="microinstruction-sequencing">Microinstruction Sequencing</h4>
<ul>
<li>
<p>Microinstruction controller has two basic tasks</p>
<ul>
<li>
<p>Microinstruction sequencingï¼š Get the next microinstruction from the control memory</p>
</li>
<li>
<p>Microinstruction execution : Through control word generates control signal for executing the micro instruction</p>
</li>
</ul>
</li>
<li>
<p>Must consider both together</p>
<ul>
<li>Affects instruction format and controller timing</li>
</ul>
</li>
</ul>
<h4 id="sequencing-techniques">Sequencing Techniques</h4>
<ul>
<li>
<p>Two problems must be considered</p>
<ul>
<li>
<p>Size of microinstructions</p>
</li>
<li>
<p>Address generation time</p>
</li>
</ul>
</li>
<li>
<p>Size of microinstructions</p>
<ul>
<li>The larger the microinstruction, the larger the control memory, and the more expensive</li>
<li>Size of microinstructions should be reduced</li>
</ul>
</li>
<li>
<p>Address generation time</p>
<ul>
<li>The requirement to execute microinstructions as quickly as possible</li>
</ul>
</li>
</ul>
<h5 id="address-generation-time">Address generation time</h5>
<ul>
<li>
<p>Determined by instruction register</p>
<ul>
<li>Once per cycle, after instruction is fetched</li>
</ul>
</li>
<li>
<p>Next sequential address</p>
<ul>
<li>Use in most cases</li>
</ul>
</li>
<li>
<p>Branch</p>
<ul>
<li>
<p>Both conditional and unconditional</p>
</li>
<li>
<p>Generally, there is a jump after 3-4 microinstructions</p>
</li>
<li>
<p>Very important</p>
</li>
</ul>
</li>
</ul>
<h5 id="sequencing-techniques-1">Sequencing Techniques</h5>
<ul>
<li>
<p>Based on current microinstruction, condition flags, contents of IR, generate control memory address of next microinstruction</p>
</li>
<li>
<p>The jump of microinstructions can be divided into three modes according to the address information format in the microinstructions</p>
<ul>
<li>
<p>Two address fields</p>
<ul>
<li>
<p>å¯¹äºåŒåœ°å€å­—æ®µæ¨¡å¼ï¼Œå¾®æŒ‡ä»¤ä¸­æä¾›äº†2ä¸ªåœ°å€å­—æ®µ</p>
</li>
<li>
<p>æ§åˆ¶ç¼“å†²å¯„å­˜å™¨è¯»å–å¾®æŒ‡ä»¤åï¼Œç¬¬ä¸€éƒ¨åˆ†äº§ç”Ÿæ§åˆ¶ä¿¡å·ï¼Œç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯2ä¸ªåœ°å€ï¼Œè¿™2ä¸ªåœ°å€ï¼ŒåŠ ä¸ŠæŒ‡ä»¤å¯„å­˜å™¨çš„å†…å®¹ï¼Œè¿æ¥åˆ°ä¸€ä¸ªå¤šè·¯å™¨ä¸­ã€‚å¤šè·¯å™¨é€‰æ‹©ä¸€ä¸ªé€åˆ°æ§åˆ¶åœ°å€å¯„å­˜å™¨ä¸­</p>
</li>
<li>
<p>æ§åˆ¶åœ°å€å¯„å­˜å™¨é€šè¿‡è¯‘ç ï¼Œäº§ç”Ÿä¸‹ä¸€ä¸ªå¾®æŒ‡ä»¤çš„åœ°å€ã€‚åœ°å€é€‰æ‹©çš„è¾“å…¥æ˜¯ç”±è½¬ç§»é€»è¾‘æ¨¡å—æ¥å®Œæˆçš„ï¼Œå®ƒæ ¹æ®å¾®æŒ‡ä»¤ä¸­çš„æ§åˆ¶éƒ¨åˆ†ï¼Œä»¥åŠæ ‡å¿—ä½ï¼Œå‘å¤šè·¯å™¨æä¾›é€‰æ‹©ä¿¡å·</p>
</li>
<li>
<p>åŒåœ°å€å­—æ®µæ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå¾®æŒ‡ä»¤ä¸­æœ‰2ä¸ªåœ°å€ï¼Œéœ€è¦æ›´å¤šçš„ä½</p>
</li>
</ul>
</li>
<li>
<p>Single address field</p>
<ul>
<li>
<p>å•åœ°å€å­—æ®µæ–¹å¼ä¸­ï¼Œå¾®æŒ‡ä»¤ä¸­åªæœ‰ä¸€ä¸ªåœ°å€ã€‚ä¸‹ä¸€ä¸ªåœ°å€çš„é€‰æ‹©æ–¹æ³•æ˜¯ï¼š</p>
<ul>
<li>
<p>åœ°å€å­—æ®µä¸­æŒ‡å®šçš„åœ°å€</p>
</li>
<li>
<p>æŒ‡ä»¤å¯„å­˜å™¨ä¸­çš„ä»£ç </p>
</li>
<li>
<p>ä¸‹ä¸€ä¸ªé¡ºåºåœ°å€</p>
</li>
</ul>
</li>
<li>
<p>ä¸‹ä¸€ä¸ªé¡ºåºåœ°å€æ˜¯ç”¨ä¸Šä¸€æ¬¡çš„æ§åˆ¶åœ°å€å¯„å­˜å™¨ä¸­çš„åœ°å€+1æ¥å¾—åˆ°çš„</p>
</li>
</ul>
</li>
<li>
<p>Variable format</p>
<ul>
<li>
<p>å¯å˜æ ¼å¼æä¾›ä¸¤ç§ä¸åŒæ ¼å¼çš„æŒ‡ä»¤ã€‚ç”¨1ä½æ¥æ ‡è¯†å½“å‰æ˜¯å“ªç§æ ¼å¼ã€‚</p>
</li>
<li>
<p>åœ¨ä¸€ç§æ ¼å¼ä¸­ï¼Œæ‰€æœ‰ä½éƒ½ç”¨äºäº§ç”Ÿæ§åˆ¶ä¿¡å·ã€‚æ‰€ä»¥ï¼Œä¸‹ä¸€ä¸ªå¾®æŒ‡ä»¤çš„åœ°å€ï¼Œæˆ–è€…æ˜¯ä¸‹ä¸€é¡ºåºåœ°å€ï¼Œæˆ–è€…æ˜¯ç”±æŒ‡ä»¤å¯„å­˜å™¨æ¥æŒ‡å®š</p>
</li>
<li>
<p>å¦ä¸€ç§æ ¼å¼ä¸­ï¼Œæœ‰ä¸€äº›ä½ç”¨äºå¯åŠ¨è½¬ç§»é€»è¾‘æ¨¡å—ï¼Œå…¶ä½™çš„ä½æ¥æä¾›åœ°å€ã€‚è¿™æ ·å°±å¯ä»¥è¿›è¡Œæ¡ä»¶æˆ–è€…æ— æ¡ä»¶è½¬ç§»</p>
</li>
<li>
<p>è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯è½¬ç§»å¾®æŒ‡ä»¤éœ€è¦èŠ±è´¹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="microinstruction-execution">Microinstruction Execution</h4>
<ul>
<li>
<p>Microinstruction execution is a periodic basic even</p>
</li>
<li>
<p>Each cycle is made up of two events</p>
<ul>
<li>
<p>Fetch</p>
</li>
<li>
<p>Execute</p>
</li>
</ul>
</li>
<li>
<p>Fetch</p>
<ul>
<li>Get the microinstruction from the control memory according to the generated microinstruction address</li>
</ul>
</li>
<li>
<p>Execute</p>
<ul>
<li>Execute microinstructions and generate control signals</li>
</ul>
</li>
</ul>
<h4 id="execution-effect">Execution effect</h4>
<ul>
<li>
<p>Effect is to generate control signals</p>
</li>
<li>
<p>Internal</p>
<ul>
<li>
<p>Control signals inside the processor</p>
</li>
<li>
<p>Control the internal components of the processor</p>
</li>
</ul>
</li>
<li>
<p>External</p>
<ul>
<li>
<p>Control signals to external control bus or other interface</p>
</li>
<li>
<p>Control disk read-write, I/O read-write etc</p>
</li>
</ul>
</li>
<li>
<p>With the function to generate next address</p>
</li>
</ul>
<h4 id="summary-1">Summary</h4>
<ul>
<li>
<p>A microprogrammed control unit is a relatively simple logic circuit that is capable of</p>
<ul>
<li>
<p>Sequencing through microinstructions</p>
</li>
<li>
<p>Generating control signals to execute each microinstruction</p>
</li>
</ul>
</li>
</ul>
]]></description>
</item>
<item>
    <title>Computer Organization and Architecture Instruction Level Parallelism and Superscalar Processors</title>
    <link>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-instruction-level-parallelism-and-superscalar-processors/</link>
    <pubDate>Mon, 30 Jan 2023 16:28:39 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-instruction-level-parallelism-and-superscalar-processors/</guid>
    <description><![CDATA[<h1 id="computer-organization-and-architecture">Computer Organization and Architecture</h1>
<h2 id="instruction-level-parallelism-and-superscalar-processors">Instruction Level Parallelism and Superscalar Processors</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>
<p>Overview of Superscalar</p>
</li>
<li>
<p>Design Issues of Superscalar</p>
</li>
<li>
<p>Superscalar in Pentium</p>
</li>
<li>
<p>Superscalar in ARM CORTEX-A8</p>
</li>
</ul>
<h3 id="overview-of-superscalar">Overview of Superscalar</h3>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-1.png" title="/img/Computer Organization and Architecture/chapter14-1.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-1.png" data-sub-html="<h2>Ideal pipeline</h2>">
        
    </a><figcaption class="image-caption"><code>Ideal pipeline</code></figcaption>
    </figure>
<ul>
<li>
<p>ç†æƒ³çš„æŒ‡ä»¤æµæ°´çº¿çš„æ‰§è¡Œè¿‡ç¨‹</p>
</li>
<li>
<p>æŒ‡ä»¤æ‰§è¡Œåˆ†ä¸º6ä¸ªé˜¶æ®µï¼Œä¸”ä¸å…±äº«èµ„æº</p>
</li>
<li>
<p>æ¯ä¸ªæ—¶é—´å•ä½éƒ½ä¼šæœ‰1ä¸ªæŒ‡ä»¤å®Œæˆæ‰§è¡Œ</p>
</li>
<li>
<p>æŒ‡ä»¤æ•°é‡è¶³å¤Ÿå¤šæ—¶ï¼Œæ‰§è¡Œæ•ˆç‡ä¸ºåŸæ¥çš„6å€</p>
</li>
</ul>
<hr>
<p><strong>Actual pipeline</strong></p>
<ul>
<li>
<p>Not all instructions require the same steps</p>
<ul>
<li>Some pipeline stages are idle</li>
</ul>
</li>
<li>
<p>Running time of different pipeline stages is different</p>
<ul>
<li>running time of some pipeline stages is wasted</li>
</ul>
</li>
<li>
<p>Instructions are not independent of each other</p>
<ul>
<li>Poor operation of the pipeline</li>
</ul>
</li>
</ul>
<h4 id="problem-about-pipeline">Problem about pipeline</h4>
<ul>
<li>
<p>The pipeline pauses due to dependencies between instructions, which is called pipeline risk</p>
</li>
<li>
<p>There are three types of dependencies</p>
<ul>
<li>
<p>Data dependence</p>
</li>
<li>
<p>Control dependence</p>
</li>
<li>
<p>resource dependence</p>
</li>
</ul>
</li>
</ul>
<h4 id="question">Question</h4>
<ul>
<li>
<p>Is instruction pipelining truly parallel?</p>
<ul>
<li>
<p>Yes: There are indeed multiple instructions in the pipeline being processed at the same time</p>
</li>
<li>
<p>No: multiple instructions do not enter the pipeline at the same time</p>
</li>
</ul>
</li>
<li>
<p>How to further improve the execution efficiency of instructions?</p>
<ul>
<li>
<p>Optimize pipeline: super pipeline</p>
</li>
<li>
<p>True instruction level parallelism: superscalar pipelining</p>
</li>
</ul>
</li>
</ul>
<h4 id="superpipeline">Superpipeline</h4>
<ul>
<li>
<p>In an ordinary pipeline, each clock cycle can complete processing of one pipeline stage</p>
</li>
<li>
<p>Many pipeline stages need less than half a clock cycle</p>
</li>
<li>
<p>Superpipeline</p>
<ul>
<li>
<p>Double internal clock rate is adopted for instruction scheduling</p>
</li>
<li>
<p>Double internal clock speed gets two tasks per external clock cycle</p>
</li>
</ul>
</li>
<li>
<p>Get twice the instruction throughput</p>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-2.png" title="/img/Computer Organization and Architecture/chapter14-2.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-2.png">
        
    </a>
<ul>
<li>
<p>å››é˜¶æ®µæµæ°´çº¿ï¼ŒæŒ‡ä»¤åˆ’åˆ†ä¸º4ä¸ªé˜¶æ®µ</p>
</li>
<li>
<p>æ™®é€šæµæ°´çº¿ä¸­ï¼Œæ¯ä¸ªé˜¶æ®µéœ€è¦1ä¸ªæ—¶é’Ÿå‘¨æœŸæ¥å®Œæˆã€‚æœ€é«˜èƒ½è¾¾åˆ°4å€çš„æŒ‡ä»¤æ‰§è¡Œæ•ˆç‡ï¼Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå¯ä»¥è¾“å‡º1ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œç»“æœ</p>
</li>
<li>
<p>è¶…çº§æµæ°´çº¿ã€‚é€šè¿‡é‡‡ç”¨åŒå€å†…éƒ¨æ—¶é’Ÿçš„æ–¹å¼ï¼Œæ¯0.5ä¸ªå¤–éƒ¨æ—¶é’Ÿå‘¨æœŸï¼Œå°±èƒ½å®Œæˆ1ä¸ªæŒ‡ä»¤é˜¶æ®µçš„æ‰§è¡Œã€‚æœ€é«˜èƒ½è¾¾åˆ°8å€çš„æ‰§è¡Œæ•ˆç‡</p>
</li>
</ul>
<h5 id="limit-of-superpipeline">Limit of Superpipeline</h5>
<ul>
<li>
<p>The effect is similar to that of increasing the main frequency</p>
</li>
<li>
<p><strong>It is still not really instruction level parallelism</strong></p>
</li>
<li>
<p>The overall performance is limited by the clock cycle and the length of time the instruction phase executes</p>
<ul>
<li>Long execution phases affect overall performance</li>
</ul>
</li>
<li>
<p><strong>Another technology-superscalar</strong></p>
</li>
</ul>
<h4 id="vector-and-scalar">Vector and Scalar</h4>
<ul>
<li>
<p>Scalar</p>
<ul>
<li>
<p>Also called â€œvector freeâ€. Some physical quantities have only numerical value, but no direction. Some of them are positive or negative</p>
</li>
<li>
<p>A single number used to represent a single attribute of a thing</p>
</li>
<li>
<p>For example: temperature, length</p>
</li>
</ul>
</li>
<li>
<p>Vector</p>
<ul>
<li>
<p>Originally refers to a quantity with size and direction</p>
</li>
<li>
<p>A group of orderly arranged numbers used to demarcate the quantitative characteristics of things</p>
</li>
<li>
<p>For example: the position of a point in the plane coordinate system$ (x, y) $</p>
</li>
</ul>
</li>
</ul>
<h5 id="scalar-instruction">Scalar instruction</h5>
<ul>
<li>
<p>The instructions that do not have vector processing functions and only operate on a single quantity, namely a scalar quantity, are called scalar instructions</p>
</li>
<li>
<p>Most instructions are scalar</p>
</li>
</ul>
<h5 id="vector-instruction">Vector instruction</h5>
<ul>
<li>
<p>The basic operating object is a vector, that is, a group of numbers arranged in order</p>
</li>
<li>
<p>The instruction determines the address of the vector operand and directly or implicitly specifies vector parameters such as increment, vector length, etc</p>
</li>
<li>
<p>The vector instruction specifies that the processor processes vector according to the same operation, which can effectively improve the operation speed</p>
</li>
<li>
<p>Some mainframes are equipped with vector operation instruction systems with complete functions</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-3.png" title="/img/Computer Organization and Architecture/chapter14-3.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-3.png" data-sub-html="<h2>Superscalar</h2>">
        
    </a><figcaption class="image-caption"><code>Superscalar</code></figcaption>
    </figure>
<ul>
<li>
<p>è¶…æ ‡é‡é‡‡ç”¨äº†2ä¸ªç‹¬ç«‹çš„æµæ°´çº¿</p>
</li>
<li>
<p>æ¯ä¸ªæµæ°´çº¿éƒ½å¯ä»¥å†è¿›è¡ŒæŒ‡ä»¤çš„å¹¶è¡Œè¿è¡Œ</p>
</li>
<li>
<p>èƒ½å¤Ÿå¹¶è¡Œæ‰§è¡Œæ¯ä¸ªé˜¶æ®µçš„2ä¸ªæŒ‡ä»¤</p>
</li>
<li>
<p>åœ¨ç¨³å®šè¿è¡Œçš„çŠ¶æ€ä¸‹ï¼Œå¯ä»¥è¾¾åˆ°8å€çš„æ‰§è¡Œæ•ˆç‡</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-4.png" title="/img/Computer Organization and Architecture/chapter14-4.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-4.png" data-sub-html="<h2>Ceneral Superscalar organization</h2>">
        
    </a><figcaption class="image-caption"><code>Ceneral Superscalar organization</code></figcaption>
    </figure>
<ul>
<li>
<p>åŒ…å«äº†2ä¸ªæ•´æ•°è¿ç®—å•å…ƒï¼Œ2ä¸ªæµ®ç‚¹æ•°è¿ç®—å•å…ƒï¼Œä¸€ä¸ªå­˜å‚¨å•å…ƒ</p>
</li>
<li>
<p>æ•´æ•°è¿ç®—å•å…ƒä¸­ï¼Œå…è®¸æœ‰2ä¸ªæŒ‡ä»¤å¹¶è¡Œæ‰§è¡Œï¼Œæµ®ç‚¹æ•°è¿ç®—å•å…ƒä¹Ÿå…è®¸2ä¸ªæµ®ç‚¹æŒ‡ä»¤åŒæ—¶è¿è¡Œã€‚ä¸æ­¤åŒæ—¶ï¼Œ1ä¸ªå­˜å‚¨å™¨æ“ä½œä¹Ÿå¯ä»¥å¹¶è¡Œæ¥æ‰§è¡Œ</p>
</li>
<li>
<p>è¿™ä¸ªç»“æ„ä¸­ï¼ŒåŒæ—¶å…è®¸5ä¸ªæŒ‡ä»¤å¹¶è¡Œæ‰§è¡Œ</p>
</li>
</ul>
<h4 id="key-problem-of-superscalar">Key problem of superscalar</h4>
<ul>
<li>
<p>Superscalar implementations raise a number of complex design issues related to the instruction pipeline</p>
<ul>
<li>
<p>First, the relevance of the pipeline itself still exists</p>
</li>
<li>
<p>Multiple pipelines bring more complex correlation problems</p>
</li>
</ul>
</li>
<li>
<p>The compiler is required to have more complex optimization techniques to achieve greater instruction level parallelism</p>
</li>
</ul>
<h5 id="application-of-superscalar">Application of superscalar</h5>
<ul>
<li>
<p><strong>Superscalar technology itself is proposed and developed with the development of RISC technology</strong></p>
</li>
<li>
<p>RISC processors also tend to use superscalar technology</p>
</li>
<li>
<p><strong>Although RISC machine lends itself readily to superscalar techniques, the superscalar approach can be used on either a RISC or CISC architecture</strong></p>
</li>
<li>
<p><strong>Superscalar approach has now become the standard method for implementing high-performance microprocessors</strong></p>
</li>
</ul>
<h4 id="factors-limiting-parallelism">Factors limiting parallelism</h4>
<ul>
<li>
<p>Instruction level parallelism</p>
<ul>
<li>The degree to which program instructions can be executed in parallel</li>
</ul>
</li>
<li>
<p>Compiler capabilities</p>
<ul>
<li>The compiler can maximize instruction level parallelism of programs</li>
</ul>
</li>
<li>
<p>Hardware techniques</p>
<ul>
<li>Hardware capability supports parallel operation of instructions</li>
</ul>
</li>
</ul>
<h4 id="limitations">Limitations</h4>
<ul>
<li>
<p>The most important reason for limiting instruction level parallelism is the correlation between instructions in the program</p>
</li>
<li>
<p>The dependencies between instructions include</p>
<ul>
<li>
<p>True data dependency</p>
</li>
<li>
<p>Output dependency</p>
</li>
<li>
<p>Anti-dependency</p>
</li>
<li>
<p>Procedural dependency</p>
</li>
<li>
<p>Resource conflicts</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>True Data Dependency</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-5.png" title="/img/Computer Organization and Architecture/chapter14-5.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-5.png">
        
    </a>
<ul>
<li>
<p>I0å’Œi1èƒ½å¤ŸåŒæ—¶è¿›è¡Œå–æŒ‡å’Œè§£ç </p>
</li>
<li>
<p><strong>ä½†æ˜¯ç”±äºi1å–çš„æ“ä½œæ•°æ˜¯i0çš„ç»“æœï¼Œæ‰€ä»¥å¿…é¡»è¦ç­‰åˆ°i0æ‰§è¡Œå®Œä¹‹åï¼Œi1æ‰èƒ½è¿›è¡Œå–æŒ‡</strong></p>
</li>
<li>
<p>ç¬¬äºŒæ¡æŒ‡ä»¤å­˜åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„å»¶è¿Ÿ</p>
</li>
<li>
<p><strong>å…ˆå†™åè¯»ï¼Œä¹Ÿç§°ä¸ºâ€œå†™åè¯»ç›¸å…³æ€§â€</strong></p>
</li>
<li>
<p><strong>è¿™ç§ç›¸å…³æ€§å’ŒæŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºä¸¥æ ¼ç›¸å…³ï¼Œæ˜¯çœŸå®çš„ç›¸å…³æ€§</strong></p>
</li>
</ul>
<hr>
<p><strong>Procedural dependency</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-6.png" title="/img/Computer Organization and Architecture/chapter14-6.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-6.png">
        
    </a>
<ul>
<li>
<p>åˆ†æ”¯å‰å’Œåˆ†æ”¯åçš„æŒ‡ä»¤ä¸èƒ½å¹¶è¡Œæ‰§è¡Œ</p>
</li>
<li>
<p>å¦‚æœæŒ‡ä»¤éå®šé•¿ï¼Œåˆ™å¿…é¡»å¯¹æŒ‡ä»¤è¿›è¡Œè§£ç ï¼Œæ‰èƒ½ç¡®å®šå–å¤šé•¿çš„æŒ‡ä»¤</p>
</li>
<li>
<p><strong>å¦‚æœä½¿ç”¨çš„æ˜¯å˜é•¿æŒ‡ä»¤ï¼Œåœ¨å–åç»­æŒ‡ä»¤ä¹‹å‰ï¼Œå‰ä¸€ä¸ªæŒ‡ä»¤å¿…é¡»è¦éƒ¨åˆ†è¯‘ç ï¼Œå¦åˆ™ä¸‹ä¸€ä¸ªæŒ‡ä»¤ä¸çŸ¥é“ä»å†…å­˜çš„å“ªä¸ªä½ç½®å»å–ï¼Œè¿™é˜»æ­¢äº†åŒæ—¶å–æŒ‡çš„æ“ä½œ</strong></p>
</li>
<li>
<p>è¶…æ ‡é‡æ›´é€‚åˆRISCæ¶æ„çš„ç†ç”±ä¹‹ä¸€ï¼Œå› ä¸ºRISCçš„æŒ‡ä»¤éƒ½æ˜¯å®šé•¿çš„ï¼Œä¸ä¼šæœ‰è¿™ç§ç›¸å…³æ€§</p>
</li>
</ul>
<hr>
<p><strong>Resource conflict</strong></p>
<ul>
<li>
<p>èµ„æºå†²çªï¼Œä¹Ÿç§°ä¸ºèµ„æºç›¸å…³æ€§</p>
</li>
<li>
<p>æŒ‡ä»¤i0å’Œi1åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéƒ½éœ€è¦ç”¨åˆ°åŒä¸€ä¸ªåŠŸèƒ½å•å…ƒï¼Œæ‰€ä»¥ä»–ä»¬ä¸èƒ½å¹¶è¡Œæ‰§è¡Œï¼Œåªèƒ½ä¸²è¡Œå¤„ç†ã€‚è¿™é‡Œæµªè´¹äº†ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ</p>
</li>
<li>
<p>èµ„æºå†²çªå’Œæ•°æ®ç›¸å…³æ€§çš„è¡¨ç°å·®ä¸å¤šï¼Œä½†æ˜¯èµ„æºå†²çªå¯ä»¥é€šè¿‡å¤åˆ¶èµ„æºæ¥è§£å†³ï¼Œä¾‹å¦‚åœ¨å‰é¢è®²åˆ°çš„å¢åŠ å¹²è¡£æœº</p>
</li>
</ul>
<h3 id="design-issues-of-superscalar">Design Issues of Superscalar</h3>
<h4 id="parallelism">Parallelism</h4>
<ul>
<li>
<p><strong>Factors limiting parallelism</strong></p>
<ul>
<li>
<p><strong>Instruction level parallelism</strong></p>
</li>
<li>
<p><strong>Compiler capabilities</strong></p>
</li>
<li>
<p><strong>Hardware techniques</strong></p>
</li>
</ul>
</li>
<li>
<p>Instruction level parallelism</p>
<ul>
<li>
<p>Instructions have the characteristics of parallel execution</p>
</li>
<li>
<p>Instructions in a sequence are independent</p>
</li>
<li>
<p>Execution can be overlapped</p>
</li>
<li>
<p>Governed by data and procedural dependency</p>
</li>
</ul>
</li>
</ul>
<h5 id="machine-parallelism">Machine Parallelism</h5>
<ul>
<li>
<p>Machine Parallelism</p>
<ul>
<li>
<p>Ability to take advantage of instruction level parallelism</p>
</li>
<li>
<p>Governed by number of parallel pipelines</p>
</li>
<li>
<p>The ability to find independent instructions and obtain instruction level parallelism</p>
</li>
</ul>
</li>
<li>
<p>Instructions that can be executed in parallel</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Load R1 &lt;- R2(23)
</span></span><span class="line"><span class="cl">Add R3 &lt;- R3, &#34;1&#34;
</span></span><span class="line"><span class="cl">Add R4 &lt;- R4, R2
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Instructions that cannot be executed in parallel</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Add R3 &lt;- R3, &#34;1&#34;
</span></span><span class="line"><span class="cl">Add R4 &lt;- R3, R2
</span></span><span class="line"><span class="cl">Store[R4] &lt;- R0
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="instruction-issue">Instruction issue</h4>
<ul>
<li>
<p><strong>Instruction issueï¼š the process of starting instructions to be executed by the functional unit of the processor</strong></p>
<ul>
<li>Instruction issue occurs when instruction moves from the decode stage of the pipeline to the first execute stage of the pipeline</li>
</ul>
</li>
<li>
<p><strong>In order to improve the parallelism, it is necessary to use a reasonable issue order, instead of the original order</strong></p>
</li>
<li>
<p>In essence, instruction emission is a strategy to find instructions that can enter the pipeline and be executed</p>
</li>
</ul>
<h5 id="order-about-instruction-issue">Order about instruction issue</h5>
<ul>
<li>
<p>Three sequences are involved in the command sending process</p>
<ul>
<li>
<p>Order in which instructions are fetched</p>
</li>
<li>
<p>Order in which instructions are executed</p>
</li>
<li>
<p>Order in which instructions change registers and memory</p>
</li>
</ul>
</li>
<li>
<p>The one constraint on the processor is that the result must be correct</p>
</li>
<li>
<p>Instruction issue policy refers to the protocol used to start the execution of the command</p>
</li>
</ul>
<h5 id="instruction-issue-policy">Instruction issue policy</h5>
<ul>
<li>
<p><strong>The original instruction stream itself has dependencies</strong></p>
</li>
<li>
<p>To improve the parallelism of execution, the processor may change the order in which instructions are executed</p>
</li>
<li>
<p>The more sophisticated the processor, the less it is bound by a strict relationship between these orderings</p>
</li>
<li>
<p><strong>There are three issue policy</strong></p>
<ul>
<li>
<p><strong>In-order issue with in-order completion</strong></p>
</li>
<li>
<p><strong>In-order issue with out-of-order completion</strong></p>
</li>
<li>
<p><strong>Out-of order issue with out-of â€“order completion</strong></p>
</li>
</ul>
</li>
</ul>
<h6 id="in-order-issuein-order-completion">In-order issue/in-order completion</h6>
<ul>
<li>
<p>Issue instructions in the order they occur</p>
</li>
<li>
<p>Write the results in the same order to complete the execution of instructions</p>
</li>
<li>
<p><strong>Very inefficientï¼Œeven scalar pipeline will not use policy</strong></p>
</li>
<li>
<p>In Superscalar pipeline</p>
<ul>
<li>
<p>May fetch more than one instruction</p>
</li>
<li>
<p><strong>To ensure orderly completion, when the functional units conflict, or the execution of the functional units requires multiple cycles, instruction issue must wait</strong></p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-7.png" title="/img/Computer Organization and Architecture/chapter14-7.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-7.png">
        
    </a>
<ul>
<li>
<p><strong>è¶…æ ‡é‡å¤„ç†å™¨æœ‰2ä¸ªç‹¬ç«‹çš„æµæ°´çº¿ï¼Œèƒ½å¤ŸåŒæ—¶å–2ä¸ªæŒ‡ä»¤</strong></p>
</li>
<li>
<p><strong>æœ‰3ä¸ªæ‰§è¡Œå•å…ƒï¼Œä»¥åŠ2ä¸ªå†™å›çš„å•å…ƒ</strong></p>
</li>
<li>
<p>I1éœ€è¦2ä¸ªå‘¨æœŸå®Œæˆæ‰§è¡Œï¼›I3å’ŒI4éœ€è¦åŒæ—¶ä½¿ç”¨æŸä¸ªåŠŸèƒ½å•å…ƒï¼Œå¯¼è‡´å‡ºç°å†²çªï¼›I5ä¾èµ–äºI4çš„ç»“æœï¼›I5å’ŒI6éœ€è¦åŒæ—¶ä½¿ç”¨æŸä¸ªåŠŸèƒ½å•å…ƒï¼Œå¯¼è‡´å‡ºç°å†²çª</p>
</li>
<li>
<p>æˆå¯¹å–æŒ‡å¹¶é€åˆ°è¯‘ç å•å…ƒè¿›è¡Œè¯‘ç ã€‚I1éœ€è¦èŠ±è´¹2ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰§è¡Œã€‚æ‰€ä»¥I3å’ŒI4éœ€è¦åœ¨ç¬¬å››ä¸ªå‘¨æœŸå¼€å§‹æ‰§è¡Œã€‚ç”±äºI3å’ŒI4èµ„æºå†²çªï¼Œæ‰€ä»¥I3å’ŒI4éœ€è¦é¡ºåºæ‰§è¡Œã€‚I5éœ€è¦ä¾èµ–I4çš„ç»“æœï¼Œå¹¶ä¸”I5å’ŒI6å­˜åœ¨èµ„æºå†²çªï¼Œæ‰€ä»¥I5å’ŒI6éœ€è¦ä¸²è¡Œæ‰§è¡Œ</p>
</li>
<li>
<p>8ä¸ªæŒ‡ä»¤ï¼Œæ€»å…±éœ€è¦8ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰èƒ½å®Œæˆ</p>
</li>
<li>
<p>ç”±äºæŒ‡ä»¤æ‰§è¡Œçš„æ—¶é—´ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¦‚æœåŒæ—¶å‘å°„çš„æŒ‡ä»¤ç»™æ‰§è¡Œå•å…ƒï¼Œéœ€è¦ç­‰å…¨éƒ¨æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ¬¡å‘å°„</p>
</li>
<li>
<p>å¦‚æœæŒ‡ä»¤é—´å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œéœ€è¦åœæ­¢è°ƒåº¦è¡Œä¸ºï¼Œç­‰å…·å¤‡æ¡ä»¶ä¹‹åï¼Œæ‰èƒ½è¿›è¡ŒæŒ‡ä»¤å‘å°„</p>
</li>
</ul>
<hr>
<h6 id="in-order-issueout-of-order-completion">In-order issue/out-of-order completion</h6>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-8.png" title="/img/Computer Organization and Architecture/chapter14-8.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-8.png">
        
    </a>
<ul>
<li>
<p>I1å’ŒI2åŒæ—¶å‘å°„åˆ°æ‰§è¡Œå•å…ƒï¼Œç”±äºI2åªéœ€è¦1ä¸ªå‘¨æœŸå®Œæˆï¼Œæ‰€ä»¥I2å¯ä»¥å…ˆå®Œæˆã€‚I3å¯ä»¥å’ŒI1åŒæ—¶æ‰§è¡Œï¼Œå¹¶è¿›å…¥å†™çš„é˜¶æ®µ</p>
</li>
<li>
<p>I4ç”±äºå’ŒI3èµ„æºå†²çªï¼Œæ‰€ä»¥éœ€è¦ç­‰I3å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œã€‚I5ä¾èµ–äºI4çš„ç»“æœï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ç­‰å¾…I4ï¼ŒåŒç†I6éœ€è¦ç­‰å¾…I5</p>
</li>
<li>
<p>æ•´ä½“ä¸Šéœ€è¦7ä¸ªå‘¨æœŸå®ŒæˆæŒ‡ä»¤çš„æ‰§è¡Œ</p>
</li>
</ul>
<hr>
<p><strong>Output (write-write) dependency</strong></p>
<ul>
<li>In the process of out of sequence completion, the execution order is different from the original order, which may lead to output dependency problems</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">R3 = R3 + R5 ;(l1)
</span></span><span class="line"><span class="cl">R4 = R3 + 1  ;(l2)
</span></span><span class="line"><span class="cl">R3 = R5 + 1  ;(l3)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Analyze
<ul>
<li>I2 depends on result of I1 - data dependency</li>
<li>If I3 completes before I1, the result from I1 will be wrong - output (write-write) dependency</li>
</ul>
</li>
</ul>
<hr>
<p><strong>How?</strong></p>
<ul>
<li>
<p><strong>Adopt dynamic scheduling strategy</strong></p>
</li>
<li>
<p>Idea: Move the dependent instructions out of the way of independent ones (s.t. independent ones can execute)</p>
<ul>
<li>Rest areas for dependent instructions: Reservation stations</li>
</ul>
</li>
<li>
<p>Monitor the source â€œvaluesâ€ of each instruction in the resting area</p>
</li>
<li>
<p>When all source â€œvaluesâ€ of an instruction are available, â€œfireâ€ (i.e. dispatch) the instruction</p>
<ul>
<li>Instructions dispatched in <strong>data-flow orderï¼Œnot control-flow</strong></li>
</ul>
</li>
<li>
<p>Benefit</p>
<ul>
<li>
<p>Latency tolerance: Allows independent instructions to execute and complete in the presence of a long latency operation</p>
</li>
<li>
<p>Reasonably schedule instructions with dependencies</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p><strong>Problem about In-order issue</strong></p>
</li>
<li>
<p>When decoding instructions, if there are related points or conflicting points, the decoding needs to stop</p>
</li>
<li>
<p>In this way, subsequent instructions cannot be decoded</p>
</li>
<li>
<p>At this time, the processor cannot check whether any instruction is independent and can be executed on the pipeline</p>
</li>
</ul>
<hr>
<h6 id="out-of-order-issueout-of-order-completion">Out-of-order issue/out-of-order completion</h6>
<ul>
<li>
<p>Solution: decouple decode from execution</p>
</li>
<li>
<p>Decode</p>
<ul>
<li>
<p>Decode stage can continuously fetch and decode</p>
</li>
<li>
<p>Decoded instruction is put into the buffer</p>
</li>
<li>
<p>As long as the buffer is not full, fetching and decoding can continue</p>
</li>
</ul>
</li>
<li>
<p>Execution</p>
<ul>
<li>
<p>When the functional unit is available, transmit the executable instructions to execute</p>
</li>
<li>
<p>Since the instruction has been decoded, the processor can first identify whether the instruction can be executed</p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-9.png" title="/img/Computer Organization and Architecture/chapter14-9.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-9.png">
        
    </a>
<ul>
<li>ç¬¬ä¸€ä¸ªå‘¨æœŸï¼ŒI1å’ŒI2è¿›è¡Œè§£ç ï¼Œå®Œæˆè§£ç åè¿›å…¥å‘å°„ç¼“å†²åŒºã€‚æ‰§è¡Œå•å…ƒä¸ºç©ºï¼ŒI1å’ŒI2è¢«å‘å°„å‡ºå»æ‰§è¡Œ</li>
<li>ç¬¬äºŒä¸ªå‘¨æœŸï¼ŒI3å’ŒI4è¿›è¡Œè§£ç ï¼Œå®Œæˆè§£ç åè¿›å…¥å‘å°„ç¼“å†²åŒºã€‚ç”±äºI3å’ŒI4å…±ç”¨æ‰§è¡Œå•å…ƒï¼ŒI3å‘å°„å‡ºå»è¿›è¡Œæ‰§è¡Œ</li>
<li>ç¬¬ä¸‰ä¸ªå‘¨æœŸï¼ŒI5å’ŒI6è¿›è¡Œè§£ç ï¼Œå®Œæˆè§£ç åè¿›å…¥å‘å°„ç¼“å†²åŒºã€‚æ­¤æ—¶ï¼ŒI3æ‰§è¡Œå®Œäº†ï¼Œæ‰€ä»¥I4å¯ä»¥å‘å°„äº†ã€‚åŒæ—¶ç”±äºI5å’ŒI4æœ‰æ•°æ®ç›¸å…³æ€§ï¼Œæ‰€ä»¥I5ä¸èƒ½å‘å°„ï¼Œäºæ˜¯æŠŠI6å‘å°„å‡ºå»æ‰§è¡Œ</li>
<li>ç¬¬å››ä¸ªå‘¨æœŸï¼Œæ²¡æœ‰æŒ‡ä»¤éœ€è¦è§£ç </li>
<li>ç¬¬äº”ä¸ªå‘¨æœŸï¼Œæ²¡æœ‰æŒ‡ä»¤éœ€è¦è§£ç ã€‚æ­¤æ—¶å‘å°„ç¼“å†²åŒºåªæœ‰I5ã€‚I6æ‰§è¡Œå®Œæˆï¼Œå¯ä»¥å‘å°„I5æŒ‡ä»¤ã€‚I5åœ¨ç¬¬äº”ä¸ªæ—¶é’Ÿå‘¨æœŸå®Œæˆæ‰§è¡Œï¼Œå¹¶åœ¨ç¬¬å…­ä¸ªæ—¶é’Ÿå‘¨æœŸå®Œæˆå†™å…¥æ“ä½œ</li>
<li>æ•´ä¸ªè¿‡ç¨‹éœ€è¦6ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚æ¯”ä¹‹å‰çš„åˆç¼©çŸ­äº†1ä¸ªå‘¨æœŸ</li>
</ul>
<h6 id="anti-dependencywrite-after-read">Anti-dependency(Write-after-read)</h6>
<ul>
<li>
<p>Out-of-order issue/out-of-order completion also need to comply with restrictions</p>
</li>
<li>
<p>Anti correlation occurs</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">R3 = R3 + R5 ;l1
</span></span><span class="line"><span class="cl">R4 = R3 + 1  ;l2
</span></span><span class="line"><span class="cl">R3 = R5 + 1  ;l3
</span></span><span class="line"><span class="cl">R7 = R3 + R4 ;l4
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Analyze
<ul>
<li>I3 can not complete before I2 starts as I2 needs a value in R3 and I3 changes R3</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Dependency Analyzing</strong></p>
<ul>
<li>
<p>True data dependency reflects the real dependency between data</p>
</li>
<li>
<p>In essence, anti dependency and output dependency are caused by register conflict</p>
<ul>
<li>Register contents may not reflect the correct ordering from the program</li>
</ul>
</li>
<li>
<p>Instruction issue stops, pipeline stall</p>
<ul>
<li>Processor pauses for one cycle</li>
</ul>
</li>
<li>
<p>This situation is more serious when register optimization technology is used</p>
<ul>
<li>
<p>Register optimization technology maximizes the use of registers to improve performance</p>
</li>
<li>
<p>Register conflicts will be more significant</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Register renaming</strong></p>
<ul>
<li>
<p>Registers are dynamically allocated by hardware</p>
</li>
<li>
<p>When an instruction with a register as the destination operand is executed, a new register is allocated</p>
</li>
<li>
<p><strong>The instruction that accesses the original register after this instruction must be modified to the newly allocated register to maintain consistency</strong></p>
</li>
<li>
<p>Avoid dependencies caused by register conflicts</p>
</li>
</ul>
<hr>
<ul>
<li><strong>Original</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">R3 = R3 + R5 ;I1
</span></span><span class="line"><span class="cl">R4 = R3 + 1  ;I2
</span></span><span class="line"><span class="cl">R3 = R5 + 1  ;I3
</span></span><span class="line"><span class="cl">R7 = R3 + R4 ;I4
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>I1å’ŒI2å­˜åœ¨çœŸå®æ•°æ®ç›¸å…³æ€§</p>
</li>
<li>
<p>I3å’ŒI4å­˜åœ¨çœŸå®æ•°æ®ç›¸å…³æ€§</p>
</li>
<li>
<p>I3å’ŒI2å­˜åœ¨åç›¸å…³æ€§ï¼Œè¯»åå†™</p>
</li>
<li>
<p>I3å’ŒI1å­˜åœ¨è¾“å‡ºç›¸å…³æ€§ï¼Œå†™åå†™</p>
</li>
<li>
<p><strong>Register renaming</strong></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">R3b = R3a + R5a ;l1
</span></span><span class="line"><span class="cl">R4b = R3b + 1   ;l2
</span></span><span class="line"><span class="cl">R3c = R5a + 1   ;l3
</span></span><span class="line"><span class="cl">R7 = R3c + R4b  ;l4
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>é‡‡ç”¨å¯„å­˜å™¨é‡å‘½åçš„è§„åˆ™ï¼ŒI1çš„R3ä¿®æ”¹æˆR3bï¼ŒI3ä¸­çš„R3ï¼Œä¿®æ”¹æˆR3cã€‚</p>
</li>
<li>
<p><strong>I3å’ŒI2ä¹‹é—´çš„åç›¸å…³æ€§æ²¡æœ‰äº†ï¼ŒI3å’ŒI1ä¹‹é—´çš„è¾“å‡ºç›¸å…³æ€§ä¹Ÿæ²¡æœ‰äº†ï¼ŒI3å¯ä»¥ç«‹å³å‘å°„</strong></p>
</li>
<li>
<p><strong>çœŸå®æ•°æ®ç›¸å…³æ€§æ— æ³•é€šè¿‡å¯„å­˜å™¨é‡å‘½åæ¥è§£å†³</strong></p>
</li>
</ul>
<h4 id="analysis-of-three-technologies---">Analysis of three technologies ! ! !</h4>
<ul>
<li>
<p><strong>Techniques for improving performance in superscalar processors</strong></p>
<ul>
<li>
<p><strong>Duplication of Resources</strong></p>
</li>
<li>
<p><strong>Out of order issue</strong></p>
</li>
<li>
<p><strong>Renaming</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Resources are the foundation</strong></p>
<ul>
<li>Sufficient resources to execute multiple pipelines</li>
</ul>
</li>
<li>
<p><strong>Out of order issue is the method</strong></p>
<ul>
<li>Provide executable instructions through disordered transmissionRenaming is a guarantee</li>
</ul>
</li>
<li>
<p><strong>Renaming is a guarantee</strong></p>
<ul>
<li>Rename mechanism reduces the correlation between instructions</li>
</ul>
</li>
</ul>
<h4 id="about-instruction-window">About instruction window</h4>
<ul>
<li>
<p>Out of order issue: register window is used to cache instructions after decoding</p>
</li>
<li>
<p>Through the register window, the processor can identify independent instructions that can be placed in the execution segment</p>
</li>
<li>
<p><strong>If the instruction window is very small, the probability of successful recognition is very low</strong></p>
</li>
<li>
<p><strong>The instruction window needs to be large enough to find independent instructions and use the hardware more effectively</strong></p>
</li>
<li>
<p><strong>Need instruction window large enough (more than 8)</strong></p>
</li>
</ul>
<hr>
<p><strong>Effect of technology</strong></p>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter14-10.png" title="/img/Computer Organization and Architecture/chapter14-10.png" data-thumbnail="/img/Computer Organization and Architecture/chapter14-10.png" data-sub-html="<h2>Without Procedural Dependencies</h2>">
        
    </a><figcaption class="image-caption"><code>Without Procedural Dependencies</code></figcaption>
    </figure>
<ul>
<li>
<p>Baseï¼šä¸å¤åˆ¶ä»»ä½•åŠŸèƒ½å•å…ƒ</p>
</li>
<li>
<p>+Id/stï¼šå¢åŠ äº†è£…å…¥/å­˜å‚¨å•å…ƒ</p>
</li>
<li>
<p>+aluï¼šå¢åŠ äº†ALUå•å…ƒ</p>
</li>
<li>
<p>+bothï¼šå¢åŠ äº†ALUå’ŒId/st</p>
</li>
<li>
<p>ä¸è€ƒè™‘è¿‡ç¨‹ç›¸å…³æ€§</p>
</li>
<li>
<p>æ²¡æœ‰é‡‡ç”¨å¯„å­˜å™¨é‡å‘½åï¼Œå¢åŠ ç¡¬ä»¶æ‰§è¡Œæ•ˆæœå¹¶ä¸æ˜æ˜¾ã€‚è€Œé‡‡ç”¨å¯„å­˜å™¨é‡å‘½ååï¼Œå¢åŠ äº†ALUä¼šæ˜æ˜¾æé«˜åŠ é€Ÿæ¯”</p>
</li>
<li>
<p>ä»å‘å°„çª—å£çš„è§’åº¦æ¥çœ‹ï¼Œçª—å£æ•°é‡ä»8ä¸ªå¢åŠ åˆ°16ä¸ªï¼Œæ•ˆæœå°±å¾ˆæ˜æ˜¾ã€‚ä½†ä»16ä¸ªåˆ°32ä¸ªï¼Œæ•ˆæœç¨å·®ä¸€äº›</p>
</li>
<li>
<p><strong>èµ„æºå¤åˆ¶ã€ä¹±åºå‘å°„ã€å¯„å­˜å™¨é‡å‘½åä¸‰è€…ç›¸äº’å½±å“</strong></p>
</li>
</ul>
<h4 id="consideration-of-control-dependence">Consideration of control dependence</h4>
<ul>
<li>
<p>Also called branch hazard</p>
</li>
<li>
<p>When branching instructions, it is not possible to determine which instruction to execute after the branch</p>
</li>
<li>
<p>In the pipeline, after prefetching the wrong instruction, it is necessary to discard and re fetch the instruction, which causes the pipeline to fail to run with full load</p>
</li>
</ul>
<p><strong>Methods</strong></p>
<ul>
<li>
<p>Processing method of control dependence</p>
<ul>
<li>
<p>Multiple Streams</p>
</li>
<li>
<p>Prefetch Branch Target</p>
</li>
<li>
<p>Loop buffer</p>
</li>
<li>
<p>Branch prediction</p>
</li>
<li>
<p>Delayed branching</p>
</li>
</ul>
</li>
<li>
<p>Goal: Keep the pipeline running full</p>
</li>
</ul>
<p><strong>About delayed branch</strong></p>
<ul>
<li>
<p>Delayed branching is often used in RIS</p>
</li>
<li>
<p>Calculate result of branch before unusable instructions pre-fetched</p>
<ul>
<li>
<p>Instructions that are not affected by branches are immediately followed by branch</p>
</li>
<li>
<p>Keeps pipeline full while fetching new instruction stream</p>
</li>
</ul>
</li>
<li>
<p>Not as good for superscalar</p>
<ul>
<li>Multiple instructions need to execute in delay slot</li>
<li>Instruction dependence problems</li>
<li>Often use branch prediction</li>
</ul>
</li>
</ul>
<p><strong>Superscalar execution</strong></p>
<ul>
<li>
<p>é™æ€ç¨‹åºé€šè¿‡å–æŒ‡å’Œåˆ†æ”¯é¢„æµ‹ï¼Œå½¢æˆåŠ¨æ€çš„æŒ‡ä»¤æµ</p>
</li>
<li>
<p>æŒ‡ä»¤æµç»è¿‡å¤„ç†å™¨çš„ç›¸å…³æ€§æ£€æŸ¥ï¼Œä¼šå»æ‰ä¸å¿…è¦çš„ç›¸å…³æ€§ï¼Œæ¯”å¦‚åç›¸å…³å’Œè¾“å‡ºç›¸å…³ã€‚ç„¶åå°†æŒ‡ä»¤æ”¾åˆ°æ‰§è¡Œçª—å£ä¸­ï¼Œç­‰å¾…æ‰§è¡Œ</p>
</li>
<li>
<p>åœ¨æ‰§è¡Œçª—å£ä¸­çš„æŒ‡ä»¤ï¼Œæ ¹æ®çœŸå®æ•°æ®ç›¸å…³æ€§æ¥æ’åºã€‚å¤„ç†å™¨æ ¹æ®çœŸå®æ•°æ®ç›¸å…³æ€§å’Œèµ„æºå¯ç”¨æ€§ï¼Œæ¥å‘å°„æŒ‡ä»¤åˆ°æ‰§è¡Œå•å…ƒè¿›è¡Œæ‰§è¡Œ</p>
</li>
<li>
<p>æœ€åçš„æ‰§è¡Œç»“æœéœ€è¦æœ‰ä¸€ä¸ªæäº¤çš„æ­¥éª¤ã€‚å› ä¸ºæŒ‡ä»¤ä¸æ˜¯æŒ‰ç…§åŸæœ‰çš„é¡ºåºæ¥æ‰§è¡Œçš„ï¼ŒåŒæ—¶åˆ†æ”¯é¢„æµ‹å’Œæ¨æµ‹æ‰§è¡Œä½¿å¾—æœ‰äº›æ‰§è¡Œçš„ç»“æœéœ€è¦ä¸¢å¼ƒ</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Simultaneously fetch multiple instructions</p>
<ul>
<li>
<p>Multiple fetching and decoding</p>
</li>
<li>
<p>Branch prediction logic</p>
</li>
</ul>
</li>
<li>
<p>Logic to determine true dependencies involving register values</p>
<ul>
<li>Determine instruction position of true correlation</li>
</ul>
</li>
<li>
<p>Dealing with unnecessary dependencies</p>
<ul>
<li>Anti-dependency and output dependency</li>
</ul>
</li>
<li>
<p>Mechanisms to initiate multiple instructions in parallel</p>
<ul>
<li>
<p>Instruction window</p>
</li>
<li>
<p>Out of order issue logic</p>
</li>
</ul>
</li>
<li>
<p>Resources for parallel execution of multiple instructions</p>
<ul>
<li>The system has sufficient resources</li>
</ul>
</li>
<li>
<p>Mechanisms for committing process state in correct order</p>
<ul>
<li>Submit results according to the order of instructions</li>
</ul>
</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>
<p><strong>Resources are the foundation</strong></p>
<ul>
<li><strong>Machine parallelism</strong></li>
</ul>
</li>
<li>
<p><strong>Out of order issue is the method</strong></p>
<ul>
<li><strong>Instruction level parallelism</strong></li>
</ul>
</li>
<li>
<p><strong>Renaming is a guarantee</strong></p>
<ul>
<li><strong>Methods of improving instruction level parallelism</strong></li>
</ul>
</li>
<li>
<p>Through superscalar pipeline, multiple pipelines can run at the same time to achieve truly parallel operation at the instruction level</p>
</li>
</ul>
]]></description>
</item>
<item>
    <title>Computer Organization and Architecture Reduced Instruction Set Computers</title>
    <link>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-reduced-instruction-set-computers/</link>
    <pubDate>Sun, 29 Jan 2023 16:34:59 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-reduced-instruction-set-computers/</guid>
    <description><![CDATA[<h1 id="computer-organization-and-architecture">Computer Organization and Architecture</h1>
<h2 id="reduced-instruction-set-computers">Reduced Instruction Set Computers</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>
<p>Register and instruction architecture</p>
</li>
<li>
<p>Reduced Instruction Set Architecture</p>
</li>
<li>
<p>The Use of a Large Register File</p>
</li>
<li>
<p>Compiler-Based Register Optimization</p>
</li>
<li>
<p><code>RISC</code> Pipelining</p>
</li>
<li>
<p><code>RISC</code> Versus <code>CISC</code> Controversy</p>
</li>
</ul>
<h3 id="register-and-instruction-architecture">Register and instruction architecture</h3>
<p><strong>Major advanced in computers</strong></p>
<ul>
<li>
<p><strong>The family concept</strong></p>
<ul>
<li>
<p>IBM System/360 1964ï¼ŒDEC PDP-8</p>
</li>
<li>
<p><strong>Separates architecture from implementation</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Microprogrammed control unit</strong></p>
<ul>
<li>
<p>Idea by Wilkes 1951,Produced by IBM S/360 1964</p>
</li>
<li>
<p><strong>Easier controller design and implementation</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Cache</strong></p>
<ul>
<li>
<p>IBM S/360 model 85 1969</p>
</li>
<li>
<p><strong>Greatly improves the performance of computer</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Microprocessors</strong></p>
<ul>
<li>
<p>Intel 4004 1971</p>
</li>
<li>
<p><strong>Reduced the size of the computer</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Pipelining</strong></p>
<ul>
<li>
<p><strong>Introducing parallelism into instruction execution</strong></p>
</li>
<li>
<p><strong>Greatly improves instruction throughput</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Multiple processors</strong></p>
<ul>
<li>
<p><strong>Multiple processors combine to form a new architecture</strong></p>
</li>
<li>
<p><strong>Further improve the processing capacity of the computer</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>RISC</strong></p>
<ul>
<li>
<p>Major challenges to traditional CPU</p>
</li>
<li>
<p>It has been widely used</p>
</li>
<li>
<p>Learn from RISC and be widely used in different fields</p>
</li>
</ul>
</li>
<li>
<p>Solid State RAM</p>
<ul>
<li>Access speed is much faster than mechanical hard disk</li>
<li>Greatly improves the computerâ€™s I/O performance</li>
</ul>
</li>
</ul>
<h4 id="register-and-isas">Register and ISAs</h4>
<ul>
<li>
<p>Accumulators</p>
<ul>
<li>
<p>Early stored-program computers had <strong>one</strong> register</p>
</li>
<li>
<p>Very inconvenient to use</p>
</li>
<li>
<p>Requires a memory-based operand-addressing mode in instruction</p>
</li>
</ul>
</li>
</ul>
<p>Example</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ADD 200
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><strong>Add the accumulator to the word in memory at address 200</strong></p>
</li>
<li>
<p>Place the sum back in the accumulator</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Next step, more registersâ€¦</p>
<ul>
<li>
<p>Dedicated registers</p>
<ul>
<li>
<p>separate accumulators for multiply or divide instructions</p>
</li>
<li>
<p>op-of-stack pointer</p>
</li>
</ul>
</li>
<li>
<p>Extended Accumulator</p>
<ul>
<li>Increase bits of register</li>
<li>Increase the number of registers</li>
</ul>
</li>
</ul>
</li>
<li>
<p>More flexible</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Next step, more registersâ€¦</p>
<ul>
<li>General-purpose registers
<ul>
<li>Registers can be used for any purpose E.g. MIPS, ARM, x86</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Instruction architecture</p>
<ul>
<li>
<p><em>Register-memory</em> architectures</p>
<ul>
<li><strong>One operand may be in memory</strong> (i.e. 80386 processors)</li>
</ul>
</li>
<li>
<p><em>Register-register</em> architectures (load-store)</p>
<ul>
<li><strong>All operands must be in registers</strong> E.g. MIPS, ARM</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="comparison-of-processors">Comparison of processors</h4>
<ul>
<li>
<p>æŒ‡ä»¤æ•°é‡ã€é•¿åº¦ã€å¯»å€æ–¹å¼ç­‰æ–¹é¢ï¼ŒCISCæ˜æ˜¾é«˜äºRISC</p>
</li>
<li>
<p>RISCå’Œè¶…æ ‡é‡çš„é€šç”¨å¯„å­˜å™¨æ•°é‡æ¯”CISCè¦å¤š</p>
</li>
<li>
<p>RISCå’Œè¶…æ ‡é‡ä¸€èˆ¬é‡‡ç”¨ç¡¬å¸ƒçº¿æ§åˆ¶ï¼Œæ‰€ä»¥æ²¡æœ‰é…ç½®æ§åˆ¶å­˜å‚¨å™¨</p>
</li>
</ul>
<h3 id="reduced-instruction-set-architecture">Reduced Instruction Set Architecture</h3>
<h4 id="cisc">CISC</h4>
<ul>
<li>
<p><strong>CISC&ndash;Complex Instruction Set Computer</strong></p>
</li>
<li>
<p>With the development of computer technology, an instruction set design concept is proposed</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>The gap between high-level programming languages and instruction sets is growing</p>
<ul>
<li>
<p><strong>Need more complex compilers to translate high-level languages</strong></p>
</li>
<li>
<p><strong>A high-level language statement requires multiple instructions to completeï¼Œlow execution efficiency</strong></p>
</li>
</ul>
</li>
<li>
<p>CISC proposed by instruction set designer</p>
<ul>
<li>
<p><strong>Provides more types of instructions, and even uses a single instruction to implement complex high-level language statements</strong></p>
</li>
<li>
<p><strong>Provide more addressing modes to meet the needs of high-level languages for various addressing</strong></p>
</li>
</ul>
</li>
</ul>
<h5 id="characteristics-of-cisc">Characteristics of CISC</h5>
<ul>
<li>
<p>There are many kinds of instruction opcodes</p>
<ul>
<li>The opcode of X86 is 1-2 bytes</li>
</ul>
</li>
<li>
<p>Variable instruction length</p>
<ul>
<li>The instruction length of X86 is 1-16 bytes</li>
</ul>
</li>
<li>
<p>Various addressing modes</p>
<ul>
<li><strong>X86 has 9 addressing modes</strong>, such as base address proportional index band offset</li>
</ul>
</li>
</ul>
<h5 id="ideal-effect-of-cisc">Ideal effect of CISC</h5>
<ul>
<li>
<p><strong>Compilers are easy to write</strong></p>
<ul>
<li>
<p>The instruction set provides many types of instructions</p>
</li>
<li>
<p>The compiler can use the most appropriate instructions to translate statements in high-level languages. Less instructions after compilation and less space</p>
</li>
<li>
<p>The instruction set provides rich addressing modes</p>
</li>
<li>
<p>Meet the requirements of high-level language for flexible addressing mode</p>
</li>
</ul>
</li>
<li>
<p>Improve the execution efficiency of high-level language statements</p>
<ul>
<li>
<p>It used to require multiple instructions to complete statements in a high-level language, but now it can be completed with one instruction, and some high-level language statements can be implemented at the hardware level</p>
</li>
<li>
<p>Instruction level addressing mode to help implement complex instructions</p>
</li>
</ul>
</li>
</ul>
<h5 id="instruction-execution-characteristics">Instruction execution characteristics</h5>
<ul>
<li>
<p>Operations performed</p>
<ul>
<li>Functions that can be completed by CPU and interaction with memory</li>
</ul>
</li>
<li>
<p>Operands used</p>
<ul>
<li>Type and frequency of operandsï¼Œwhich determine the organization and addressing mode of the storage system</li>
</ul>
</li>
<li>
<p>Execution sequencing</p>
<ul>
<li>Control function and pipeline organization</li>
</ul>
</li>
</ul>
<h6 id="operations">Operations</h6>
<ul>
<li>
<p>It is best to optimize the most used and time-consuming statements</p>
</li>
<li>
<p>Assignments</p>
<ul>
<li>Movement of data</li>
</ul>
</li>
<li>
<p>Condition(Loop and IF)</p>
<ul>
<li>Sequence control</li>
</ul>
</li>
<li>
<p>Procedure call-return</p>
<ul>
<li>Very time consuming</li>
</ul>
</li>
<li>
<p><strong>è¿‡ç¨‹è°ƒç”¨å’Œè¿”å›æ˜¯å…¸å‹çš„é«˜çº§è¯­è¨€ç¨‹åºä¸­æœ€è€—æ—¶çš„æ“ä½œ</strong></p>
</li>
<li>
<p><strong>å¾ªç¯è¯­å¥ã€æ¡ä»¶è¯­å¥å’Œå¹…å€¼è¯­å¥ä¹Ÿå å¾ˆå¤§çš„æ¯”é‡</strong></p>
</li>
</ul>
<hr>
<ul>
<li>Operands
<ul>
<li>
<p>ä¸»è¦æ˜¯å±€éƒ¨æ ‡é‡å˜é‡</p>
</li>
<li>
<p>ä¼˜åŒ–æ–¹å‘åº”é›†ä¸­äºæœ¬åœ°å˜é‡çš„å­˜å‚¨å’Œè®¿é—®</p>
</li>
</ul>
</li>
</ul>
<h5 id="procedure-calls">Procedure calls</h5>
<ul>
<li>
<p><strong>Very time consuming</strong></p>
<ul>
<li>
<p>Depends on number of parameters passed</p>
</li>
<li>
<p>Depends on level of nesting</p>
</li>
</ul>
</li>
<li>
<p>Characteristics</p>
<ul>
<li>
<p>Number of parameter is mostly less than 6</p>
</li>
<li>
<p>Most variables are local</p>
</li>
<li>
<p>Most programs do not do a lot of calls followed by lots of returns</p>
</li>
</ul>
</li>
<li>
<p>It further explains that operand access is highly localized</p>
</li>
</ul>
<h5 id="summary">Summary</h5>
<ul>
<li>
<p>Assignment statement</p>
<ul>
<li>
<p>high proportion, valuable to improve efficiency</p>
</li>
<li>
<p>Need to access cache or storage</p>
</li>
<li>
<p>Use register access to reduce memory access and improve efficiency</p>
</li>
</ul>
</li>
<li>
<p>Condition and procedure calls</p>
<ul>
<li>
<p>time consuming, high proportion, valuable to improve efficiency</p>
</li>
<li>
<p>Influence the execution of the pipeline</p>
</li>
<li>
<p>Design a better pipeline to reduce the impact of transfer statements on the water line</p>
</li>
</ul>
</li>
</ul>
<p><strong>å•çº¯ä¾é æä¾›æ¥è¿‘äºé«˜çº§è¯­è¨€çš„æŒ‡ä»¤å¹¶ä¸ä¸€å®šèƒ½æé«˜å…¸å‹è¯­å¥çš„æ‰§è¡Œæ•ˆç‡</strong></p>
<hr>
<ul>
<li>
<p><strong>Ideal 1 of CISC: Compilers are easy to write</strong></p>
</li>
<li>
<p>Implementation method: complex instruction</p>
</li>
<li>
<p>Compiler simplification?</p>
<ul>
<li>
<p>Because of strict requirements of instruction designï¼Œcompiler needs high-level language strictly meet the instruction</p>
</li>
<li>
<p>The compiler needs to optimize machine instructions to reduce the length of generated machine code and meet the requirements of pipeline operation. This is also difficult to achieve for complex instructions Optimization more difficult</p>
</li>
</ul>
</li>
<li>
<p><strong>Ideal 2 of CISC: smaller programs</strong></p>
</li>
<li>
<p>Implementation method: mores instruction</p>
</li>
<li>
<p>Smaller programs?</p>
<ul>
<li>
<p>Program looks using less memory</p>
</li>
<li>
<p>Memory is now cheap</p>
</li>
<li>
<p>May not occupy less bits, just look shorter in symbolic form</p>
</li>
<li>
<p>More instructions require longer op-codes</p>
</li>
<li>
<p>CISC has no fewer machine instructions than RISC</p>
</li>
</ul>
</li>
<li>
<p><strong>Ideal 3 of CISC: high efficiency</strong></p>
</li>
<li>
<p>Implementation method: more instructions and more addressing mode</p>
</li>
<li>
<p>Faster programs?</p>
<ul>
<li>
<p>Compiler bias towards use of simpler instructions</p>
</li>
<li>
<p>CISC need more complex control unit</p>
</li>
<li>
<p>Microprogram control store larger</p>
</li>
<li>
<p>Simple instructions take longer to execute</p>
</li>
</ul>
</li>
</ul>
<h5 id="conclusion">Conclusion</h5>
<ul>
<li>
<p>The goal CISC hopes to achieve is actually contradictory to the way CISC realizes it</p>
</li>
<li>
<p>Target: improve operational efficiency by optimizing the most frequently used and time-consuming functions</p>
</li>
<li>
<p>Following methods may be better choices</p>
<ul>
<li>
<p>More registers to reduce memory access</p>
</li>
<li>
<p>Careful design of pipeline to improve the efficiency of the pipeline</p>
</li>
<li>
<p>Careful designed simple instruction set to improve the efficiency of instruction execution</p>
</li>
</ul>
</li>
</ul>
<h4 id="risc">RISC</h4>
<ul>
<li>
<p>RISC: Reduced Instruction Set Computer</p>
</li>
<li>
<p>Key features</p>
<ul>
<li>
<p><strong>Large number of general purpose registers</strong></p>
</li>
<li>
<p><strong>Compiler technology to optimize register use</strong></p>
</li>
<li>
<p><strong>Limited and simple instruction set</strong></p>
</li>
<li>
<p><strong>Emphasis on optimising the instruction pipeline</strong></p>
</li>
</ul>
</li>
</ul>
<p><strong>Main contributors of RISC</strong></p>
<ul>
<li>
<p>John Cocke: IBM</p>
<ul>
<li>Influences: Known as â€œthe father of RISC Architectureâ€. Turing Award Recipient and National Medal of Science</li>
</ul>
</li>
<li>
<p>Dave Patterson: UC Berkeley</p>
<ul>
<li>Influences: Sun SPARC from his achievements</li>
</ul>
</li>
<li>
<p>John L. Hennessy: Stanford</p>
<ul>
<li>Influences: In 1984, MIPS (Microprocessor without interlocked pipelined stages) was founded</li>
</ul>
</li>
</ul>
<h5 id="typical-features-of-risc">Typical features of RISC</h5>
<ul>
<li>
<p><strong>Simplified instruction set</strong></p>
<ul>
<li>
<p><strong>Standardized, fixed length</strong> instruction format (ARM instructions are all 32-bit)</p>
</li>
<li>
<p><strong>Limited operation types, only 8-bit operation code</strong></p>
</li>
<li>
<p><strong>Fetching and decoding instruction become easier</strong></p>
</li>
<li>
<p>One instruction per machine cycle</p>
</li>
<li>
<p>Hardwired design (no microcode)</p>
</li>
</ul>
</li>
<li>
<p>Use registers whenever possible</p>
<ul>
<li>
<p>Except for load/save instructions, other instructions are for register operations</p>
</li>
<li>
<p><strong>Data operations can only be performed in registers</strong></p>
</li>
<li>
<p><strong>Memory access has only three addressing modes</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Better pipeline design</strong></p>
<ul>
<li>
<p>Instruction pipeline is carefully designed to better meet the impact of conditional branches and procedure calls on the flow pipeline</p>
</li>
<li>
<p><strong>Each instruction is conditionally executed, which can reduce branches</strong></p>
</li>
</ul>
</li>
</ul>
<h5 id="influence-of-risc-concept">Influence of RISC concept</h5>
<ul>
<li>
<p><strong>RISC&rsquo;s design concept gave birth to a series of new computer architectures</strong></p>
<ul>
<li>Simplified pipeline design on RISC instruction set is becoming more and more attractive</li>
</ul>
</li>
<li>
<p><strong>RISC and CISC learn from each other</strong></p>
<ul>
<li>
<p>Make up for the disadvantage of CISC pipeline implementation</p>
</li>
<li>
<p>RISC is also learning from CISC, and both sides are learning from each other</p>
</li>
</ul>
</li>
<li>
<p><strong>Current situation</strong></p>
</li>
<li>
<p>With the development of architecture and microelectronics technology, the so-called disadvantage of CISC in structure is gradually reduced</p>
</li>
<li>
<p>RISC&rsquo;s theory of superiority has gradually died down, and RISC camp has been losing ground</p>
</li>
</ul>
<blockquote>
<p>Focus on the design and implementation of micro structures and physics, and explore the possibilities buried in operating systems, compilers and upper applications</p>
</blockquote>
<h5 id="summary-1">Summary</h5>
<ul>
<li>
<p>The number of available registers greatly influenced the <strong>instruction set architecture (ISA)</strong></p>
</li>
<li>
<p>Complex Instruction Set Computers were very complex</p>
</li>
<li>
<p><strong>CISC was necessary</strong></p>
<ul>
<li>
<p>The processor of X86 architecture dominates the server and desktop market</p>
</li>
<li>
<p>X86 draws many advantages from RISC</p>
</li>
</ul>
</li>
<li>
<p><strong>RISC is still widely concerned and applied</strong></p>
<ul>
<li>
<p><strong>ARM occupies a major share of the embedded market</strong></p>
</li>
<li>
<p><strong>Mobile phones, tablets PC and various sensors in daily life mostly adopt ARM architecture</strong></p>
</li>
<li>
<p><strong>ARM borrows a bit from both RISC and CISC</strong></p>
</li>
</ul>
</li>
</ul>
<h3 id="the-use-of-a-large-register-file">The Use of a Large Register File</h3>
<ul>
<li>
<p>Target: Keep frequently accessed operands in registers</p>
</li>
<li>
<p>Software solution</p>
<ul>
<li>
<p>Require compiler to allocate registers</p>
</li>
<li>
<p>Allocate based on most used variables in a given time</p>
</li>
<li>
<p>Requires sophisticated program analysis</p>
</li>
</ul>
</li>
<li>
<p>Hardware solution</p>
<ul>
<li>
<p>Have more registers</p>
</li>
<li>
<p>Thus more variables will be in registers</p>
</li>
</ul>
</li>
</ul>
<h4 id="how-and-problem">How and problem?</h4>
<ul>
<li>
<p>Limited number of registers requires reasonable use, and the locality principle provides the possibility</p>
<ul>
<li>
<p>Store local scalar variables in registers</p>
</li>
<li>
<p>Reduces memory access</p>
</li>
</ul>
</li>
<li>
<p><strong>Every procedure (function) call changes locality</strong></p>
<ul>
<li>
<p>Parameters must be passed</p>
</li>
<li>
<p>Results must be returned</p>
</li>
<li>
<p>Variables from calling programs must be restored</p>
</li>
</ul>
</li>
</ul>
<h4 id="register-windows">Register windows</h4>
<ul>
<li>
<p><strong>Characteristics of procedure call</strong></p>
<ul>
<li>
<p><strong>Only few parameters</strong></p>
</li>
<li>
<p><strong>Limited range of depth of call</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Divide the available registers into several small registers set</strong></p>
<ul>
<li>
<p><strong>Calls switch to a different set of registers</strong></p>
</li>
<li>
<p><strong>Returns switch back to a previously used set of registers</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Set of registers called register windows</strong></p>
</li>
</ul>
<hr>
<ul>
<li>
<p><strong>Three areas within a register set</strong></p>
<ul>
<li>
<p><strong>Parameter registers</strong></p>
</li>
<li>
<p><strong>Local registers</strong></p>
</li>
<li>
<p><strong>Temporary registers</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Temporary registers from one set overlap parameter registers from the next</strong></p>
<ul>
<li><strong>This allows parameter passing without moving data</strong></li>
</ul>
</li>
<li>
<p><strong>At any time, only one register window is visible</strong></p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-1.png" title="/img/Computer Organization and Architecture/chapter13-1.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-1.png" data-sub-html="<h2>Overlapping register windows</h2>">
        
    </a><figcaption class="image-caption"><code>Overlapping register windows</code></figcaption>
    </figure>
<ul>
<li>
<p>æœ¬çº§çš„ä¸´æ—¶å˜é‡å¯„å­˜å™¨å’Œä¸‹ä¸€çº§çš„å‚æ•°å¯„å­˜å™¨åœ¨ç‰©ç†ä¸Šæ˜¯åŒä¸€ä¸ªï¼Œåœ¨ä¼ é€’å‚æ•°æ—¶ï¼Œä¸éœ€è¦ç§»åŠ¨æ•°æ®</p>
</li>
<li>
<p>ç¨‹åºä¸­è¿‡ç¨‹çš„è°ƒç”¨å’Œè¿”å›çš„æ•°é‡ä¸ç¡®å®šï¼Œæ‰€ä»¥å¯„å­˜å™¨çª—å£åº”è¯¥è¶³å¤Ÿå¤šï¼Œä»¥ä¿è¯æ‰€æœ‰çš„è¿‡ç¨‹è°ƒç”¨éƒ½èƒ½ç”¨åˆ°</p>
</li>
<li>
<p>ç”±äºå¯„å­˜å™¨çš„æ•°é‡æœ‰é™ï¼Œåªèƒ½ä¿è¯å°‘æ•°æœ€è¿‘çš„è¿‡ç¨‹èƒ½å¤Ÿä½¿ç”¨å¯„å­˜å™¨ã€‚æ›´æ—©çš„è¿‡ç¨‹è°ƒç”¨è¿˜æ˜¯éœ€è¦ä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­ã€‚å½“åµŒå¥—æ·±åº¦å‡å°‘çš„æ—¶å€™ï¼Œå†å°†æ•°æ®ä»å­˜å‚¨å™¨æ¢å¤åˆ°å¯„å­˜å™¨ä¸­</p>
</li>
<li>
<p>è¿™ç§æ–¹å¼ç§°ä¸º<strong>ç¯å½¢ç¼“å†²çª—å£</strong></p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-2.png" title="/img/Computer Organization and Architecture/chapter13-2.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-2.png" data-sub-html="<h2>Circular buffer diagram</h2>">
        
    </a><figcaption class="image-caption"><code>Circular buffer diagram</code></figcaption>
    </figure>
<ul>
<li>
<p><strong>å¯„å­˜å™¨çª—å£ä»¥ä¸€ç§éƒ¨åˆ†é‡å çš„å½¢å¼å½¢æˆä¸€ä¸ªç¯å½¢ã€‚å½“ç¯å½¢å¯„å­˜å™¨çª—å£éƒ½å……æ»¡äº†åï¼Œå†æœ‰è¿‡ç¨‹è°ƒç”¨ï¼ŒæŠŠæœ€æ—©çš„å¯„å­˜å™¨çª—å£ä¿å­˜åˆ°å­˜å‚¨å™¨</strong></p>
</li>
<li>
<p>è°ƒç”¨æ—¶ï¼Œç§»åŠ¨å½“å‰çª—å£æŒ‡é’ˆä»¥æ˜¾ç¤ºå½“å‰æ´»åŠ¨çš„å¯„å­˜å™¨çª—å£</p>
</li>
<li>
<p><strong>å¦‚æœæ‰€æœ‰çª—å£éƒ½åœ¨ä½¿ç”¨ä¸­ï¼Œå°†ç”Ÿæˆä¸€ä¸ªä¸­æ–­ï¼Œå¹¶å°†æœ€æ—©çš„çª—å£ï¼ˆè°ƒç”¨åµŒå¥—ä¸­æœ€è¿œçš„çª—å£ï¼‰ä¿å­˜åˆ°å†…å­˜ä¸­</strong></p>
</li>
<li>
<p>ä¿å­˜çš„çª—å£æŒ‡é’ˆæ ‡è¯†æœ€è¿‘ä¿å­˜åœ¨å†…å­˜ä¸­çš„çª—å£</p>
</li>
<li>
<p>å½“è¿‡ç¨‹è¿”å›çš„æ—¶å€™ï¼ŒCWPä¼šå›é€€ä¸€ä¸ªã€‚å½“CWPå›é€€åˆ°å’ŒSWPä¸€æ ·çš„æ—¶å€™ï¼Œå°±ä¼šå¼•èµ·ä¸€ä¸ªä¸­æ–­ï¼Œå¯¼è‡´ä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­çš„å¯„å­˜å™¨çª—å£æ¢å¤</p>
</li>
<li>
<p>åµŒå¥—å±‚æ•°ä¸ä¼šå¤ªæ·±ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­</p>
</li>
</ul>
<h4 id="global-variables">Global variables</h4>
<ul>
<li>
<p>Allocated by the compiler to memory</p>
<ul>
<li>
<p><strong>Inefficient for frequently accessed variables</strong></p>
</li>
<li>
<p><strong>Frequent access to memory, low efficiency</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>A set of registers for global variables</strong></p>
<ul>
<li>
<p><strong>compiler determines which global variables can be placed in global registers</strong></p>
</li>
<li>
<p><strong>Replacement is also determined by the compiler</strong></p>
</li>
</ul>
</li>
</ul>
<h4 id="registers-v-cache">Registers v cache</h4>
<ul>
<li>
<p>Cache</p>
<ul>
<li>Inserting cache between processor and memory can solve the problem of speed difference</li>
</ul>
</li>
<li>
<p>Register</p>
<ul>
<li>organized in the form of windows, which is similar to a small fast buffer. It stores a subset of all variables that may be used many times</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>å¯„å­˜å™¨ç»„ä¸­ä¿å­˜çš„æ˜¯æ‰€æœ‰å±€éƒ¨æ ‡é‡å˜é‡ã€‚cacheä¿å­˜çš„æ˜¯æœ€è¿‘ä½¿ç”¨è¿‡çš„æ ‡é‡å˜é‡</p>
</li>
<li>
<p>å¯„å­˜å™¨ç»„ä¸­ä¿å­˜çš„æ˜¯ä¸ªåˆ«çš„å˜é‡ã€‚cacheä¸­ä¿å­˜çš„æ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªå—</p>
</li>
<li>
<p>å¯„å­˜å™¨ç»„æ–¹æ¡ˆä¸­ï¼Œéœ€è¦ç¼–è¯‘å™¨æ¥å†³å®šå…¨å±€å˜é‡çš„ä¿å­˜ã€‚cacheä¸­åˆ™æ˜¯æ ¹æ®æœ€è¿‘ä½¿ç”¨åŸåˆ™è¿›è¡Œç®¡ç†</p>
</li>
<li>
<p>å¯„å­˜å™¨çš„æ•°æ®ä¿å­˜æˆ–è€…æ¢å¤ï¼Œä¾èµ–çš„æ˜¯è¿‡ç¨‹è°ƒç”¨åµŒå¥—çš„æ·±åº¦ã€‚cacheæ ¹æ®æ›¿æ¢ç®—æ³•è¿›è¡Œæ›¿æ¢</p>
</li>
<li>
<p>å¯„å­˜å™¨ç»„é‡‡ç”¨çš„æ˜¯å¯„å­˜å™¨å¯»å€ã€‚cacheé‡‡ç”¨çš„æ˜¯å†…å­˜å¯»å€</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>The register saves time because all local scalar variables are retained</p>
<ul>
<li>Not efficient use of space, because not all procedures will need the full window space allocated to them</li>
</ul>
</li>
<li>
<p>The cache may make more efficient use of space because it stores necessary data dynamically</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-3.png" title="/img/Computer Organization and Architecture/chapter13-3.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-3.png" data-sub-html="<h2>Register access</h2>">
        
    </a><figcaption class="image-caption"><code>Register access</code></figcaption>
    </figure>
<ul>
<li>
<p>è¦è®¿é—®åŸºäºçª—å£çš„å¯„å­˜å™¨ç»„ä¸­çš„ä¸€ä¸ªæ ‡é‡å˜é‡ï¼Œéœ€è¦ç»™å‡ºçª—å£å·å’Œä¸€ä¸ªå¯„å­˜å™¨å·</p>
</li>
<li>
<p>é€šè¿‡ä¸€ä¸ªç›¸å¯¹ç®€å•çš„è¯‘ç å™¨ï¼Œå°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„å¯„å­˜å™¨ï¼Œè¯»å‡ºè¿™ä¸ªæ•°æ®</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-4.png" title="/img/Computer Organization and Architecture/chapter13-4.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-4.png" data-sub-html="<h2>Cache access</h2>">
        
    </a><figcaption class="image-caption"><code>Cache access</code></figcaption>
    </figure>
<ul>
<li>
<p>å¯¹äºcacheè®¿é—®ï¼Œéœ€è¦ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„åœ°å€ï¼Œæ“ä½œçš„å¤æ‚åº¦å’Œå¯»å€æ–¹å¼æœ‰å…³</p>
</li>
<li>
<p>è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹æ•°æ®æ˜¯å¦å‘½ä¸­</p>
</li>
<li>
<p>å¦‚æœå‘½ä¸­ï¼Œå°±å¯ä»¥è¯»å–æ•°æ®</p>
</li>
<li>
<p>å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆæ›¿æ¢cacheè¡Œï¼Œç„¶åæ‰èƒ½å¾—åˆ°æ•°æ®</p>
</li>
</ul>
<h3 id="compiler-based-register-optimization">Compiler-Based Register Optimization</h3>
<ul>
<li>
<p><strong>HLL programs have no explicit references to registers</strong></p>
</li>
<li>
<p><strong>Optimizing use is up to compiler</strong></p>
<ul>
<li>
<p>Assign symbolic or virtual register to each candidate variable</p>
</li>
<li>
<p>Map symbolic registers to real registers</p>
</li>
<li>
<p>Symbolic registers that do not overlap can share real registers</p>
</li>
<li>
<p>If you run out of real registersï¼Œsome variables use memory</p>
</li>
</ul>
</li>
<li>
<p><strong>The essence is to judge which data needs to be put in the register at any time</strong></p>
</li>
</ul>
<h4 id="graph-coloring">Graph coloring</h4>
<ul>
<li>
<p>Symbol registers is more than register</p>
</li>
<li>
<p>determine which symbol registers can use the actual registers</p>
</li>
<li>
<p><strong>Using Graph Coloring of topology</strong></p>
<ul>
<li>
<p>Given a graph of nodes and edges</p>
</li>
<li>
<p>Assign a colour to each node</p>
</li>
<li>
<p>Adjacent nodes have different colours</p>
</li>
<li>
<p>Use minimum number of colours</p>
</li>
</ul>
</li>
<li>
<p>Nodes are symbolic registers</p>
</li>
<li>
<p>Two registers that are live in the same program fragment are joined by an edge</p>
</li>
<li>
<p>Try to colour the graph with <em>n</em> colours, where <em>n</em> is the number of real registers</p>
</li>
<li>
<p>Nodes that can not be coloured are placed in memory</p>
</li>
</ul>
<hr>
<p><strong>Graph colouring approach</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-5.png" title="/img/Computer Organization and Architecture/chapter13-5.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-5.png">
        
    </a>
<ul>
<li>
<p>æ„é€ æ— å‘å›¾ï¼šAå’ŒBCåœ¨æ—¶é—´ä¸Šæœ‰é‡å ï¼ŒAå’ŒBCæœ‰è¿çº¿ï¼›Bå’Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æœ‰æ—¶é—´é‡å ï¼ŒBå’Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æœ‰è¿çº¿ã€‚Cå’ŒABDæœ‰æ—¶é—´ä¸Šçš„é‡å ï¼ŒCå’ŒABDæœ‰è¿çº¿</p>
</li>
<li>
<p>ä»Aå¼€å§‹ï¼Œç»™Aèµ‹ä¸€ä¸ªç°è‰²ï¼ŒBå’ŒCå¿…é¡»è¦å’ŒAä¸ä¸€æ ·ï¼Œå¹¶ä¸”Bå’ŒCä¹Ÿä¸èƒ½ä¸€æ ·ï¼Œç»™Bé™„ä¸€ä¸ªé¡ºæ–œæ ï¼ŒCèµ‹ä¸€ä¸ªåæ–œæ ã€‚DèŠ‚ç‚¹å’ŒBCç›¸è¿ï¼Œå’ŒAä¸ç›¸è¿ï¼ŒDç‚¹å¯ä»¥ç”¨ç°è‰²ã€‚EèŠ‚ç‚¹å’ŒBDç›¸è¿ï¼ŒEå¯ä»¥ç”¨Cçš„é¢œè‰²ã€‚Få’ŒBEDç›¸è¿ï¼Œè€ŒBDEåˆ†åˆ«æ˜¯æ­£æ–œæ ã€ç°è‰²å’Œåæ–œæ ï¼ŒFå¿…é¡»è¦ç”¨åˆ°ç¬¬å››ä¸ªé¢œè‰²</p>
</li>
<li>
<p>å¦‚æœç‰©ç†å¯„å­˜å™¨åªæœ‰3ä¸ªçš„è¯ï¼Œé‚£ä¹ˆFå°±éœ€è¦ä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­äº†ï¼Œé€šè¿‡åŠ è½½å’Œä¿å­˜æ¥å¤„ç†</p>
</li>
</ul>
<h4 id="large-register-vs-compiler">Large Register vs Compiler</h4>
<ul>
<li>
<p>When the number of registers is small, the effect will be better by optimizing the registers</p>
</li>
<li>
<p>When the number of registers is large, the effect of register optimization will not be very good</p>
</li>
<li>
<p>Optimization of registers is mainly for the case of a small number of registers</p>
</li>
</ul>
<h3 id="risc-pipelining">RISC Pipelining</h3>
<ul>
<li>
<p>Most instructions are register to register</p>
</li>
<li>
<p>Two phases of execution</p>
<ul>
<li>
<p>I: Instruction fetch</p>
</li>
<li>
<p>E: Execute</p>
<ul>
<li>ALU operation with register input and output</li>
</ul>
</li>
</ul>
</li>
<li>
<p>For load and store</p>
<ul>
<li>
<p>I: Instruction fetch</p>
</li>
<li>
<p>E: Execute: Calculate memory address</p>
</li>
<li>
<p>D: Register to memory or memory to register operation</p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-6.png" title="/img/Computer Organization and Architecture/chapter13-6.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-6.png">
        
    </a>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter13-7.png" title="/img/Computer Organization and Architecture/chapter13-7.png" data-thumbnail="/img/Computer Organization and Architecture/chapter13-7.png">
        
    </a>
<ul>
<li>
<p>å›¾aæ˜¯æ²¡æœ‰é‡‡ç”¨æµæ°´çº¿æŠ€æœ¯ï¼Œå®Œå…¨æŒ‰ç…§é¡ºåºæ¥æ‰§è¡Œ</p>
</li>
<li>
<p><strong>å›¾bæ˜¯é‡‡ç”¨ä¸¤é˜¶æ®µæµæ°´çº¿çš„æ‰§è¡Œæƒ…å†µã€‚ç”±äºåŒæ—¶åªèƒ½æœ‰1ä¸ªå­˜å‚¨å™¨è®¿é—®ï¼Œå–æŒ‡å’Œå­˜å‚¨ä¼šå†²çªï¼Œå¯¼è‡´å–æŒ‡ä¼šå»¶åä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ</strong></p>
</li>
<li>
<p>å­˜å‚¨å™¨çš„è®¿é—®é™åˆ¶å¯¼è‡´äº†æ—¶é’Ÿå‘¨æœŸçš„æµªè´¹</p>
</li>
<li>
<p>å¦‚æœå­˜å‚¨æ”¯æŒ2ä¸ªè®¿é—®ï¼Œå¯ä»¥ç”¨ä¸‰é˜¶æ®µæµæ°´çº¿</p>
</li>
<li>
<p>æŒ‡ä»¤ç›¸å…³æ€§ï¼šAdd rC$\leftarrow$rA+rBï¼ŒæŒ‡ä»¤éœ€è¦çš„æ“ä½œæ•°ä¸ºrAå’ŒrBã€‚è€Œç¬¬äºŒæ¡æŒ‡ä»¤è¦åˆ°ç¬¬å››ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰èƒ½å¾—åˆ°rBã€‚æ‰€ä»¥è¦æ’å…¥ä¸€ä¸ªç©ºæŒ‡ä»¤NOOP</p>
</li>
<li>
<p>æŒ‡ä»¤æ‰§è¡Œé˜¶æ®µï¼Œé€šå¸¸æ¶‰åŠåˆ°å¯„å­˜å™¨çš„è¯»å’ŒALUçš„æ“ä½œï¼ŒæŠŠEé˜¶æ®µè¿›ä¸€æ­¥åˆ†ä¸ºE1å’ŒE2ã€‚å…¶ä¸­E1é˜¶æ®µå®Œæˆå¯„å­˜å™¨çš„è¯»ï¼Œè€ŒE2é˜¶æ®µåˆ™å®ŒæˆALUæ“ä½œå’Œå¯„å­˜å™¨çš„å†™æ“ä½œ</p>
</li>
<li>
<p>ä½¿ç”¨å››é˜¶æ®µæµæ°´çº¿æ¥æé«˜æ•ˆç‡ã€‚ä½†åŒæ ·éœ€è¦è€ƒè™‘ç›¸å…³æ€§é—®é¢˜</p>
</li>
</ul>
<h4 id="optimization-of-pipelining">Optimization of Pipelining</h4>
<ul>
<li>
<p>Dependency of data and branch will disrupt the pipeline and affect the efficiency</p>
</li>
<li>
<p>Two methods: Delayed branch, Loop Unrolling</p>
</li>
<li>
<p>Delayed branch</p>
<ul>
<li>
<p>Branch instruction affects only the instructions that follow it</p>
</li>
<li>
<p>This following instruction is the delay slot</p>
</li>
<li>
<p><strong>Arrange a useful instruction to replace the NOOP instruction</strong></p>
</li>
</ul>
</li>
</ul>
<h4 id="delayed-branch">delayed branch</h4>
<ul>
<li>
<p><strong>Calculate result of branch before unusable instructions pre-fetched</strong></p>
<ul>
<li>
<p><strong>Instructions that are not affected by branches are immediately followed by branch</strong></p>
</li>
<li>
<p><strong>Keeps pipeline full while fetching new instruction stream</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Not as good for superscalar</strong></p>
<ul>
<li>
<p>Multiple instructions need to execute in delay slot</p>
</li>
<li>
<p>Instruction dependence problems</p>
</li>
<li>
<p>Often use branch prediction</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>Problem: How do you find instructions to fill the delay slots?</p>
<ul>
<li>
<p>Branch must be independent of delay slot instructions</p>
</li>
<li>
<p>Unconditional branch: Easier to find instructions to fill the delay slot</p>
</li>
<li>
<p>Conditional branch: Condition computation should not depend on instructions in delay slots â†’ difficult to fill the delay slot</p>
</li>
</ul>
</li>
</ul>
<h4 id="advantage">Advantage</h4>
<ul>
<li>
<p>Keeps the pipeline full with useful instructions in a simple way assuming</p>
<ul>
<li>
<p>Number of delay slots = number of instructions to keep the pipeline full before the branch resolves</p>
</li>
<li>
<p>All delay slots can be filled with useful instructions</p>
</li>
</ul>
</li>
</ul>
<h4 id="disadvantage">Disadvantage</h4>
<ul>
<li>
<p>Not easy to fill the delay slots (even with a 2-stage pipeline)</p>
<ul>
<li>
<p>Number of delay slots increases with pipeline depth, superscalar execution width</p>
</li>
<li>
<p>Number of delay slots should be variable with variable latency operations</p>
</li>
</ul>
</li>
</ul>
<h4 id="another-method-loop-unrolling">Another method-Loop Unrolling</h4>
<ul>
<li>
<p>Replicate body of loop a number of times</p>
<ul>
<li>Iterate loop fewer times</li>
<li>Reduces loop overhead</li>
<li>Increases instruction parallelism</li>
</ul>
</li>
<li>
<p>During the execution of the loop body, because of the locality principle, some data can be used for many times, which can reduce the number of times to access the</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fortran" data-lang="fortran"><span class="line"><span class="cl"><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">end do</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>åŸå§‹çš„å¾ªç¯æ˜¯è¦åšä¸€ä¸ªä¸€ç»´æ•°ç»„çš„å˜åŒ–ã€‚å¾ªç¯ä½“ä¸­æœ‰ä¸€ä¸ªè¯­å¥éœ€è¦æ‰§è¡Œ</p>
</li>
<li>
<p>æŠŠè¿™ä¸ªå¾ªç¯ä½“è¿›è¡Œæ‹†è§£ï¼Œå˜æˆäº†2ä¸ªè¯­å¥ï¼Œä¸€ä¸ªå¾ªç¯ä½“æ‰§è¡Œäº†2ä¸ªè¿­ä»£æ“ä½œ</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fortran" data-lang="fortran"><span class="line"><span class="cl"><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">end do</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>2ä¸ªæŒ‡ä»¤å¯ä»¥å¹¶è¡Œè¿›è¡Œã€‚åŸæ¥æ¯æ¬¡å¾ªç¯éœ€è¦è®¿é—®3æ¬¡å­˜å‚¨å™¨ï¼Œç°åœ¨ç›¸å½“äº2æ¬¡å¾ªç¯åªéœ€è¦è®¿é—®4æ¬¡å­˜å‚¨å™¨ï¼Œé™ä½äº†å­˜å‚¨å™¨è®¿é—®çš„æ¬¡æ•°</li>
</ul>
<h3 id="risc-versus-cisc-controversy">RISC Versus CISC Controversy</h3>
<ul>
<li>
<p>Not clear cut</p>
<ul>
<li>
<p>RISC designs may benefit from the inclusion of some CISC features and that</p>
</li>
<li>
<p>CISC designs may benefit from the inclusion of some RISC features</p>
</li>
</ul>
</li>
<li>
<p>Many designs borrow from both philosophies</p>
<ul>
<li>
<p>PowerPC are no longer â€œpureâ€ RISC</p>
</li>
<li>
<p>Pentium II and later Pentium models do incorporate some RISC characteristics</p>
</li>
</ul>
</li>
</ul>
]]></description>
</item>
<item>
    <title>Computer Organization and Architecture Processor Structure and Function</title>
    <link>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-processor-structure-and-function/</link>
    <pubDate>Sat, 28 Jan 2023 14:20:25 &#43;0800</pubDate><author>1239946358@qq.com (Jungle)</author><guid>https://Jungle430.github.io/posts/computer-organization-and-architecture/computer-organization-and-architecture-processor-structure-and-function/</guid>
    <description><![CDATA[<h1 id="computer-organization-and-architecture">Computer Organization and Architecture</h1>
<h2 id="processor-structure-and-function">Processor Structure and Function</h2>
<h3 id="outline">Outline</h3>
<ul>
<li>
<p>Processor Organization</p>
</li>
<li>
<p>Register Organization</p>
</li>
<li>
<p>Instruction Cycle</p>
</li>
<li>
<p>Instruction Pipelining</p>
</li>
</ul>
<h3 id="processor-organization">Processor Organization</h3>
<ul>
<li>
<p>A CPU must be able to</p>
<ul>
<li>
<p>Fetch instruction from memory</p>
</li>
<li>
<p>Decode the instruction to determine what action to do</p>
</li>
<li>
<p>Fetch data</p>
</li>
<li>
<p>Process data</p>
</li>
<li>
<p>Write data</p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-1.png" title="/img/Computer Organization and Architecture/chapter12-1.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-1.png">
        
    </a>
<ul>
<li>
<p>CPUå¿…é¡»è¦èƒ½å¤Ÿæš‚æ—¶ä¿å­˜ä¸€äº›æ•°æ®ï¼Œä»¥å¯¹æ•°æ®è¿›è¡Œå¤„ç†</p>
</li>
<li>
<p>CPUéœ€è¦è®°ä½ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„ä½ç½®ï¼Œè¿™æ ·æ‰èƒ½åœ¨å½“å‰æŒ‡ä»¤æ‰§è¡Œå®Œæˆä¹‹åï¼Œèƒ½åˆ°æ‰¾åˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤</p>
</li>
<li>
<p>å¤„ç†è¿‡ç¨‹ä¸­éœ€è¦èƒ½å¤Ÿä¿å­˜æŒ‡ä»¤å’Œæ•°æ®</p>
</li>
<li>
<p><strong>CPUåŒ…æ‹¬ALUï¼ŒCUï¼Œè¿˜éœ€è¦æœ‰ä¸€ç»„å­˜å‚¨éƒ¨ä»¶â€”â€”å¯„å­˜å™¨</strong></p>
</li>
<li>
<p>CPUé€šè¿‡ä¸€ç»„ç³»ç»Ÿæ€»çº¿å’Œè®¡ç®—æœºçš„å…¶ä»–éƒ¨ä»¶è¿›è¡Œè¿æ¥ã€‚ç³»ç»Ÿæ€»çº¿åŒ…æ‹¬æ§åˆ¶æ€»çº¿ã€æ•°æ®æ€»çº¿å’Œåœ°å€æ€»çº¿</p>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-2.png" title="/img/Computer Organization and Architecture/chapter12-2.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-2.png">
        
    </a>
<ul>
<li>
<p><strong>CPUçš„å†…éƒ¨æ€»çº¿æŠŠALUã€å¯„å­˜å™¨å’ŒCUè¿åœ¨ä¸€èµ·ï¼Œå®Œæˆæ•°æ®åœ¨å¯„å­˜å™¨å’ŒALUçš„ä¼ é€</strong></p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒå¯¹å¯„å­˜å™¨ã€å†…éƒ¨æ€»çº¿å’ŒALUè¿›è¡Œæ§åˆ¶ï¼Œæ§åˆ¶å„ä¸ªéƒ¨ä»¶æŒ‰ç…§æŒ‡ä»¤è¦æ±‚å®Œæˆç›¸åº”çš„å¤„ç†</p>
</li>
<li>
<p>åœ¨ALUå†…éƒ¨ï¼Œè¿˜åŒ…æ‹¬å„ç§æ›´å°çš„ç»„ä»¶ï¼Œä¾‹å¦‚çŠ¶æ€æ ‡å¿—ï¼Œç§»ä½å™¨ï¼Œæ±‚è¡¥å™¨ï¼Œä»¥åŠç®—æœ¯å’Œå¸ƒå°”é€»è¾‘ç­‰</p>
</li>
</ul>
<h3 id="register-organization">Register Organization</h3>
<ul>
<li>
<p>CPU must have some working space (temporary storage)</p>
<ul>
<li>Called registers</li>
</ul>
</li>
<li>
<p>Number and function vary between processor designs</p>
</li>
<li>
<p><strong>One of the major design decisions</strong></p>
</li>
<li>
<p><strong>Top level of memory hierarchy</strong></p>
</li>
</ul>
<hr>
<ul>
<li>
<p><strong>Registers in the CPU Including two types</strong></p>
<ul>
<li>
<p><strong>User-visible registers</strong></p>
</li>
<li>
<p><strong>Reduce access to main memory and improve instruction processing efficiency by optimizing the use of registers</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Control and status registers</strong></p>
<ul>
<li>
<p><strong>Used by control unit</strong></p>
</li>
<li>
<p><strong>Control the operation of the CPU and the execution of the program by the privileged operating system</strong></p>
</li>
</ul>
</li>
</ul>
<h4 id="user-visible-registers">User-visible registers</h4>
<ul>
<li>
<p>User visible registers can be divided into four categories according to its purpose</p>
<ul>
<li>
<p><strong>General purpose: assigned to various purposes</strong></p>
</li>
<li>
<p><strong>Data: for data retention only</strong></p>
</li>
<li>
<p><strong>Address: used for some addressing mode</strong></p>
</li>
<li>
<p><strong>Condition codes: also called flag register, it stores some flags of operation results</strong></p>
</li>
</ul>
</li>
</ul>
<h5 id="general-purpose-registers">General purpose registers</h5>
<ul>
<li>
<p>True general purpose</p>
<ul>
<li>Registers and opcodes are orthogonal in the instruction set</li>
<li>Registers can be arbitrarily matched with opcodes</li>
</ul>
</li>
<li>
<p><strong>Restricted general registers</strong></p>
<ul>
<li><strong>Specially used for floating point number or stack operation</strong></li>
</ul>
</li>
<li>
<p>In some cases, general registers can be used for addressing</p>
<ul>
<li>Register indirect addressing</li>
<li>Displacement addressing</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>Data register</p>
<ul>
<li><strong>It can only be used for store data, not for addressing</strong></li>
<li><strong>Accumulator</strong></li>
</ul>
</li>
<li>
<p><strong>Addressing register</strong></p>
<ul>
<li>
<p><strong>Used for a specific addressing mode</strong></p>
</li>
<li>
<p><strong>Segment pointer</strong></p>
</li>
<li>
<p><strong>Index register</strong></p>
</li>
<li>
<p><strong>Stack pointer</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>General or Specialized</strong></p>
<ul>
<li>
<p>Whether registers are general or special affects the design of instruction sets</p>
</li>
<li>
<p><strong>Specialized</strong></p>
<ul>
<li>
<p><strong>Opcode can implicitly use a register group or a register</strong></p>
</li>
<li>
<p><strong>Smaller instructions</strong></p>
</li>
<li>
<p><strong>Less flexibility</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>General purpose</strong></p>
<ul>
<li>
<p><strong>Increase flexibility and programmer options</strong></p>
</li>
<li>
<p><strong>Increase instruction size &amp; complexity</strong></p>
</li>
</ul>
</li>
<li>
<p>More registers require more bits to specify registers in instructions</p>
</li>
<li>
<p>Fewer registers require more memory access</p>
</li>
<li>
<p>Too many registers does not reduce memory references remarkably and takes up processor real estate</p>
<ul>
<li>Between 8-32 is appropriate</li>
</ul>
</li>
<li>
<p><strong>Using register files with RISC makes use of using more registers</strong></p>
</li>
</ul>
<hr>
<ul>
<li>
<p>Address register: large enough to hold full address</p>
</li>
<li>
<p>Data address: large enough to hold full word</p>
</li>
<li>
<p><strong>Sometimes combine two data registers to hold double length data</strong></p>
<ul>
<li><strong>In C language, there is a double integer and a long integer, both of which are two words long</strong></li>
</ul>
</li>
</ul>
<hr>
<p><strong>Condition code registers</strong></p>
<ul>
<li>
<p><strong>Also called flag registers, some of which are visible to users</strong></p>
</li>
<li>
<p><strong>After operating,CPU set the condition bit according to the result</strong></p>
<ul>
<li>
<p>After arithmetic operation, positive, negative, zero or overflow may occur</p>
</li>
<li>
<p>These conditions will be set in</p>
</li>
</ul>
</li>
<li>
<p>Programs are allowed to read the condition code and perform</p>
</li>
<li>
<p>Condition code cannot be modified by the program</p>
</li>
</ul>
<hr>
<p><strong>Control &amp; status registers</strong></p>
<ul>
<li>
<p>Four registers are essential to instruction execution</p>
<ul>
<li>
<p>Program Counter (PC)</p>
</li>
<li>
<p>Instruction Register (IR)</p>
</li>
<li>
<p>Memory Address Register (MAR)</p>
</li>
<li>
<p>Memory Buffer Register (MBR)</p>
</li>
</ul>
</li>
<li>
<p>Not all processors have MAR and MBR. However, the system still needs registers similar to these two registers</p>
</li>
</ul>
<hr>
<p><strong>Program status word</strong></p>
<ul>
<li>
<p>The PSW contains status information</p>
</li>
<li>
<p>The flags include</p>
<ul>
<li>
<p>Sign, zero, carry, equal, overflow</p>
</li>
<li>
<p>interrupt enable/disable</p>
</li>
<li>
<p>Supervisor: indicates whether the CPU is executing in supervisor or user mode</p>
</li>
</ul>
</li>
<li>
<p><strong>Supervisor mode</strong></p>
<ul>
<li>
<p>Not available to user programs</p>
</li>
<li>
<p>Used by operating system(<strong>System call</strong>)</p>
</li>
<li>
<p>Certain privileged instructions can be executed only in supervisor mode</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Other status and control registers</strong></p>
<ul>
<li>
<p>Other additional status and control registers</p>
<ul>
<li>
<p>Pointer register to process control block</p>
</li>
<li>
<p>Interrupt vector register in vector interrupt computer</p>
</li>
<li>
<p>System stack pointer</p>
</li>
<li>
<p>Page table pointer register in virtual memory</p>
</li>
<li>
<p>I/O operation related registers</p>
</li>
</ul>
</li>
<li>
<p>Control and status registers design elements</p>
<ul>
<li>Need to support the operating system</li>
<li>Storage location in registers and memory</li>
</ul>
</li>
</ul>
<h3 id="instruction-cycle">Instruction Cycle</h3>
<ul>
<li>
<p><strong>Instruction cycle includes fetching cycle and execution cycle</strong></p>
</li>
<li>
<p><strong>In execution cycle, first decode to get the operation type of the instruction</strong></p>
</li>
<li>
<p><strong>If instruction has operands, get the operand specifier in the instruction</strong></p>
<ul>
<li>
<p><strong>Immediate</strong></p>
</li>
<li>
<p><strong>Register</strong></p>
</li>
<li>
<p><strong>Direct addressing: memory access once</strong></p>
</li>
<li>
<p><strong>Indirect addressing: may requires more memory accesses</strong></p>
<ul>
<li><strong>Also called â€œindirect cycleâ€</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Instruction cycle with indirect</strong></p>
<div class="mermaid" id="id-1"></div>
<ul>
<li>
<p>æŒ‡ä»¤å‘¨æœŸåŒ…æ‹¬å–æŒ‡å‘¨æœŸå’Œæ‰§è¡Œå‘¨æœŸï¼Œè¿˜å¯èƒ½åŒ…æ‹¬é—´æ¥å‘¨æœŸå’Œä¸­æ–­å‘¨æœŸ</p>
</li>
<li>
<p>å–æŒ‡åï¼Œé€šè¿‡è¯‘ç ç¡®å®šæ˜¯å¦åŒ…å«éœ€è¦é—´æ¥å¯»å€çš„æ“ä½œæ•°ï¼Œå¦‚æœæœ‰ï¼Œè¿›å…¥é—´æ¥å‘¨æœŸ</p>
</li>
<li>
<p>å½“å‰æŒ‡ä»¤æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä¸­æ–­ã€‚å¦‚æœæœ‰ï¼Œè¿›å…¥ä¸­æ–­å‘¨æœŸ</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-3.png" title="/img/Computer Organization and Architecture/chapter12-3.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-3.png" data-sub-html="<h2>Instruction Cycle(with Interrupts - State Diagram)</h2>">
        
    </a><figcaption class="image-caption">Instruction Cycle(with Interrupts - State Diagram)</figcaption>
    </figure>
<ul>
<li>
<p>æŒ‡ä»¤å‘¨æœŸä¸­ï¼Œå…ˆå–æŒ‡ï¼Œç„¶åè¿›è¡ŒæŒ‡ä»¤æ“ä½œè¯‘ç </p>
</li>
<li>
<p>å¦‚æœæ¶‰åŠåˆ°æ“ä½œæ•°ï¼Œè¿›è¡Œæ“ä½œæ•°åœ°å€è®¡ç®—ï¼Œç„¶åå–æ“ä½œæ•°</p>
</li>
<li>
<p>ä¹‹åè¿›è¡Œæ•°æ®æ“ä½œã€‚æ“ä½œç»“æœå¦‚æœè¦ä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­ï¼Œéœ€è¦è®¡ç®—æ“ä½œæ•°çš„åœ°å€ï¼Œç„¶åä¿å­˜</p>
</li>
<li>
<p>åœ¨è¿™æ¡æŒ‡ä»¤æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ£€æµ‹æ˜¯å¦æœ‰ä¸­æ–­ã€‚å¦‚æœæ²¡æœ‰ä¸­æ–­ï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚å¦‚æœæœ‰ä¸­æ–­ï¼Œå°±æŒ‰ç…§ä¸­æ–­çš„å¤„ç†è§„åˆ™ï¼Œè¿›è¡Œä¸­æ–­å¤„ç†</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-4.png" title="/img/Computer Organization and Architecture/chapter12-4.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-4.png" data-sub-html="<h2>Indirect cycle</h2>">
        
    </a><figcaption class="image-caption">Indirect cycle</figcaption>
    </figure>
<ul>
<li>
<p>é—´æ¥å¯»å€è¿‡ç¨‹ä¸­ï¼Œç”±äºæ“ä½œæ•°åœ°å€éœ€è¦é€šè¿‡è®¡ç®—å¾—åˆ°ï¼Œæ‰€ä»¥åœ¨å–æ“ä½œæ•°çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šæ¬¡è®¿é—®å­˜å‚¨å™¨çš„æƒ…å†µ</p>
</li>
<li>
<p>å–æ“ä½œæ•°å’Œå­˜ç»“æœçš„è¿‡ç¨‹ä¸­ï¼Œéƒ½å¯èƒ½ä¼šå­˜åœ¨é—´æ¥å‘¨æœŸ</p>
</li>
</ul>
<hr>
<p><strong>Data flow (instruction fetch)</strong></p>
<ul>
<li>
<p>Depends on CPU design</p>
</li>
<li>
<p>Fetch inn general</p>
<ul>
<li>
<p>PC contains address of next instruction</p>
</li>
<li>
<p>Address moved to MAR</p>
</li>
<li>
<p>Address placed on address bus</p>
</li>
<li>
<p>Control unit requests memory read</p>
</li>
<li>
<p>Result placed on data bus, copied to MBR, then to IR</p>
</li>
<li>
<p>Meanwhile PC incremented by 1</p>
</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-5.png" title="/img/Computer Organization and Architecture/chapter12-5.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-5.png" data-sub-html="<h2>Data flow(fetch diagram)</h2>">
        
    </a><figcaption class="image-caption"><code>Data flow(fetch diagram)</code></figcaption>
    </figure>
<ul>
<li>
<p>åˆšå¼€å§‹ï¼Œä¸‹ä¸€ä¸ªåœ°å€åœ¨PCä¸­</p>
</li>
<li>
<p>åœ°å€ç»™MAR</p>
</li>
<li>
<p>åœ°å€æ”¾åˆ°æ•°æ®æ€»çº¿ä¸Š</p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒå‘èµ·è¯»æ§åˆ¶</p>
</li>
<li>
<p>å­˜å‚¨å™¨æŠŠæ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŒ‡ä»¤å†…å®¹ï¼Œæ”¾åˆ°æ•°æ®æ€»çº¿ä¸Š</p>
</li>
<li>
<p>MBRè¯»å–æ•°æ®æ€»çº¿å†…å®¹ï¼Œç„¶åæŠŠæŒ‡ä»¤ç»™IR</p>
</li>
<li>
<p>æ§åˆ¶å•å…ƒè¿˜éœ€è¦è®©PC+1ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªæŒ‡ä»¤</p>
</li>
</ul>
<hr>
<ul>
<li>
<p>IR is examined</p>
</li>
<li>
<p><strong>If there is no indirect addressing, enter the execution cycle</strong></p>
</li>
<li>
<p><strong>If indirect addressing, indirect cycle is performed</strong></p>
<ul>
<li>
<p>Rightmost N bits of MBR transferred to MAR</p>
</li>
<li>
<p>Control unit requests memory read</p>
</li>
<li>
<p>Result (address of operand) moved to MBR</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Data flow (execute)</strong></p>
<ul>
<li>
<p>May take many forms</p>
</li>
<li>
<p>Depends on instruction being executed</p>
</li>
<li>
<p>May include</p>
<ul>
<li>
<p>Memory read/write</p>
</li>
<li>
<p>Input/Output</p>
</li>
<li>
<p>Register transfers</p>
</li>
<li>
<p>ALU operations</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Data flow (interrupt)</strong></p>
<ul>
<li>
<p>Simple and predictable</p>
</li>
<li>
<p><strong>Current PC saved to allow resumption after interrupt</strong></p>
<ul>
<li>
<p>Contents of PC copied to MBR</p>
</li>
<li>
<p>Special memory location (e.g. stack pointer) loaded to MAR</p>
</li>
<li>
<p>MBR written to memory</p>
</li>
</ul>
</li>
<li>
<p><strong>PC loaded with address of interrupt handling routine</strong></p>
</li>
<li>
<p>Interrupt handler first instruction fetched</p>
</li>
</ul>
<h3 id="instruction-pipelining">Instruction Pipelining</h3>
<p><strong>Why need pipeline?</strong></p>
<ul>
<li>
<p>Development of computer application requires continuous improvement of processing capacity</p>
</li>
<li>
<p>The development of integrated circuit, clock frequency, registers, cache, etc. have reduced the instruction processing time and improved the processing ability</p>
</li>
<li>
<p><strong>More and more difficult to solve problems by simply relying on the performance of hardware</strong></p>
</li>
<li>
<p><strong>The goal is the execution efficiency of instructions</strong></p>
</li>
<li>
<p><strong>Better organization is needed to improve the efficiency of instruction execution</strong></p>
</li>
</ul>
<hr>
<p><strong>What is pipeline? ï¼ ï¼ ï¼</strong></p>
<ul>
<li>
<p><strong>The working mode of factory assembly line is used for reference</strong></p>
<ul>
<li>
<p><strong>Divide the execution of instructions into several stages</strong></p>
</li>
<li>
<p><strong>Different stages of multiple instructions can be processed in parallel</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Although execution time of each instruction is not shortened, the execution time of a group of instructions is shortened due to the parallel method</strong></p>
</li>
<li>
<p><strong>This is the basic idea of instruction pipeline</strong></p>
</li>
</ul>
<h4 id="prefetch">Prefetch</h4>
<ul>
<li>
<p>Before pipelining, next instruction is taken after current instruction is executed</p>
</li>
<li>
<p>With pipelining, more than one instruction in different stages of the pipeline</p>
</li>
<li>
<p>How to get instructions is a problem</p>
<ul>
<li>
<p><strong>Fetch accessing main memory</strong></p>
</li>
<li>
<p><strong>Execution usually does not access memory</strong></p>
</li>
<li>
<p><strong>Fetch next instruction during execution of current instruction</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Called instruction prefetch</strong></p>
</li>
</ul>
<hr>
<p><strong>Advantage</strong></p>
<ul>
<li>
<p>During execution of an instruction, a new instruction has entered the pipeline</p>
</li>
<li>
<p><strong>After current instruction is executed, it can be executed immediately</strong></p>
<ul>
<li>
<p>Next instruction has finished fetching</p>
</li>
<li>
<p><strong>Save time for fetching</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Accessing memory is required for fetching</strong></p>
<ul>
<li>
<p>If cache hits, take it directly</p>
</li>
<li>
<p>If cache missing, access memory</p>
</li>
</ul>
</li>
<li>
<p>In fact, the instruction cycle is divided into more detailed stages, more pipeline stages, and more overlapping and efficient instruction execution stages</p>
</li>
</ul>
<hr>
<p><strong>Which instruction is Prefetched?</strong></p>
<ul>
<li>
<p>Which instruction is appropriate for prefetching?</p>
</li>
<li>
<p><strong>Next instruction of the current instruction?</strong></p>
<ul>
<li>
<p><strong>If it is executed sequentially, no problem</strong></p>
</li>
<li>
<p><strong>If there is a transition, the next instruction needs to be determined according to the conditions</strong></p>
</li>
<li>
<p><strong>Hard to predict</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Does a misprediction in prefetching affect correctness?</strong></p>
<ul>
<li>
<p><strong>No, prefetched data at a â€œmis-predictedâ€ address is simply not used</strong></p>
</li>
<li>
<p><strong>There is no need for state recovery</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Basics characteristics</strong></p>
<ul>
<li>
<p>In modern systems, prefetching is usually done in cache block granularity</p>
</li>
<li>
<p>Prefetching is a technique that can reduce both</p>
<ul>
<li>
<p>Miss rate</p>
</li>
<li>
<p>Miss latency</p>
</li>
</ul>
</li>
<li>
<p><strong>Prefetching can be done by</strong></p>
<ul>
<li><strong>Hardware</strong></li>
<li><strong>Compiler</strong></li>
<li><strong>Programmer</strong></li>
</ul>
</li>
</ul>
<h4 id="prefetching-the-four-questions">Prefetching: the four questions</h4>
<ul>
<li>
<p>What</p>
<ul>
<li>What addresses to prefetch</li>
</ul>
</li>
<li>
<p>When</p>
<ul>
<li>When to initiate a prefetch request</li>
</ul>
</li>
<li>
<p>Where</p>
<ul>
<li>Where to place the prefetched data</li>
</ul>
</li>
<li>
<p>How</p>
<ul>
<li>Software, hardware, execution-based, cooperative</li>
</ul>
</li>
</ul>
<h4 id="two-stage-instruction-pipeline">Two stage instruction pipeline</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-6.png" title="/img/Computer Organization and Architecture/chapter12-6.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-6.png">
        
    </a>
<ul>
<li>
<p>ç®€å•çš„æŒ‡ä»¤è¿‡ç¨‹å°±æ˜¯ä¸²è¡Œå¤„ç†ï¼Œå–æŒ‡-æ‰§è¡Œ-å–æŒ‡-æ‰§è¡Œï¼Œæ•ˆç‡ä½</p>
</li>
<li>
<p>é‡‡ç”¨ä¸¤é˜¶æ®µæµæ°´çº¿åï¼Œåœ¨å½“å‰æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„å–æŒ‡</p>
</li>
<li>
<p>å¦‚æœå½“å‰æŒ‡ä»¤æ‰§è¡Œå®Œæˆåï¼Œä¸‹ä¸€ä¸ªæŒ‡ä»¤ä¸æ˜¯é¢„å–çš„ï¼Œéœ€è¦é‡æ–°å–æŒ‡</p>
</li>
<li>
<p>å–æŒ‡å’Œæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶é—´é‡å ï¼ŒèŠ‚çœäº†æ—¶é—´</p>
</li>
<li>
<p>ä½†æ˜¯ç”±äºå–æŒ‡å’Œæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶é—´éœ€è¦ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ‰§è¡Œé€Ÿåº¦ä¸èƒ½ç¿»å€</p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-7.png" title="/img/Computer Organization and Architecture/chapter12-7.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-7.png" data-sub-html="<h2>Instruction pipelining</h2>">
        
    </a><figcaption class="image-caption"><code>Instruction pipelining</code></figcaption>
    </figure>
<ul>
<li>
<p>ä¸¤é˜¶æ®µæµæ°´çº¿çš„æ‰§è¡Œè¿‡ç¨‹</p>
</li>
<li>
<p><strong>ä¸Šä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œé˜¶æ®µå’Œä¸‹ä¸€æ¡æŒ‡ä»¤çš„å–æŒ‡é˜¶æ®µåœ¨æ—¶é—´ä¸Šæ˜¯é‡å çš„</strong></p>
</li>
<li>
<p>æ¯ä¸ªæŒ‡ä»¤çš„æ€»ä½“æ‰§è¡Œæ—¶é—´æ²¡æœ‰ç¼©çŸ­ï¼Œéƒ¨æŒ‡ä»¤çš„æ‰§è¡Œæ—¶é—´ç¼©çŸ­äº†</p>
</li>
<li>
<p>å¦‚æœå–æŒ‡å’Œæ‰§è¡Œæ—¶é—´ç›¸åŒï¼Œé‚£ä¹ˆæµæ°´çº¿çš„æ‰§è¡Œæ—¶é—´æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ä¸€åŠï¼Œæ€§èƒ½æå‡ä¸€å€</p>
</li>
</ul>
<h4 id="improved-performance">Improved performance</h4>
<ul>
<li>
<p><strong>But not doubled</strong></p>
<ul>
<li>
<p><strong>Fetch usually shorter than execution</strong></p>
</li>
<li>
<p>Instruction execution process is complex and time-consuming</p>
</li>
<li>
<p><strong>Execution time determines the improvement effect</strong></p>
</li>
</ul>
</li>
<li>
<p>Jump or branch instruction</p>
<ul>
<li>
<p><strong>means that prefetched instructions are not the required instructions</strong></p>
</li>
<li>
<p><strong>Get the actual instructions according to the results</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Add more stages to improve performance</strong></p>
</li>
</ul>
<h4 id="improve-concurrency">improve concurrency</h4>
<ul>
<li>
<p>Goal: More concurrency â†’ Higher instruction throughput</p>
</li>
<li>
<p><strong>Method: When an instruction is using some resources in its processing phase, process other instructions on idle resources</strong></p>
<ul>
<li>
<p>Fetch next instruction when an instruction is being decoded</p>
</li>
<li>
<p>Decode an instruction when an instruction is being executed</p>
</li>
<li>
<p>Execute the next instruction when current instruction is accessing memory</p>
</li>
<li>
<p>When an instruction is writing its result into the register file, access data memory for the next instruction</p>
</li>
</ul>
</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>
<p>Analogy: â€œAssembly line processingâ€ of instructions</p>
</li>
<li>
<p>Pipeline the execution of multiple instructions</p>
<ul>
<li>
<p><strong>Divide the instruction processing cycle into distinct â€œstagesâ€ of processing</strong></p>
</li>
<li>
<p>Ensure there are enough hardware resources to process one instruction in each stage</p>
</li>
<li>
<p>Process a different instruction in each stage</p>
</li>
<li>
<p>Instructions are executed in the order of program</p>
</li>
</ul>
</li>
<li>
<p><strong>Benefit: Increases instruction processing throughput</strong></p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-8.png" title="/img/Computer Organization and Architecture/chapter12-8.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-8.png" data-sub-html="<h2>execution of four independent add</h2>">
        
    </a><figcaption class="image-caption">execution of four independent add</figcaption>
    </figure>
<ul>
<li>
<p>åŠ æ³•æŒ‡ä»¤æµæ°´çº¿</p>
</li>
<li>
<p>æ•´ä¸ªæŒ‡ä»¤åˆ†ä¸º4ä¸ªé˜¶æ®µï¼šå–æŒ‡ï¼Œè¯‘ç ï¼Œæ‰§è¡Œï¼Œå†™ç»“æœï¼Œå‡ä¸ºt</p>
</li>
<li>
<p>é‡‡ç”¨4é˜¶æ®µæµæ°´çº¿ï¼Œæ¯ä¸ªé˜¶æ®µå®Œå…¨ç‹¬ç«‹ï¼Œnä¸ªæŒ‡ä»¤ï¼Œéœ€è¦$nt+3t$çš„æ—¶é—´</p>
</li>
<li>
<p>åŸºæœ¬ä¸Šæ˜¯$\frac {1}{4}$çš„æ—¶é—´</p>
</li>
</ul>
<h4 id="in-practice">In practice</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-9.png" title="/img/Computer Organization and Architecture/chapter12-9.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-9.png">
        
    </a>
<ul>
<li>
<p>çƒ˜å¹²è¡£æœéœ€è¦2ä¸ªæ—¶é—´å•ä½ï¼Œè¿™æ ·ï¼Œå¦‚æœå®Œå…¨ä¸²è¡Œï¼Œéœ€è¦20ä¸ªæ—¶é—´å•ä½</p>
</li>
<li>
<p>é‡‡ç”¨æµæ°´çº¿åï¼Œæœ‰ç­‰å¾…çƒ˜å¹²æœºçš„æ—¶é—´</p>
</li>
<li>
<p>4ä»¶è¡£æœéœ€è¦11ä¸ªæ—¶é—´å•ä½</p>
</li>
<li>
<p>ç†è®ºä¸Šçš„é€Ÿåº¦ä¸ºéæµæ°´çº¿çš„$2.5$å€</p>
</li>
<li>
<p><strong>æœ€æ…¢çš„æ­¥éª¤å†³å®šäº†æ•´ä¸ªç³»ç»Ÿçš„ååé‡</strong></p>
</li>
</ul>
<h5 id="how">How</h5>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-10.png" title="/img/Computer Organization and Architecture/chapter12-10.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-10.png">
        
    </a>
<ul>
<li>
<p>çƒ˜å¹²æœºæˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆ</p>
</li>
<li>
<p>è¡¥å……èµ„æºï¼Œé…ç½®2ä¸ªçƒ˜å¹²æœº</p>
</li>
<li>
<p>ä¸‹ä¸€ä¸ªè¡£æœæ´—å®Œåï¼Œä¸éœ€è¦ç­‰å¾…ä¸Šä¸€ä¸ªè¡£æœçš„çƒ˜å¹²ï¼Œç”¨å¦ä¸€å°çƒ˜å¹²æœº</p>
</li>
<li>
<p>å…³é”®ç¯èŠ‚å¢åŠ èµ„æºï¼Œä½¿å¾—æ•´ä¸ªååé‡å›åˆ°ä¹‹å‰çš„æƒ…å†µ</p>
</li>
<li>
<p>ä»£ä»·å°±æ˜¯é…ç½®é¢å¤–çš„èµ„æº</p>
</li>
</ul>
<h4 id="goal">Goal</h4>
<ul>
<li>
<p>Increase instruction throughput with little increase in cost</p>
<ul>
<li>
<p><strong>Process instructions in the order required by the program</strong></p>
</li>
<li>
<p><strong>Hardware cost cannot be increased too much</strong></p>
</li>
<li>
<p>Instruction throughput can be greatly increased</p>
</li>
</ul>
</li>
</ul>
<h4 id="an-ideal-pipeline">An ideal pipeline</h4>
<ul>
<li>
<p><strong>Repetition of identical operations</strong></p>
<ul>
<li>
<p><strong>Same operation, different operation objects</strong></p>
</li>
<li>
<p>Automobiles of the same model can be produced on one assembly line</p>
</li>
<li>
<p><strong>Different operations require different steps, which affects the operation of the pipeline</strong></p>
</li>
<li>
<p>The production of automobiles and motorcycles requires different steps and cannot be put on the same assembly line</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p><strong>Operating objects are independent of each other</strong></p>
<ul>
<li>
<p><strong>There is no dependency between each operation object</strong></p>
</li>
<li>
<p>For example, there is no relationship between cars produced on the assembly line</p>
</li>
<li>
<p><strong>Operating objects with sequential dependencies affect each other during parallel operations</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>A complete operation can be decomposed into several sub operations</p>
<ul>
<li>
<p><strong>Each sub operation takes the same time</strong></p>
</li>
<li>
<p><strong>Each sub operation requires independent resources and does not share resources</strong></p>
</li>
<li>
<p>If sub operation requires different time, some sub operations must wait</p>
</li>
<li>
<p>Resource sharing leads to resource contention</p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p>For the pipeline design of instructions, we divide the execution of instructions into six stages</p>
<ul>
<li>
<p><strong>Fetch instruction(FI)</strong></p>
</li>
<li>
<p><strong>Decode instruction(DI)</strong></p>
</li>
<li>
<p><strong>Calculate operands(CO)</strong></p>
</li>
<li>
<p><strong>Fetch operands(FO)</strong></p>
</li>
<li>
<p><strong>Execute instructions(EI)</strong></p>
</li>
<li>
<p><strong>Write result(WO)</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Overlap these operations</strong></p>
</li>
</ul>
<h4 id="timing-of-pipeline">Timing of pipeline</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-11.png" title="/img/Computer Organization and Architecture/chapter12-11.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-11.png">
        
    </a>
<ul>
<li>
<p>ç†æƒ³çš„æŒ‡ä»¤æµæ°´çº¿çš„æ‰§è¡Œè¿‡ç¨‹</p>
</li>
<li>
<p><strong>æŒ‡ä»¤æ‰§è¡Œåˆ†ä¸º6ä¸ªé˜¶æ®µï¼Œç›¸äº’ä¹‹é—´ä¸å…±äº«èµ„æº</strong></p>
</li>
<li>
<p>æŒ‰ç…§æµæ°´çº¿çš„æ–¹å¼æ¥æ‰§è¡Œï¼Œä»ç¬¬å…­ä¸ªæ—¶é—´å•ä½å¼€å§‹ï¼Œæ¯ä¸ªæ—¶é—´å•ä½éƒ½ä¼šæœ‰1ä¸ªæŒ‡ä»¤å®Œæˆæ‰§è¡Œ</p>
</li>
<li>
<p>æŒ‡ä»¤æ•°é‡è¶³å¤Ÿå¤šæ—¶ï¼Œæ‰§è¡Œæ•ˆç‡ä¸ºåŸæ¥çš„6å€</p>
</li>
</ul>
<h4 id="summary-1">Summary</h4>
<ul>
<li>
<p>The total execution time for each individual instruction is not changed by pipelining</p>
<ul>
<li>It still takes an instruction cycle to make it all the way through the processor</li>
</ul>
</li>
<li>
<p>Pipelining doesn&rsquo;t speed up instruction execution time</p>
</li>
<li>
<p>It does speed up program execution time by increasing the number of instructions finished per unit time</p>
</li>
</ul>
<h4 id="branch-in-a-pipeline">Branch in a pipeline</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-12.png" title="/img/Computer Organization and Architecture/chapter12-12.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-12.png">
        
    </a>
<ul>
<li>
<p>æŒ‡ä»¤1å’Œ2çš„æ‰§è¡Œéƒ½æ˜¯æ­£å¸¸çš„</p>
</li>
<li>
<p>æŒ‡ä»¤3åœ¨æ—¶é—´ç‰‡8æ—¶ï¼Œéœ€è¦è·³è½¬åˆ°æŒ‡ä»¤15çš„æ‰§è¡Œ</p>
</li>
<li>
<p>æŒ‡ä»¤4-7å·²ç»å®Œæˆçš„å¤„ç†ä½œåºŸ</p>
</li>
<li>
<p>éœ€è¦é‡æ–°å¼€å§‹æŒ‡ä»¤15çš„å–æŒ‡</p>
</li>
<li>
<p><strong>ç¬¬9åˆ°ç¬¬12æ—¶é—´ç‰‡ï¼Œæ²¡æœ‰æŒ‡ä»¤å®Œæˆæ‰§è¡Œï¼Œç§°ä¸ºåˆ†æ”¯æƒ©ç½š</strong></p>
</li>
<li>
<p><strong>åˆ†æ”¯è¶Šå¤šï¼Œåˆ†æ”¯æƒ©ç½šå°±è¶Šå¤šï¼Œæ•´ä¸ªç¨‹åºçš„æŒ‡ä»¤ååç‡å°±è¶Šä½</strong></p>
</li>
</ul>
<hr>
<p><strong>Six stage instruction pipeline</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-13.png" title="/img/Computer Organization and Architecture/chapter12-13.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-13.png">
        
    </a>
<ul>
<li>
<p>ç¬¬ä¸€æ­¥æ˜¯å–æŒ‡ï¼Œä¹‹åæ˜¯æŒ‡ä»¤è¯‘ç ï¼Œå¹¶è®¡ç®—æ“ä½œæ•°åœ°å€</p>
</li>
<li>
<p><strong>æ­¤æ—¶ï¼Œéœ€è¦åˆ¤æ–­æŒ‡ä»¤æ˜¯å¦æ˜¯æ— æ¡ä»¶è½¬ç§»ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆæ›´æ–°PCï¼Œå¹¶æ¸…ç©ºæµæ°´çº¿ï¼Œç»§ç»­å¼€å§‹å–æŒ‡</strong></p>
</li>
<li>
<p><strong>å¦‚æœä¸è½¬ç§»ï¼Œæ­£å¸¸æ‰§è¡ŒæŒ‡ä»¤ï¼Œå–æ“ä½œæ•°ï¼Œç„¶åæ‰§è¡ŒæŒ‡ä»¤ï¼Œå¹¶å†™æ“ä½œæ•°</strong></p>
</li>
<li>
<p><strong>åˆ¤æ–­æ˜¯å¦è¿›è¡Œåˆ†æ”¯ï¼Œæˆ–è€…æ˜¯å¦æœ‰ä¸­æ–­ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå’Œæ— æ¡ä»¶åˆ†æ”¯ä¸€æ ·ï¼Œæ›´æ”¹PCï¼Œæ¸…ç©ºæµæ°´çº¿ï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œåç»­æŒ‡ä»¤</strong></p>
</li>
</ul>
<h4 id="other-factors">Other factors</h4>
<ul>
<li>
<p>Data transmission between different parts takes time</p>
</li>
<li>
<p>Theoretically, the more stages, the higher the efficiency of instruction execution</p>
<ul>
<li>
<p>The more stages are divided, the more complex the control between stages will be</p>
</li>
<li>
<p><strong>Latching delay, buffering between phases takes a certain time</strong></p>
</li>
<li>
<p>Need reasonable design</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Speedup factors with instruction pipelining</strong></p>
<ul>
<li>å‡å®šæ€»å…±éœ€è¦æ‰§è¡Œnæ¡æŒ‡ä»¤ï¼Œé‡‡ç”¨çš„æµæ°´çº¿æ®µæ•°ä¸ºkï¼Œé‚£ä¹ˆä½¿ç”¨æŒ‡ä»¤æµæ°´çº¿ç›¸å¯¹äºä¸ä½¿ç”¨æµæ°´çº¿çš„åŠ é€Ÿæ¯”çš„å®šä¹‰æ˜¯</li>
</ul>
<p>$$
S_k=\frac {nk}{k+n-1}
$$</p>
<ul>
<li>
<p>éšç€æŒ‡ä»¤æ•°çš„å¢åŠ ï¼ŒåŠ é€Ÿæ¯”è¶‹å‘äºæµæ°´çº¿çš„é˜¶æ®µ</p>
</li>
<li>
<p>æŒ‡ä»¤æ•°è¶Šå¤šï¼ŒåŠ é€Ÿæ¯”è¶Šæ¥è¿‘ç†è®ºä¸Šçš„åŠ é€Ÿæ¯”ã€‚è€Œéšç€æ®µæ•°çš„å¢åŠ ï¼ŒåŠ é€Ÿæ¯”å¢åŠ ç¼“æ…¢</p>
</li>
<li>
<p>æµæ°´çº¿æ®µæ•°èƒ½å¸¦æ¥æ›´å¥½çš„æ½œåœ¨åŠ é€Ÿæ¯”ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚æ¯”å¦‚åˆ†æ”¯æ—¶éœ€è¦æ¸…ç©ºæµæ°´çº¿ï¼Œæ®µé—´å»¶æ—¶ä¹Ÿéœ€è¦è€ƒè™‘</p>
</li>
</ul>
<h4 id="analysis-of-instruction-pipeline">Analysis of instruction pipeline</h4>
<ul>
<li>What are the characteristics of an ideal pipeline?
<ul>
<li>
<p>Repetition of identical operations</p>
</li>
<li>
<p>Operating objects are independent of each other</p>
</li>
<li>
<p>A complete operation can be decomposed into several sub operations</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Identical operations â€¦ NOT!</strong></p>
<ul>
<li>
<p><strong>different instructions â†’ not all need the same stages</strong></p>
</li>
<li>
<p>Forcing different instructions to go through the same pipe stages</p>
</li>
<li>
<p><strong>Some pipeline stages are idle</strong></p>
</li>
<li>
<p><strong>Leading to a waste of time, called external fragmentation</strong></p>
</li>
</ul>
<hr>
<p><strong>Independent operations &hellip; NOT!</strong></p>
<ul>
<li>
<p><strong>instructions are not independent of each other</strong></p>
</li>
<li>
<p>Need to detect and resolve inter-instruction dependencies to ensure the pipeline provides correct results</p>
</li>
<li>
<p>Pipeline stalls frequently due to branch</p>
</li>
<li>
<p>Poor operation of the pipeline</p>
</li>
</ul>
<hr>
<p><strong>Uniform sub-operations &hellip; NOT!</strong></p>
<ul>
<li>
<p><strong>different pipeline stages â†’ not the same latency</strong></p>
</li>
<li>
<p>Need to force each stage to be controlled by the same clock</p>
</li>
<li>
<p><strong>Some pipe stages are too fast but all take the same clock cycle time</strong></p>
</li>
<li>
<p><strong>These wasted time are called internal fragmentation</strong></p>
</li>
</ul>
<hr>
<h4 id="issues-in-pipeline-design">Issues in pipeline design</h4>
<ul>
<li>
<p>Reasonably divide the stages of instructions</p>
<ul>
<li>
<p><strong>How many stages is the instruction cycle divided into?</strong></p>
</li>
<li>
<p>what is done in each stage</p>
</li>
</ul>
</li>
<li>
<p>Handling exceptions, interrupts</p>
</li>
<li>
<p>Keeping the pipeline correct, moving, and full</p>
<ul>
<li>
<p>Data dependences</p>
</li>
<li>
<p>Control dependences</p>
</li>
<li>
<p>Resource conflict</p>
</li>
<li>
<p>Long-latency (or multi-cycle) operations</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Causes of pipeline stalls</strong></p>
<ul>
<li>
<p><strong>Pipeline stall: A condition when the pipeline stops moving</strong></p>
</li>
<li>
<p>Causes of stall</p>
<ul>
<li>Resource contention</li>
<li>Dependences between instructions, including data dependence and control dependence</li>
<li>Long-latency (multi-cycle) operations</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Dependences and Their Types</strong></p>
<ul>
<li>
<p>Also called â€œhazardâ€ or â€œpipeline bubbleâ€</p>
</li>
<li>
<p>Dependences dictate ordering requirements between instructions</p>
</li>
<li>
<p>Two types</p>
<ul>
<li>
<p>Data dependence</p>
</li>
<li>
<p>Control dependence</p>
</li>
</ul>
</li>
<li>
<p><strong>Resource contention is sometimes called resource dependence</strong></p>
</li>
<li>
<p><strong>When dependency occurs, the pipeline will be suspended, which is called pipeline adventure</strong></p>
</li>
</ul>
<h4 id="resource-hazards">Resource hazards</h4>
<ul>
<li>
<p><strong>Two (or more) instructions in pipeline need same resource</strong></p>
<ul>
<li>
<p><strong>Executed in serial rather than parallel for part of pipeline</strong></p>
</li>
<li>
<p><strong>Also called <em>structural hazard</em></strong></p>
</li>
</ul>
</li>
<li>
<p>It is caused by unreasonable structure or insufficient resources</p>
<ul>
<li>Such as using the same register</li>
</ul>
</li>
<li>
<p><strong>The solution is generally to increase available resources, such as adding a dryer in the previous example</strong></p>
</li>
</ul>
<p><strong>Example</strong></p>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-14.png" title="/img/Computer Organization and Architecture/chapter12-14.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-14.png">
        
    </a>
<ul>
<li>
<p>ç¬¬3ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œ$I_1$éœ€è¦è¯»å–å†…å­˜å–æ“ä½œæ•°ï¼ŒåŒæ—¶$I_3$ä¹Ÿéœ€è¦å–æŒ‡</p>
</li>
<li>
<p>ä¸¤ä¸ªæŒ‡ä»¤è¯»éœ€è¦è¯»å­˜å‚¨å™¨ï¼Œå‘ç”Ÿèµ„æºå†²çª</p>
</li>
<li>
<p>$I_3$éœ€è¦ç©ºä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œç­‰åˆ°ç¬¬4ä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ—¶å€™ï¼Œæ‰å»å–æŒ‡</p>
</li>
<li>
<p>å› ä¸ºèµ„æºå†²çªè€Œæµªè´¹äº†1ä¸ªæ—¶é’Ÿå‘¨æœŸ</p>
</li>
<li>
<p>å¦‚æœåªæœ‰ä¸€ä¸ª$ALU$ï¼Œæ‰§è¡ŒæŒ‡ä»¤ä¹Ÿå¯èƒ½ä¼šå†²çª</p>
</li>
</ul>
<h4 id="handling-resource-contention">Handling resource contention</h4>
<ul>
<li>
<p><strong>Solution 1: Eliminate the cause of contention</strong></p>
<ul>
<li>
<p>Duplicate the resource or increase its throughput</p>
</li>
<li>
<p>E.g., use separate instruction and data memories (caches)</p>
</li>
<li>
<p>E.g., use multiple ports for memory structures</p>
</li>
</ul>
</li>
<li>
<p><strong>Solution 2: Detect the resource contention and stall one</strong></p>
<ul>
<li>Need to decide which one to stop</li>
</ul>
</li>
</ul>
<h4 id="data-hazards">Data hazards</h4>
<ul>
<li>
<p>Conflict in access of an operand</p>
<ul>
<li>E.g. ,both instructions access a particular memory or register operand</li>
</ul>
</li>
<li>
<p><strong>If two instructions are executed serially in strict order, that is one instruction executes after the finish of the previous instruction execution. No problem</strong></p>
</li>
<li>
<p><strong>If in a pipeline, operand value could be updated so as to produce different result from strict sequential execution</strong></p>
</li>
<li>
<p><strong>Data Hazard is caused by the conflict of access to the same operand location</strong></p>
</li>
</ul>
<hr>
<h4 id="types-of-data-hazard">Types of data hazard</h4>
<ul>
<li>
<p>Types of data dependencesï¼š</p>
<ul>
<li>
<p><strong>read after write</strong></p>
<ul>
<li><strong>Called â€œTrue dependence â€</strong></li>
</ul>
</li>
<li>
<p><strong>write after read</strong></p>
<ul>
<li><strong>Called â€œAnti dependence â€</strong></li>
</ul>
</li>
<li>
<p><strong>write after write</strong></p>
<ul>
<li><strong>Called â€œOutput dependenceâ€</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="true-dependency">True dependency</h5>
<ul>
<li>
<p><strong>Read after write (RAW), or true dependency</strong></p>
<ul>
<li>
<p><strong>An instruction modifies a register or memory location</strong></p>
</li>
<li>
<p><strong>Succeeding instruction reads data in that location</strong></p>
</li>
<li>
<p><strong>Hazard occurs if read takes place before write complete</strong></p>
</li>
<li>
<p><strong>What needs to be read by succeeding instruction is the modified data</strong></p>
</li>
<li>
<p><strong>After the pipeline is adopted, the read data becomes the data before writing</strong></p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-15.png" title="/img/Computer Organization and Architecture/chapter12-15.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-15.png">
        
    </a>
<ul>
<li>
<p>ç¬¬ä¸€ä¸ªæŒ‡ä»¤éœ€è¦å†™$r_3$</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªæŒ‡ä»¤éœ€è¦è¯»$r_3$</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªæŒ‡ä»¤<strong>å¿…é¡»è¦ç­‰ç¬¬ä¸€ä¸ªæŒ‡ä»¤æ‰§è¡Œå®Œæˆä¹‹åå¹¶å†™äº†</strong>$r_3$ï¼Œæ‰èƒ½å®Œæˆè¯»æ“ä½œæ•°çš„æŒ‡ä»¤ï¼Œå¦åˆ™è¯»å–çš„$r_3$ä¸æ˜¯éœ€è¦çš„æ•°</p>
</li>
</ul>
<h5 id="anti-dependence">Anti dependence</h5>
<ul>
<li>
<p><strong>Write after read (WAR), or anti-dependency</strong></p>
</li>
<li>
<p><strong>An instruction reads a register or memory location</strong></p>
</li>
<li>
<p><strong>Succeeding instruction writes to location</strong></p>
</li>
<li>
<p><strong>Hazard occur if write completes before read takes place</strong></p>
</li>
<li>
<p><strong>The data of the first instruction read operation is incorrect</strong></p>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-16.png" title="/img/Computer Organization and Architecture/chapter12-16.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-16.png">
        
    </a>
<ul>
<li>
<p>ç¬¬ä¸€ä¸ªæŒ‡ä»¤è¯»$r_1$</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªæŒ‡ä»¤å†™$r_1$</p>
</li>
<li>
<p>å¦‚æœå…ˆæ‰§è¡Œäº†ç¬¬äºŒä¸ªæŒ‡ä»¤ï¼Œé‚£ä¹ˆç»“æœä¹Ÿä¸æ­£ç¡®</p>
</li>
<li>
<p>åœ¨è¶…æ ‡é‡ä¸­ä¼šå‡ºç°è¿™ç§æƒ…å†µ</p>
</li>
</ul>
<h5 id="output-dependence">Output dependence</h5>
<ul>
<li>
<p><strong>Write after write (WAW), or output dependency</strong></p>
<ul>
<li>
<p><strong>Two instructions both write to same location</strong></p>
</li>
<li>
<p><strong>Hazard if writes take place in reverse of order intended sequence</strong></p>
</li>
<li>
<p><strong>The data to be stored is the data written by the second instruction</strong></p>
</li>
<li>
<p><strong>In the pipeline, the data actually saved is the data written by the first instruction</strong></p>
</li>
<li>
<p><strong>Data of memory or register is not required</strong></p>
</li>
</ul>
</li>
</ul>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-17.png" title="/img/Computer Organization and Architecture/chapter12-17.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-17.png">
        
    </a>
<ul>
<li>
<p>ç¬¬ä¸€ä¸ªæ‰§è¡Œå†™$r_3$</p>
</li>
<li>
<p>ç¬¬ä¸‰ä¸ªæŒ‡ä»¤ä¹Ÿå†™$r_3$</p>
</li>
<li>
<p>å¦‚æœç¬¬ä¸‰ä¸ªæŒ‡ä»¤å…ˆæ‰§è¡Œäº†ï¼Œä¹Ÿç»“æœä¸æ­£ç¡®</p>
</li>
<li>
<p>åœ¨è¶…æ ‡é‡ä¸­ä¼šå‡ºç°è¿™ç§æƒ…å†µ</p>
</li>
</ul>
<h4 id="how-1">How?</h4>
<ul>
<li>
<p>True dependences always need to be obeyed because they constitute true dependence on a value</p>
</li>
<li>
<p><strong>True dependences always need to be obeyed because they constitute true dependence on a value</strong></p>
</li>
<li>
<p><strong>Anti and output dependences exist due to limited number of architectural registers</strong></p>
<ul>
<li><strong>They are dependence on a name, not a value</strong></li>
</ul>
</li>
<li>
<p><strong>Without special hardware and specific avoidance algorithms, results in inefficient pipeline usage</strong></p>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-18.png" title="/img/Computer Organization and Architecture/chapter12-18.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-18.png" data-sub-html="<h2>Data hazard diagram</h2>">
        
    </a><figcaption class="image-caption"><code>Data hazard diagram</code></figcaption>
    </figure>
<ul>
<li>
<p>åœ¨ç¬¬äº”ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ŒåŠ æ³•æŒ‡ä»¤å†™EAX</p>
</li>
<li>
<p>ç¬¬å››ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œå‡æ³•è¦ç”¨EAX</p>
</li>
<li>
<p>å¦‚æœç¬¬äºŒä¸ªæŒ‡ä»¤ä¸ç­‰å¾…ï¼Œé‚£å–çš„EAXè¿˜æ˜¯æœ€æ—©çš„EAXï¼Œä¸æ˜¯åŠ æ³•çš„ç»“æœ</p>
</li>
<li>
<p>æ‰€ä»¥å‡æ³•æŒ‡ä»¤éœ€è¦åœé¡¿2ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œåˆ°ç¬¬å…­ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰ä¼šå»å–æ“ä½œæ•°</p>
</li>
<li>
<p>æµªè´¹äº†2ä¸ªæ—¶é’Ÿå‘¨æœŸ</p>
</li>
</ul>
<h4 id="method-of-handle">Method of handle</h4>
<ul>
<li>
<p>True dependences are more interesting</p>
<ul>
<li><strong>Actual interdependence between dataï¼Œrequires waiting</strong></li>
</ul>
</li>
<li>
<p><strong>Anti and output dependences are easier to handle</strong></p>
<ul>
<li>
<p><strong>Itâ€™s all about writing</strong></p>
</li>
<li>
<p><strong>Use more registers</strong></p>
</li>
<li>
<p><strong>Use different registers to eliminate possible correlation</strong></p>
</li>
</ul>
</li>
<li>
<p>Some fundamental ways of handling true dependences</p>
<ul>
<li>
<p>Detect and wait until value is available in register file</p>
</li>
<li>
<p>Detect and eliminate the dependence at the software level</p>
<ul>
<li>
<p>Register renaming</p>
</li>
<li>
<p>Discussed later</p>
</li>
</ul>
</li>
<li>
<p>Predict the needed value(s), execute â€œspeculativelyâ€, and verify</p>
</li>
</ul>
</li>
</ul>
<h4 id="control-dependence">Control dependence</h4>
<ul>
<li>
<p>Also called â€œcontrol hazardâ€â€œbranch hazardâ€</p>
</li>
<li>
<p>A Special Case of Data Dependence</p>
</li>
<li>
<p>Occurs when the pipeline makes a wrong judgment on branch transfer</p>
</li>
<li>
<p>Brings instructions into pipeline that must subsequently be discarded</p>
</li>
<li>
<p>The pipeline cannot run with full load</p>
</li>
</ul>
<h5 id="solve">solve</h5>
<ul>
<li>
<p><strong>Multiple Streams</strong></p>
</li>
<li>
<p><strong>Prefetch Branch Target</strong></p>
</li>
<li>
<p><strong>Loop buffer</strong></p>
</li>
<li>
<p><strong>Branch prediction</strong></p>
</li>
<li>
<p><strong>Delayed branching</strong></p>
</li>
</ul>
<h6 id="multiple-streams">Multiple streams</h6>
<ul>
<li>
<p>Have two pipelines for each branch</p>
<ul>
<li>Prefetch each branch into a separate pipeline</li>
</ul>
</li>
<li>
<p>Finally, determine which pipeline to use according to the branching conditions</p>
</li>
<li>
<p>Shortcoming</p>
<ul>
<li>
<p>Leads to bus &amp; register contention</p>
</li>
<li>
<p>Multiple branches lead to further pipelines being needed</p>
</li>
</ul>
</li>
</ul>
<h6 id="prefetch-branch-target">Prefetch branch target</h6>
<ul>
<li>Target of branch is prefetched in addition to instructions following branch</li>
<li>It is not executed after prefetching, but fetching and decoding</li>
<li>Keep target until branch is executed</li>
<li>It can save the time of fetching and decoding</li>
<li>Used by IBM 360/91</li>
</ul>
<h6 id="loop-buffer">Loop buffer</h6>
<ul>
<li>
<p>Very fast memory</p>
</li>
<li>
<p>Contains n instructions taken in the most recent order</p>
</li>
<li>
<p>When a branch may occur, first check whether the transfer target is in the buffer</p>
</li>
<li>
<p><strong>Very good for small loops or jumps</strong></p>
</li>
</ul>
<h6 id="branch-prediction">Branch prediction</h6>
<ul>
<li>
<p>There are two types of branch predictions</p>
<ul>
<li>
<p>Static branch predictions: the branch does not depend on the execution history</p>
</li>
<li>
<p>Dynamic branch prediction: the branch depends on the execution history</p>
</li>
</ul>
</li>
<li>
<p>Static branching</p>
<ul>
<li>
<p>Predict never taken</p>
</li>
<li>
<p>Predict always taken</p>
</li>
<li>
<p>Predict by Opcode</p>
</li>
</ul>
</li>
<li>
<p>Dynamic branching</p>
<ul>
<li>
<p>Taken/not taken switch</p>
</li>
<li>
<p>Branch history table</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Static branch prediction</strong></p>
<ul>
<li>
<p><strong>Predict never taken</strong></p>
<ul>
<li>
<p><strong>Assume that jump will not happen</strong></p>
</li>
<li>
<p><strong>Always fetch next instruction</strong></p>
</li>
<li>
<p><strong>68020 &amp; VAX 11/780</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>Predict always taken</strong></p>
<ul>
<li>
<p><strong>Assume that jump will happen</strong></p>
</li>
<li>
<p><strong>Always fetch target instruction</strong></p>
</li>
</ul>
</li>
<li>
<p><strong>â€œPredict always taken â€ are most used</strong></p>
</li>
<li>
<p>Predict by Opcode</p>
<ul>
<li>
<p>Some instructions are more likely to result in a jump than others</p>
</li>
<li>
<p>Can get up to 75% success</p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Dynamic branch prediction</strong></p>
<ul>
<li>
<p><strong>Record the history of conditional branch instructions in a program</strong></p>
</li>
<li>
<p>Taken/not taken switch: One or more bits are used to indicate recent history of the instruction</p>
<ul>
<li>
<p><strong>The branching decision is depended on these bits</strong></p>
</li>
<li>
<p><strong>Based on previous history</strong></p>
</li>
<li>
<p><strong>Good for loops</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Branch history table</strong></p>
<ul>
<li>
<p>If Predict branchï¼Œtarget address can only be obtained by decoding instructions</p>
<ul>
<li>
<p>A waiting time is required</p>
</li>
<li>
<p>How to improve efficiency?</p>
</li>
</ul>
</li>
<li>
<p>A storage area called branch target buffer is designed</p>
<ul>
<li>
<p>Also called branch history table</p>
</li>
<li>
<p>It records information related to branch transfer, including branch instruction address, transfer history bit, and target address information</p>
</li>
</ul>
</li>
<li>
<p>Target address information</p>
<ul>
<li>
<p>Can be target instruction</p>
<ul>
<li>
<p>Use this instruction directly</p>
</li>
<li>
<p>Less time</p>
</li>
<li>
<p>It will take up more space</p>
</li>
</ul>
</li>
<li>
<p>Can be the target instruction address</p>
<ul>
<li>
<p>Less space</p>
</li>
<li>
<p>More time</p>
</li>
</ul>
</li>
<li>
<p>Whether to save time or space depends on the specific situation</p>
</li>
</ul>
</li>
</ul>
<h4 id="branch-history-table">Branch history table</h4>
<a class="lightgallery" href="/img/Computer%20Organization%20and%20Architecture/chapter12-19.png" title="/img/Computer Organization and Architecture/chapter12-19.png" data-thumbnail="/img/Computer Organization and Architecture/chapter12-19.png">
        
    </a>
<ul>
<li>
<p>é¢„æµ‹è½¬ç§»åï¼ŒæŒ‡ä»¤é¢„å–çš„æ—¶å€™ï¼Œå…ˆå»è½¬ç§»å†å²è¡¨ä¸­æŸ¥è¯¢</p>
<ul>
<li>
<p>å¦‚æœæœ‰çš„è¯ï¼Œæ ¹æ®æŒ‡ä»¤çŠ¶æ€è¿›è¡Œé¢„æµ‹ï¼Œå¯èƒ½æ˜¯ç›®æ ‡åœ°å€ï¼Œæˆ–è€…æ˜¯ä¸‹ä¸€é¡ºåºåœ°å€</p>
</li>
<li>
<p>å¦‚æœä¸åŒ¹é…ï¼Œé¡ºåºå–ä¸‹ä¸€ä¸ªæŒ‡ä»¤</p>
</li>
</ul>
</li>
<li>
<p>åˆ†æ”¯æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œæ ¹æ®å®é™…æ˜¯å¦å‘ç”Ÿäº†è½¬ç§»ï¼Œæ›´æ–°è½¬ç§»å†å²è¡¨ä¸­çš„çŠ¶æ€ä½</p>
</li>
<li>
<p>å¦‚æœæ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ä¸åœ¨è¡¨ä¸­çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæŒ‡ä»¤åŠ åˆ°è¿™ä¸ªè¡¨ä¸­ï¼ŒåŒæ—¶éœ€è¦æ›¿æ¢åˆ°å½“å‰è¡¨ä¸­çš„ä¸€é¡¹ã€‚æ›¿æ¢æ–¹æ³•å¯ä»¥é‡‡ç”¨å¾ˆå¤šç§æ–¹æ³•ï¼Œ<strong>ç±»ä¼¼äºcacheçš„æ›¿æ¢ç­–ç•¥</strong></p>
</li>
<li>
<p>è½¬ç§»å†å²è¡¨åŠ¨æ€è‡ªåŠ¨ç»´æŠ¤</p>
</li>
</ul>
<hr>
<p><strong>Correlation-based prediction</strong></p>
<ul>
<li>
<p>The execution effect of the branch history table in the loop statement is good</p>
</li>
<li>
<p>In more complex structures, branch instruction directly correlates with that of related branches instruction</p>
</li>
<li>
<p><strong>A method called Correlation-based branch history is proposed</strong></p>
<ul>
<li><strong>Create a global branch history table</strong></li>
<li><strong>Predict by combining global and current branch instructions</strong></li>
</ul>
</li>
</ul>
<hr>
<p><strong>Delayed Branch</strong></p>
<ul>
<li>
<p>A method of instruction rearrangement</p>
</li>
<li>
<p><strong>Delayed branches need to calculate the impact of branches and determine which instructions are not affected before prefetching unwanted instructions</strong></p>
<ul>
<li>
<p><strong>Execute such an instruction immediately after the branch instruction</strong></p>
</li>
<li>
<p><strong>The execution of this instruction keeps the pipeline in a full rotation state, and the clock cycle will not be wasted due to waiting</strong></p>
</li>
</ul>
</li>
</ul>
]]></description>
</item>
</channel>
</rss>
