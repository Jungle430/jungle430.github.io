<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº - Jungle&#39;s Blog</title><meta name="description" content="Welcome to Jungle&#39;s blog."><meta property="og:title" content="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº" />
<meta property="og:description" content="Operating System $Nanjing\ University\rightarrow Yanyan\ Jiang\newline$ æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº Overview å¤ä¹  ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ åº”ç”¨è§†è§’ (è®¾è®¡): ä¸€ç»„å¯¹è±¡ (è¿›ç¨‹/æ–‡ä»¶/&hellip;) &#43; API ç¡¬ä»¶è§†è§’ (å®ç°): ä¸€ä¸ª C ç¨‹åº" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-31T19:30:30+08:00" />
<meta property="article:modified_time" content="2022-12-31T19:30:30+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº"/>
<meta name="twitter:description" content="Operating System $Nanjing\ University\rightarrow Yanyan\ Jiang\newline$ æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº Overview å¤ä¹  ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ åº”ç”¨è§†è§’ (è®¾è®¡): ä¸€ç»„å¯¹è±¡ (è¿›ç¨‹/æ–‡ä»¶/&hellip;) &#43; API ç¡¬ä»¶è§†è§’ (å®ç°): ä¸€ä¸ª C ç¨‹åº"/>
<meta name="application-name" content="Jungle&#39;s blog">
<meta name="apple-mobile-web-app-title" content="Jungle&#39;s blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" /><link rel="prev" href="https://Jungle430.github.io/posts/opencv/opencv-chapter1/" /><link rel="next" href="https://Jungle430.github.io/posts/operating-system/operating-system-chapter3/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/Jungle430.github.io\/posts\/operating-system\/operating-system-chapter2\/"
        },"genre": "posts","keywords": "Operating System","wordcount":  5843 ,
        "url": "https:\/\/Jungle430.github.io\/posts\/operating-system\/operating-system-chapter2\/","datePublished": "2022-12-31T19:30:30+08:00","dateModified": "2022-12-31T19:30:30+08:00","publisher": {
            "@type": "Organization",
            "name": "Jungle"},"author": {
                "@type": "Person",
                "name": "Jungle"
            },"description": ""
    }
    </script></head><body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Jungle&#39;s Blog">Jungle&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/">ğŸ“š æ–‡ç«  </a><a class="menu-item" href="/tags/">ğŸ·ï¸ æ ‡ç­¾ </a><a class="menu-item" href="/categories/">ğŸ—ƒï¸ åˆ†ç±» </a><a class="menu-item" href="/about/">ğŸ‘´ å…³äº </a><a class="menu-item" href="https://github.com/Jungle430" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Jungle&#39;s Blog">Jungle&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">ğŸ“šæ–‡ç« </a><a class="menu-item" href="/tags/" title="">ğŸ·ï¸æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">ğŸ—ƒï¸åˆ†ç±»</a><a class="menu-item" href="/about/" title="">ğŸ‘´å…³äº</a><a class="menu-item" href="https://github.com/Jungle430" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="enable"><div class="single-card" ><h2 class="single-title animated flipInX">Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="https://github.com/Jungle430" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Jungle</a></span>&nbsp;<span class="post-category">å‡ºç‰ˆäº  <a href="/categories/operating-system/"><i class="far fa-folder fa-fw"></i>Operating System</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-12-31">2022-12-31</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 5843 å­—</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 12 åˆ†é’Ÿ</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>ç›®å½•</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº">æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº</a>
      <ul>
        <li><a href="#overview">Overview</a>
          <ul>
            <li><a href="#å¤ä¹ ">å¤ä¹ </a></li>
            <li><a href="#æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦é—®é¢˜">æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦é—®é¢˜</a></li>
            <li><a href="#æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹">æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹</a></li>
          </ul>
        </li>
        <li><a href="#çŠ¶æ€æœºä¸æ•°å­—ç”µè·¯">çŠ¶æ€æœºä¸æ•°å­—ç”µè·¯</a></li>
        <li><a href="#ä»€ä¹ˆæ˜¯ç¨‹åºæºä»£ç è§†è§’">ä»€ä¹ˆæ˜¯ç¨‹åºï¼ˆæºä»£ç è§†è§’ï¼‰</a>
          <ul>
            <li><a href="#c-ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹è§’åº¦ä¸€">C ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ï¼ˆè§’åº¦ä¸€ï¼‰</a></li>
            <li><a href="#c-ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹è§’åº¦äºŒ">C ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ï¼ˆè§’åº¦äºŒï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#ä»€ä¹ˆæ˜¯ç¨‹åº-äºŒè¿›åˆ¶ä»£ç è§†è§’">ä»€ä¹ˆæ˜¯ç¨‹åº (äºŒè¿›åˆ¶ä»£ç è§†è§’)</a>
          <ul>
            <li><a href="#ä¸€æ¡ç‰¹æ®Šçš„æŒ‡ä»¤">ä¸€æ¡ç‰¹æ®Šçš„æŒ‡ä»¤</a></li>
            <li><a href="#é—®é¢˜æ€ä¹ˆæ„é€ ä¸€ä¸ªæœ€å°çš„-hello-world">é—®é¢˜ï¼šæ€ä¹ˆæ„é€ ä¸€ä¸ªæœ€å°çš„ Hello, Worldï¼Ÿ</a>
              <ul>
                <li><a href="#è§£å†³å¼‚å¸¸é€€å‡º">è§£å†³å¼‚å¸¸é€€å‡º</a></li>
                <li><a href="#hello-worldçš„æ±‡ç¼–å®ç°">Hello, Worldçš„æ±‡ç¼–å®ç°</a>
                  <ul>
                    <li><a href="#å½©è›‹ansi-escape-code">å½©è›‹ï¼šANSI Escape Code</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#ç¼–è¯‘å™¨ä¸ç¼–è¯‘ä¼˜åŒ–">ç¼–è¯‘å™¨ä¸ç¼–è¯‘ä¼˜åŒ–</a>
          <ul>
            <li><a href="#ç°ä»£-ä¸æœªæ¥çš„-ç¼–è¯‘ä¼˜åŒ–">ç°ä»£ (ä¸æœªæ¥çš„) ç¼–è¯‘ä¼˜åŒ–</a></li>
            <li><a href="#è¿›å…¥-plprogramming-language-çš„é¢†åŸŸ">è¿›å…¥ PL(Programming language) çš„é¢†åŸŸ</a></li>
          </ul>
        </li>
        <li><a href="#æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åº">æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åº</a>
          <ul>
            <li><a href="#æ“ä½œç³»ç»Ÿä¸­çš„ä¸€èˆ¬ç¨‹åº">æ“ä½œç³»ç»Ÿä¸­çš„ä¸€èˆ¬ç¨‹åº</a></li>
            <li><a href="#äºŒè¿›åˆ¶-ç¨‹åºä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡">(äºŒè¿›åˆ¶) ç¨‹åºä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡</a></li>
            <li><a href="#ç³»ç»Ÿä¸­å¸¸è§çš„åº”ç”¨ç¨‹åº">ç³»ç»Ÿä¸­å¸¸è§çš„åº”ç”¨ç¨‹åº</a></li>
            <li><a href="#æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åºdark-side">æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åºï¼šDark Side</a>
              <ul>
                <li><a href="#main-ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆ"><code>main()</code> ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</a></li>
              </ul>
            </li>
            <li><a href="#æ‰“å¼€ç¨‹åºçš„æ‰§è¡Œtrace-è¸ªè¿¹">æ‰“å¼€ç¨‹åºçš„æ‰§è¡Œï¼šTrace (è¸ªè¿¹)</a></li>
            <li><a href="#æœ¬è´¨ä¸Šæ‰€æœ‰çš„ç¨‹åºå’Œ-hello-world-ç±»ä¼¼">æœ¬è´¨ä¸Šï¼Œæ‰€æœ‰çš„ç¨‹åºå’Œ Hello World ç±»ä¼¼</a></li>
            <li><a href="#yes---è¿™äº›-api-å°±æ˜¯æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨">Yes! - è¿™äº› API å°±æ˜¯æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨</a></li>
            <li><a href="#å„å¼å„æ ·çš„åº”ç”¨ç¨‹åº">å„å¼å„æ ·çš„åº”ç”¨ç¨‹åº</a></li>
          </ul>
        </li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
        <li><a href="#ä¸ªäººçš„ä¸€äº›è¡¥å……">ä¸ªäººçš„ä¸€äº›è¡¥å……</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h1 id="operating-system">Operating System</h1>
<p>$Nanjing\ University\rightarrow Yanyan\ Jiang\newline$</p>
<h2 id="æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº">æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº</h2>
<h3 id="overview">Overview</h3>
<h4 id="å¤ä¹ ">å¤ä¹ </h4>
<p>ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ</p>
<ul>
<li>åº”ç”¨è§†è§’ (è®¾è®¡): ä¸€ç»„å¯¹è±¡ (è¿›ç¨‹/æ–‡ä»¶/&hellip;) + API</li>
<li>ç¡¬ä»¶è§†è§’ (å®ç°): ä¸€ä¸ª C ç¨‹åº</li>
</ul>
<h4 id="æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦é—®é¢˜">æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦é—®é¢˜</h4>
<ul>
<li>åˆ°åº•ä»€ä¹ˆæ˜¯â€ç¨‹åºâ€ï¼Ÿ</li>
</ul>
<h4 id="æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹">æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹</h4>
<ul>
<li>ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ (å’Œç¼–è¯‘å™¨)</li>
<li>æ“ä½œç³»ç»Ÿä¸Šçš„ {æœ€å°/ä¸€èˆ¬/å›¾å½¢} ç¨‹åº</li>
</ul>
<h3 id="çŠ¶æ€æœºä¸æ•°å­—ç”µè·¯">çŠ¶æ€æœºä¸æ•°å­—ç”µè·¯</h3>
<p>æ•°å­—é€»è¾‘ç”µè·¯</p>
<ul>
<li>çŠ¶æ€ = å¯„å­˜å™¨ä¿å­˜çš„å€¼ (flip-flop)</li>
<li>åˆå§‹çŠ¶æ€ = RESET (implementation dependent)</li>
<li>è¿ç§» = ç»„åˆé€»è¾‘ç”µè·¯è®¡ç®—å¯„å­˜å™¨ä¸‹ä¸€å‘¨æœŸçš„å€¼</li>
</ul>
<p>ä¾‹å­ï¼š
$$
\begin{align}
&amp;X^{&rsquo;}= \neg X \wedge Y\newline
&amp;Y^{&rsquo;}= \neg X \wedge \neg Y\newline
\end{align}
$$</p>
<div class="mermaid" id="id-1"></div>
<p>ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;Windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define REGS_FOREACH(_)  _(X) _(Y)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define RUN_LOGIC        X1 = !X &amp;&amp; Y; \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         Y1 = !X &amp;&amp; !Y;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define DEFINE(X)        static int X, X##1;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define UPDATE(X)        X = X##1;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define PRINT(X)         printf(#X &#34; = %d; &#34;, X);
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">REGS_FOREACH</span><span class="p">(</span><span class="n">DEFINE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">RUN_LOGIC</span>
</span></span><span class="line"><span class="cl">        <span class="n">REGS_FOREACH</span><span class="p">(</span><span class="n">PRINT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">REGS_FOREACH</span><span class="p">(</span><span class="n">UPDATE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®å±•å¼€</p>
<p>ä½¿ç”¨mingwå‘½ä»¤(æ³¨æ„å»æ‰å¤´æ–‡ä»¶ï¼Œå¦åˆ™å¤´æ–‡ä»¶ä¹Ÿä¼šä¸€å¹¶å±•å¼€ï¼Œå°±æ²¡æ³•çœ‹äº†ğŸ¤¡)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -E main.c
</span></span></code></pre></td></tr></table>
</div>
</div><p>å±•å¼€å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">int</span> <span class="n">X</span><span class="p">,</span> <span class="n">X1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">X1</span> <span class="o">=</span> <span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="n">Y</span><span class="p">;</span> <span class="n">Y1</span> <span class="o">=</span> <span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;X&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">X</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Y&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">X</span> <span class="o">=</span> <span class="n">X1</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å®Œæ•´çš„å®ç°ï¼šæ•°ç ç®¡æ˜¾ç¤º</p>
<p>ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;Windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define REGS_FOREACH(_)  _(X) _(Y)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OUTS_FOREACH(_)  _(A) _(B) _(C) _(D) _(E) _(F) _(G)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define RUN_LOGIC        X1 = !X &amp;&amp; Y; \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         Y1 = !X &amp;&amp; !Y; \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         A  = (!X &amp;&amp; !Y) || (X &amp;&amp; !Y); \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         B  = 1; \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         C  = (!X &amp;&amp; !Y) || (!X &amp;&amp; Y); \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         D  = (!X &amp;&amp; !Y) || (X &amp;&amp; !Y); \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         E  = (!X &amp;&amp; !Y) || (X &amp;&amp; !Y); \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         F  = (!X &amp;&amp; !Y); \
</span></span></span><span class="line"><span class="cl"><span class="cp">                         G  = (X &amp;&amp; !Y);
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define DEFINE(X)   static int X, X##1;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define UPDATE(X)   X = X##1;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define PRINT(X)    printf(#X &#34; = %d; &#34;, X);
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">REGS_FOREACH</span><span class="p">(</span><span class="n">DEFINE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">OUTS_FOREACH</span><span class="p">(</span><span class="n">DEFINE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">RUN_LOGIC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">OUTS_FOREACH</span><span class="p">(</span><span class="n">PRINT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">REGS_FOREACH</span><span class="p">(</span><span class="n">UPDATE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®å±•å¼€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">int</span> <span class="n">X</span><span class="p">,</span> <span class="n">X1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">int</span> <span class="n">A</span><span class="p">,</span> <span class="n">A1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">B</span><span class="p">,</span> <span class="n">B1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">C</span><span class="p">,</span> <span class="n">C1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">D</span><span class="p">,</span> <span class="n">D1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">E</span><span class="p">,</span> <span class="n">E1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">F</span><span class="p">,</span> <span class="n">F1</span><span class="p">;</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">G</span><span class="p">,</span> <span class="n">G1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">X1</span> <span class="o">=</span> <span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="n">Y</span><span class="p">;</span> <span class="n">Y1</span> <span class="o">=</span> <span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">);</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="n">Y</span><span class="p">);</span> <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">);</span> <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">);</span> <span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Y</span><span class="p">);;</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;A&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;B&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;C&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;D&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;E&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;F&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">F</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;G&#34;</span> <span class="s">&#34; = %d; &#34;</span><span class="p">,</span> <span class="n">G</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">X</span> <span class="o">=</span> <span class="n">X1</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>pythonåç«¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">fileinput</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">TEMPLATE</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1"></span><span class="se">\033</span><span class="s1">[2J</span><span class="se">\033</span><span class="s1">[1;1f
</span></span></span><span class="line"><span class="cl"><span class="s1">     AAAAAAAAA
</span></span></span><span class="line"><span class="cl"><span class="s1">    FF       BB
</span></span></span><span class="line"><span class="cl"><span class="s1">    FF       BB
</span></span></span><span class="line"><span class="cl"><span class="s1">    FF       BB
</span></span></span><span class="line"><span class="cl"><span class="s1">    FF       BB
</span></span></span><span class="line"><span class="cl"><span class="s1">    GGGGGGGGGG
</span></span></span><span class="line"><span class="cl"><span class="s1">   EE       CC
</span></span></span><span class="line"><span class="cl"><span class="s1">   EE       CC
</span></span></span><span class="line"><span class="cl"><span class="s1">   EE       CC
</span></span></span><span class="line"><span class="cl"><span class="s1">   EE       CC
</span></span></span><span class="line"><span class="cl"><span class="s1">    DDDDDDDDD
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="n">BLOCK</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[37mâ–‘</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">,</span> <span class="c1"># STFW: ANSI Escape Code</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[31mâ–ˆ</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">VARS</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFG&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">VARS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">globals</span><span class="p">()[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">stdin</span> <span class="o">=</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">exec</span><span class="p">(</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">pic</span> <span class="o">=</span> <span class="n">TEMPLATE</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">VARS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pic</span> <span class="o">=</span> <span class="n">pic</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">BLOCK</span><span class="p">[</span><span class="nb">globals</span><span class="p">()[</span><span class="n">v</span><span class="p">]])</span> <span class="c1"># &#39;A&#39; -&gt; BLOCK[A], ...</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">pic</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨æ–¹æ³•</p>
<p>å…ˆé€šè¿‡gccå°†cæ–‡ä»¶ç¼–è¯‘ä¸ºexeæ–‡ä»¶</p>
<p>ç„¶åcmdå‘½ä»¤ç«¯è¾“å…¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">logisim.exe <span class="p">|</span> python seven-seg.py
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•ˆæœï¼šå¾ªç¯å‡ºç°å¦‚ä¸‹ç”»é¢</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-1.png" title="/img/Operating System/chapter2-1.png" data-thumbnail="/img/Operating System/chapter2-1.png" data-sub-html="<h2>pythonåç«¯(image 1)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-1.png"
            data-srcset="/img/Operating%20System/chapter2-1.png, /img/Operating%20System/chapter2-1.png 1.5x, /img/Operating%20System/chapter2-1.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-1.png" />
    </a><figcaption class="image-caption">pythonåç«¯(<code>image 1</code>)</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-2.png" title="/img/Operating System/chapter2-2.png" data-thumbnail="/img/Operating System/chapter2-2.png" data-sub-html="<h2>pythonåç«¯(image 2)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-2.png"
            data-srcset="/img/Operating%20System/chapter2-2.png, /img/Operating%20System/chapter2-2.png 1.5x, /img/Operating%20System/chapter2-2.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-2.png" />
    </a><figcaption class="image-caption">pythonåç«¯(<code>image 2</code>)</figcaption>
    </figure>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-3.png" title="/img/Operating System/chapter2-3.png" data-thumbnail="/img/Operating System/chapter2-3.png" data-sub-html="<h2>pythonåç«¯(image 3)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-3.png"
            data-srcset="/img/Operating%20System/chapter2-3.png, /img/Operating%20System/chapter2-3.png 1.5x, /img/Operating%20System/chapter2-3.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-3.png" />
    </a><figcaption class="image-caption">pythonåç«¯(<code>image 3</code>)</figcaption>
    </figure>
<ul>
<li>
<p>ä¼šç¼–ç¨‹ï¼Œä½ å°±æ‹¥æœ‰å…¨ä¸–ç•Œï¼</p>
</li>
<li>
<p>åŒæ ·çš„æ–¹å¼å¯ä»¥æ¨¡æ‹Ÿä»»ä½•æ•°å­—ç³»ç»Ÿ</p>
<ul>
<li>å½“ç„¶ï¼Œä¹ŸåŒ…æ‹¬è®¡ç®—æœºç³»ç»Ÿ</li>
</ul>
</li>
</ul>
<p>UNIX å“²å­¦</p>
<ul>
<li>Make each program do one thing well</li>
<li>Expect the output of every program to become the input to another</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯ç¨‹åºæºä»£ç è§†è§’">ä»€ä¹ˆæ˜¯ç¨‹åºï¼ˆæºä»£ç è§†è§’ï¼‰</h3>
<p>ç¨‹åºå°±æ˜¯çŠ¶æ€æœº (ä½ åœ¨ gdb é‡Œçœ‹åˆ°çš„)</p>
<p>ä»£ç ï¼šhanoi-r.c</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">hanoi</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">char</span> <span class="n">from</span><span class="p">,</span> <span class="kt">char</span> <span class="n">to</span><span class="p">,</span> <span class="kt">char</span> <span class="n">via</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%c -&gt; %c</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">hanoi</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">via</span><span class="p">,</span> <span class="n">to</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">hanoi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>     <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span>  <span class="n">via</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">hanoi</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">via</span><span class="p">,</span>  <span class="n">to</span><span class="p">,</span>  <span class="n">from</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="c-ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹è§’åº¦ä¸€">C ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ï¼ˆè§’åº¦ä¸€ï¼‰</h4>
<p><strong>(è¯­ä¹‰ï¼Œsemantics)</strong></p>
<ul>
<li>çŠ¶æ€ = å † + æ ˆ</li>
<li>åˆå§‹çŠ¶æ€ = <code>main</code> çš„ç¬¬ä¸€æ¡è¯­å¥</li>
<li>è¿ç§» = æ‰§è¡Œä¸€æ¡ç®€å•è¯­å¥
<ul>
<li>ä»»ä½• C ç¨‹åºéƒ½å¯ä»¥æ”¹å†™æˆ â€œéå¤åˆè¯­å¥â€ çš„ C ä»£ç </li>
<li><a href="https://cil-project.github.io/cil/" target="_blank" rel="noopener noreffer">çœŸçš„æœ‰è¿™ç§å·¥å…·</a> (C Intermediate Language) å’Œ<a href="https://gitlab.com/zsaleeba/picoc" target="_blank" rel="noopener noreffer">è§£é‡Šå™¨</a></li>
</ul>
</li>
</ul>
<hr>
<p>(è¿™è¿˜åªæ˜¯ â€œç²—æµ…â€ çš„ç†è§£)</p>
<ul>
<li>Talk is cheap. Show me the code. (Linus Torvalds): ä»»ä½•çœŸæ­£çš„ç†è§£éƒ½åº”è¯¥è½åˆ°å¯ä»¥æ‰§è¡Œçš„ä»£ç </li>
</ul>
<h4 id="c-ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹è§’åº¦äºŒ">C ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ï¼ˆè§’åº¦äºŒï¼‰</h4>
<p><strong>(è¯­ä¹‰ï¼Œsemantics)</strong></p>
<ul>
<li>çŠ¶æ€ = stack frame çš„åˆ—è¡¨ (æ¯ä¸ª frame æœ‰ PC <code>program counter</code> ) + å…¨å±€å˜é‡</li>
<li>åˆå§‹çŠ¶æ€ = main(argc, argv), å…¨å±€å˜é‡åˆå§‹åŒ–</li>
<li>è¿ç§» = æ‰§è¡Œ top stack frame PC çš„è¯­å¥; PC++
<ul>
<li>å‡½æ•°è°ƒç”¨ = push frame (frame.PC = å…¥å£)</li>
<li>å‡½æ•°è¿”å› = pop frame</li>
</ul>
</li>
</ul>
<p><strong>åº”ç”¨ï¼šå°†ä»»ä½•é€’å½’ç¨‹åºå°±åœ°è½¬ä¸ºéé€’å½’</strong>ï¼ˆæ¨¡æ‹Ÿ$stack$ï¼‰</p>
<p>$hanoi-nr.c\newline$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">pc</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">via</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Frame</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define call(...) ({ *(++top) = (Frame) { .pc = 0, __VA_ARGS__ }; })
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ret()     ({ top--; })
</span></span></span><span class="line"><span class="cl"><span class="cp">#define goto(loc) ({ f-&gt;pc = (loc) - 1; })
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">hanoi</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">char</span> <span class="n">from</span><span class="p">,</span> <span class="kt">char</span> <span class="n">to</span><span class="p">,</span> <span class="kt">char</span> <span class="n">via</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Frame</span> <span class="n">stk</span><span class="p">[</span><span class="mi">64</span><span class="p">],</span> <span class="o">*</span><span class="n">top</span> <span class="o">=</span> <span class="n">stk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">call</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">via</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="n">Frame</span> <span class="o">*</span><span class="n">f</span><span class="p">;</span> <span class="p">(</span><span class="n">f</span> <span class="o">=</span> <span class="n">top</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">stk</span><span class="p">;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">pc</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">pc</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%c -&gt; %c</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">from</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">to</span><span class="p">);</span> <span class="k">goto</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="n">call</span><span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">from</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">via</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">to</span><span class="p">);</span>   <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="n">call</span><span class="p">(</span>       <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">from</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">to</span><span class="p">,</span>  <span class="n">f</span><span class="o">-&gt;</span><span class="n">via</span><span class="p">);</span>  <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="n">call</span><span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">via</span><span class="p">,</span>  <span class="n">f</span><span class="o">-&gt;</span><span class="n">to</span><span class="p">,</span>  <span class="n">f</span><span class="o">-&gt;</span><span class="n">from</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="n">ret</span><span class="p">();</span>                                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">default</span><span class="o">:</span> <span class="n">assert</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>A â†’ B, B â†’ A çš„è¿åˆƒè€Œè§£
<ul>
<li>è¿˜æ˜¯ä¸€æ ·çš„ <code>call()</code>ï¼Œä½†æ”¾å…¥ä¸åŒçš„ <code>Frame</code></li>
</ul>
</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯ç¨‹åº-äºŒè¿›åˆ¶ä»£ç è§†è§’">ä»€ä¹ˆæ˜¯ç¨‹åº (äºŒè¿›åˆ¶ä»£ç è§†è§’)</h3>
<p>è¿˜æ˜¯çŠ¶æ€æœº	(æ²¡çœ‹è¿‡å—å¤§çš„è®¡ç®—æœºåŸºç¡€å’Œæ•°å­—é€»è¾‘è¯¾åˆ°è¿™å¤šå°‘æœ‰ç‚¹ğŸ¤¡äº†)</p>
<ul>
<li>çŠ¶æ€ = å†…å­˜ <code>M</code> + å¯„å­˜å™¨ <code>R</code></li>
<li>åˆå§‹çŠ¶æ€ = (ç¨åå›ç­”)</li>
<li>è¿ç§» = æ‰§è¡Œä¸€æ¡æŒ‡ä»¤
<ul>
<li>æˆ‘ä»¬èŠ±äº†ä¸€æ•´ä¸ªã€Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€ã€‹è§£é‡Šè¿™ä»¶äº‹</li>
<li>gdb åŒæ ·å¯ä»¥è§‚å¯ŸçŠ¶æ€å’Œæ‰§è¡Œ</li>
</ul>
</li>
</ul>
<hr>
<p>æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº</p>
<ul>
<li>
<p>æ‰€æœ‰çš„æŒ‡ä»¤éƒ½åªèƒ½<code>è®¡ç®—</code></p>
<ul>
<li>deterministic: mov, add, sub, call, &hellip;</li>
<li>non-deterministic: rdrand, &hellip;</li>
<li>ä½†è¿™äº›æŒ‡ä»¤ç”šè‡³éƒ½æ— æ³•ä½¿ç¨‹åºåœä¸‹æ¥ ,ç›´æ¥ğŸ¤¡, å¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´æ²¡æœ‰ä»€ä¹ˆğŸ”ç”¨(NEMU: åŠ æ¡ <code>trap</code> æŒ‡ä»¤)</li>
</ul>
</li>
</ul>
<h4 id="ä¸€æ¡ç‰¹æ®Šçš„æŒ‡ä»¤">ä¸€æ¡ç‰¹æ®Šçš„æŒ‡ä»¤</h4>
<p>è°ƒç”¨æ“ä½œç³»ç»Ÿ <code>syscall</code></p>
<ul>
<li>æŠŠ(<code>M</code>, <code>R</code>)<strong>å®Œå…¨äº¤ç»™æ“ä½œç³»ç»Ÿ</strong>ï¼Œä»»å…¶ä¿®æ”¹
<ul>
<li>ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šå¦‚æœç¨‹åºä¸æ‰“ç®—å®Œå…¨ä¿¡ä»»æ“ä½œç³»ç»Ÿï¼Ÿ</li>
</ul>
</li>
<li>å®ç°ä¸æ“ä½œç³»ç»Ÿä¸­çš„å…¶ä»–å¯¹è±¡äº¤äº’
<ul>
<li>è¯»å†™æ–‡ä»¶/æ“ä½œç³»ç»ŸçŠ¶æ€ (ä¾‹å¦‚æŠŠæ–‡ä»¶å†…å®¹å†™å…¥ M<em>M</em>)</li>
<li>æ”¹å˜è¿›ç¨‹ (è¿è¡Œä¸­çŠ¶æ€æœº) çš„çŠ¶æ€ï¼Œä¾‹å¦‚åˆ›å»ºè¿›ç¨‹/é”€æ¯è‡ªå·±</li>
</ul>
</li>
</ul>
<hr>
<p><strong>ç¨‹åº = è®¡ç®— + syscall</strong></p>
<div class="mermaid" id="id-2"></div>
<h4 id="é—®é¢˜æ€ä¹ˆæ„é€ ä¸€ä¸ªæœ€å°çš„-hello-world">é—®é¢˜ï¼šæ€ä¹ˆæ„é€ ä¸€ä¸ªæœ€å°çš„ Hello, Worldï¼Ÿ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hello, World</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>gcc ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶ä¸æ»¡è¶³ â€œæœ€å°â€</p>
<ul>
<li><code>--verbose</code>å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ç¼–è¯‘é€‰é¡¹ (çœŸä¸å°‘)
<ul>
<li><code>printf </code>å˜æˆäº† puts@plt</li>
</ul>
</li>
<li><code>-static</code> ä¼šå¤åˆ¶ libc</li>
</ul>
<p>gccèƒ½ç©çš„è¿™ä¹ˆå¤šï¼Œçœ‹æ¥âœŒï¸ä¹‹å‰å¤©å¤©é ç°æˆ$IDE$å¤šå°‘æ²¾ç‚¹ğŸ¤¡äº†</p>
<p>å®é™…ä½¿ç”¨<code>--verbose</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc --verbose hello.c
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•ˆæœ</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-4.png" title="/img/Operating System/chapter2-4.png" data-thumbnail="/img/Operating System/chapter2-4.png" data-sub-html="<h2>æ•ˆæœ(on windows)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-4.png"
            data-srcset="/img/Operating%20System/chapter2-4.png, /img/Operating%20System/chapter2-4.png 1.5x, /img/Operating%20System/chapter2-4.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-4.png" />
    </a><figcaption class="image-caption">æ•ˆæœ(<code>on windows</code>)</figcaption>
    </figure>
<p>å®é™…ä½¿ç”¨<code>â€“static</code>(ä¸ä¾èµ–åŠ¨æ€é“¾æ¥åº“)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -static hello.c
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶ä¼šå¾ˆå¤§ï¼ˆæˆ‘çš„æ˜¯53KBï¼‰</p>
<hr>
<p>ç›´æ¥ç¡¬æ¥ï¼Ÿ</p>
<p>å¼ºè¡Œç¼–è¯‘ + é“¾æ¥ï¼š<code>gcc -c</code> + <code>ld</code></p>
<ul>
<li>
<p>ç›´æ¥ç”¨ ld é“¾æ¥å¤±è´¥</p>
<ul>
<li>ld ä¸çŸ¥é“æ€ä¹ˆé“¾æ¥åº“å‡½æ•°â€¦â€¦</li>
</ul>
</li>
<li>
<p>ç©ºçš„ main å‡½æ•°å€’æ˜¯å¯ä»¥</p>
<ul>
<li>é“¾æ¥æ—¶å¾—åˆ°å¥‡æ€ªçš„è­¦å‘Š (å¯ä»¥å®šä¹‰æˆ <code>_start</code> é¿å…è­¦å‘Š)</li>
<li>ä½† Segmentation Fault äº†â€¦â€¦</li>
</ul>
</li>
</ul>
<p>æ‰¾äº†ä¸€ä¸‹<code>Segmentation Fault</code></p>
<p>$From\ wikipedia\newline$
$\rightarrow$ <a href="https://en.wikipedia.org/wiki/Segmentation_fault" target="_blank" rel="noopener noreffer">address</a></p>
<blockquote>
<p>In <a href="https://en.wikipedia.org/wiki/Computing" target="_blank" rel="noopener noreffer">computing</a>, a <strong>segmentation fault</strong> (often shortened to <strong>segfault</strong>) or <strong>access violation</strong> is a <a href="https://en.wikipedia.org/wiki/Fault_%28computing%29" target="_blank" rel="noopener noreffer">fault</a>, or failure condition, raised by hardware with <a href="https://en.wikipedia.org/wiki/Memory_protection" target="_blank" rel="noopener noreffer">memory protection</a>, notifying an <a href="https://en.wikipedia.org/wiki/Operating_system" target="_blank" rel="noopener noreffer">operating system</a> (OS) the software has attempted to access a restricted area of memory (a memory access violation). On standard <a href="https://en.wikipedia.org/wiki/X86" target="_blank" rel="noopener noreffer">x86</a> computers, this is a form of <a href="https://en.wikipedia.org/wiki/General_protection_fault" target="_blank" rel="noopener noreffer">general protection fault</a>. The <a href="https://en.wikipedia.org/wiki/Operating_system_kernel" target="_blank" rel="noopener noreffer">operating system kernel</a> will, in response, usually perform some corrective action, generally passing the fault on to the offending <a href="https://en.wikipedia.org/wiki/Process_%28computing%29" target="_blank" rel="noopener noreffer">process</a> by sending the process a <a href="https://en.wikipedia.org/wiki/Signal_%28computing%29" target="_blank" rel="noopener noreffer">signal</a>. Processes can in some cases install a custom signal handler, allowing them to recover on their own,[<a href="https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-Peter_Van_der_Linden-1" target="_blank" rel="noopener noreffer">1]</a> but otherwise the OS default signal handler is used, generally causing <a href="https://en.wikipedia.org/wiki/Abnormal_termination" target="_blank" rel="noopener noreffer">abnormal termination</a> of the process (a program <a href="https://en.wikipedia.org/wiki/Crash_%28computing%29" target="_blank" rel="noopener noreffer">crash</a>), and sometimes a <a href="https://en.wikipedia.org/wiki/Core_dump" target="_blank" rel="noopener noreffer">core dump</a>.</p>
<p>Segmentation faults are a common class of error in programs written in languages like <a href="https://en.wikipedia.org/wiki/C_%28programming_language%29" target="_blank" rel="noopener noreffer">C</a> that provide low-level memory access and few to no safety checks. They arise primarily due to errors in use of <a href="https://en.wikipedia.org/wiki/Pointer_%28computer_programming%29" target="_blank" rel="noopener noreffer">pointers</a> for <a href="https://en.wikipedia.org/wiki/Virtual_memory" target="_blank" rel="noopener noreffer">virtual memory</a> addressing, particularly illegal access. Another type of memory access error is a <a href="https://en.wikipedia.org/wiki/Bus_error" target="_blank" rel="noopener noreffer">bus error</a>, which also has various causes, but is today much rarer; these occur primarily due to incorrect <em>physical</em> memory addressing, or due to misaligned memory access â€“ these are memory references that the hardware <em>cannot</em> address, rather than references that a process is not <em>allowed</em> to address.</p>
<p>Many programming languages may employ mechanisms designed to avoid segmentation faults and improve memory safety. For example, <a href="https://en.wikipedia.org/wiki/Rust_%28programming_language%29" target="_blank" rel="noopener noreffer">Rust</a> employs an ownership-based[<a href="https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-2" target="_blank" rel="noopener noreffer">2]</a> model to ensure memory safety.[<a href="https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-3" target="_blank" rel="noopener noreffer">3]</a> Other languages, such as <a href="https://en.wikipedia.org/wiki/Lisp_%28programming_language%29" target="_blank" rel="noopener noreffer">Lisp</a> and <a href="https://en.wikipedia.org/wiki/Java_%28programming_language%29" target="_blank" rel="noopener noreffer">Java</a>, employ <a href="https://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29" target="_blank" rel="noopener noreffer">garbage collection</a>,[<a href="https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-4" target="_blank" rel="noopener noreffer">4]</a> which avoids certain classes of memory errors that could lead to segmentation faults.[<a href="https://en.wikipedia.org/wiki/Segmentation_fault#cite_note-5" target="_blank" rel="noopener noreffer">5]</a></p>
</blockquote>
<p>ä¸»è¦å’Œéæ³•è®¿é—®å†…å­˜æœ‰å…³</p>
<p>è§£å†³æ–¹æ³•ï¼šè§‚å¯Ÿç¨‹åºï¼ˆçŠ¶æ€æœºï¼‰æ‰§è¡Œ</p>
<ul>
<li>
<p><code>starti</code>å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»<strong>ç¬¬ä¸€æ¡æŒ‡ä»¤</strong>å¼€å§‹æ‰§è¡Œç¨‹åº</p>
<ul>
<li><code>gdb</code> å¯ä»¥åœ¨ä¸¤ç§çŠ¶æ€æœºè§†è§’ä¹‹é—´åˆ‡æ¢ (<code>layout</code>) <a href="http://sourceware.org/gdb/documentation/" target="_blank" rel="noopener noreffer">GDBå®˜æ–¹æ–‡æ¡£</a></li>
</ul>
</li>
</ul>
<p>å®šä½å‡ºé”™ä½ç½®</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-5.png" title="/img/Operating System/chapter2-5.png" data-thumbnail="/img/Operating System/chapter2-5.png" data-sub-html="<h2>å‡ºé”™ä½ç½®(on linux)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-5.png"
            data-srcset="/img/Operating%20System/chapter2-5.png, /img/Operating%20System/chapter2-5.png 1.5x, /img/Operating%20System/chapter2-5.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-5.png" />
    </a><figcaption class="image-caption">å‡ºé”™ä½ç½®(<code>on linux</code>)</figcaption>
    </figure>
<p><code>retq</code>:æ ˆç”±<code>rsp</code>ï¼ˆå¯„å­˜å™¨ï¼‰æ§åˆ¶,<code>retq</code>å°±æ˜¯ä»<code>rsp</code>å¯„å­˜å™¨å½“ä¸­å–å‡º8ä¸ªå­—èŠ‚ï¼Œèµ‹å€¼ç»™<code>rip</code>(pc)ï¼Œç„¶å<code>rsp &lt;- rsp + 8</code>ï¼ˆå¾€ä¸ŠæŒªä¸€æ ¼ï¼‰ï¼ˆæ ˆå‘ä¸‹å¢é•¿ï¼‰</p>
<p>åˆå§‹<code>rsp</code>é¡¶éƒ¨ä¸º1</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-6.png" title="/img/Operating System/chapter2-6.png" data-thumbnail="/img/Operating System/chapter2-6.png" data-sub-html="<h2>æŸ¥çœ‹é”™è¯¯(on gdb)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-6.png"
            data-srcset="/img/Operating%20System/chapter2-6.png, /img/Operating%20System/chapter2-6.png 1.5x, /img/Operating%20System/chapter2-6.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-6.png" />
    </a><figcaption class="image-caption">æŸ¥çœ‹é”™è¯¯(<code>on gdb</code>)</figcaption>
    </figure>
<p>æ ˆ</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-7.png" title="/img/Operating System/chapter2-7.png" data-thumbnail="/img/Operating System/chapter2-7.png" data-sub-html="<h2>æŸ¥çœ‹é”™è¯¯(on gdb)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-7.png"
            data-srcset="/img/Operating%20System/chapter2-7.png, /img/Operating%20System/chapter2-7.png 1.5x, /img/Operating%20System/chapter2-7.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-7.png" />
    </a><figcaption class="image-caption">æŸ¥çœ‹é”™è¯¯(<code>on gdb</code>)</figcaption>
    </figure>
<p>ä½†æ˜¯å½“æ‰§è¡Œå®Œæœ‰é—®é¢˜çš„è¯­å¥ä¹‹å<code>retq</code>ï¼Œ<code>rip</code>å°±å˜æˆäº†8</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-8.png" title="/img/Operating System/chapter2-8.png" data-thumbnail="/img/Operating System/chapter2-8.png" data-sub-html="<h2>å‡ºç°é”™è¯¯(on gdb)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-8.png"
            data-srcset="/img/Operating%20System/chapter2-8.png, /img/Operating%20System/chapter2-8.png 1.5x, /img/Operating%20System/chapter2-8.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-8.png" />
    </a><figcaption class="image-caption">å‡ºç°é”™è¯¯(<code>on gdb</code>)</figcaption>
    </figure>
<p>éæ³•è®¿é—®ï¼Œè§¦å‘äº†<code>Segmentation Fault</code></p>
<p><strong>æ‰€ä»¥è¯¥ç¨‹åºèƒ½è¢«æ“ä½œç³»ç»Ÿæ­£ç¡®çš„æ‰§è¡Œï¼Œä½†æ²¡æœ‰åŠæ³•è¿”å›ï¼Œé—®é¢˜å‡ºåœ¨åˆå§‹çŠ¶æ€ä¸Šï¼ˆå³é”™è¯¯çš„æŒ‡ä»¤ï¼‰</strong></p>
<h5 id="è§£å†³å¼‚å¸¸é€€å‡º">è§£å†³å¼‚å¸¸é€€å‡º</h5>
<p>æœ‰åŠæ³•è®©çŠ¶æ€æœº â€œåœä¸‹æ¥â€ å—ï¼Ÿ</p>
<ul>
<li>çº¯ â€œè®¡ç®—â€ çš„çŠ¶æ€æœºï¼šä¸è¡Œ</li>
<li>è¦ä¹ˆæ­»å¾ªç¯ï¼Œè¦ä¹ˆ undefined behavior</li>
</ul>
<p>è§£å†³åŠæ³•ï¼š<code>syscall</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;sys/syscall.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span><span class="p">(</span><span class="n">SYS_exit</span><span class="p">,</span> <span class="mi">42</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>linux</code>ç¯å¢ƒä¸‹ä½¿ç”¨<code>gdb</code>è¿›è¡Œè°ƒè¯•</p>
<p>å‘ç°è°ƒç”¨äº†<code>syscall</code></p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-9.png" title="/img/Operating System/chapter2-9.png" data-thumbnail="/img/Operating System/chapter2-9.png" data-sub-html="<h2>gdb(on linux)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-9.png"
            data-srcset="/img/Operating%20System/chapter2-9.png, /img/Operating%20System/chapter2-9.png 1.5x, /img/Operating%20System/chapter2-9.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-9.png" />
    </a><figcaption class="image-caption">gdb(<code>on linux</code>)</figcaption>
    </figure>
<p>è¿›å…¥<code>syscall</code>ç»§ç»­æŸ¥çœ‹</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-10.png" title="/img/Operating System/chapter2-10.png" data-thumbnail="/img/Operating System/chapter2-10.png" data-sub-html="<h2>gdb(ç»§ç»­æŸ¥çœ‹)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-10.png"
            data-srcset="/img/Operating%20System/chapter2-10.png, /img/Operating%20System/chapter2-10.png 1.5x, /img/Operating%20System/chapter2-10.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-10.png" />
    </a><figcaption class="image-caption">gdb(<code>ç»§ç»­æŸ¥çœ‹</code>)</figcaption>
    </figure>
<p>å‘ç°è¯¥å‡½æ•°ç»™ä¸€å¤§å †å¯„å­˜å™¨èµ‹äº†å€¼ï¼Œèµ‹å®Œå€¼ä¹‹åä¼šæ‰§è¡Œä¸€ä¸ª<code>syscall</code>æŒ‡ä»¤</p>
<p>å®è´¨ï¼šå‡†å¤‡å¥½ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‚æ•°ï¼Œç„¶åæŠŠè‡ªå·±å®Œå…¨äº¤ç»™æ“ä½œç³»ç»Ÿ</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-11.png" title="/img/Operating System/chapter2-11.png" data-thumbnail="/img/Operating System/chapter2-11.png" data-sub-html="<h2>gdb(å¯ä»¥çœ‹åˆ°é€€å‡ºç )</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-11.png"
            data-srcset="/img/Operating%20System/chapter2-11.png, /img/Operating%20System/chapter2-11.png 1.5x, /img/Operating%20System/chapter2-11.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-11.png" />
    </a><figcaption class="image-caption">gdb(<code>å¯ä»¥çœ‹åˆ°é€€å‡ºç </code>)</figcaption>
    </figure>
<p>ï¼ˆç»ˆæ­¢ï¼‰</p>
<ul>
<li>è°ƒè¯•ä»£ç ï¼šsyscall çš„å®ç°åœ¨å“ªé‡Œï¼Ÿ
<ul>
<li>åæ¶ˆæ¯ï¼šåœ¨ libc é‡Œï¼Œä¸æ–¹ä¾¿ç›´æ¥é“¾æ¥</li>
<li>å¥½æ¶ˆæ¯ï¼šä»£ç å¾ˆçŸ­ï¼Œè€Œä¸”ä¼¼ä¹çœ‹æ‡‚äº†</li>
</ul>
</li>
</ul>
<h5 id="hello-worldçš„æ±‡ç¼–å®ç°">Hello, Worldçš„æ±‡ç¼–å®ç°</h5>
<p>minmal.S</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;sys/syscall.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="n">globl</span> <span class="n">_start</span>
</span></span><span class="line"><span class="cl"><span class="nl">_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">SYS_write</span><span class="p">,</span> <span class="o">%</span><span class="n">rax</span>   <span class="err">#</span> <span class="n">write</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span>         <span class="o">%</span><span class="n">rdi</span>   <span class="err">#</span>   <span class="n">fd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">st</span><span class="p">,</span>        <span class="o">%</span><span class="n">rsi</span>   <span class="err">#</span>   <span class="n">buf</span><span class="o">=</span><span class="n">st</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="p">(</span><span class="n">ed</span> <span class="o">-</span> <span class="n">st</span><span class="p">),</span> <span class="o">%</span><span class="n">rdx</span>   <span class="err">#</span>   <span class="n">count</span><span class="o">=</span><span class="n">ed</span><span class="o">-</span><span class="n">st</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span>                 <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">SYS_exit</span><span class="p">,</span>  <span class="o">%</span><span class="n">rax</span>   <span class="err">#</span> <span class="n">exit</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span>         <span class="o">%</span><span class="n">rdi</span>   <span class="err">#</span>   <span class="n">status</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span>                 <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">st</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="n">ascii</span> <span class="s">&#34;</span><span class="se">\033</span><span class="s">[01;31mHello, OS World</span><span class="se">\033</span><span class="s">[0m</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">ed</span><span class="p">:</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note: gcc æ”¯æŒå¯¹æ±‡ç¼–ä»£ç çš„é¢„ç¼–è¯‘ (è¿˜ä¼šå®šä¹‰ <code>__ASSEMBLER__</code> å®)</p>
<p>è¿è¡ŒæˆåŠŸï¼Œçº¢è‰²çš„hello,worldï¼ˆ<code>linux</code>å¼€å§‹ğŸ’©ğŸ´çŠ¯ç—…ï¼Œç”¨gdbæ‰è°ƒå‡ºæ¥ï¼‰</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-12.png" title="/img/Operating System/chapter2-12.png" data-thumbnail="/img/Operating System/chapter2-12.png" data-sub-html="<h2>è¿è¡Œç¨‹åº(on gdb)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-12.png"
            data-srcset="/img/Operating%20System/chapter2-12.png, /img/Operating%20System/chapter2-12.png 1.5x, /img/Operating%20System/chapter2-12.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-12.png" />
    </a><figcaption class="image-caption">è¿è¡Œç¨‹åº(<code>on gdb</code>)</figcaption>
    </figure>
<p>å®å±•å¼€ç»“æœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gcc -E minmal.S
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">.</span><span class="n">globl</span> <span class="n">_start</span>
</span></span><span class="line"><span class="cl"><span class="nl">_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="n">rax</span> <span class="err">#</span> <span class="n">write</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="n">rdi</span> <span class="err">#</span> <span class="n">fd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="n">st</span><span class="p">,</span> <span class="o">%</span><span class="n">rsi</span> <span class="err">#</span> <span class="n">buf</span><span class="o">=</span><span class="n">st</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="p">(</span><span class="n">ed</span> <span class="o">-</span> <span class="n">st</span><span class="p">),</span> <span class="o">%</span><span class="n">rdx</span> <span class="err">#</span> <span class="n">count</span><span class="o">=</span><span class="n">ed</span><span class="o">-</span><span class="n">st</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span> <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">60</span><span class="p">,</span> <span class="o">%</span><span class="n">rax</span> <span class="err">#</span> <span class="n">exit</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">movq</span> <span class="err">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="n">rdi</span> <span class="err">#</span> <span class="n">status</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">syscall</span> <span class="err">#</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">st</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="n">ascii</span> <span class="s">&#34;</span><span class="se">\033</span><span class="s">[01;31mHello, OS World</span><span class="se">\033</span><span class="s">[0m</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">ed</span><span class="p">:</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ·±ç©¶<code>syscall</code></p>
<p>ä½¿ç”¨å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man syscall
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥ç›´æ¥æŸ¥çœ‹æ‰‹å†Œ</p>
<hr>
<p>å›é¡¾ï¼šçŠ¶æ€æœºè§†è§’çš„ç¨‹åº</p>
<ul>
<li>ç¨‹åº = è®¡ç®— â†’ <code>syscall </code>â†’ è®¡ç®— â†’ &hellip;</li>
</ul>
<h6 id="å½©è›‹ansi-escape-code">å½©è›‹ï¼šANSI Escape Code</h6>
<blockquote>
<p>ä¸ºä»€ä¹ˆ Hello World æœ‰é¢œè‰²ï¼Ÿï¼Ÿ</p>
</blockquote>
<p>ç‰¹æ®Šç¼–ç çš„å­—ç¬¦å®ç°ç»ˆç«¯æ§åˆ¶</p>
<ul>
<li>
<p><a href="https://git.busybox.net/busybox/tree/editors/vi.c" target="_blank" rel="noopener noreffer">vi.c</a> from busybox</p>
</li>
<li>
<p><code>telnet towel.blinkenlights.nl</code> (ç”µå½±ï¼›Ctrl-] and q é€€å‡º)</p>
</li>
<li>
<p><code>dialog --msgbox 'Hello, OS World!' 8 32</code></p>
</li>
<li>
<p><code>ssh sshtron.zachlatta.com</code>(ç½‘ç»œæ¸¸æˆ)</p>
<ul>
<li>
<p>æ‰€ä»¥ç¼–ç¨‹å¯ä»¥ä»ä¸€å¼€å§‹å°±ä¸é‚£ä¹ˆæ¯ç‡¥</p>
</li>
<li>
<p>çœ‹ä¼¼å¤æ‚ï¼Œå®é™…ç®€å•æ˜äº†</p>
</li>
</ul>
</li>
</ul>
<h3 id="ç¼–è¯‘å™¨ä¸ç¼–è¯‘ä¼˜åŒ–">ç¼–è¯‘å™¨ä¸ç¼–è¯‘ä¼˜åŒ–</h3>
<p>â€œçŠ¶æ€æœºâ€ é¡ºä¾¿è§£å†³äº†ä¸€ä¸ªéå¸¸é‡è¦çš„åŸºæœ¬é—®é¢˜ï¼š</p>
<blockquote>
<p>ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨ï¼Ÿï¼Ÿï¼Ÿ</p>
</blockquote>
<p>ç¼–è¯‘å™¨ï¼šæºä»£ç  <code>S</code>(çŠ¶æ€æœº) â†’ äºŒè¿›åˆ¶ä»£ç  <code>C</code> (çŠ¶æ€æœº)</p>
<p>$C = \textrm{compile}(S)\newline$</p>
<p>ç¼–è¯‘ (ä¼˜åŒ–) çš„æ­£ç¡®æ€§ (Soundness):</p>
<ul>
<li><em>S</em> ä¸ <em>C</em> çš„å¯è§‚æµ‹è¡Œä¸ºä¸¥æ ¼ä¸€è‡´
<ul>
<li>system calls; volatile variable loads/stores; termination</li>
</ul>
</li>
<li><code>Trivially</code> æ­£ç¡® (ä½†ä½æ•ˆ) çš„å®ç°
<ul>
<li>è§£é‡Šæ‰§è¡Œ/ç›´æ¥ç¿»è¯‘ <code>S</code>çš„è¯­ä¹‰</li>
</ul>
</li>
</ul>
<h4 id="ç°ä»£-ä¸æœªæ¥çš„-ç¼–è¯‘ä¼˜åŒ–">ç°ä»£ (ä¸æœªæ¥çš„) ç¼–è¯‘ä¼˜åŒ–</h4>
<p>åœ¨ä¿è¯è§‚æµ‹ä¸€è‡´æ€§ (sound) çš„å‰æä¸‹æ”¹å†™ä»£ç  (rewriting)</p>
<ul>
<li>
<p>Inline assembly ä¹Ÿå¯ä»¥å‚ä¸ä¼˜åŒ–</p>
<ul>
<li>å…¶ä»–ä¼˜åŒ–å¯èƒ½ä¼šè·¨è¿‡ä¸å¸¦ barrier çš„ <code>asm volatile</code></li>
</ul>
</li>
<li>
<p>Eventual memory consistency</p>
</li>
<li>
<p>Call to external CU = write back visible memory</p>
<ul>
<li>talk is cheap, show me the code!</li>
</ul>
</li>
</ul>
<hr>
<p>è¿™ç»™äº†æˆ‘ä»¬å¾ˆå¤šæƒ³è±¡çš„ç©ºé—´ï¼ˆğŸ®ğŸºçš„ä¸œè¥¿ï¼‰</p>
<ul>
<li>Semantic-based compilation (synthesis)</li>
<li>AI-based rewriting</li>
<li>Fine-grained semantics &amp; system call fusion</li>
</ul>
<p>ä¸å¯ä¼˜åŒ–çš„éƒ¨åˆ†å¯ä»¥è¿›è¡Œåˆå¹¶ï¼Ÿï¼ˆğŸ®ğŸºçš„ä¸œè¥¿ï¼‰</p>
<h4 id="è¿›å…¥-plprogramming-language-çš„é¢†åŸŸ">è¿›å…¥ PL(Programming language) çš„é¢†åŸŸ</h4>
<p>PL é¢†åŸŸ (çš„å¾ˆå¤šäºº) æœ‰ä¸€ç§å€¾å‘ï¼šç”¨æ•°å­¦åŒ–çš„è¯­è¨€å®šä¹‰å’Œç†è§£ä¸€åˆ‡ (all about semantics)</p>
<ul>
<li><del>æ‰€ä»¥ä½ çœ‹ä¸€çœ¼ paper å°±è§‰å¾—è‡ªå·±çäº†</del></li>
<li>ä½†èƒŒåçš„ç›´è§‰ä¾ç„¶æ˜¯ system/software çš„
<ul>
<li>(æˆ‘ä»¬æ˜¯äººï¼Œä¸æ˜¯æ— æƒ…çš„æ•°å­¦æœºå™¨ ğŸ˜‚)</li>
<li>æºœäº†æºœäº†ï¼Œå›åˆ° system çš„ä¸–ç•Œ</li>
</ul>
</li>
</ul>
<hr>
<p>Further readings</p>
<ul>
<li><a href="https://dl.acm.org/doi/10.1145/2103621.2103719" target="_blank" rel="noopener noreffer">An executable formal semantics of C with applications</a> (POPL'12)</li>
<li><a href="https://compcert.org/motivations.html" target="_blank" rel="noopener noreffer">CompCert C verified compiler</a> and a <a href="https://xavierleroy.org/publi/compcert-backend.pdf" target="_blank" rel="noopener noreffer">paper</a> (POPL'06, Most Influential Paper Award :gold medalğŸ®)</li>
<li><a href="https://dl.acm.org/doi/10.1145/3485513" target="_blank" rel="noopener noreffer">Copy-and-patch compilation</a> (OOPSLA'21, Distinguished Paper ğŸ®)</li>
</ul>
<h3 id="æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åº">æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åº</h3>
<h4 id="æ“ä½œç³»ç»Ÿä¸­çš„ä¸€èˆ¬ç¨‹åº">æ“ä½œç³»ç»Ÿä¸­çš„ä¸€èˆ¬ç¨‹åº</h4>
<blockquote>
<p>å’Œ <a href="https://jyywiki.cn/pages/OS/2022/demos/minimal.S" target="_blank" rel="noopener noreffer">minimal.S</a> æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼šç¨‹åº = è®¡ç®— â†’ syscall â†’ &hellip;</p>
</blockquote>
<p>æ“ä½œç³»ç»Ÿæ”¶ç¼–äº†æ‰€æœ‰çš„ç¡¬ä»¶/è½¯ä»¶èµ„æº</p>
<ul>
<li>åªèƒ½ç”¨æ“ä½œç³»ç»Ÿå…è®¸çš„æ–¹å¼è®¿é—®æ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡
<ul>
<li>ä»è€Œå®ç°æ“ä½œç³»ç»Ÿçš„ â€œéœ¸ä¸»â€ åœ°ä½</li>
<li>ä¾‹å­ï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/tryopen.c" target="_blank" rel="noopener noreffer">tryopen.c</a></li>
</ul>
</li>
<li>è¿™æ˜¯ä¸º â€œç®¡ç†å¤šä¸ªçŠ¶æ€æœºâ€ æ‰€å¿…é¡»çš„
<ul>
<li>ä¸èƒ½æ‰“æ¶ï¼Œè°æœ‰æƒé™å°±ç»™ä»–</li>
</ul>
</li>
</ul>
<p>tryopen.c</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">try_open</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fname</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">O_RDWR</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;open(</span><span class="se">\&#34;</span><span class="s">%s</span><span class="se">\&#34;</span><span class="s">) returns %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">perror</span><span class="p">(</span><span class="s">&#34;  FAIL&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;  SUCCESS!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">try_open</span><span class="p">(</span><span class="s">&#34;/something/not/exist&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">try_open</span><span class="p">(</span><span class="s">&#34;/dev/sda&#34;</span><span class="p">);</span> <span class="c1">// hard drive
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œæ•ˆæœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">jungle@jungle-virtual-machine:~$ gcc tryopen.c <span class="o">&amp;&amp;</span> ./a.out
</span></span><span class="line"><span class="cl">open<span class="o">(</span><span class="s2">&#34;/something/not/exist&#34;</span><span class="o">)</span> returns -1
</span></span><span class="line"><span class="cl">  FAIL: No such file or directory
</span></span><span class="line"><span class="cl">open<span class="o">(</span><span class="s2">&#34;/dev/sda&#34;</span><span class="o">)</span> returns -1
</span></span><span class="line"><span class="cl">  FAIL: Permission denied
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="äºŒè¿›åˆ¶-ç¨‹åºä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡">(äºŒè¿›åˆ¶) ç¨‹åºä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡</h4>
<p>å¯æ‰§è¡Œæ–‡ä»¶</p>
<ul>
<li>ä¸å¤§å®¶æ—¥å¸¸ä½¿ç”¨çš„æ–‡ä»¶ (a.c, README.txt) æ²¡æœ‰æœ¬è´¨åŒºåˆ«</li>
<li>æ“ä½œç³»ç»Ÿæä¾› API æ‰“å¼€ã€è¯»å–ã€æ”¹å†™ (éƒ½éœ€è¦ç›¸åº”çš„æƒé™)</li>
</ul>
<hr>
<p>æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶</p>
<ul>
<li>
<p><code>vim</code>,<code>cat</code>,<code>xxd</code></p>
<p>éƒ½å¯ä»¥ç›´æ¥æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶</p>
<ul>
<li><code>vim</code> ä¸­äºŒè¿›åˆ¶çš„éƒ¨åˆ†æ— æ³• â€œé˜…è¯»â€ï¼Œä½†å¯ä»¥çœ‹åˆ°å­—ç¬¦ä¸²å¸¸é‡</li>
<li>ä½¿ç”¨ <code>xxd</code> å¯ä»¥çœ‹åˆ°æ–‡ä»¶ä»¥ <code>&quot;\x7f&quot; &quot;ELF&quot;</code> å¼€å¤´</li>
<li>vscode æœ‰ <code>binary editor</code> æ’ä»¶</li>
</ul>
</li>
</ul>
<h4 id="ç³»ç»Ÿä¸­å¸¸è§çš„åº”ç”¨ç¨‹åº">ç³»ç»Ÿä¸­å¸¸è§çš„åº”ç”¨ç¨‹åº</h4>
<p>Core Utilities (coreutils)</p>
<ul>
<li><em>standard</em> programs for text and file manipulation</li>
<li>ç³»ç»Ÿä¸­å®‰è£…çš„æ˜¯ <a href="https://www.gnu.org/software/coreutils/" target="_blank" rel="noopener noreffer">GNU Coreutils</a>
<ul>
<li>æœ‰è¾ƒå°çš„æ›¿ä»£å“ <a href="https://www.busybox.net/" target="_blank" rel="noopener noreffer">busybox</a></li>
</ul>
</li>
</ul>
<hr>
<p>ç³»ç»Ÿ/å·¥å…·ç¨‹åº</p>
<ul>
<li>
<p>bash,binutils, apt, ip, ssh, vim, tmux, jdk, python, &hellip;</p>
<ul>
<li>
<p>è¿™äº›å·¥å…·çš„åŸç†éƒ½ä¸å¤æ‚ (ä¾‹å¦‚ apt å…¶å®åªæ˜¯ dpkg çš„å£³)</p>
</li>
<li>
<p><a href="https://packages.ubuntu.com/" target="_blank" rel="noopener noreffer">Ubuntu Packages</a> (å’Œ apt-file å·¥å…·) æ”¯æŒæ–‡ä»¶åæ£€ç´¢</p>
<ul>
<li>ä¾‹å­ï¼šæ‰¾ä¸åˆ° <code>SDL2/SDL.h</code> æ—¶&hellip;</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p>å…¶ä»–å„ç§åº”ç”¨ç¨‹åº</p>
<ul>
<li>æµè§ˆå™¨ã€éŸ³ä¹æ’­æ”¾å™¨â€¦â€¦</li>
</ul>
<h4 id="æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åºdark-side">æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åºï¼šDark Side</h4>
<blockquote>
<p>æ€äººçš„é¢è¯•é¢˜ (1)ï¼šä¸€ä¸ªæ™®é€šçš„ã€äººç•œæ— å®³çš„ Hello World C ç¨‹åºæ‰§è¡Œçš„ç¬¬ä¸€æ¡æŒ‡ä»¤åœ¨å“ªé‡Œï¼Ÿ</p>
</blockquote>
<p>ç­‰ä»·é—®æ³•</p>
<ul>
<li>â€œäºŒè¿›åˆ¶ç¨‹åºçŠ¶æ€æœºçš„åˆå§‹çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿâ€
<ul>
<li><code>main</code> çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ âŒ</li>
<li><code>libc</code> çš„ <code>_start</code> âŒ</li>
</ul>
</li>
</ul>
<hr>
<p>é—® gdb å§</p>
<ul>
<li><code>info proc {mappings,...}</code> - æ‰“å°è¿›ç¨‹å†…å­˜</li>
</ul>
<p>ä½¿ç”¨<code>gdb</code></p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-13.png" title="/img/Operating System/chapter2-13.png" data-thumbnail="/img/Operating System/chapter2-13.png" data-sub-html="<h2>gdb(æŸ¥çœ‹å…¥å£)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-13.png"
            data-srcset="/img/Operating%20System/chapter2-13.png, /img/Operating%20System/chapter2-13.png 1.5x, /img/Operating%20System/chapter2-13.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-13.png" />
    </a><figcaption class="image-caption">gdb(<code>æŸ¥çœ‹å…¥å£</code>)</figcaption>
    </figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">0x00007ffff7fe32b0 in _start <span class="o">()</span> from /lib64/ld-linux-x86-64.so.2
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨<code>info proc mappings</code>å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> info proc mappings 
</span></span><span class="line"><span class="cl">process <span class="m">48808</span>
</span></span><span class="line"><span class="cl">Mapped address spaces:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Start Addr           End Addr       Size     Offset  Perms  objfile
</span></span><span class="line"><span class="cl">      0x555555554000     0x555555555000     0x1000        0x0  r--p   /home/jungle/a.out
</span></span><span class="line"><span class="cl">      0x555555555000     0x555555556000     0x1000     0x1000  r-xp   /home/jungle/a.out
</span></span><span class="line"><span class="cl">      0x555555556000     0x555555557000     0x1000     0x2000  r--p   /home/jungle/a.out
</span></span><span class="line"><span class="cl">      0x555555557000     0x555555559000     0x2000     0x2000  rw-p   /home/jungle/a.out
</span></span><span class="line"><span class="cl">      0x7ffff7fbd000     0x7ffff7fc1000     0x4000        0x0  r--p   <span class="o">[</span>vvar<span class="o">]</span>
</span></span><span class="line"><span class="cl">      0x7ffff7fc1000     0x7ffff7fc3000     0x2000        0x0  r-xp   <span class="o">[</span>vdso<span class="o">]</span>
</span></span><span class="line"><span class="cl">      0x7ffff7fc3000     0x7ffff7fc5000     0x2000        0x0  r--p   /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">      0x7ffff7fc5000     0x7ffff7fef000    0x2a000     0x2000  r-xp   /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">      0x7ffff7fef000     0x7ffff7ffa000     0xb000    0x2c000  r--p   /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">      0x7ffff7ffb000     0x7ffff7fff000     0x4000    0x37000  rw-p   /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">      0x7ffffffde000     0x7ffffffff000    0x21000        0x0  rw-p   <span class="o">[</span>stack<span class="o">]</span>
</span></span><span class="line"><span class="cl">  0xffffffffff600000 0xffffffffff601000     0x1000        0x0  --xp   <span class="o">[</span>vsyscall<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="main-ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆ"><code>main()</code> ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h5>
<p><code>ld-linux-x86-64.so</code> åŠ è½½äº† libc</p>
<ul>
<li>ä¹‹å libc å®Œæˆäº†è‡ªå·±çš„åˆå§‹åŒ–
<ul>
<li>RTFM: <a href="https://www.gnu.org/software/hurd/glibc/startup.html" target="_blank" rel="noopener noreffer">libc startup</a> on Hurd</li>
<li><code>main()</code> çš„å¼€å§‹/ç»“æŸå¹¶ä¸æ˜¯æ•´ä¸ªç¨‹åºçš„å¼€å§‹/ç»“æŸ</li>
<li>ä¾‹å­ï¼š<a href="https://jyywiki.cn/pages/OS/2022/demos/hello-goodbye.c" target="_blank" rel="noopener noreffer">hello-goodbye.c</a></li>
</ul>
</li>
</ul>
<hr>
<p>è°è§„å®šæ˜¯ <code>ld-linux-x86-64.so</code>ï¼Œè€Œä¸æ˜¯ <code>rtfm.so</code>ï¼Ÿ</p>
<ul>
<li>readelf å‘Šè¯‰ä½ ç­”æ¡ˆ</li>
<li>(è®¡ç®—æœºç³»ç»Ÿä¸å­˜åœ¨ç„å­¦ï¼›ä¸€åˆ‡éƒ½å»ºç«‹åœ¨ç¡®å®šçš„æœºåˆ¶ä¸Š)
<ul>
<li>å›é¡¾ <code>gcc --verbose</code></li>
</ul>
</li>
</ul>
<p><code>hello-goodbye.c</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="n">__attribute__</span><span class="p">((</span><span class="n">constructor</span><span class="p">))</span> <span class="kt">void</span> <span class="n">hello</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hello, World</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// See also: atexit(3)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">__attribute__</span><span class="p">((</span><span class="n">destructor</span><span class="p">))</span> <span class="kt">void</span> <span class="n">goodbye</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Goodbye, Cruel OS World!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="/img/Operating%20System/chapter2-14.png" title="/img/Operating System/chapter2-14.png" data-thumbnail="/img/Operating System/chapter2-14.png" data-sub-html="<h2>vim(æ±‡ç¼–ä»£ç )</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-14.png"
            data-srcset="/img/Operating%20System/chapter2-14.png, /img/Operating%20System/chapter2-14.png 1.5x, /img/Operating%20System/chapter2-14.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-14.png" />
    </a><figcaption class="image-caption">vim(<code>æ±‡ç¼–ä»£ç </code>)</figcaption>
    </figure>
<p>åé¢è€å¸ˆhackeræ”¹äºŒè¿›åˆ¶ä»£ç çš„æ—¶å€™âœŒï¸çš„ğŸ‘€å·²ç»è·Ÿä¸ä¸Šäº†ï¼Œè„‘å­æ›´æ˜¯ç›´æ¥ğŸ’©ğŸ´</p>
<blockquote>
<p>æ€äººçš„é¢è¯•é¢˜ (2)ï¼šmain æ‰§è¡Œä¹‹å‰ã€æ‰§è¡Œä¸­ã€æ‰§è¡Œåï¼Œå‘ç”Ÿäº†å“ªäº›æ“ä½œç³»ç»Ÿ API è°ƒç”¨ï¼Ÿ</p>
</blockquote>
<hr>
<p>å‘ƒâ€¦â€¦</p>
<ul>
<li>(è®¡ç®—æœºç³»ç»Ÿä¸å­˜åœ¨ç„å­¦ï¼›ä¸€åˆ‡éƒ½å»ºç«‹åœ¨ç¡®å®šçš„æœºåˆ¶ä¸Š)</li>
<li>æ‰€ä»¥ä½ åº”è¯¥æœ‰ä¸€ä¸ªå¼ºçƒˆçš„ä¿¡å¿µï¼šè¿™ä¸ªé—®é¢˜æ˜¯å¯ä»¥å›ç­”çš„</li>
</ul>
<h4 id="æ‰“å¼€ç¨‹åºçš„æ‰§è¡Œtrace-è¸ªè¿¹">æ‰“å¼€ç¨‹åºçš„æ‰§è¡Œï¼šTrace (è¸ªè¿¹)</h4>
<blockquote>
<p>In general, trace refers to the process of following <em>anything</em> from the beginning to the end. For example, the <code>traceroute</code> command follows each of the network hops as your computer connects to another computer.</p>
</blockquote>
<p>è¿™é—¨è¯¾ä¸­å¾ˆé‡è¦çš„å·¥å…·ï¼šstrace</p>
<ul>
<li>system call trace</li>
<li>ç†è§£ç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨
<ul>
<li>demo: <code>strace ./hello-goodbye</code></li>
<li>åœ¨è¿™é—¨è¯¾ä¸­ï¼Œä½ èƒ½ç†è§£ strace çš„è¾“å‡ºå¹¶åœ¨ä½ è‡ªå·±çš„æ“ä½œç³»ç»Ÿé‡Œå®ç°ç›¸å½“ä¸€éƒ¨åˆ†ç³»ç»Ÿè°ƒç”¨ (mmap, execve, &hellip;)</li>
</ul>
</li>
</ul>
<p>ä½¿ç”¨<code>strace</code></p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-15.png" title="/img/Operating System/chapter2-15.png" data-thumbnail="/img/Operating System/chapter2-15.png" data-sub-html="<h2>linux(ä½¿ç”¨strace)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-15.png"
            data-srcset="/img/Operating%20System/chapter2-15.png, /img/Operating%20System/chapter2-15.png 1.5x, /img/Operating%20System/chapter2-15.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-15.png" />
    </a><figcaption class="image-caption">linux(<code>ä½¿ç”¨strace</code>)</figcaption>
    </figure>
<h4 id="æœ¬è´¨ä¸Šæ‰€æœ‰çš„ç¨‹åºå’Œ-hello-world-ç±»ä¼¼">æœ¬è´¨ä¸Šï¼Œæ‰€æœ‰çš„ç¨‹åºå’Œ Hello World ç±»ä¼¼</h4>
<p>ç¨‹åº = çŠ¶æ€æœº = è®¡ç®— â†’ syscall â†’ è®¡ç®— â†’</p>
<ul>
<li>
<p>è¢«æ“ä½œç³»ç»ŸåŠ è½½</p>
<ul>
<li>é€šè¿‡å¦ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œ execve è®¾ç½®ä¸ºåˆå§‹çŠ¶æ€</li>
</ul>
</li>
<li>
<p>çŠ¶æ€æœºæ‰§è¡Œ</p>
<ul>
<li>è¿›ç¨‹ç®¡ç†ï¼šfork, execve, exit, &hellip;</li>
<li>æ–‡ä»¶/è®¾å¤‡ç®¡ç†ï¼šopen, close, read, write, &hellip;</li>
<li>å­˜å‚¨ç®¡ç†ï¼šmmap, brk, &hellip;</li>
</ul>
</li>
<li>
<p>ç›´åˆ° _exit (exit_group) é€€å‡º</p>
</li>
</ul>
<hr>
<ul>
<li>è¯´å¥½çš„æµè§ˆå™¨ã€æ¸¸æˆã€æ€æ¯’è½¯ä»¶ã€ç—…æ¯’å‘¢ï¼Ÿéƒ½æ˜¯è¿™äº› API å—ï¼ŸğŸ’¢ğŸ’¢ğŸ’¢(éƒ½æ˜¯) $\rightarrow$ğŸ®ğŸº</li>
</ul>
<h4 id="yes---è¿™äº›-api-å°±æ˜¯æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨">Yes! - è¿™äº› API å°±æ˜¯æ“ä½œç³»ç»Ÿçš„å…¨éƒ¨</h4>
<p>ç¼–è¯‘å™¨ (gcc)ï¼Œä»£è¡¨å…¶ä»–å·¥å…·ç¨‹åº</p>
<ul>
<li>
<p>ä¸»è¦çš„ç³»ç»Ÿè°ƒç”¨ï¼šexecve, read, write</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">strace -f gcc a.c
</span></span></code></pre></td></tr></table>
</div>
</div><p>(gcc ä¼šå¯åŠ¨å…¶ä»–è¿›ç¨‹)</p>
<ul>
<li>å¯ä»¥ç®¡é“ç»™ç¼–è¾‘å™¨ <code>vim -</code></li>
<li>ç¼–è¾‘å™¨é‡Œè¿˜å¯ä»¥ <code>%!grep</code> (ç»†èŠ‚/æŠ€å·§)</li>
</ul>
</li>
</ul>
<hr>
<p>å›¾å½¢ç•Œé¢ç¨‹åº (xedit)ï¼Œä»£è¡¨å…¶ä»–å›¾å½¢ç•Œé¢ç¨‹åº (ä¾‹å¦‚ vscode)</p>
<ul>
<li>
<p>ä¸»è¦çš„ç³»ç»Ÿè°ƒç”¨ï¼špoll, recvmsg, writev</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">strace xedit
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å›¾å½¢ç•Œé¢ç¨‹åºå’Œ X-Window æœåŠ¡å™¨æŒ‰ç…§ X11 åè®®é€šä¿¡</li>
<li>è™šæ‹Ÿæœºä¸­çš„ <code>xedit</code> å°† <code>X11</code> å‘½ä»¤é€šè¿‡<code>ssh</code>(X11 forwarding) è½¬å‘åˆ° Host</li>
</ul>
</li>
</ul>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-16.png" title="/img/Operating System/chapter2-16.png" data-thumbnail="/img/Operating System/chapter2-16.png" data-sub-html="<h2>strace(xedit)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-16.png"
            data-srcset="/img/Operating%20System/chapter2-16.png, /img/Operating%20System/chapter2-16.png 1.5x, /img/Operating%20System/chapter2-16.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-16.png" />
    </a><figcaption class="image-caption">strace(<code>xedit</code>)</figcaption>
    </figure>
<h4 id="å„å¼å„æ ·çš„åº”ç”¨ç¨‹åº">å„å¼å„æ ·çš„åº”ç”¨ç¨‹åº</h4>
<p>éƒ½åœ¨æ“ä½œç³»ç»Ÿ API (syscall) å’Œæ“ä½œç³»ç»Ÿä¸­çš„å¯¹è±¡ä¸Šæ„å»º</p>
<ul>
<li>çª—å£ç®¡ç†å™¨
<ul>
<li>ç®¡ç†è®¾å¤‡å’Œå±å¹• (read/write/mmap)</li>
<li>è¿›ç¨‹é—´é€šä¿¡ (send, recv)</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>ä»»åŠ¡ç®¡ç†å™¨
<ul>
<li>è®¿é—®æ“ä½œç³»ç»Ÿæä¾›çš„è¿›ç¨‹å¯¹è±¡ (readdir/read)</li>
<li>å‚è€ƒ gdb é‡Œçš„ <code>info proc *</code></li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>æ€æ¯’è½¯ä»¶
<ul>
<li>æ–‡ä»¶é™æ€æ‰«æ (read)</li>
<li>ä¸»åŠ¨é˜²å¾¡ (ptrace)</li>
<li>å…¶ä»–æ›´å¤æ‚çš„å®‰å…¨æœºåˆ¶â€¦â€¦</li>
</ul>
</li>
</ul>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>æœ¬æ¬¡è¯¾å›ç­”çš„é—®é¢˜</p>
<ul>
<li><strong>Q</strong>: åˆ°åº•ä»€ä¹ˆæ˜¯ â€œç¨‹åºâ€ï¼Ÿ</li>
</ul>
<hr>
<p>$Take-away\ message\newline$</p>
<ul>
<li>ç¨‹åº = çŠ¶æ€æœº
<ul>
<li>æºä»£ç  S: çŠ¶æ€è¿ç§» = æ‰§è¡Œè¯­å¥</li>
<li>äºŒè¿›åˆ¶ä»£ç  C: çŠ¶æ€è¿ç§» = æ‰§è¡ŒæŒ‡ä»¤</li>
<li>ç¼–è¯‘å™¨ $C=compile(S)\newline$</li>
</ul>
</li>
<li>åº”ç”¨è§†è§’çš„æ“ä½œç³»ç»Ÿ
<ul>
<li>å°±æ˜¯ä¸€æ¡ <code>syscall</code> æŒ‡ä»¤</li>
</ul>
</li>
<li>è®¡ç®—æœºç³»ç»Ÿä¸å­˜åœ¨ç„å­¦ï¼›ä¸€åˆ‡éƒ½å»ºç«‹åœ¨ç¡®å®šçš„æœºåˆ¶ä¸Š
<ul>
<li>ç†è§£æ“ä½œç³»ç»Ÿçš„é‡è¦å·¥å…·ï¼š<code>gcc</code>, <code>binutils</code>, <code>gdb</code>, <code>strace</code></li>
</ul>
</li>
</ul>
<h3 id="ä¸ªäººçš„ä¸€äº›è¡¥å……">ä¸ªäººçš„ä¸€äº›è¡¥å……</h3>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="typeit"><div id="id-3" class=""></div></div>
</div>
        </div>
    </div>
<p>æ–°å­¦æœŸå¼€è¯¾ï¼Œä¹Ÿä¸Šäº†æ“ä½œç³»ç»Ÿï¼Œå½“ç„¶ï¼Œè€å¸ˆå¿µpptè®²çš„ä¹Ÿç¡®å®æ˜¯ğŸ’©ğŸ´åœ°å¬ä¸æ‡‚ï¼Œä»Šæ™šåšä½œä¸šï¼Œå…¶ä¸­ä¹Ÿæœ‰æœ‰å…³<b>System call</b>çš„ä¸€äº›ç›¸å…³é—®é¢˜ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªæœ€ç®€å•çš„Cç¨‹åº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åç”¨gdbè°ƒè¯•äº†ä¸€ä¸‹</p>
<figure><a class="lightgallery" href="/img/Operating%20System/chapter2-17.png" title="/img/Operating System/chapter2-17.png" data-thumbnail="/img/Operating System/chapter2-17.png" data-sub-html="<h2>gdb $\Longrightarrow$ layout asm</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/Operating%20System/chapter2-17.png"
            data-srcset="/img/Operating%20System/chapter2-17.png, /img/Operating%20System/chapter2-17.png 1.5x, /img/Operating%20System/chapter2-17.png 2x"
            data-sizes="auto"
            alt="/img/Operating System/chapter2-17.png" />
    </a><figcaption class="image-caption">gdb $\Longrightarrow$ <code>layout asm</code></figcaption>
    </figure>
<p>å¿½ç„¶å¯¹å‰é¢è¿™äº›æŒ‡ä»¤çš„è°ƒç”¨æœ‰äº†äº›å…´è¶£ï¼Œ&lt;_do_global_dtors_aux&gt;æ˜¯ä¸ªå•¥ï¼Ÿ&lt;frame_dummy&gt;åˆæ˜¯ä¸ªå•¥ï¼Œç»“æœç”¨è¿™äº›åå­—æ‰¾åˆ°äº†ä¸€ä¸ªè®²çš„éå¸¸ç»†çš„åšå®¢<a href="https://luomuxiaoxiao.com/?p=516" target="_blank" rel="noopener noreffer">ã€ŠLinux X86 ç¨‹åºå¯åŠ¨ â€“ mainå‡½æ•°æ˜¯å¦‚ä½•è¢«æ‰§è¡Œçš„ï¼Ÿâ€”â€”è½æœ¨è§è§çš„åšå®¢ã€‹</a>ï¼Œä¸è¿‡å†…å®¹çœŸçš„æ˜¯å¤ªå¤šäº†ï¼Œå…ˆç«‹ä¸€ä¸ªflagï¼Œè¿™ä¸¤å‘¨ä¸€å®šè¦æ‰¾æ—¶é—´ç»™è¯»ä¸€éï¼Œå®Œä¸æˆå°±å…¨éƒ¨ğŸ’©ğŸ´</p>
<hr>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="typeit"><div id="id-4" class=""></div></div>
</div>
        </div>
    </div>
<p>çœ‹äº†ä¸€éƒ¨åˆ†è¯¥æ–‡ç« ï¼Œå¤ªé•¿äº†ï¼Œå…ˆçœ‹ä¸€å°åŠï¼Œå› ä¸ºæ˜¯32ä½çš„è€ç‰ˆæœ¬Linuxï¼Œå¾ˆå¤šä¸œè¥¿ä¸èƒ½å®Œå…¨å¤ç°</p>
<p>$\Longrightarrow$ <a href="https://jungle430.github.io/posts/operating-system/support2/" target="_blank" rel="noopener noreffer">ã€ŠLinux x86 Program Start Up or - How the heck do we get to main()?ã€‹</a></p>
<p><b>å£°æ˜ï¼šæœ¬æ–‡ç« å¼•ç”¨èµ„æ–™ä¸å›¾åƒå‡å·²åšæ ‡æ³¨ï¼Œå¦‚æœ‰ä¾µæƒæœ¬äººä¼šé©¬ä¸Šåˆ é™¤</b></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/operating-system/">Operating System</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>æ›´æ–°äº 2022-12-31</span>
            </div><div class="post-info-mod"></div>
        </div><div class="post-info-share">
            <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº" data-hashtags="Operating System"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-hashtag="Operating System"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Linkedin" data-sharer="linkedin" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° WhatsApp" data-sharer="whatsapp" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº"><i class="fab fa-line fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Myspace" data-sharer="myspace" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Blogger" data-sharer="blogger" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° ç™¾åº¦" data-sharer="baidu" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº"><i data-svg-src="/lib/simple-icons/icons/baidu.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://Jungle430.github.io/posts/operating-system/operating-system-chapter2/" data-title="Operating System Chapter2 æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº"><i class="fab fa-evernote fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="/posts/opencv/opencv-chapter1/" class="prev" rel="prev" title="OpenCV Chapter1 åŸºæœ¬æ“ä½œä¸é˜ˆå€¼å¤„ç†"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/operating-system/operating-system-chapter3/" class="next" rel="next" title="Operating System Chapter3 å¤šå¤„ç†å™¨ç¼–ç¨‹ï¼šä»å…¥é—¨åˆ°æ”¾å¼ƒ">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.105.0">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/Jungle430">Jungle</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
</div>
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker
        .register('/sw.min.js?version=0.0.1', { scope: '/' })
        .then(() => {
            console.info('Jungle\u0027s Blog\u00A0Service Worker Registered');
        }, err => console.error('Jungle\u0027s Blog\u00A0Service Worker registration failed: ', err));

    navigator.serviceWorker
        .ready
        .then(() => {
            console.info('Jungle\u0027s Blog\u00A0Service Worker Ready');
        });
}
</script>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/typeit/typeit.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/auto-render.min.js"></script><script src="/lib/katex/copy-tex.min.js"></script><script src="/lib/katex/mhchem.min.js"></script><script src="/lib/mermaid/mermaid.min.js"></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":100},"comment":{},"data":{"id-1":"graph TB\nA((00))\nB((01))\nC((10))\nA--\u003eB--clk--\u003eC--\u003eA","id-2":"graph LR\n1(åˆå§‹çŠ¶æ€)\n2(1 state)\n3(2 state)\n4(3 state)\n5(......)\n1--è®¡ç®—æŒ‡ä»¤--\u003e2--è®¡ç®—æŒ‡ä»¤--\u003e3--syscall--\u003e4--è®¡ç®—æŒ‡ä»¤/syscall--\u003e5","id-3":"Update in 2023-02-25","id-4":"Update in 2023-03-04"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"typeit":{"cursorChar":"","cursorSpeed":1000,"data":{"id-3":["id-3"],"id-4":["id-4"]},"duration":-1,"speed":100}};</script><script src="/js/theme.min.js"></script></body></html>
